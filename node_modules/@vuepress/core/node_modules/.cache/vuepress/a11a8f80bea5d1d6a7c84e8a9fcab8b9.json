{"remainingRequest":"F:\\fortivex\\vuepress-tutorial\\docs\\node_modules\\babel-loader\\lib\\index.js??ref--3-1!F:\\fortivex\\vuepress-tutorial\\docs\\node_modules\\vue\\dist\\vue.runtime.esm.js","dependencies":[{"path":"F:\\fortivex\\vuepress-tutorial\\docs\\node_modules\\vue\\dist\\vue.runtime.esm.js","mtime":1765807960472},{"path":"F:\\fortivex\\vuepress-tutorial\\docs\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1765807958813},{"path":"F:\\fortivex\\vuepress-tutorial\\docs\\node_modules\\babel-loader\\lib\\index.js","mtime":1765807958345}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdXBwcmVzc2VkLWVycm9yLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnJlZHVjZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZXZlcnkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLnJlZHVjZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLnNvbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5qc29uLnN0cmluZ2lmeS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZmxlY3QudG8tc3RyaW5nLXRhZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5kaWZmZXJlbmNlLnYyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0LmludGVyc2VjdGlvbi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5pcy1kaXNqb2ludC1mcm9tLnYyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0LmlzLXN1YnNldC1vZi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5pcy1zdXBlcnNldC1vZi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5zeW1tZXRyaWMtZGlmZmVyZW5jZS52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC51bmlvbi52Mi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5pbW1lZGlhdGUuanMiOwovKiEKICogVnVlLmpzIHYyLjcuMTYKICogKGMpIDIwMTQtMjAyMyBFdmFuIFlvdQogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuCiAqLwp2YXIgZW1wdHlPYmplY3QgPSBPYmplY3QuZnJlZXplKHt9KTsKdmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5OwovLyBUaGVzZSBoZWxwZXJzIHByb2R1Y2UgYmV0dGVyIFZNIGNvZGUgaW4gSlMgZW5naW5lcyBkdWUgdG8gdGhlaXIKLy8gZXhwbGljaXRuZXNzIGFuZCBmdW5jdGlvbiBpbmxpbmluZy4KZnVuY3Rpb24gaXNVbmRlZih2KSB7CiAgcmV0dXJuIHYgPT09IHVuZGVmaW5lZCB8fCB2ID09PSBudWxsOwp9CmZ1bmN0aW9uIGlzRGVmKHYpIHsKICByZXR1cm4gdiAhPT0gdW5kZWZpbmVkICYmIHYgIT09IG51bGw7Cn0KZnVuY3Rpb24gaXNUcnVlKHYpIHsKICByZXR1cm4gdiA9PT0gdHJ1ZTsKfQpmdW5jdGlvbiBpc0ZhbHNlKHYpIHsKICByZXR1cm4gdiA9PT0gZmFsc2U7Cn0KLyoqCiAqIENoZWNrIGlmIHZhbHVlIGlzIHByaW1pdGl2ZS4KICovCmZ1bmN0aW9uIGlzUHJpbWl0aXZlKHZhbHVlKSB7CiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyB8fAogIC8vICRmbG93LWRpc2FibGUtbGluZQogIHR5cGVvZiB2YWx1ZSA9PT0gJ3N5bWJvbCcgfHwgdHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbic7Cn0KZnVuY3Rpb24gaXNGdW5jdGlvbih2YWx1ZSkgewogIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbic7Cn0KLyoqCiAqIFF1aWNrIG9iamVjdCBjaGVjayAtIHRoaXMgaXMgcHJpbWFyaWx5IHVzZWQgdG8gdGVsbAogKiBvYmplY3RzIGZyb20gcHJpbWl0aXZlIHZhbHVlcyB3aGVuIHdlIGtub3cgdGhlIHZhbHVlCiAqIGlzIGEgSlNPTi1jb21wbGlhbnQgdHlwZS4KICovCmZ1bmN0aW9uIGlzT2JqZWN0KG9iaikgewogIHJldHVybiBvYmogIT09IG51bGwgJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCc7Cn0KLyoqCiAqIEdldCB0aGUgcmF3IHR5cGUgc3RyaW5nIG9mIGEgdmFsdWUsIGUuZy4sIFtvYmplY3QgT2JqZWN0XS4KICovCnZhciBfdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nOwpmdW5jdGlvbiB0b1Jhd1R5cGUodmFsdWUpIHsKICByZXR1cm4gX3RvU3RyaW5nLmNhbGwodmFsdWUpLnNsaWNlKDgsIC0xKTsKfQovKioKICogU3RyaWN0IG9iamVjdCB0eXBlIGNoZWNrLiBPbmx5IHJldHVybnMgdHJ1ZQogKiBmb3IgcGxhaW4gSmF2YVNjcmlwdCBvYmplY3RzLgogKi8KZnVuY3Rpb24gaXNQbGFpbk9iamVjdChvYmopIHsKICByZXR1cm4gX3RvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgT2JqZWN0XSc7Cn0KZnVuY3Rpb24gaXNSZWdFeHAodikgewogIHJldHVybiBfdG9TdHJpbmcuY2FsbCh2KSA9PT0gJ1tvYmplY3QgUmVnRXhwXSc7Cn0KLyoqCiAqIENoZWNrIGlmIHZhbCBpcyBhIHZhbGlkIGFycmF5IGluZGV4LgogKi8KZnVuY3Rpb24gaXNWYWxpZEFycmF5SW5kZXgodmFsKSB7CiAgdmFyIG4gPSBwYXJzZUZsb2F0KFN0cmluZyh2YWwpKTsKICByZXR1cm4gbiA+PSAwICYmIE1hdGguZmxvb3IobikgPT09IG4gJiYgaXNGaW5pdGUodmFsKTsKfQpmdW5jdGlvbiBpc1Byb21pc2UodmFsKSB7CiAgcmV0dXJuIGlzRGVmKHZhbCkgJiYgdHlwZW9mIHZhbC50aGVuID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiB2YWwuY2F0Y2ggPT09ICdmdW5jdGlvbic7Cn0KLyoqCiAqIENvbnZlcnQgYSB2YWx1ZSB0byBhIHN0cmluZyB0aGF0IGlzIGFjdHVhbGx5IHJlbmRlcmVkLgogKi8KZnVuY3Rpb24gdG9TdHJpbmcodmFsKSB7CiAgcmV0dXJuIHZhbCA9PSBudWxsID8gJycgOiBBcnJheS5pc0FycmF5KHZhbCkgfHwgaXNQbGFpbk9iamVjdCh2YWwpICYmIHZhbC50b1N0cmluZyA9PT0gX3RvU3RyaW5nID8gSlNPTi5zdHJpbmdpZnkodmFsLCByZXBsYWNlciwgMikgOiBTdHJpbmcodmFsKTsKfQpmdW5jdGlvbiByZXBsYWNlcihfa2V5LCB2YWwpIHsKICAvLyBhdm9pZCBjaXJjdWxhciBkZXBzIGZyb20gdjMKICBpZiAodmFsICYmIHZhbC5fX3ZfaXNSZWYpIHsKICAgIHJldHVybiB2YWwudmFsdWU7CiAgfQogIHJldHVybiB2YWw7Cn0KLyoqCiAqIENvbnZlcnQgYW4gaW5wdXQgdmFsdWUgdG8gYSBudW1iZXIgZm9yIHBlcnNpc3RlbmNlLgogKiBJZiB0aGUgY29udmVyc2lvbiBmYWlscywgcmV0dXJuIG9yaWdpbmFsIHN0cmluZy4KICovCmZ1bmN0aW9uIHRvTnVtYmVyKHZhbCkgewogIHZhciBuID0gcGFyc2VGbG9hdCh2YWwpOwogIHJldHVybiBpc05hTihuKSA/IHZhbCA6IG47Cn0KLyoqCiAqIE1ha2UgYSBtYXAgYW5kIHJldHVybiBhIGZ1bmN0aW9uIGZvciBjaGVja2luZyBpZiBhIGtleQogKiBpcyBpbiB0aGF0IG1hcC4KICovCmZ1bmN0aW9uIG1ha2VNYXAoc3RyLCBleHBlY3RzTG93ZXJDYXNlKSB7CiAgdmFyIG1hcCA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgdmFyIGxpc3QgPSBzdHIuc3BsaXQoJywnKTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHsKICAgIG1hcFtsaXN0W2ldXSA9IHRydWU7CiAgfQogIHJldHVybiBleHBlY3RzTG93ZXJDYXNlID8gZnVuY3Rpb24gKHZhbCkgewogICAgcmV0dXJuIG1hcFt2YWwudG9Mb3dlckNhc2UoKV07CiAgfSA6IGZ1bmN0aW9uICh2YWwpIHsKICAgIHJldHVybiBtYXBbdmFsXTsKICB9Owp9Ci8qKgogKiBDaGVjayBpZiBhIHRhZyBpcyBhIGJ1aWx0LWluIHRhZy4KICovCnZhciBpc0J1aWx0SW5UYWcgPSBtYWtlTWFwKCdzbG90LGNvbXBvbmVudCcsIHRydWUpOwovKioKICogQ2hlY2sgaWYgYW4gYXR0cmlidXRlIGlzIGEgcmVzZXJ2ZWQgYXR0cmlidXRlLgogKi8KdmFyIGlzUmVzZXJ2ZWRBdHRyaWJ1dGUgPSBtYWtlTWFwKCdrZXkscmVmLHNsb3Qsc2xvdC1zY29wZSxpcycpOwovKioKICogUmVtb3ZlIGFuIGl0ZW0gZnJvbSBhbiBhcnJheS4KICovCmZ1bmN0aW9uIHJlbW92ZSQyKGFyciwgaXRlbSkgewogIHZhciBsZW4gPSBhcnIubGVuZ3RoOwogIGlmIChsZW4pIHsKICAgIC8vIGZhc3QgcGF0aCBmb3IgdGhlIG9ubHkgLyBsYXN0IGl0ZW0KICAgIGlmIChpdGVtID09PSBhcnJbbGVuIC0gMV0pIHsKICAgICAgYXJyLmxlbmd0aCA9IGxlbiAtIDE7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHZhciBpbmRleCA9IGFyci5pbmRleE9mKGl0ZW0pOwogICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgcmV0dXJuIGFyci5zcGxpY2UoaW5kZXgsIDEpOwogICAgfQogIH0KfQovKioKICogQ2hlY2sgd2hldGhlciBhbiBvYmplY3QgaGFzIHRoZSBwcm9wZXJ0eS4KICovCnZhciBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7CmZ1bmN0aW9uIGhhc093bihvYmosIGtleSkgewogIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTsKfQovKioKICogQ3JlYXRlIGEgY2FjaGVkIHZlcnNpb24gb2YgYSBwdXJlIGZ1bmN0aW9uLgogKi8KZnVuY3Rpb24gY2FjaGVkKGZuKSB7CiAgdmFyIGNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICByZXR1cm4gZnVuY3Rpb24gY2FjaGVkRm4oc3RyKSB7CiAgICB2YXIgaGl0ID0gY2FjaGVbc3RyXTsKICAgIHJldHVybiBoaXQgfHwgKGNhY2hlW3N0cl0gPSBmbihzdHIpKTsKICB9Owp9Ci8qKgogKiBDYW1lbGl6ZSBhIGh5cGhlbi1kZWxpbWl0ZWQgc3RyaW5nLgogKi8KdmFyIGNhbWVsaXplUkUgPSAvLShcdykvZzsKdmFyIGNhbWVsaXplID0gY2FjaGVkKGZ1bmN0aW9uIChzdHIpIHsKICByZXR1cm4gc3RyLnJlcGxhY2UoY2FtZWxpemVSRSwgZnVuY3Rpb24gKF8sIGMpIHsKICAgIHJldHVybiBjID8gYy50b1VwcGVyQ2FzZSgpIDogJyc7CiAgfSk7Cn0pOwovKioKICogQ2FwaXRhbGl6ZSBhIHN0cmluZy4KICovCnZhciBjYXBpdGFsaXplID0gY2FjaGVkKGZ1bmN0aW9uIChzdHIpIHsKICByZXR1cm4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3RyLnNsaWNlKDEpOwp9KTsKLyoqCiAqIEh5cGhlbmF0ZSBhIGNhbWVsQ2FzZSBzdHJpbmcuCiAqLwp2YXIgaHlwaGVuYXRlUkUgPSAvXEIoW0EtWl0pL2c7CnZhciBoeXBoZW5hdGUgPSBjYWNoZWQoZnVuY3Rpb24gKHN0cikgewogIHJldHVybiBzdHIucmVwbGFjZShoeXBoZW5hdGVSRSwgJy0kMScpLnRvTG93ZXJDYXNlKCk7Cn0pOwovKioKICogU2ltcGxlIGJpbmQgcG9seWZpbGwgZm9yIGVudmlyb25tZW50cyB0aGF0IGRvIG5vdCBzdXBwb3J0IGl0LAogKiBlLmcuLCBQaGFudG9tSlMgMS54LiBUZWNobmljYWxseSwgd2UgZG9uJ3QgbmVlZCB0aGlzIGFueW1vcmUKICogc2luY2UgbmF0aXZlIGJpbmQgaXMgbm93IHBlcmZvcm1hbnQgZW5vdWdoIGluIG1vc3QgYnJvd3NlcnMuCiAqIEJ1dCByZW1vdmluZyBpdCB3b3VsZCBtZWFuIGJyZWFraW5nIGNvZGUgdGhhdCB3YXMgYWJsZSB0byBydW4gaW4KICogUGhhbnRvbUpTIDEueCwgc28gdGhpcyBtdXN0IGJlIGtlcHQgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkuCiAqLwovKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwpmdW5jdGlvbiBwb2x5ZmlsbEJpbmQoZm4sIGN0eCkgewogIGZ1bmN0aW9uIGJvdW5kRm4oYSkgewogICAgdmFyIGwgPSBhcmd1bWVudHMubGVuZ3RoOwogICAgcmV0dXJuIGwgPyBsID4gMSA/IGZuLmFwcGx5KGN0eCwgYXJndW1lbnRzKSA6IGZuLmNhbGwoY3R4LCBhKSA6IGZuLmNhbGwoY3R4KTsKICB9CiAgYm91bmRGbi5fbGVuZ3RoID0gZm4ubGVuZ3RoOwogIHJldHVybiBib3VuZEZuOwp9CmZ1bmN0aW9uIG5hdGl2ZUJpbmQoZm4sIGN0eCkgewogIHJldHVybiBmbi5iaW5kKGN0eCk7Cn0KLy8gQHRzLWV4cGVjdC1lcnJvciBiaW5kIGNhbm5vdCBiZSBgdW5kZWZpbmVkYAp2YXIgYmluZCA9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kID8gbmF0aXZlQmluZCA6IHBvbHlmaWxsQmluZDsKLyoqCiAqIENvbnZlcnQgYW4gQXJyYXktbGlrZSBvYmplY3QgdG8gYSByZWFsIEFycmF5LgogKi8KZnVuY3Rpb24gdG9BcnJheShsaXN0LCBzdGFydCkgewogIHN0YXJ0ID0gc3RhcnQgfHwgMDsKICB2YXIgaSA9IGxpc3QubGVuZ3RoIC0gc3RhcnQ7CiAgdmFyIHJldCA9IG5ldyBBcnJheShpKTsKICB3aGlsZSAoaS0tKSB7CiAgICByZXRbaV0gPSBsaXN0W2kgKyBzdGFydF07CiAgfQogIHJldHVybiByZXQ7Cn0KLyoqCiAqIE1peCBwcm9wZXJ0aWVzIGludG8gdGFyZ2V0IG9iamVjdC4KICovCmZ1bmN0aW9uIGV4dGVuZCh0bywgX2Zyb20pIHsKICBmb3IgKHZhciBrZXkgaW4gX2Zyb20pIHsKICAgIHRvW2tleV0gPSBfZnJvbVtrZXldOwogIH0KICByZXR1cm4gdG87Cn0KLyoqCiAqIE1lcmdlIGFuIEFycmF5IG9mIE9iamVjdHMgaW50byBhIHNpbmdsZSBPYmplY3QuCiAqLwpmdW5jdGlvbiB0b09iamVjdChhcnIpIHsKICB2YXIgcmVzID0ge307CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgIGlmIChhcnJbaV0pIHsKICAgICAgZXh0ZW5kKHJlcywgYXJyW2ldKTsKICAgIH0KICB9CiAgcmV0dXJuIHJlczsKfQovKiBlc2xpbnQtZGlzYWJsZSBuby11bnVzZWQtdmFycyAqLwovKioKICogUGVyZm9ybSBubyBvcGVyYXRpb24uCiAqIFN0dWJiaW5nIGFyZ3MgdG8gbWFrZSBGbG93IGhhcHB5IHdpdGhvdXQgbGVhdmluZyB1c2VsZXNzIHRyYW5zcGlsZWQgY29kZQogKiB3aXRoIC4uLnJlc3QgKGh0dHBzOi8vZmxvdy5vcmcvYmxvZy8yMDE3LzA1LzA3L1N0cmljdC1GdW5jdGlvbi1DYWxsLUFyaXR5LykuCiAqLwpmdW5jdGlvbiBub29wKGEsIGIsIGMpIHt9Ci8qKgogKiBBbHdheXMgcmV0dXJuIGZhbHNlLgogKi8KdmFyIG5vID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsKICByZXR1cm4gZmFsc2U7Cn07Ci8qIGVzbGludC1lbmFibGUgbm8tdW51c2VkLXZhcnMgKi8KLyoqCiAqIFJldHVybiB0aGUgc2FtZSB2YWx1ZS4KICovCnZhciBpZGVudGl0eSA9IGZ1bmN0aW9uIChfKSB7CiAgcmV0dXJuIF87Cn07Ci8qKgogKiBDaGVjayBpZiB0d28gdmFsdWVzIGFyZSBsb29zZWx5IGVxdWFsIC0gdGhhdCBpcywKICogaWYgdGhleSBhcmUgcGxhaW4gb2JqZWN0cywgZG8gdGhleSBoYXZlIHRoZSBzYW1lIHNoYXBlPwogKi8KZnVuY3Rpb24gbG9vc2VFcXVhbChhLCBiKSB7CiAgaWYgKGEgPT09IGIpIHJldHVybiB0cnVlOwogIHZhciBpc09iamVjdEEgPSBpc09iamVjdChhKTsKICB2YXIgaXNPYmplY3RCID0gaXNPYmplY3QoYik7CiAgaWYgKGlzT2JqZWN0QSAmJiBpc09iamVjdEIpIHsKICAgIHRyeSB7CiAgICAgIHZhciBpc0FycmF5QSA9IEFycmF5LmlzQXJyYXkoYSk7CiAgICAgIHZhciBpc0FycmF5QiA9IEFycmF5LmlzQXJyYXkoYik7CiAgICAgIGlmIChpc0FycmF5QSAmJiBpc0FycmF5QikgewogICAgICAgIHJldHVybiBhLmxlbmd0aCA9PT0gYi5sZW5ndGggJiYgYS5ldmVyeShmdW5jdGlvbiAoZSwgaSkgewogICAgICAgICAgcmV0dXJuIGxvb3NlRXF1YWwoZSwgYltpXSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoYSBpbnN0YW5jZW9mIERhdGUgJiYgYiBpbnN0YW5jZW9mIERhdGUpIHsKICAgICAgICByZXR1cm4gYS5nZXRUaW1lKCkgPT09IGIuZ2V0VGltZSgpOwogICAgICB9IGVsc2UgaWYgKCFpc0FycmF5QSAmJiAhaXNBcnJheUIpIHsKICAgICAgICB2YXIga2V5c0EgPSBPYmplY3Qua2V5cyhhKTsKICAgICAgICB2YXIga2V5c0IgPSBPYmplY3Qua2V5cyhiKTsKICAgICAgICByZXR1cm4ga2V5c0EubGVuZ3RoID09PSBrZXlzQi5sZW5ndGggJiYga2V5c0EuZXZlcnkoZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgcmV0dXJuIGxvb3NlRXF1YWwoYVtrZXldLCBiW2tleV0pOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9IGVsc2UgaWYgKCFpc09iamVjdEEgJiYgIWlzT2JqZWN0QikgewogICAgcmV0dXJuIFN0cmluZyhhKSA9PT0gU3RyaW5nKGIpOwogIH0gZWxzZSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQp9Ci8qKgogKiBSZXR1cm4gdGhlIGZpcnN0IGluZGV4IGF0IHdoaWNoIGEgbG9vc2VseSBlcXVhbCB2YWx1ZSBjYW4gYmUKICogZm91bmQgaW4gdGhlIGFycmF5IChpZiB2YWx1ZSBpcyBhIHBsYWluIG9iamVjdCwgdGhlIGFycmF5IG11c3QKICogY29udGFpbiBhbiBvYmplY3Qgb2YgdGhlIHNhbWUgc2hhcGUpLCBvciAtMSBpZiBpdCBpcyBub3QgcHJlc2VudC4KICovCmZ1bmN0aW9uIGxvb3NlSW5kZXhPZihhcnIsIHZhbCkgewogIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICBpZiAobG9vc2VFcXVhbChhcnJbaV0sIHZhbCkpIHJldHVybiBpOwogIH0KICByZXR1cm4gLTE7Cn0KLyoqCiAqIEVuc3VyZSBhIGZ1bmN0aW9uIGlzIGNhbGxlZCBvbmx5IG9uY2UuCiAqLwpmdW5jdGlvbiBvbmNlKGZuKSB7CiAgdmFyIGNhbGxlZCA9IGZhbHNlOwogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICBpZiAoIWNhbGxlZCkgewogICAgICBjYWxsZWQgPSB0cnVlOwogICAgICBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfQogIH07Cn0KLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L2lzI3BvbHlmaWxsCmZ1bmN0aW9uIGhhc0NoYW5nZWQoeCwgeSkgewogIGlmICh4ID09PSB5KSB7CiAgICByZXR1cm4geCA9PT0gMCAmJiAxIC8geCAhPT0gMSAvIHk7CiAgfSBlbHNlIHsKICAgIHJldHVybiB4ID09PSB4IHx8IHkgPT09IHk7CiAgfQp9CnZhciBTU1JfQVRUUiA9ICdkYXRhLXNlcnZlci1yZW5kZXJlZCc7CnZhciBBU1NFVF9UWVBFUyA9IFsnY29tcG9uZW50JywgJ2RpcmVjdGl2ZScsICdmaWx0ZXInXTsKdmFyIExJRkVDWUNMRV9IT09LUyA9IFsnYmVmb3JlQ3JlYXRlJywgJ2NyZWF0ZWQnLCAnYmVmb3JlTW91bnQnLCAnbW91bnRlZCcsICdiZWZvcmVVcGRhdGUnLCAndXBkYXRlZCcsICdiZWZvcmVEZXN0cm95JywgJ2Rlc3Ryb3llZCcsICdhY3RpdmF0ZWQnLCAnZGVhY3RpdmF0ZWQnLCAnZXJyb3JDYXB0dXJlZCcsICdzZXJ2ZXJQcmVmZXRjaCcsICdyZW5kZXJUcmFja2VkJywgJ3JlbmRlclRyaWdnZXJlZCddOwp2YXIgY29uZmlnID0gewogIC8qKgogICAqIE9wdGlvbiBtZXJnZSBzdHJhdGVnaWVzICh1c2VkIGluIGNvcmUvdXRpbC9vcHRpb25zKQogICAqLwogIC8vICRmbG93LWRpc2FibGUtbGluZQogIG9wdGlvbk1lcmdlU3RyYXRlZ2llczogT2JqZWN0LmNyZWF0ZShudWxsKSwKICAvKioKICAgKiBXaGV0aGVyIHRvIHN1cHByZXNzIHdhcm5pbmdzLgogICAqLwogIHNpbGVudDogZmFsc2UsCiAgLyoqCiAgICogU2hvdyBwcm9kdWN0aW9uIG1vZGUgdGlwIG1lc3NhZ2Ugb24gYm9vdD8KICAgKi8KICBwcm9kdWN0aW9uVGlwOiBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nLAogIC8qKgogICAqIFdoZXRoZXIgdG8gZW5hYmxlIGRldnRvb2xzCiAgICovCiAgZGV2dG9vbHM6IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicsCiAgLyoqCiAgICogV2hldGhlciB0byByZWNvcmQgcGVyZgogICAqLwogIHBlcmZvcm1hbmNlOiBmYWxzZSwKICAvKioKICAgKiBFcnJvciBoYW5kbGVyIGZvciB3YXRjaGVyIGVycm9ycwogICAqLwogIGVycm9ySGFuZGxlcjogbnVsbCwKICAvKioKICAgKiBXYXJuIGhhbmRsZXIgZm9yIHdhdGNoZXIgd2FybnMKICAgKi8KICB3YXJuSGFuZGxlcjogbnVsbCwKICAvKioKICAgKiBJZ25vcmUgY2VydGFpbiBjdXN0b20gZWxlbWVudHMKICAgKi8KICBpZ25vcmVkRWxlbWVudHM6IFtdLAogIC8qKgogICAqIEN1c3RvbSB1c2VyIGtleSBhbGlhc2VzIGZvciB2LW9uCiAgICovCiAgLy8gJGZsb3ctZGlzYWJsZS1saW5lCiAga2V5Q29kZXM6IE9iamVjdC5jcmVhdGUobnVsbCksCiAgLyoqCiAgICogQ2hlY2sgaWYgYSB0YWcgaXMgcmVzZXJ2ZWQgc28gdGhhdCBpdCBjYW5ub3QgYmUgcmVnaXN0ZXJlZCBhcyBhCiAgICogY29tcG9uZW50LiBUaGlzIGlzIHBsYXRmb3JtLWRlcGVuZGVudCBhbmQgbWF5IGJlIG92ZXJ3cml0dGVuLgogICAqLwogIGlzUmVzZXJ2ZWRUYWc6IG5vLAogIC8qKgogICAqIENoZWNrIGlmIGFuIGF0dHJpYnV0ZSBpcyByZXNlcnZlZCBzbyB0aGF0IGl0IGNhbm5vdCBiZSB1c2VkIGFzIGEgY29tcG9uZW50CiAgICogcHJvcC4gVGhpcyBpcyBwbGF0Zm9ybS1kZXBlbmRlbnQgYW5kIG1heSBiZSBvdmVyd3JpdHRlbi4KICAgKi8KICBpc1Jlc2VydmVkQXR0cjogbm8sCiAgLyoqCiAgICogQ2hlY2sgaWYgYSB0YWcgaXMgYW4gdW5rbm93biBlbGVtZW50LgogICAqIFBsYXRmb3JtLWRlcGVuZGVudC4KICAgKi8KICBpc1Vua25vd25FbGVtZW50OiBubywKICAvKioKICAgKiBHZXQgdGhlIG5hbWVzcGFjZSBvZiBhbiBlbGVtZW50CiAgICovCiAgZ2V0VGFnTmFtZXNwYWNlOiBub29wLAogIC8qKgogICAqIFBhcnNlIHRoZSByZWFsIHRhZyBuYW1lIGZvciB0aGUgc3BlY2lmaWMgcGxhdGZvcm0uCiAgICovCiAgcGFyc2VQbGF0Zm9ybVRhZ05hbWU6IGlkZW50aXR5LAogIC8qKgogICAqIENoZWNrIGlmIGFuIGF0dHJpYnV0ZSBtdXN0IGJlIGJvdW5kIHVzaW5nIHByb3BlcnR5LCBlLmcuIHZhbHVlCiAgICogUGxhdGZvcm0tZGVwZW5kZW50LgogICAqLwogIG11c3RVc2VQcm9wOiBubywKICAvKioKICAgKiBQZXJmb3JtIHVwZGF0ZXMgYXN5bmNocm9ub3VzbHkuIEludGVuZGVkIHRvIGJlIHVzZWQgYnkgVnVlIFRlc3QgVXRpbHMKICAgKiBUaGlzIHdpbGwgc2lnbmlmaWNhbnRseSByZWR1Y2UgcGVyZm9ybWFuY2UgaWYgc2V0IHRvIGZhbHNlLgogICAqLwogIGFzeW5jOiB0cnVlLAogIC8qKgogICAqIEV4cG9zZWQgZm9yIGxlZ2FjeSByZWFzb25zCiAgICovCiAgX2xpZmVjeWNsZUhvb2tzOiBMSUZFQ1lDTEVfSE9PS1MKfTsKCi8qKgogKiB1bmljb2RlIGxldHRlcnMgdXNlZCBmb3IgcGFyc2luZyBodG1sIHRhZ3MsIGNvbXBvbmVudCBuYW1lcyBhbmQgcHJvcGVydHkgcGF0aHMuCiAqIHVzaW5nIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9odG1sNTMvc2VtYW50aWNzLXNjcmlwdGluZy5odG1sI3BvdGVudGlhbGN1c3RvbWVsZW1lbnRuYW1lCiAqIHNraXBwaW5nIFx1MTAwMDAtXHVFRkZGRiBkdWUgdG8gaXQgZnJlZXppbmcgdXAgUGhhbnRvbUpTCiAqLwp2YXIgdW5pY29kZVJlZ0V4cCA9IC9hLXpBLVpcdTAwQjdcdTAwQzAtXHUwMEQ2XHUwMEQ4LVx1MDBGNlx1MDBGOC1cdTAzN0RcdTAzN0YtXHUxRkZGXHUyMDBDLVx1MjAwRFx1MjAzRi1cdTIwNDBcdTIwNzAtXHUyMThGXHUyQzAwLVx1MkZFRlx1MzAwMS1cdUQ3RkZcdUY5MDAtXHVGRENGXHVGREYwLVx1RkZGRC87Ci8qKgogKiBDaGVjayBpZiBhIHN0cmluZyBzdGFydHMgd2l0aCAkIG9yIF8KICovCmZ1bmN0aW9uIGlzUmVzZXJ2ZWQoc3RyKSB7CiAgdmFyIGMgPSAoc3RyICsgJycpLmNoYXJDb2RlQXQoMCk7CiAgcmV0dXJuIGMgPT09IDB4MjQgfHwgYyA9PT0gMHg1ZjsKfQovKioKICogRGVmaW5lIGEgcHJvcGVydHkuCiAqLwpmdW5jdGlvbiBkZWYob2JqLCBrZXksIHZhbCwgZW51bWVyYWJsZSkgewogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgdmFsdWU6IHZhbCwKICAgIGVudW1lcmFibGU6ICEhZW51bWVyYWJsZSwKICAgIHdyaXRhYmxlOiB0cnVlLAogICAgY29uZmlndXJhYmxlOiB0cnVlCiAgfSk7Cn0KLyoqCiAqIFBhcnNlIHNpbXBsZSBwYXRoLgogKi8KdmFyIGJhaWxSRSA9IG5ldyBSZWdFeHAoIlteIi5jb25jYXQodW5pY29kZVJlZ0V4cC5zb3VyY2UsICIuJF9cXGRdIikpOwpmdW5jdGlvbiBwYXJzZVBhdGgocGF0aCkgewogIGlmIChiYWlsUkUudGVzdChwYXRoKSkgewogICAgcmV0dXJuOwogIH0KICB2YXIgc2VnbWVudHMgPSBwYXRoLnNwbGl0KCcuJyk7CiAgcmV0dXJuIGZ1bmN0aW9uIChvYmopIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VnbWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKCFvYmopIHJldHVybjsKICAgICAgb2JqID0gb2JqW3NlZ21lbnRzW2ldXTsKICAgIH0KICAgIHJldHVybiBvYmo7CiAgfTsKfQoKLy8gY2FuIHdlIHVzZSBfX3Byb3RvX18/CnZhciBoYXNQcm90byA9ICdfX3Byb3RvX18nIGluIHt9OwovLyBCcm93c2VyIGVudmlyb25tZW50IHNuaWZmaW5nCnZhciBpbkJyb3dzZXIgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJzsKdmFyIFVBID0gaW5Ccm93c2VyICYmIHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCk7CnZhciBpc0lFID0gVUEgJiYgL21zaWV8dHJpZGVudC8udGVzdChVQSk7CnZhciBpc0lFOSA9IFVBICYmIFVBLmluZGV4T2YoJ21zaWUgOS4wJykgPiAwOwp2YXIgaXNFZGdlID0gVUEgJiYgVUEuaW5kZXhPZignZWRnZS8nKSA+IDA7ClVBICYmIFVBLmluZGV4T2YoJ2FuZHJvaWQnKSA+IDA7CnZhciBpc0lPUyA9IFVBICYmIC9pcGhvbmV8aXBhZHxpcG9kfGlvcy8udGVzdChVQSk7ClVBICYmIC9jaHJvbWVcL1xkKy8udGVzdChVQSkgJiYgIWlzRWRnZTsKVUEgJiYgL3BoYW50b21qcy8udGVzdChVQSk7CnZhciBpc0ZGID0gVUEgJiYgVUEubWF0Y2goL2ZpcmVmb3hcLyhcZCspLyk7Ci8vIEZpcmVmb3ggaGFzIGEgIndhdGNoIiBmdW5jdGlvbiBvbiBPYmplY3QucHJvdG90eXBlLi4uCi8vIEB0cy1leHBlY3QtZXJyb3IgZmlyZWJveCBzdXBwb3J0CnZhciBuYXRpdmVXYXRjaCA9IHt9LndhdGNoOwp2YXIgc3VwcG9ydHNQYXNzaXZlID0gZmFsc2U7CmlmIChpbkJyb3dzZXIpIHsKICB0cnkgewogICAgdmFyIG9wdHMgPSB7fTsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvcHRzLCAncGFzc2l2ZScsIHsKICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KICAgICAgICBzdXBwb3J0c1Bhc3NpdmUgPSB0cnVlOwogICAgICB9CiAgICB9KTsgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL2Zsb3cvaXNzdWVzLzI4NQogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Rlc3QtcGFzc2l2ZScsIG51bGwsIG9wdHMpOwogIH0gY2F0Y2ggKGUpIHt9Cn0KLy8gdGhpcyBuZWVkcyB0byBiZSBsYXp5LWV2YWxlZCBiZWNhdXNlIHZ1ZSBtYXkgYmUgcmVxdWlyZWQgYmVmb3JlCi8vIHZ1ZS1zZXJ2ZXItcmVuZGVyZXIgY2FuIHNldCBWVUVfRU5WCnZhciBfaXNTZXJ2ZXI7CnZhciBpc1NlcnZlclJlbmRlcmluZyA9IGZ1bmN0aW9uICgpIHsKICBpZiAoX2lzU2VydmVyID09PSB1bmRlZmluZWQpIHsKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgaWYgKCFpbkJyb3dzZXIgJiYgdHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgLy8gZGV0ZWN0IHByZXNlbmNlIG9mIHZ1ZS1zZXJ2ZXItcmVuZGVyZXIgYW5kIGF2b2lkCiAgICAgIC8vIFdlYnBhY2sgc2hpbW1pbmcgdGhlIHByb2Nlc3MKICAgICAgX2lzU2VydmVyID0gZ2xvYmFsWydwcm9jZXNzJ10gJiYgZ2xvYmFsWydwcm9jZXNzJ10uZW52LlZVRV9FTlYgPT09ICdzZXJ2ZXInOwogICAgfSBlbHNlIHsKICAgICAgX2lzU2VydmVyID0gZmFsc2U7CiAgICB9CiAgfQogIHJldHVybiBfaXNTZXJ2ZXI7Cn07Ci8vIGRldGVjdCBkZXZ0b29scwp2YXIgZGV2dG9vbHMgPSBpbkJyb3dzZXIgJiYgd2luZG93Ll9fVlVFX0RFVlRPT0xTX0dMT0JBTF9IT09LX187Ci8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCmZ1bmN0aW9uIGlzTmF0aXZlKEN0b3IpIHsKICByZXR1cm4gdHlwZW9mIEN0b3IgPT09ICdmdW5jdGlvbicgJiYgL25hdGl2ZSBjb2RlLy50ZXN0KEN0b3IudG9TdHJpbmcoKSk7Cn0KdmFyIGhhc1N5bWJvbCA9IHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIGlzTmF0aXZlKFN5bWJvbCkgJiYgdHlwZW9mIFJlZmxlY3QgIT09ICd1bmRlZmluZWQnICYmIGlzTmF0aXZlKFJlZmxlY3Qub3duS2V5cyk7CnZhciBfU2V0OyAvLyAkZmxvdy1kaXNhYmxlLWxpbmUKLyogaXN0YW5idWwgaWdub3JlIGlmICovCmlmICh0eXBlb2YgU2V0ICE9PSAndW5kZWZpbmVkJyAmJiBpc05hdGl2ZShTZXQpKSB7CiAgLy8gdXNlIG5hdGl2ZSBTZXQgd2hlbiBhdmFpbGFibGUuCiAgX1NldCA9IFNldDsKfSBlbHNlIHsKICAvLyBhIG5vbi1zdGFuZGFyZCBTZXQgcG9seWZpbGwgdGhhdCBvbmx5IHdvcmtzIHdpdGggcHJpbWl0aXZlIGtleXMuCiAgX1NldCA9IC8qKiBAY2xhc3MgKi9mdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBTZXQoKSB7CiAgICAgIHRoaXMuc2V0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIH0KICAgIFNldC5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24gKGtleSkgewogICAgICByZXR1cm4gdGhpcy5zZXRba2V5XSA9PT0gdHJ1ZTsKICAgIH07CiAgICBTZXQucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChrZXkpIHsKICAgICAgdGhpcy5zZXRba2V5XSA9IHRydWU7CiAgICB9OwogICAgU2V0LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5zZXQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgfTsKICAgIHJldHVybiBTZXQ7CiAgfSgpOwp9CnZhciBjdXJyZW50SW5zdGFuY2UgPSBudWxsOwovKioKICogVGhpcyBpcyBleHBvc2VkIGZvciBjb21wYXRpYmlsaXR5IHdpdGggdjMgKGUuZy4gc29tZSBmdW5jdGlvbnMgaW4gVnVlVXNlCiAqIHJlbGllcyBvbiBpdCkuIERvIG5vdCB1c2UgdGhpcyBpbnRlcm5hbGx5LCBqdXN0IHVzZSBgY3VycmVudEluc3RhbmNlYC4KICoKICogQGludGVybmFsIHRoaXMgZnVuY3Rpb24gbmVlZHMgbWFudWFsIHR5cGUgZGVjbGFyYXRpb24gYmVjYXVzZSBpdCByZWxpZXMKICogb24gcHJldmlvdXNseSBtYW51YWxseSBhdXRob3JlZCB0eXBlcyBmcm9tIFZ1ZSAyCiAqLwpmdW5jdGlvbiBnZXRDdXJyZW50SW5zdGFuY2UoKSB7CiAgcmV0dXJuIGN1cnJlbnRJbnN0YW5jZSAmJiB7CiAgICBwcm94eTogY3VycmVudEluc3RhbmNlCiAgfTsKfQovKioKICogQGludGVybmFsCiAqLwpmdW5jdGlvbiBzZXRDdXJyZW50SW5zdGFuY2Uodm0pIHsKICBpZiAodm0gPT09IHZvaWQgMCkgewogICAgdm0gPSBudWxsOwogIH0KICBpZiAoIXZtKSBjdXJyZW50SW5zdGFuY2UgJiYgY3VycmVudEluc3RhbmNlLl9zY29wZS5vZmYoKTsKICBjdXJyZW50SW5zdGFuY2UgPSB2bTsKICB2bSAmJiB2bS5fc2NvcGUub24oKTsKfQoKLyoqCiAqIEBpbnRlcm5hbAogKi8KdmFyIFZOb2RlID0gLyoqIEBjbGFzcyAqL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBWTm9kZSh0YWcsIGRhdGEsIGNoaWxkcmVuLCB0ZXh0LCBlbG0sIGNvbnRleHQsIGNvbXBvbmVudE9wdGlvbnMsIGFzeW5jRmFjdG9yeSkgewogICAgdGhpcy50YWcgPSB0YWc7CiAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgdGhpcy5jaGlsZHJlbiA9IGNoaWxkcmVuOwogICAgdGhpcy50ZXh0ID0gdGV4dDsKICAgIHRoaXMuZWxtID0gZWxtOwogICAgdGhpcy5ucyA9IHVuZGVmaW5lZDsKICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7CiAgICB0aGlzLmZuQ29udGV4dCA9IHVuZGVmaW5lZDsKICAgIHRoaXMuZm5PcHRpb25zID0gdW5kZWZpbmVkOwogICAgdGhpcy5mblNjb3BlSWQgPSB1bmRlZmluZWQ7CiAgICB0aGlzLmtleSA9IGRhdGEgJiYgZGF0YS5rZXk7CiAgICB0aGlzLmNvbXBvbmVudE9wdGlvbnMgPSBjb21wb25lbnRPcHRpb25zOwogICAgdGhpcy5jb21wb25lbnRJbnN0YW5jZSA9IHVuZGVmaW5lZDsKICAgIHRoaXMucGFyZW50ID0gdW5kZWZpbmVkOwogICAgdGhpcy5yYXcgPSBmYWxzZTsKICAgIHRoaXMuaXNTdGF0aWMgPSBmYWxzZTsKICAgIHRoaXMuaXNSb290SW5zZXJ0ID0gdHJ1ZTsKICAgIHRoaXMuaXNDb21tZW50ID0gZmFsc2U7CiAgICB0aGlzLmlzQ2xvbmVkID0gZmFsc2U7CiAgICB0aGlzLmlzT25jZSA9IGZhbHNlOwogICAgdGhpcy5hc3luY0ZhY3RvcnkgPSBhc3luY0ZhY3Rvcnk7CiAgICB0aGlzLmFzeW5jTWV0YSA9IHVuZGVmaW5lZDsKICAgIHRoaXMuaXNBc3luY1BsYWNlaG9sZGVyID0gZmFsc2U7CiAgfQogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWTm9kZS5wcm90b3R5cGUsICJjaGlsZCIsIHsKICAgIC8vIERFUFJFQ0FURUQ6IGFsaWFzIGZvciBjb21wb25lbnRJbnN0YW5jZSBmb3IgYmFja3dhcmRzIGNvbXBhdC4KICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50SW5zdGFuY2U7CiAgICB9LAogICAgZW51bWVyYWJsZTogZmFsc2UsCiAgICBjb25maWd1cmFibGU6IHRydWUKICB9KTsKICByZXR1cm4gVk5vZGU7Cn0oKTsKdmFyIGNyZWF0ZUVtcHR5Vk5vZGUgPSBmdW5jdGlvbiAodGV4dCkgewogIGlmICh0ZXh0ID09PSB2b2lkIDApIHsKICAgIHRleHQgPSAnJzsKICB9CiAgdmFyIG5vZGUgPSBuZXcgVk5vZGUoKTsKICBub2RlLnRleHQgPSB0ZXh0OwogIG5vZGUuaXNDb21tZW50ID0gdHJ1ZTsKICByZXR1cm4gbm9kZTsKfTsKZnVuY3Rpb24gY3JlYXRlVGV4dFZOb2RlKHZhbCkgewogIHJldHVybiBuZXcgVk5vZGUodW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgU3RyaW5nKHZhbCkpOwp9Ci8vIG9wdGltaXplZCBzaGFsbG93IGNsb25lCi8vIHVzZWQgZm9yIHN0YXRpYyBub2RlcyBhbmQgc2xvdCBub2RlcyBiZWNhdXNlIHRoZXkgbWF5IGJlIHJldXNlZCBhY3Jvc3MKLy8gbXVsdGlwbGUgcmVuZGVycywgY2xvbmluZyB0aGVtIGF2b2lkcyBlcnJvcnMgd2hlbiBET00gbWFuaXB1bGF0aW9ucyByZWx5Ci8vIG9uIHRoZWlyIGVsbSByZWZlcmVuY2UuCmZ1bmN0aW9uIGNsb25lVk5vZGUodm5vZGUpIHsKICB2YXIgY2xvbmVkID0gbmV3IFZOb2RlKHZub2RlLnRhZywgdm5vZGUuZGF0YSwKICAvLyAjNzk3NQogIC8vIGNsb25lIGNoaWxkcmVuIGFycmF5IHRvIGF2b2lkIG11dGF0aW5nIG9yaWdpbmFsIGluIGNhc2Ugb2YgY2xvbmluZwogIC8vIGEgY2hpbGQuCiAgdm5vZGUuY2hpbGRyZW4gJiYgdm5vZGUuY2hpbGRyZW4uc2xpY2UoKSwgdm5vZGUudGV4dCwgdm5vZGUuZWxtLCB2bm9kZS5jb250ZXh0LCB2bm9kZS5jb21wb25lbnRPcHRpb25zLCB2bm9kZS5hc3luY0ZhY3RvcnkpOwogIGNsb25lZC5ucyA9IHZub2RlLm5zOwogIGNsb25lZC5pc1N0YXRpYyA9IHZub2RlLmlzU3RhdGljOwogIGNsb25lZC5rZXkgPSB2bm9kZS5rZXk7CiAgY2xvbmVkLmlzQ29tbWVudCA9IHZub2RlLmlzQ29tbWVudDsKICBjbG9uZWQuZm5Db250ZXh0ID0gdm5vZGUuZm5Db250ZXh0OwogIGNsb25lZC5mbk9wdGlvbnMgPSB2bm9kZS5mbk9wdGlvbnM7CiAgY2xvbmVkLmZuU2NvcGVJZCA9IHZub2RlLmZuU2NvcGVJZDsKICBjbG9uZWQuYXN5bmNNZXRhID0gdm5vZGUuYXN5bmNNZXRhOwogIGNsb25lZC5pc0Nsb25lZCA9IHRydWU7CiAgcmV0dXJuIGNsb25lZDsKfQoKLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uDQoNClBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueQ0KcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQpUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSA0KUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZDQpBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQpJTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST00NCkxPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SDQpPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQpQRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLg0KKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi8KCnZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uICgpIHsKICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkgewogICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7CiAgICAgIHMgPSBhcmd1bWVudHNbaV07CiAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07CiAgICB9CiAgICByZXR1cm4gdDsKICB9OwogIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9Owp0eXBlb2YgU3VwcHJlc3NlZEVycm9yID09PSAiZnVuY3Rpb24iID8gU3VwcHJlc3NlZEVycm9yIDogZnVuY3Rpb24gKGVycm9yLCBzdXBwcmVzc2VkLCBtZXNzYWdlKSB7CiAgdmFyIGUgPSBuZXcgRXJyb3IobWVzc2FnZSk7CiAgcmV0dXJuIGUubmFtZSA9ICJTdXBwcmVzc2VkRXJyb3IiLCBlLmVycm9yID0gZXJyb3IsIGUuc3VwcHJlc3NlZCA9IHN1cHByZXNzZWQsIGU7Cn07CnZhciB1aWQkMiA9IDA7CnZhciBwZW5kaW5nQ2xlYW51cERlcHMgPSBbXTsKdmFyIGNsZWFudXBEZXBzID0gZnVuY3Rpb24gKCkgewogIGZvciAodmFyIGkgPSAwOyBpIDwgcGVuZGluZ0NsZWFudXBEZXBzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgZGVwID0gcGVuZGluZ0NsZWFudXBEZXBzW2ldOwogICAgZGVwLnN1YnMgPSBkZXAuc3Vicy5maWx0ZXIoZnVuY3Rpb24gKHMpIHsKICAgICAgcmV0dXJuIHM7CiAgICB9KTsKICAgIGRlcC5fcGVuZGluZyA9IGZhbHNlOwogIH0KICBwZW5kaW5nQ2xlYW51cERlcHMubGVuZ3RoID0gMDsKfTsKLyoqCiAqIEEgZGVwIGlzIGFuIG9ic2VydmFibGUgdGhhdCBjYW4gaGF2ZSBtdWx0aXBsZQogKiBkaXJlY3RpdmVzIHN1YnNjcmliaW5nIHRvIGl0LgogKiBAaW50ZXJuYWwKICovCnZhciBEZXAgPSAvKiogQGNsYXNzICovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIERlcCgpIHsKICAgIC8vIHBlbmRpbmcgc3VicyBjbGVhbnVwCiAgICB0aGlzLl9wZW5kaW5nID0gZmFsc2U7CiAgICB0aGlzLmlkID0gdWlkJDIrKzsKICAgIHRoaXMuc3VicyA9IFtdOwogIH0KICBEZXAucHJvdG90eXBlLmFkZFN1YiA9IGZ1bmN0aW9uIChzdWIpIHsKICAgIHRoaXMuc3Vicy5wdXNoKHN1Yik7CiAgfTsKICBEZXAucHJvdG90eXBlLnJlbW92ZVN1YiA9IGZ1bmN0aW9uIChzdWIpIHsKICAgIC8vICMxMjY5NiBkZXBzIHdpdGggbWFzc2l2ZSBhbW91bnQgb2Ygc3Vic2NyaWJlcnMgYXJlIGV4dHJlbWVseSBzbG93IHRvCiAgICAvLyBjbGVhbiB1cCBpbiBDaHJvbWl1bQogICAgLy8gdG8gd29ya2Fyb3VuZCB0aGlzLCB3ZSB1bnNldCB0aGUgc3ViIGZvciBub3csIGFuZCBjbGVhciB0aGVtIG9uCiAgICAvLyBuZXh0IHNjaGVkdWxlciBmbHVzaC4KICAgIHRoaXMuc3Vic1t0aGlzLnN1YnMuaW5kZXhPZihzdWIpXSA9IG51bGw7CiAgICBpZiAoIXRoaXMuX3BlbmRpbmcpIHsKICAgICAgdGhpcy5fcGVuZGluZyA9IHRydWU7CiAgICAgIHBlbmRpbmdDbGVhbnVwRGVwcy5wdXNoKHRoaXMpOwogICAgfQogIH07CiAgRGVwLnByb3RvdHlwZS5kZXBlbmQgPSBmdW5jdGlvbiAoaW5mbykgewogICAgaWYgKERlcC50YXJnZXQpIHsKICAgICAgRGVwLnRhcmdldC5hZGREZXAodGhpcyk7CiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIGluZm8gJiYgRGVwLnRhcmdldC5vblRyYWNrKSB7CiAgICAgICAgRGVwLnRhcmdldC5vblRyYWNrKF9fYXNzaWduKHsKICAgICAgICAgIGVmZmVjdDogRGVwLnRhcmdldAogICAgICAgIH0sIGluZm8pKTsKICAgICAgfQogICAgfQogIH07CiAgRGVwLnByb3RvdHlwZS5ub3RpZnkgPSBmdW5jdGlvbiAoaW5mbykgewogICAgLy8gc3RhYmlsaXplIHRoZSBzdWJzY3JpYmVyIGxpc3QgZmlyc3QKICAgIHZhciBzdWJzID0gdGhpcy5zdWJzLmZpbHRlcihmdW5jdGlvbiAocykgewogICAgICByZXR1cm4gczsKICAgIH0pOwogICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgIWNvbmZpZy5hc3luYykgewogICAgICAvLyBzdWJzIGFyZW4ndCBzb3J0ZWQgaW4gc2NoZWR1bGVyIGlmIG5vdCBydW5uaW5nIGFzeW5jCiAgICAgIC8vIHdlIG5lZWQgdG8gc29ydCB0aGVtIG5vdyB0byBtYWtlIHN1cmUgdGhleSBmaXJlIGluIGNvcnJlY3QKICAgICAgLy8gb3JkZXIKICAgICAgc3Vicy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgcmV0dXJuIGEuaWQgLSBiLmlkOwogICAgICB9KTsKICAgIH0KICAgIGZvciAodmFyIGkgPSAwLCBsID0gc3Vicy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgdmFyIHN1YiA9IHN1YnNbaV07CiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIGluZm8pIHsKICAgICAgICBzdWIub25UcmlnZ2VyICYmIHN1Yi5vblRyaWdnZXIoX19hc3NpZ24oewogICAgICAgICAgZWZmZWN0OiBzdWJzW2ldCiAgICAgICAgfSwgaW5mbykpOwogICAgICB9CiAgICAgIHN1Yi51cGRhdGUoKTsKICAgIH0KICB9OwogIHJldHVybiBEZXA7Cn0oKTsKLy8gVGhlIGN1cnJlbnQgdGFyZ2V0IHdhdGNoZXIgYmVpbmcgZXZhbHVhdGVkLgovLyBUaGlzIGlzIGdsb2JhbGx5IHVuaXF1ZSBiZWNhdXNlIG9ubHkgb25lIHdhdGNoZXIKLy8gY2FuIGJlIGV2YWx1YXRlZCBhdCBhIHRpbWUuCkRlcC50YXJnZXQgPSBudWxsOwp2YXIgdGFyZ2V0U3RhY2sgPSBbXTsKZnVuY3Rpb24gcHVzaFRhcmdldCh0YXJnZXQpIHsKICB0YXJnZXRTdGFjay5wdXNoKHRhcmdldCk7CiAgRGVwLnRhcmdldCA9IHRhcmdldDsKfQpmdW5jdGlvbiBwb3BUYXJnZXQoKSB7CiAgdGFyZ2V0U3RhY2sucG9wKCk7CiAgRGVwLnRhcmdldCA9IHRhcmdldFN0YWNrW3RhcmdldFN0YWNrLmxlbmd0aCAtIDFdOwp9CgovKgogKiBub3QgdHlwZSBjaGVja2luZyB0aGlzIGZpbGUgYmVjYXVzZSBmbG93IGRvZXNuJ3QgcGxheSB3ZWxsIHdpdGgKICogZHluYW1pY2FsbHkgYWNjZXNzaW5nIG1ldGhvZHMgb24gQXJyYXkgcHJvdG90eXBlCiAqLwp2YXIgYXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZTsKdmFyIGFycmF5TWV0aG9kcyA9IE9iamVjdC5jcmVhdGUoYXJyYXlQcm90byk7CnZhciBtZXRob2RzVG9QYXRjaCA9IFsncHVzaCcsICdwb3AnLCAnc2hpZnQnLCAndW5zaGlmdCcsICdzcGxpY2UnLCAnc29ydCcsICdyZXZlcnNlJ107Ci8qKgogKiBJbnRlcmNlcHQgbXV0YXRpbmcgbWV0aG9kcyBhbmQgZW1pdCBldmVudHMKICovCm1ldGhvZHNUb1BhdGNoLmZvckVhY2goZnVuY3Rpb24gKG1ldGhvZCkgewogIC8vIGNhY2hlIG9yaWdpbmFsIG1ldGhvZAogIHZhciBvcmlnaW5hbCA9IGFycmF5UHJvdG9bbWV0aG9kXTsKICBkZWYoYXJyYXlNZXRob2RzLCBtZXRob2QsIGZ1bmN0aW9uIG11dGF0b3IoKSB7CiAgICB2YXIgYXJncyA9IFtdOwogICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldOwogICAgfQogICAgdmFyIHJlc3VsdCA9IG9yaWdpbmFsLmFwcGx5KHRoaXMsIGFyZ3MpOwogICAgdmFyIG9iID0gdGhpcy5fX29iX187CiAgICB2YXIgaW5zZXJ0ZWQ7CiAgICBzd2l0Y2ggKG1ldGhvZCkgewogICAgICBjYXNlICdwdXNoJzoKICAgICAgY2FzZSAndW5zaGlmdCc6CiAgICAgICAgaW5zZXJ0ZWQgPSBhcmdzOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlICdzcGxpY2UnOgogICAgICAgIGluc2VydGVkID0gYXJncy5zbGljZSgyKTsKICAgICAgICBicmVhazsKICAgIH0KICAgIGlmIChpbnNlcnRlZCkgb2Iub2JzZXJ2ZUFycmF5KGluc2VydGVkKTsKICAgIC8vIG5vdGlmeSBjaGFuZ2UKICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICAgIG9iLmRlcC5ub3RpZnkoewogICAgICAgIHR5cGU6ICJhcnJheSBtdXRhdGlvbiIgLyogVHJpZ2dlck9wVHlwZXMuQVJSQVlfTVVUQVRJT04gKi8sCiAgICAgICAgdGFyZ2V0OiB0aGlzLAogICAgICAgIGtleTogbWV0aG9kCiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgb2IuZGVwLm5vdGlmeSgpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKICB9KTsKfSk7CnZhciBhcnJheUtleXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhhcnJheU1ldGhvZHMpOwp2YXIgTk9fSU5JVElBTF9WQUxVRSA9IHt9OwovKioKICogSW4gc29tZSBjYXNlcyB3ZSBtYXkgd2FudCB0byBkaXNhYmxlIG9ic2VydmF0aW9uIGluc2lkZSBhIGNvbXBvbmVudCdzCiAqIHVwZGF0ZSBjb21wdXRhdGlvbi4KICovCnZhciBzaG91bGRPYnNlcnZlID0gdHJ1ZTsKZnVuY3Rpb24gdG9nZ2xlT2JzZXJ2aW5nKHZhbHVlKSB7CiAgc2hvdWxkT2JzZXJ2ZSA9IHZhbHVlOwp9Ci8vIHNzciBtb2NrIGRlcAp2YXIgbW9ja0RlcCA9IHsKICBub3RpZnk6IG5vb3AsCiAgZGVwZW5kOiBub29wLAogIGFkZFN1Yjogbm9vcCwKICByZW1vdmVTdWI6IG5vb3AKfTsKLyoqCiAqIE9ic2VydmVyIGNsYXNzIHRoYXQgaXMgYXR0YWNoZWQgdG8gZWFjaCBvYnNlcnZlZAogKiBvYmplY3QuIE9uY2UgYXR0YWNoZWQsIHRoZSBvYnNlcnZlciBjb252ZXJ0cyB0aGUgdGFyZ2V0CiAqIG9iamVjdCdzIHByb3BlcnR5IGtleXMgaW50byBnZXR0ZXIvc2V0dGVycyB0aGF0CiAqIGNvbGxlY3QgZGVwZW5kZW5jaWVzIGFuZCBkaXNwYXRjaCB1cGRhdGVzLgogKi8KdmFyIE9ic2VydmVyID0gLyoqIEBjbGFzcyAqL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBPYnNlcnZlcih2YWx1ZSwgc2hhbGxvdywgbW9jaykgewogICAgaWYgKHNoYWxsb3cgPT09IHZvaWQgMCkgewogICAgICBzaGFsbG93ID0gZmFsc2U7CiAgICB9CiAgICBpZiAobW9jayA9PT0gdm9pZCAwKSB7CiAgICAgIG1vY2sgPSBmYWxzZTsKICAgIH0KICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKICAgIHRoaXMuc2hhbGxvdyA9IHNoYWxsb3c7CiAgICB0aGlzLm1vY2sgPSBtb2NrOwogICAgLy8gdGhpcy52YWx1ZSA9IHZhbHVlCiAgICB0aGlzLmRlcCA9IG1vY2sgPyBtb2NrRGVwIDogbmV3IERlcCgpOwogICAgdGhpcy52bUNvdW50ID0gMDsKICAgIGRlZih2YWx1ZSwgJ19fb2JfXycsIHRoaXMpOwogICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7CiAgICAgIGlmICghbW9jaykgewogICAgICAgIGlmIChoYXNQcm90bykgewogICAgICAgICAgdmFsdWUuX19wcm90b19fID0gYXJyYXlNZXRob2RzOwogICAgICAgICAgLyogZXNsaW50LWVuYWJsZSBuby1wcm90byAqLwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGFycmF5S2V5cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICAgICAgdmFyIGtleSA9IGFycmF5S2V5c1tpXTsKICAgICAgICAgICAgZGVmKHZhbHVlLCBrZXksIGFycmF5TWV0aG9kc1trZXldKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKCFzaGFsbG93KSB7CiAgICAgICAgdGhpcy5vYnNlcnZlQXJyYXkodmFsdWUpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAvKioKICAgICAgICogV2FsayB0aHJvdWdoIGFsbCBwcm9wZXJ0aWVzIGFuZCBjb252ZXJ0IHRoZW0gaW50bwogICAgICAgKiBnZXR0ZXIvc2V0dGVycy4gVGhpcyBtZXRob2Qgc2hvdWxkIG9ubHkgYmUgY2FsbGVkIHdoZW4KICAgICAgICogdmFsdWUgdHlwZSBpcyBPYmplY3QuCiAgICAgICAqLwogICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHZhbHVlKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGtleSA9IGtleXNbaV07CiAgICAgICAgZGVmaW5lUmVhY3RpdmUodmFsdWUsIGtleSwgTk9fSU5JVElBTF9WQUxVRSwgdW5kZWZpbmVkLCBzaGFsbG93LCBtb2NrKTsKICAgICAgfQogICAgfQogIH0KICAvKioKICAgKiBPYnNlcnZlIGEgbGlzdCBvZiBBcnJheSBpdGVtcy4KICAgKi8KICBPYnNlcnZlci5wcm90b3R5cGUub2JzZXJ2ZUFycmF5ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICBmb3IgKHZhciBpID0gMCwgbCA9IHZhbHVlLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICBvYnNlcnZlKHZhbHVlW2ldLCBmYWxzZSwgdGhpcy5tb2NrKTsKICAgIH0KICB9OwogIHJldHVybiBPYnNlcnZlcjsKfSgpOwovLyBoZWxwZXJzCi8qKgogKiBBdHRlbXB0IHRvIGNyZWF0ZSBhbiBvYnNlcnZlciBpbnN0YW5jZSBmb3IgYSB2YWx1ZSwKICogcmV0dXJucyB0aGUgbmV3IG9ic2VydmVyIGlmIHN1Y2Nlc3NmdWxseSBvYnNlcnZlZCwKICogb3IgdGhlIGV4aXN0aW5nIG9ic2VydmVyIGlmIHRoZSB2YWx1ZSBhbHJlYWR5IGhhcyBvbmUuCiAqLwpmdW5jdGlvbiBvYnNlcnZlKHZhbHVlLCBzaGFsbG93LCBzc3JNb2NrUmVhY3Rpdml0eSkgewogIGlmICh2YWx1ZSAmJiBoYXNPd24odmFsdWUsICdfX29iX18nKSAmJiB2YWx1ZS5fX29iX18gaW5zdGFuY2VvZiBPYnNlcnZlcikgewogICAgcmV0dXJuIHZhbHVlLl9fb2JfXzsKICB9CiAgaWYgKHNob3VsZE9ic2VydmUgJiYgKHNzck1vY2tSZWFjdGl2aXR5IHx8ICFpc1NlcnZlclJlbmRlcmluZygpKSAmJiAoaXNBcnJheSh2YWx1ZSkgfHwgaXNQbGFpbk9iamVjdCh2YWx1ZSkpICYmIE9iamVjdC5pc0V4dGVuc2libGUodmFsdWUpICYmICF2YWx1ZS5fX3Zfc2tpcCAvKiBSZWFjdGl2ZUZsYWdzLlNLSVAgKi8gJiYgIWlzUmVmKHZhbHVlKSAmJiAhKHZhbHVlIGluc3RhbmNlb2YgVk5vZGUpKSB7CiAgICByZXR1cm4gbmV3IE9ic2VydmVyKHZhbHVlLCBzaGFsbG93LCBzc3JNb2NrUmVhY3Rpdml0eSk7CiAgfQp9Ci8qKgogKiBEZWZpbmUgYSByZWFjdGl2ZSBwcm9wZXJ0eSBvbiBhbiBPYmplY3QuCiAqLwpmdW5jdGlvbiBkZWZpbmVSZWFjdGl2ZShvYmosIGtleSwgdmFsLCBjdXN0b21TZXR0ZXIsIHNoYWxsb3csIG1vY2ssIG9ic2VydmVFdmVuSWZTaGFsbG93KSB7CiAgaWYgKG9ic2VydmVFdmVuSWZTaGFsbG93ID09PSB2b2lkIDApIHsKICAgIG9ic2VydmVFdmVuSWZTaGFsbG93ID0gZmFsc2U7CiAgfQogIHZhciBkZXAgPSBuZXcgRGVwKCk7CiAgdmFyIHByb3BlcnR5ID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSk7CiAgaWYgKHByb3BlcnR5ICYmIHByb3BlcnR5LmNvbmZpZ3VyYWJsZSA9PT0gZmFsc2UpIHsKICAgIHJldHVybjsKICB9CiAgLy8gY2F0ZXIgZm9yIHByZS1kZWZpbmVkIGdldHRlci9zZXR0ZXJzCiAgdmFyIGdldHRlciA9IHByb3BlcnR5ICYmIHByb3BlcnR5LmdldDsKICB2YXIgc2V0dGVyID0gcHJvcGVydHkgJiYgcHJvcGVydHkuc2V0OwogIGlmICgoIWdldHRlciB8fCBzZXR0ZXIpICYmICh2YWwgPT09IE5PX0lOSVRJQUxfVkFMVUUgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikpIHsKICAgIHZhbCA9IG9ialtrZXldOwogIH0KICB2YXIgY2hpbGRPYiA9IHNoYWxsb3cgPyB2YWwgJiYgdmFsLl9fb2JfXyA6IG9ic2VydmUodmFsLCBmYWxzZSwgbW9jayk7CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgZ2V0OiBmdW5jdGlvbiByZWFjdGl2ZUdldHRlcigpIHsKICAgICAgdmFyIHZhbHVlID0gZ2V0dGVyID8gZ2V0dGVyLmNhbGwob2JqKSA6IHZhbDsKICAgICAgaWYgKERlcC50YXJnZXQpIHsKICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICAgICAgZGVwLmRlcGVuZCh7CiAgICAgICAgICAgIHRhcmdldDogb2JqLAogICAgICAgICAgICB0eXBlOiAiZ2V0IiAvKiBUcmFja09wVHlwZXMuR0VUICovLAogICAgICAgICAgICBrZXk6IGtleQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRlcC5kZXBlbmQoKTsKICAgICAgICB9CiAgICAgICAgaWYgKGNoaWxkT2IpIHsKICAgICAgICAgIGNoaWxkT2IuZGVwLmRlcGVuZCgpOwogICAgICAgICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7CiAgICAgICAgICAgIGRlcGVuZEFycmF5KHZhbHVlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGlzUmVmKHZhbHVlKSAmJiAhc2hhbGxvdyA/IHZhbHVlLnZhbHVlIDogdmFsdWU7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbiByZWFjdGl2ZVNldHRlcihuZXdWYWwpIHsKICAgICAgdmFyIHZhbHVlID0gZ2V0dGVyID8gZ2V0dGVyLmNhbGwob2JqKSA6IHZhbDsKICAgICAgaWYgKCFoYXNDaGFuZ2VkKHZhbHVlLCBuZXdWYWwpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIGN1c3RvbVNldHRlcikgewogICAgICAgIGN1c3RvbVNldHRlcigpOwogICAgICB9CiAgICAgIGlmIChzZXR0ZXIpIHsKICAgICAgICBzZXR0ZXIuY2FsbChvYmosIG5ld1ZhbCk7CiAgICAgIH0gZWxzZSBpZiAoZ2V0dGVyKSB7CiAgICAgICAgLy8gIzc5ODE6IGZvciBhY2Nlc3NvciBwcm9wZXJ0aWVzIHdpdGhvdXQgc2V0dGVyCiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKCFzaGFsbG93ICYmIGlzUmVmKHZhbHVlKSAmJiAhaXNSZWYobmV3VmFsKSkgewogICAgICAgIHZhbHVlLnZhbHVlID0gbmV3VmFsOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YWwgPSBuZXdWYWw7CiAgICAgIH0KICAgICAgY2hpbGRPYiA9IHNoYWxsb3cgPyBuZXdWYWwgJiYgbmV3VmFsLl9fb2JfXyA6IG9ic2VydmUobmV3VmFsLCBmYWxzZSwgbW9jayk7CiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICAgICAgZGVwLm5vdGlmeSh7CiAgICAgICAgICB0eXBlOiAic2V0IiAvKiBUcmlnZ2VyT3BUeXBlcy5TRVQgKi8sCiAgICAgICAgICB0YXJnZXQ6IG9iaiwKICAgICAgICAgIGtleToga2V5LAogICAgICAgICAgbmV3VmFsdWU6IG5ld1ZhbCwKICAgICAgICAgIG9sZFZhbHVlOiB2YWx1ZQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGRlcC5ub3RpZnkoKTsKICAgICAgfQogICAgfQogIH0pOwogIHJldHVybiBkZXA7Cn0KZnVuY3Rpb24gc2V0KHRhcmdldCwga2V5LCB2YWwpIHsKICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiAoaXNVbmRlZih0YXJnZXQpIHx8IGlzUHJpbWl0aXZlKHRhcmdldCkpKSB7CiAgICB3YXJuKCJDYW5ub3Qgc2V0IHJlYWN0aXZlIHByb3BlcnR5IG9uIHVuZGVmaW5lZCwgbnVsbCwgb3IgcHJpbWl0aXZlIHZhbHVlOiAiLmNvbmNhdCh0YXJnZXQpKTsKICB9CiAgaWYgKGlzUmVhZG9ubHkodGFyZ2V0KSkgewogICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuKCJTZXQgb3BlcmF0aW9uIG9uIGtleSBcIiIuY29uY2F0KGtleSwgIlwiIGZhaWxlZDogdGFyZ2V0IGlzIHJlYWRvbmx5LiIpKTsKICAgIHJldHVybjsKICB9CiAgdmFyIG9iID0gdGFyZ2V0Ll9fb2JfXzsKICBpZiAoaXNBcnJheSh0YXJnZXQpICYmIGlzVmFsaWRBcnJheUluZGV4KGtleSkpIHsKICAgIHRhcmdldC5sZW5ndGggPSBNYXRoLm1heCh0YXJnZXQubGVuZ3RoLCBrZXkpOwogICAgdGFyZ2V0LnNwbGljZShrZXksIDEsIHZhbCk7CiAgICAvLyB3aGVuIG1vY2tpbmcgZm9yIFNTUiwgYXJyYXkgbWV0aG9kcyBhcmUgbm90IGhpamFja2VkCiAgICBpZiAob2IgJiYgIW9iLnNoYWxsb3cgJiYgb2IubW9jaykgewogICAgICBvYnNlcnZlKHZhbCwgZmFsc2UsIHRydWUpOwogICAgfQogICAgcmV0dXJuIHZhbDsKICB9CiAgaWYgKGtleSBpbiB0YXJnZXQgJiYgIShrZXkgaW4gT2JqZWN0LnByb3RvdHlwZSkpIHsKICAgIHRhcmdldFtrZXldID0gdmFsOwogICAgcmV0dXJuIHZhbDsKICB9CiAgaWYgKHRhcmdldC5faXNWdWUgfHwgb2IgJiYgb2Iudm1Db3VudCkgewogICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuKCdBdm9pZCBhZGRpbmcgcmVhY3RpdmUgcHJvcGVydGllcyB0byBhIFZ1ZSBpbnN0YW5jZSBvciBpdHMgcm9vdCAkZGF0YSAnICsgJ2F0IHJ1bnRpbWUgLSBkZWNsYXJlIGl0IHVwZnJvbnQgaW4gdGhlIGRhdGEgb3B0aW9uLicpOwogICAgcmV0dXJuIHZhbDsKICB9CiAgaWYgKCFvYikgewogICAgdGFyZ2V0W2tleV0gPSB2YWw7CiAgICByZXR1cm4gdmFsOwogIH0KICBkZWZpbmVSZWFjdGl2ZShvYi52YWx1ZSwga2V5LCB2YWwsIHVuZGVmaW5lZCwgb2Iuc2hhbGxvdywgb2IubW9jayk7CiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgIG9iLmRlcC5ub3RpZnkoewogICAgICB0eXBlOiAiYWRkIiAvKiBUcmlnZ2VyT3BUeXBlcy5BREQgKi8sCiAgICAgIHRhcmdldDogdGFyZ2V0LAogICAgICBrZXk6IGtleSwKICAgICAgbmV3VmFsdWU6IHZhbCwKICAgICAgb2xkVmFsdWU6IHVuZGVmaW5lZAogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9iLmRlcC5ub3RpZnkoKTsKICB9CiAgcmV0dXJuIHZhbDsKfQpmdW5jdGlvbiBkZWwodGFyZ2V0LCBrZXkpIHsKICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiAoaXNVbmRlZih0YXJnZXQpIHx8IGlzUHJpbWl0aXZlKHRhcmdldCkpKSB7CiAgICB3YXJuKCJDYW5ub3QgZGVsZXRlIHJlYWN0aXZlIHByb3BlcnR5IG9uIHVuZGVmaW5lZCwgbnVsbCwgb3IgcHJpbWl0aXZlIHZhbHVlOiAiLmNvbmNhdCh0YXJnZXQpKTsKICB9CiAgaWYgKGlzQXJyYXkodGFyZ2V0KSAmJiBpc1ZhbGlkQXJyYXlJbmRleChrZXkpKSB7CiAgICB0YXJnZXQuc3BsaWNlKGtleSwgMSk7CiAgICByZXR1cm47CiAgfQogIHZhciBvYiA9IHRhcmdldC5fX29iX187CiAgaWYgKHRhcmdldC5faXNWdWUgfHwgb2IgJiYgb2Iudm1Db3VudCkgewogICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuKCdBdm9pZCBkZWxldGluZyBwcm9wZXJ0aWVzIG9uIGEgVnVlIGluc3RhbmNlIG9yIGl0cyByb290ICRkYXRhICcgKyAnLSBqdXN0IHNldCBpdCB0byBudWxsLicpOwogICAgcmV0dXJuOwogIH0KICBpZiAoaXNSZWFkb25seSh0YXJnZXQpKSB7CiAgICBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm4oIkRlbGV0ZSBvcGVyYXRpb24gb24ga2V5IFwiIi5jb25jYXQoa2V5LCAiXCIgZmFpbGVkOiB0YXJnZXQgaXMgcmVhZG9ubHkuIikpOwogICAgcmV0dXJuOwogIH0KICBpZiAoIWhhc093bih0YXJnZXQsIGtleSkpIHsKICAgIHJldHVybjsKICB9CiAgZGVsZXRlIHRhcmdldFtrZXldOwogIGlmICghb2IpIHsKICAgIHJldHVybjsKICB9CiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgIG9iLmRlcC5ub3RpZnkoewogICAgICB0eXBlOiAiZGVsZXRlIiAvKiBUcmlnZ2VyT3BUeXBlcy5ERUxFVEUgKi8sCiAgICAgIHRhcmdldDogdGFyZ2V0LAogICAgICBrZXk6IGtleQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9iLmRlcC5ub3RpZnkoKTsKICB9Cn0KLyoqCiAqIENvbGxlY3QgZGVwZW5kZW5jaWVzIG9uIGFycmF5IGVsZW1lbnRzIHdoZW4gdGhlIGFycmF5IGlzIHRvdWNoZWQsIHNpbmNlCiAqIHdlIGNhbm5vdCBpbnRlcmNlcHQgYXJyYXkgZWxlbWVudCBhY2Nlc3MgbGlrZSBwcm9wZXJ0eSBnZXR0ZXJzLgogKi8KZnVuY3Rpb24gZGVwZW5kQXJyYXkodmFsdWUpIHsKICBmb3IgKHZhciBlID0gdm9pZCAwLCBpID0gMCwgbCA9IHZhbHVlLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgZSA9IHZhbHVlW2ldOwogICAgaWYgKGUgJiYgZS5fX29iX18pIHsKICAgICAgZS5fX29iX18uZGVwLmRlcGVuZCgpOwogICAgfQogICAgaWYgKGlzQXJyYXkoZSkpIHsKICAgICAgZGVwZW5kQXJyYXkoZSk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIHJlYWN0aXZlKHRhcmdldCkgewogIG1ha2VSZWFjdGl2ZSh0YXJnZXQsIGZhbHNlKTsKICByZXR1cm4gdGFyZ2V0Owp9Ci8qKgogKiBSZXR1cm4gYSBzaGFsbG93bHktcmVhY3RpdmUgY29weSBvZiB0aGUgb3JpZ2luYWwgb2JqZWN0LCB3aGVyZSBvbmx5IHRoZSByb290CiAqIGxldmVsIHByb3BlcnRpZXMgYXJlIHJlYWN0aXZlLiBJdCBhbHNvIGRvZXMgbm90IGF1dG8tdW53cmFwIHJlZnMgKGV2ZW4gYXQgdGhlCiAqIHJvb3QgbGV2ZWwpLgogKi8KZnVuY3Rpb24gc2hhbGxvd1JlYWN0aXZlKHRhcmdldCkgewogIG1ha2VSZWFjdGl2ZSh0YXJnZXQsIHRydWUpOwogIGRlZih0YXJnZXQsICJfX3ZfaXNTaGFsbG93IiAvKiBSZWFjdGl2ZUZsYWdzLklTX1NIQUxMT1cgKi8sIHRydWUpOwogIHJldHVybiB0YXJnZXQ7Cn0KZnVuY3Rpb24gbWFrZVJlYWN0aXZlKHRhcmdldCwgc2hhbGxvdykgewogIC8vIGlmIHRyeWluZyB0byBvYnNlcnZlIGEgcmVhZG9ubHkgcHJveHksIHJldHVybiB0aGUgcmVhZG9ubHkgdmVyc2lvbi4KICBpZiAoIWlzUmVhZG9ubHkodGFyZ2V0KSkgewogICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgICAgaWYgKGlzQXJyYXkodGFyZ2V0KSkgewogICAgICAgIHdhcm4oIkF2b2lkIHVzaW5nIEFycmF5IGFzIHJvb3QgdmFsdWUgZm9yICIuY29uY2F0KHNoYWxsb3cgPyAic2hhbGxvd1JlYWN0aXZlKCkiIDogInJlYWN0aXZlKCkiLCAiIGFzIGl0IGNhbm5vdCBiZSB0cmFja2VkIGluIHdhdGNoKCkgb3Igd2F0Y2hFZmZlY3QoKS4gVXNlICIpLmNvbmNhdChzaGFsbG93ID8gInNoYWxsb3dSZWYoKSIgOiAicmVmKCkiLCAiIGluc3RlYWQuIFRoaXMgaXMgYSBWdWUtMi1vbmx5IGxpbWl0YXRpb24uIikpOwogICAgICB9CiAgICAgIHZhciBleGlzdGluZ09iID0gdGFyZ2V0ICYmIHRhcmdldC5fX29iX187CiAgICAgIGlmIChleGlzdGluZ09iICYmIGV4aXN0aW5nT2Iuc2hhbGxvdyAhPT0gc2hhbGxvdykgewogICAgICAgIHdhcm4oIlRhcmdldCBpcyBhbHJlYWR5IGEgIi5jb25jYXQoZXhpc3RpbmdPYi5zaGFsbG93ID8gIiIgOiAibm9uLSIsICJzaGFsbG93IHJlYWN0aXZlIG9iamVjdCwgYW5kIGNhbm5vdCBiZSBjb252ZXJ0ZWQgdG8gIikuY29uY2F0KHNoYWxsb3cgPyAiIiA6ICJub24tIiwgInNoYWxsb3cuIikpOwogICAgICB9CiAgICB9CiAgICB2YXIgb2IgPSBvYnNlcnZlKHRhcmdldCwgc2hhbGxvdywgaXNTZXJ2ZXJSZW5kZXJpbmcoKSAvKiBzc3IgbW9jayByZWFjdGl2aXR5ICovKTsKICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmICFvYikgewogICAgICBpZiAodGFyZ2V0ID09IG51bGwgfHwgaXNQcmltaXRpdmUodGFyZ2V0KSkgewogICAgICAgIHdhcm4oInZhbHVlIGNhbm5vdCBiZSBtYWRlIHJlYWN0aXZlOiAiLmNvbmNhdChTdHJpbmcodGFyZ2V0KSkpOwogICAgICB9CiAgICAgIGlmIChpc0NvbGxlY3Rpb25UeXBlKHRhcmdldCkpIHsKICAgICAgICB3YXJuKCJWdWUgMiBkb2VzIG5vdCBzdXBwb3J0IHJlYWN0aXZlIGNvbGxlY3Rpb24gdHlwZXMgc3VjaCBhcyBNYXAgb3IgU2V0LiIpOwogICAgICB9CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGlzUmVhY3RpdmUodmFsdWUpIHsKICBpZiAoaXNSZWFkb25seSh2YWx1ZSkpIHsKICAgIHJldHVybiBpc1JlYWN0aXZlKHZhbHVlWyJfX3ZfcmF3IiAvKiBSZWFjdGl2ZUZsYWdzLlJBVyAqL10pOwogIH0KICByZXR1cm4gISEodmFsdWUgJiYgdmFsdWUuX19vYl9fKTsKfQpmdW5jdGlvbiBpc1NoYWxsb3codmFsdWUpIHsKICByZXR1cm4gISEodmFsdWUgJiYgdmFsdWUuX192X2lzU2hhbGxvdyk7Cn0KZnVuY3Rpb24gaXNSZWFkb25seSh2YWx1ZSkgewogIHJldHVybiAhISh2YWx1ZSAmJiB2YWx1ZS5fX3ZfaXNSZWFkb25seSk7Cn0KZnVuY3Rpb24gaXNQcm94eSh2YWx1ZSkgewogIHJldHVybiBpc1JlYWN0aXZlKHZhbHVlKSB8fCBpc1JlYWRvbmx5KHZhbHVlKTsKfQpmdW5jdGlvbiB0b1JhdyhvYnNlcnZlZCkgewogIHZhciByYXcgPSBvYnNlcnZlZCAmJiBvYnNlcnZlZFsiX192X3JhdyIgLyogUmVhY3RpdmVGbGFncy5SQVcgKi9dOwogIHJldHVybiByYXcgPyB0b1JhdyhyYXcpIDogb2JzZXJ2ZWQ7Cn0KZnVuY3Rpb24gbWFya1Jhdyh2YWx1ZSkgewogIC8vIG5vbi1leHRlbnNpYmxlIG9iamVjdHMgd29uJ3QgYmUgb2JzZXJ2ZWQgYW55d2F5CiAgaWYgKE9iamVjdC5pc0V4dGVuc2libGUodmFsdWUpKSB7CiAgICBkZWYodmFsdWUsICJfX3Zfc2tpcCIgLyogUmVhY3RpdmVGbGFncy5TS0lQICovLCB0cnVlKTsKICB9CiAgcmV0dXJuIHZhbHVlOwp9Ci8qKgogKiBAaW50ZXJuYWwKICovCmZ1bmN0aW9uIGlzQ29sbGVjdGlvblR5cGUodmFsdWUpIHsKICB2YXIgdHlwZSA9IHRvUmF3VHlwZSh2YWx1ZSk7CiAgcmV0dXJuIHR5cGUgPT09ICdNYXAnIHx8IHR5cGUgPT09ICdXZWFrTWFwJyB8fCB0eXBlID09PSAnU2V0JyB8fCB0eXBlID09PSAnV2Vha1NldCc7Cn0KCi8qKgogKiBAaW50ZXJuYWwKICovCnZhciBSZWZGbGFnID0gIl9fdl9pc1JlZiI7CmZ1bmN0aW9uIGlzUmVmKHIpIHsKICByZXR1cm4gISEociAmJiByLl9fdl9pc1JlZiA9PT0gdHJ1ZSk7Cn0KZnVuY3Rpb24gcmVmJDEodmFsdWUpIHsKICByZXR1cm4gY3JlYXRlUmVmKHZhbHVlLCBmYWxzZSk7Cn0KZnVuY3Rpb24gc2hhbGxvd1JlZih2YWx1ZSkgewogIHJldHVybiBjcmVhdGVSZWYodmFsdWUsIHRydWUpOwp9CmZ1bmN0aW9uIGNyZWF0ZVJlZihyYXdWYWx1ZSwgc2hhbGxvdykgewogIGlmIChpc1JlZihyYXdWYWx1ZSkpIHsKICAgIHJldHVybiByYXdWYWx1ZTsKICB9CiAgdmFyIHJlZiA9IHt9OwogIGRlZihyZWYsIFJlZkZsYWcsIHRydWUpOwogIGRlZihyZWYsICJfX3ZfaXNTaGFsbG93IiAvKiBSZWFjdGl2ZUZsYWdzLklTX1NIQUxMT1cgKi8sIHNoYWxsb3cpOwogIGRlZihyZWYsICdkZXAnLCBkZWZpbmVSZWFjdGl2ZShyZWYsICd2YWx1ZScsIHJhd1ZhbHVlLCBudWxsLCBzaGFsbG93LCBpc1NlcnZlclJlbmRlcmluZygpKSk7CiAgcmV0dXJuIHJlZjsKfQpmdW5jdGlvbiB0cmlnZ2VyUmVmKHJlZikgewogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmICFyZWYuZGVwKSB7CiAgICB3YXJuKCJyZWNlaXZlZCBvYmplY3QgaXMgbm90IGEgdHJpZ2dlcmFibGUgcmVmLiIpOwogIH0KICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgcmVmLmRlcCAmJiByZWYuZGVwLm5vdGlmeSh7CiAgICAgIHR5cGU6ICJzZXQiIC8qIFRyaWdnZXJPcFR5cGVzLlNFVCAqLywKICAgICAgdGFyZ2V0OiByZWYsCiAgICAgIGtleTogJ3ZhbHVlJwogICAgfSk7CiAgfSBlbHNlIHsKICAgIHJlZi5kZXAgJiYgcmVmLmRlcC5ub3RpZnkoKTsKICB9Cn0KZnVuY3Rpb24gdW5yZWYocmVmKSB7CiAgcmV0dXJuIGlzUmVmKHJlZikgPyByZWYudmFsdWUgOiByZWY7Cn0KZnVuY3Rpb24gcHJveHlSZWZzKG9iamVjdFdpdGhSZWZzKSB7CiAgaWYgKGlzUmVhY3RpdmUob2JqZWN0V2l0aFJlZnMpKSB7CiAgICByZXR1cm4gb2JqZWN0V2l0aFJlZnM7CiAgfQogIHZhciBwcm94eSA9IHt9OwogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0V2l0aFJlZnMpOwogIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgcHJveHlXaXRoUmVmVW53cmFwKHByb3h5LCBvYmplY3RXaXRoUmVmcywga2V5c1tpXSk7CiAgfQogIHJldHVybiBwcm94eTsKfQpmdW5jdGlvbiBwcm94eVdpdGhSZWZVbndyYXAodGFyZ2V0LCBzb3VyY2UsIGtleSkgewogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgewogICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICB2YXIgdmFsID0gc291cmNlW2tleV07CiAgICAgIGlmIChpc1JlZih2YWwpKSB7CiAgICAgICAgcmV0dXJuIHZhbC52YWx1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgb2IgPSB2YWwgJiYgdmFsLl9fb2JfXzsKICAgICAgICBpZiAob2IpIG9iLmRlcC5kZXBlbmQoKTsKICAgICAgICByZXR1cm4gdmFsOwogICAgICB9CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgdmFyIG9sZFZhbHVlID0gc291cmNlW2tleV07CiAgICAgIGlmIChpc1JlZihvbGRWYWx1ZSkgJiYgIWlzUmVmKHZhbHVlKSkgewogICAgICAgIG9sZFZhbHVlLnZhbHVlID0gdmFsdWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc291cmNlW2tleV0gPSB2YWx1ZTsKICAgICAgfQogICAgfQogIH0pOwp9CmZ1bmN0aW9uIGN1c3RvbVJlZihmYWN0b3J5KSB7CiAgdmFyIGRlcCA9IG5ldyBEZXAoKTsKICB2YXIgX2EgPSBmYWN0b3J5KGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgICAgICBkZXAuZGVwZW5kKHsKICAgICAgICAgIHRhcmdldDogcmVmLAogICAgICAgICAgdHlwZTogImdldCIgLyogVHJhY2tPcFR5cGVzLkdFVCAqLywKICAgICAgICAgIGtleTogJ3ZhbHVlJwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGRlcC5kZXBlbmQoKTsKICAgICAgfQogICAgfSwgZnVuY3Rpb24gKCkgewogICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICAgIGRlcC5ub3RpZnkoewogICAgICAgICAgdGFyZ2V0OiByZWYsCiAgICAgICAgICB0eXBlOiAic2V0IiAvKiBUcmlnZ2VyT3BUeXBlcy5TRVQgKi8sCiAgICAgICAgICBrZXk6ICd2YWx1ZScKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBkZXAubm90aWZ5KCk7CiAgICAgIH0KICAgIH0pLAogICAgZ2V0ID0gX2EuZ2V0LAogICAgc2V0ID0gX2Euc2V0OwogIHZhciByZWYgPSB7CiAgICBnZXQgdmFsdWUoKSB7CiAgICAgIHJldHVybiBnZXQoKTsKICAgIH0sCiAgICBzZXQgdmFsdWUobmV3VmFsKSB7CiAgICAgIHNldChuZXdWYWwpOwogICAgfQogIH07CiAgZGVmKHJlZiwgUmVmRmxhZywgdHJ1ZSk7CiAgcmV0dXJuIHJlZjsKfQpmdW5jdGlvbiB0b1JlZnMob2JqZWN0KSB7CiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgIWlzUmVhY3RpdmUob2JqZWN0KSkgewogICAgd2FybigidG9SZWZzKCkgZXhwZWN0cyBhIHJlYWN0aXZlIG9iamVjdCBidXQgcmVjZWl2ZWQgYSBwbGFpbiBvbmUuIik7CiAgfQogIHZhciByZXQgPSBpc0FycmF5KG9iamVjdCkgPyBuZXcgQXJyYXkob2JqZWN0Lmxlbmd0aCkgOiB7fTsKICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7CiAgICByZXRba2V5XSA9IHRvUmVmKG9iamVjdCwga2V5KTsKICB9CiAgcmV0dXJuIHJldDsKfQpmdW5jdGlvbiB0b1JlZihvYmplY3QsIGtleSwgZGVmYXVsdFZhbHVlKSB7CiAgdmFyIHZhbCA9IG9iamVjdFtrZXldOwogIGlmIChpc1JlZih2YWwpKSB7CiAgICByZXR1cm4gdmFsOwogIH0KICB2YXIgcmVmID0gewogICAgZ2V0IHZhbHVlKCkgewogICAgICB2YXIgdmFsID0gb2JqZWN0W2tleV07CiAgICAgIHJldHVybiB2YWwgPT09IHVuZGVmaW5lZCA/IGRlZmF1bHRWYWx1ZSA6IHZhbDsKICAgIH0sCiAgICBzZXQgdmFsdWUobmV3VmFsKSB7CiAgICAgIG9iamVjdFtrZXldID0gbmV3VmFsOwogICAgfQogIH07CiAgZGVmKHJlZiwgUmVmRmxhZywgdHJ1ZSk7CiAgcmV0dXJuIHJlZjsKfQp2YXIgcmF3VG9SZWFkb25seUZsYWcgPSAiX192X3Jhd1RvUmVhZG9ubHkiOwp2YXIgcmF3VG9TaGFsbG93UmVhZG9ubHlGbGFnID0gIl9fdl9yYXdUb1NoYWxsb3dSZWFkb25seSI7CmZ1bmN0aW9uIHJlYWRvbmx5KHRhcmdldCkgewogIHJldHVybiBjcmVhdGVSZWFkb25seSh0YXJnZXQsIGZhbHNlKTsKfQpmdW5jdGlvbiBjcmVhdGVSZWFkb25seSh0YXJnZXQsIHNoYWxsb3cpIHsKICBpZiAoIWlzUGxhaW5PYmplY3QodGFyZ2V0KSkgewogICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgICAgaWYgKGlzQXJyYXkodGFyZ2V0KSkgewogICAgICAgIHdhcm4oIlZ1ZSAyIGRvZXMgbm90IHN1cHBvcnQgcmVhZG9ubHkgYXJyYXlzLiIpOwogICAgICB9IGVsc2UgaWYgKGlzQ29sbGVjdGlvblR5cGUodGFyZ2V0KSkgewogICAgICAgIHdhcm4oIlZ1ZSAyIGRvZXMgbm90IHN1cHBvcnQgcmVhZG9ubHkgY29sbGVjdGlvbiB0eXBlcyBzdWNoIGFzIE1hcCBvciBTZXQuIik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgd2FybigidmFsdWUgY2Fubm90IGJlIG1hZGUgcmVhZG9ubHk6ICIuY29uY2F0KHR5cGVvZiB0YXJnZXQpKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHRhcmdldDsKICB9CiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgIU9iamVjdC5pc0V4dGVuc2libGUodGFyZ2V0KSkgewogICAgd2FybigiVnVlIDIgZG9lcyBub3Qgc3VwcG9ydCBjcmVhdGluZyByZWFkb25seSBwcm94eSBmb3Igbm9uLWV4dGVuc2libGUgb2JqZWN0LiIpOwogIH0KICAvLyBhbHJlYWR5IGEgcmVhZG9ubHkgb2JqZWN0CiAgaWYgKGlzUmVhZG9ubHkodGFyZ2V0KSkgewogICAgcmV0dXJuIHRhcmdldDsKICB9CiAgLy8gYWxyZWFkeSBoYXMgYSByZWFkb25seSBwcm94eQogIHZhciBleGlzdGluZ0ZsYWcgPSBzaGFsbG93ID8gcmF3VG9TaGFsbG93UmVhZG9ubHlGbGFnIDogcmF3VG9SZWFkb25seUZsYWc7CiAgdmFyIGV4aXN0aW5nUHJveHkgPSB0YXJnZXRbZXhpc3RpbmdGbGFnXTsKICBpZiAoZXhpc3RpbmdQcm94eSkgewogICAgcmV0dXJuIGV4aXN0aW5nUHJveHk7CiAgfQogIHZhciBwcm94eSA9IE9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKHRhcmdldCkpOwogIGRlZih0YXJnZXQsIGV4aXN0aW5nRmxhZywgcHJveHkpOwogIGRlZihwcm94eSwgIl9fdl9pc1JlYWRvbmx5IiAvKiBSZWFjdGl2ZUZsYWdzLklTX1JFQURPTkxZICovLCB0cnVlKTsKICBkZWYocHJveHksICJfX3ZfcmF3IiAvKiBSZWFjdGl2ZUZsYWdzLlJBVyAqLywgdGFyZ2V0KTsKICBpZiAoaXNSZWYodGFyZ2V0KSkgewogICAgZGVmKHByb3h5LCBSZWZGbGFnLCB0cnVlKTsKICB9CiAgaWYgKHNoYWxsb3cgfHwgaXNTaGFsbG93KHRhcmdldCkpIHsKICAgIGRlZihwcm94eSwgIl9fdl9pc1NoYWxsb3ciIC8qIFJlYWN0aXZlRmxhZ3MuSVNfU0hBTExPVyAqLywgdHJ1ZSk7CiAgfQogIHZhciBrZXlzID0gT2JqZWN0LmtleXModGFyZ2V0KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgIGRlZmluZVJlYWRvbmx5UHJvcGVydHkocHJveHksIHRhcmdldCwga2V5c1tpXSwgc2hhbGxvdyk7CiAgfQogIHJldHVybiBwcm94eTsKfQpmdW5jdGlvbiBkZWZpbmVSZWFkb25seVByb3BlcnR5KHByb3h5LCB0YXJnZXQsIGtleSwgc2hhbGxvdykgewogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm94eSwga2V5LCB7CiAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgZ2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciB2YWwgPSB0YXJnZXRba2V5XTsKICAgICAgcmV0dXJuIHNoYWxsb3cgfHwgIWlzUGxhaW5PYmplY3QodmFsKSA/IHZhbCA6IHJlYWRvbmx5KHZhbCk7CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbiAoKSB7CiAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgd2FybigiU2V0IG9wZXJhdGlvbiBvbiBrZXkgXCIiLmNvbmNhdChrZXksICJcIiBmYWlsZWQ6IHRhcmdldCBpcyByZWFkb25seS4iKSk7CiAgICB9CiAgfSk7Cn0KLyoqCiAqIFJldHVybnMgYSByZWFjdGl2ZS1jb3B5IG9mIHRoZSBvcmlnaW5hbCBvYmplY3QsIHdoZXJlIG9ubHkgdGhlIHJvb3QgbGV2ZWwKICogcHJvcGVydGllcyBhcmUgcmVhZG9ubHksIGFuZCBkb2VzIE5PVCB1bndyYXAgcmVmcyBub3IgcmVjdXJzaXZlbHkgY29udmVydAogKiByZXR1cm5lZCBwcm9wZXJ0aWVzLgogKiBUaGlzIGlzIHVzZWQgZm9yIGNyZWF0aW5nIHRoZSBwcm9wcyBwcm94eSBvYmplY3QgZm9yIHN0YXRlZnVsIGNvbXBvbmVudHMuCiAqLwpmdW5jdGlvbiBzaGFsbG93UmVhZG9ubHkodGFyZ2V0KSB7CiAgcmV0dXJuIGNyZWF0ZVJlYWRvbmx5KHRhcmdldCwgdHJ1ZSk7Cn0KZnVuY3Rpb24gY29tcHV0ZWQoZ2V0dGVyT3JPcHRpb25zLCBkZWJ1Z09wdGlvbnMpIHsKICB2YXIgZ2V0dGVyOwogIHZhciBzZXR0ZXI7CiAgdmFyIG9ubHlHZXR0ZXIgPSBpc0Z1bmN0aW9uKGdldHRlck9yT3B0aW9ucyk7CiAgaWYgKG9ubHlHZXR0ZXIpIHsKICAgIGdldHRlciA9IGdldHRlck9yT3B0aW9uczsKICAgIHNldHRlciA9IHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgPyBmdW5jdGlvbiAoKSB7CiAgICAgIHdhcm4oJ1dyaXRlIG9wZXJhdGlvbiBmYWlsZWQ6IGNvbXB1dGVkIHZhbHVlIGlzIHJlYWRvbmx5Jyk7CiAgICB9IDogbm9vcDsKICB9IGVsc2UgewogICAgZ2V0dGVyID0gZ2V0dGVyT3JPcHRpb25zLmdldDsKICAgIHNldHRlciA9IGdldHRlck9yT3B0aW9ucy5zZXQ7CiAgfQogIHZhciB3YXRjaGVyID0gaXNTZXJ2ZXJSZW5kZXJpbmcoKSA/IG51bGwgOiBuZXcgV2F0Y2hlcihjdXJyZW50SW5zdGFuY2UsIGdldHRlciwgbm9vcCwgewogICAgbGF6eTogdHJ1ZQogIH0pOwogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhdGNoZXIgJiYgZGVidWdPcHRpb25zKSB7CiAgICB3YXRjaGVyLm9uVHJhY2sgPSBkZWJ1Z09wdGlvbnMub25UcmFjazsKICAgIHdhdGNoZXIub25UcmlnZ2VyID0gZGVidWdPcHRpb25zLm9uVHJpZ2dlcjsKICB9CiAgdmFyIHJlZiA9IHsKICAgIC8vIHNvbWUgbGlicyByZWx5IG9uIHRoZSBwcmVzZW5jZSBlZmZlY3QgZm9yIGNoZWNraW5nIGNvbXB1dGVkIHJlZnMKICAgIC8vIGZyb20gbm9ybWFsIHJlZnMsIGJ1dCB0aGUgaW1wbGVtZW50YXRpb24gZG9lc24ndCBtYXR0ZXIKICAgIGVmZmVjdDogd2F0Y2hlciwKICAgIGdldCB2YWx1ZSgpIHsKICAgICAgaWYgKHdhdGNoZXIpIHsKICAgICAgICBpZiAod2F0Y2hlci5kaXJ0eSkgewogICAgICAgICAgd2F0Y2hlci5ldmFsdWF0ZSgpOwogICAgICAgIH0KICAgICAgICBpZiAoRGVwLnRhcmdldCkgewogICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgRGVwLnRhcmdldC5vblRyYWNrKSB7CiAgICAgICAgICAgIERlcC50YXJnZXQub25UcmFjayh7CiAgICAgICAgICAgICAgZWZmZWN0OiBEZXAudGFyZ2V0LAogICAgICAgICAgICAgIHRhcmdldDogcmVmLAogICAgICAgICAgICAgIHR5cGU6ICJnZXQiIC8qIFRyYWNrT3BUeXBlcy5HRVQgKi8sCiAgICAgICAgICAgICAga2V5OiAndmFsdWUnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgd2F0Y2hlci5kZXBlbmQoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHdhdGNoZXIudmFsdWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGdldHRlcigpOwogICAgICB9CiAgICB9LAogICAgc2V0IHZhbHVlKG5ld1ZhbCkgewogICAgICBzZXR0ZXIobmV3VmFsKTsKICAgIH0KICB9OwogIGRlZihyZWYsIFJlZkZsYWcsIHRydWUpOwogIGRlZihyZWYsICJfX3ZfaXNSZWFkb25seSIgLyogUmVhY3RpdmVGbGFncy5JU19SRUFET05MWSAqLywgb25seUdldHRlcik7CiAgcmV0dXJuIHJlZjsKfQp2YXIgV0FUQ0hFUiA9ICJ3YXRjaGVyIjsKdmFyIFdBVENIRVJfQ0IgPSAiIi5jb25jYXQoV0FUQ0hFUiwgIiBjYWxsYmFjayIpOwp2YXIgV0FUQ0hFUl9HRVRURVIgPSAiIi5jb25jYXQoV0FUQ0hFUiwgIiBnZXR0ZXIiKTsKdmFyIFdBVENIRVJfQ0xFQU5VUCA9ICIiLmNvbmNhdChXQVRDSEVSLCAiIGNsZWFudXAiKTsKLy8gU2ltcGxlIGVmZmVjdC4KZnVuY3Rpb24gd2F0Y2hFZmZlY3QoZWZmZWN0LCBvcHRpb25zKSB7CiAgcmV0dXJuIGRvV2F0Y2goZWZmZWN0LCBudWxsLCBvcHRpb25zKTsKfQpmdW5jdGlvbiB3YXRjaFBvc3RFZmZlY3QoZWZmZWN0LCBvcHRpb25zKSB7CiAgcmV0dXJuIGRvV2F0Y2goZWZmZWN0LCBudWxsLCBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nID8gX19hc3NpZ24oX19hc3NpZ24oe30sIG9wdGlvbnMpLCB7CiAgICBmbHVzaDogJ3Bvc3QnCiAgfSkgOiB7CiAgICBmbHVzaDogJ3Bvc3QnCiAgfSk7Cn0KZnVuY3Rpb24gd2F0Y2hTeW5jRWZmZWN0KGVmZmVjdCwgb3B0aW9ucykgewogIHJldHVybiBkb1dhdGNoKGVmZmVjdCwgbnVsbCwgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyA/IF9fYXNzaWduKF9fYXNzaWduKHt9LCBvcHRpb25zKSwgewogICAgZmx1c2g6ICdzeW5jJwogIH0pIDogewogICAgZmx1c2g6ICdzeW5jJwogIH0pOwp9Ci8vIGluaXRpYWwgdmFsdWUgZm9yIHdhdGNoZXJzIHRvIHRyaWdnZXIgb24gdW5kZWZpbmVkIGluaXRpYWwgdmFsdWVzCnZhciBJTklUSUFMX1dBVENIRVJfVkFMVUUgPSB7fTsKLy8gaW1wbGVtZW50YXRpb24KZnVuY3Rpb24gd2F0Y2goc291cmNlLCBjYiwgb3B0aW9ucykgewogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHR5cGVvZiBjYiAhPT0gJ2Z1bmN0aW9uJykgewogICAgd2FybigiYHdhdGNoKGZuLCBvcHRpb25zPylgIHNpZ25hdHVyZSBoYXMgYmVlbiBtb3ZlZCB0byBhIHNlcGFyYXRlIEFQSS4gIiArICJVc2UgYHdhdGNoRWZmZWN0KGZuLCBvcHRpb25zPylgIGluc3RlYWQuIGB3YXRjaGAgbm93IG9ubHkgIiArICJzdXBwb3J0cyBgd2F0Y2goc291cmNlLCBjYiwgb3B0aW9ucz8pIHNpZ25hdHVyZS4iKTsKICB9CiAgcmV0dXJuIGRvV2F0Y2goc291cmNlLCBjYiwgb3B0aW9ucyk7Cn0KZnVuY3Rpb24gZG9XYXRjaChzb3VyY2UsIGNiLCBfYSkgewogIHZhciBfYiA9IF9hID09PSB2b2lkIDAgPyBlbXB0eU9iamVjdCA6IF9hLAogICAgaW1tZWRpYXRlID0gX2IuaW1tZWRpYXRlLAogICAgZGVlcCA9IF9iLmRlZXAsCiAgICBfYyA9IF9iLmZsdXNoLAogICAgZmx1c2ggPSBfYyA9PT0gdm9pZCAwID8gJ3ByZScgOiBfYywKICAgIG9uVHJhY2sgPSBfYi5vblRyYWNrLAogICAgb25UcmlnZ2VyID0gX2Iub25UcmlnZ2VyOwogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmICFjYikgewogICAgaWYgKGltbWVkaWF0ZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHdhcm4oIndhdGNoKCkgXCJpbW1lZGlhdGVcIiBvcHRpb24gaXMgb25seSByZXNwZWN0ZWQgd2hlbiB1c2luZyB0aGUgIiArICJ3YXRjaChzb3VyY2UsIGNhbGxiYWNrLCBvcHRpb25zPykgc2lnbmF0dXJlLiIpOwogICAgfQogICAgaWYgKGRlZXAgIT09IHVuZGVmaW5lZCkgewogICAgICB3YXJuKCJ3YXRjaCgpIFwiZGVlcFwiIG9wdGlvbiBpcyBvbmx5IHJlc3BlY3RlZCB3aGVuIHVzaW5nIHRoZSAiICsgIndhdGNoKHNvdXJjZSwgY2FsbGJhY2ssIG9wdGlvbnM/KSBzaWduYXR1cmUuIik7CiAgICB9CiAgfQogIHZhciB3YXJuSW52YWxpZFNvdXJjZSA9IGZ1bmN0aW9uIChzKSB7CiAgICB3YXJuKCJJbnZhbGlkIHdhdGNoIHNvdXJjZTogIi5jb25jYXQocywgIi4gQSB3YXRjaCBzb3VyY2UgY2FuIG9ubHkgYmUgYSBnZXR0ZXIvZWZmZWN0ICIpICsgImZ1bmN0aW9uLCBhIHJlZiwgYSByZWFjdGl2ZSBvYmplY3QsIG9yIGFuIGFycmF5IG9mIHRoZXNlIHR5cGVzLiIpOwogIH07CiAgdmFyIGluc3RhbmNlID0gY3VycmVudEluc3RhbmNlOwogIHZhciBjYWxsID0gZnVuY3Rpb24gKGZuLCB0eXBlLCBhcmdzKSB7CiAgICBpZiAoYXJncyA9PT0gdm9pZCAwKSB7CiAgICAgIGFyZ3MgPSBudWxsOwogICAgfQogICAgdmFyIHJlcyA9IGludm9rZVdpdGhFcnJvckhhbmRsaW5nKGZuLCBudWxsLCBhcmdzLCBpbnN0YW5jZSwgdHlwZSk7CiAgICBpZiAoZGVlcCAmJiByZXMgJiYgcmVzLl9fb2JfXykgcmVzLl9fb2JfXy5kZXAuZGVwZW5kKCk7CiAgICByZXR1cm4gcmVzOwogIH07CiAgdmFyIGdldHRlcjsKICB2YXIgZm9yY2VUcmlnZ2VyID0gZmFsc2U7CiAgdmFyIGlzTXVsdGlTb3VyY2UgPSBmYWxzZTsKICBpZiAoaXNSZWYoc291cmNlKSkgewogICAgZ2V0dGVyID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gc291cmNlLnZhbHVlOwogICAgfTsKICAgIGZvcmNlVHJpZ2dlciA9IGlzU2hhbGxvdyhzb3VyY2UpOwogIH0gZWxzZSBpZiAoaXNSZWFjdGl2ZShzb3VyY2UpKSB7CiAgICBnZXR0ZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHNvdXJjZS5fX29iX18uZGVwLmRlcGVuZCgpOwogICAgICByZXR1cm4gc291cmNlOwogICAgfTsKICAgIGRlZXAgPSB0cnVlOwogIH0gZWxzZSBpZiAoaXNBcnJheShzb3VyY2UpKSB7CiAgICBpc011bHRpU291cmNlID0gdHJ1ZTsKICAgIGZvcmNlVHJpZ2dlciA9IHNvdXJjZS5zb21lKGZ1bmN0aW9uIChzKSB7CiAgICAgIHJldHVybiBpc1JlYWN0aXZlKHMpIHx8IGlzU2hhbGxvdyhzKTsKICAgIH0pOwogICAgZ2V0dGVyID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gc291cmNlLm1hcChmdW5jdGlvbiAocykgewogICAgICAgIGlmIChpc1JlZihzKSkgewogICAgICAgICAgcmV0dXJuIHMudmFsdWU7CiAgICAgICAgfSBlbHNlIGlmIChpc1JlYWN0aXZlKHMpKSB7CiAgICAgICAgICBzLl9fb2JfXy5kZXAuZGVwZW5kKCk7CiAgICAgICAgICByZXR1cm4gdHJhdmVyc2Uocyk7CiAgICAgICAgfSBlbHNlIGlmIChpc0Z1bmN0aW9uKHMpKSB7CiAgICAgICAgICByZXR1cm4gY2FsbChzLCBXQVRDSEVSX0dFVFRFUik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgd2FybkludmFsaWRTb3VyY2Uocyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CiAgfSBlbHNlIGlmIChpc0Z1bmN0aW9uKHNvdXJjZSkpIHsKICAgIGlmIChjYikgewogICAgICAvLyBnZXR0ZXIgd2l0aCBjYgogICAgICBnZXR0ZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGNhbGwoc291cmNlLCBXQVRDSEVSX0dFVFRFUik7CiAgICAgIH07CiAgICB9IGVsc2UgewogICAgICAvLyBubyBjYiAtPiBzaW1wbGUgZWZmZWN0CiAgICAgIGdldHRlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoaW5zdGFuY2UgJiYgaW5zdGFuY2UuX2lzRGVzdHJveWVkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChjbGVhbnVwKSB7CiAgICAgICAgICBjbGVhbnVwKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBjYWxsKHNvdXJjZSwgV0FUQ0hFUiwgW29uQ2xlYW51cF0pOwogICAgICB9OwogICAgfQogIH0gZWxzZSB7CiAgICBnZXR0ZXIgPSBub29wOwogICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuSW52YWxpZFNvdXJjZShzb3VyY2UpOwogIH0KICBpZiAoY2IgJiYgZGVlcCkgewogICAgdmFyIGJhc2VHZXR0ZXJfMSA9IGdldHRlcjsKICAgIGdldHRlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRyYXZlcnNlKGJhc2VHZXR0ZXJfMSgpKTsKICAgIH07CiAgfQogIHZhciBjbGVhbnVwOwogIHZhciBvbkNsZWFudXAgPSBmdW5jdGlvbiAoZm4pIHsKICAgIGNsZWFudXAgPSB3YXRjaGVyLm9uU3RvcCA9IGZ1bmN0aW9uICgpIHsKICAgICAgY2FsbChmbiwgV0FUQ0hFUl9DTEVBTlVQKTsKICAgIH07CiAgfTsKICAvLyBpbiBTU1IgdGhlcmUgaXMgbm8gbmVlZCB0byBzZXR1cCBhbiBhY3R1YWwgZWZmZWN0LCBhbmQgaXQgc2hvdWxkIGJlIG5vb3AKICAvLyB1bmxlc3MgaXQncyBlYWdlcgogIGlmIChpc1NlcnZlclJlbmRlcmluZygpKSB7CiAgICAvLyB3ZSB3aWxsIGFsc28gbm90IGNhbGwgdGhlIGludmFsaWRhdGUgY2FsbGJhY2sgKCsgcnVubmVyIGlzIG5vdCBzZXQgdXApCiAgICBvbkNsZWFudXAgPSBub29wOwogICAgaWYgKCFjYikgewogICAgICBnZXR0ZXIoKTsKICAgIH0gZWxzZSBpZiAoaW1tZWRpYXRlKSB7CiAgICAgIGNhbGwoY2IsIFdBVENIRVJfQ0IsIFtnZXR0ZXIoKSwgaXNNdWx0aVNvdXJjZSA/IFtdIDogdW5kZWZpbmVkLCBvbkNsZWFudXBdKTsKICAgIH0KICAgIHJldHVybiBub29wOwogIH0KICB2YXIgd2F0Y2hlciA9IG5ldyBXYXRjaGVyKGN1cnJlbnRJbnN0YW5jZSwgZ2V0dGVyLCBub29wLCB7CiAgICBsYXp5OiB0cnVlCiAgfSk7CiAgd2F0Y2hlci5ub1JlY3Vyc2UgPSAhY2I7CiAgdmFyIG9sZFZhbHVlID0gaXNNdWx0aVNvdXJjZSA/IFtdIDogSU5JVElBTF9XQVRDSEVSX1ZBTFVFOwogIC8vIG92ZXJ3cml0ZSBkZWZhdWx0IHJ1bgogIHdhdGNoZXIucnVuID0gZnVuY3Rpb24gKCkgewogICAgaWYgKCF3YXRjaGVyLmFjdGl2ZSkgewogICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoY2IpIHsKICAgICAgLy8gd2F0Y2goc291cmNlLCBjYikKICAgICAgdmFyIG5ld1ZhbHVlID0gd2F0Y2hlci5nZXQoKTsKICAgICAgaWYgKGRlZXAgfHwgZm9yY2VUcmlnZ2VyIHx8IChpc011bHRpU291cmNlID8gbmV3VmFsdWUuc29tZShmdW5jdGlvbiAodiwgaSkgewogICAgICAgIHJldHVybiBoYXNDaGFuZ2VkKHYsIG9sZFZhbHVlW2ldKTsKICAgICAgfSkgOiBoYXNDaGFuZ2VkKG5ld1ZhbHVlLCBvbGRWYWx1ZSkpKSB7CiAgICAgICAgLy8gY2xlYW51cCBiZWZvcmUgcnVubmluZyBjYiBhZ2FpbgogICAgICAgIGlmIChjbGVhbnVwKSB7CiAgICAgICAgICBjbGVhbnVwKCk7CiAgICAgICAgfQogICAgICAgIGNhbGwoY2IsIFdBVENIRVJfQ0IsIFtuZXdWYWx1ZSwKICAgICAgICAvLyBwYXNzIHVuZGVmaW5lZCBhcyB0aGUgb2xkIHZhbHVlIHdoZW4gaXQncyBjaGFuZ2VkIGZvciB0aGUgZmlyc3QgdGltZQogICAgICAgIG9sZFZhbHVlID09PSBJTklUSUFMX1dBVENIRVJfVkFMVUUgPyB1bmRlZmluZWQgOiBvbGRWYWx1ZSwgb25DbGVhbnVwXSk7CiAgICAgICAgb2xkVmFsdWUgPSBuZXdWYWx1ZTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gd2F0Y2hFZmZlY3QKICAgICAgd2F0Y2hlci5nZXQoKTsKICAgIH0KICB9OwogIGlmIChmbHVzaCA9PT0gJ3N5bmMnKSB7CiAgICB3YXRjaGVyLnVwZGF0ZSA9IHdhdGNoZXIucnVuOwogIH0gZWxzZSBpZiAoZmx1c2ggPT09ICdwb3N0JykgewogICAgd2F0Y2hlci5wb3N0ID0gdHJ1ZTsKICAgIHdhdGNoZXIudXBkYXRlID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gcXVldWVXYXRjaGVyKHdhdGNoZXIpOwogICAgfTsKICB9IGVsc2UgewogICAgLy8gcHJlCiAgICB3YXRjaGVyLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKGluc3RhbmNlICYmIGluc3RhbmNlID09PSBjdXJyZW50SW5zdGFuY2UgJiYgIWluc3RhbmNlLl9pc01vdW50ZWQpIHsKICAgICAgICAvLyBwcmUtd2F0Y2hlciB0cmlnZ2VyZWQgYmVmb3JlCiAgICAgICAgdmFyIGJ1ZmZlciA9IGluc3RhbmNlLl9wcmVXYXRjaGVycyB8fCAoaW5zdGFuY2UuX3ByZVdhdGNoZXJzID0gW10pOwogICAgICAgIGlmIChidWZmZXIuaW5kZXhPZih3YXRjaGVyKSA8IDApIGJ1ZmZlci5wdXNoKHdhdGNoZXIpOwogICAgICB9IGVsc2UgewogICAgICAgIHF1ZXVlV2F0Y2hlcih3YXRjaGVyKTsKICAgICAgfQogICAgfTsKICB9CiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgIHdhdGNoZXIub25UcmFjayA9IG9uVHJhY2s7CiAgICB3YXRjaGVyLm9uVHJpZ2dlciA9IG9uVHJpZ2dlcjsKICB9CiAgLy8gaW5pdGlhbCBydW4KICBpZiAoY2IpIHsKICAgIGlmIChpbW1lZGlhdGUpIHsKICAgICAgd2F0Y2hlci5ydW4oKTsKICAgIH0gZWxzZSB7CiAgICAgIG9sZFZhbHVlID0gd2F0Y2hlci5nZXQoKTsKICAgIH0KICB9IGVsc2UgaWYgKGZsdXNoID09PSAncG9zdCcgJiYgaW5zdGFuY2UpIHsKICAgIGluc3RhbmNlLiRvbmNlKCdob29rOm1vdW50ZWQnLCBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB3YXRjaGVyLmdldCgpOwogICAgfSk7CiAgfSBlbHNlIHsKICAgIHdhdGNoZXIuZ2V0KCk7CiAgfQogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICB3YXRjaGVyLnRlYXJkb3duKCk7CiAgfTsKfQp2YXIgYWN0aXZlRWZmZWN0U2NvcGU7CnZhciBFZmZlY3RTY29wZSA9IC8qKiBAY2xhc3MgKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gRWZmZWN0U2NvcGUoZGV0YWNoZWQpIHsKICAgIGlmIChkZXRhY2hlZCA9PT0gdm9pZCAwKSB7CiAgICAgIGRldGFjaGVkID0gZmFsc2U7CiAgICB9CiAgICB0aGlzLmRldGFjaGVkID0gZGV0YWNoZWQ7CiAgICAvKioKICAgICAqIEBpbnRlcm5hbAogICAgICovCiAgICB0aGlzLmFjdGl2ZSA9IHRydWU7CiAgICAvKioKICAgICAqIEBpbnRlcm5hbAogICAgICovCiAgICB0aGlzLmVmZmVjdHMgPSBbXTsKICAgIC8qKgogICAgICogQGludGVybmFsCiAgICAgKi8KICAgIHRoaXMuY2xlYW51cHMgPSBbXTsKICAgIHRoaXMucGFyZW50ID0gYWN0aXZlRWZmZWN0U2NvcGU7CiAgICBpZiAoIWRldGFjaGVkICYmIGFjdGl2ZUVmZmVjdFNjb3BlKSB7CiAgICAgIHRoaXMuaW5kZXggPSAoYWN0aXZlRWZmZWN0U2NvcGUuc2NvcGVzIHx8IChhY3RpdmVFZmZlY3RTY29wZS5zY29wZXMgPSBbXSkpLnB1c2godGhpcykgLSAxOwogICAgfQogIH0KICBFZmZlY3RTY29wZS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKGZuKSB7CiAgICBpZiAodGhpcy5hY3RpdmUpIHsKICAgICAgdmFyIGN1cnJlbnRFZmZlY3RTY29wZSA9IGFjdGl2ZUVmZmVjdFNjb3BlOwogICAgICB0cnkgewogICAgICAgIGFjdGl2ZUVmZmVjdFNjb3BlID0gdGhpczsKICAgICAgICByZXR1cm4gZm4oKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBhY3RpdmVFZmZlY3RTY29wZSA9IGN1cnJlbnRFZmZlY3RTY29wZTsKICAgICAgfQogICAgfSBlbHNlIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICAgIHdhcm4oImNhbm5vdCBydW4gYW4gaW5hY3RpdmUgZWZmZWN0IHNjb3BlLiIpOwogICAgfQogIH07CiAgLyoqCiAgICogVGhpcyBzaG91bGQgb25seSBiZSBjYWxsZWQgb24gbm9uLWRldGFjaGVkIHNjb3BlcwogICAqIEBpbnRlcm5hbAogICAqLwogIEVmZmVjdFNjb3BlLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uICgpIHsKICAgIGFjdGl2ZUVmZmVjdFNjb3BlID0gdGhpczsKICB9OwogIC8qKgogICAqIFRoaXMgc2hvdWxkIG9ubHkgYmUgY2FsbGVkIG9uIG5vbi1kZXRhY2hlZCBzY29wZXMKICAgKiBAaW50ZXJuYWwKICAgKi8KICBFZmZlY3RTY29wZS5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24gKCkgewogICAgYWN0aXZlRWZmZWN0U2NvcGUgPSB0aGlzLnBhcmVudDsKICB9OwogIEVmZmVjdFNjb3BlLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24gKGZyb21QYXJlbnQpIHsKICAgIGlmICh0aGlzLmFjdGl2ZSkgewogICAgICB2YXIgaSA9IHZvaWQgMCwKICAgICAgICBsID0gdm9pZCAwOwogICAgICBmb3IgKGkgPSAwLCBsID0gdGhpcy5lZmZlY3RzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHRoaXMuZWZmZWN0c1tpXS50ZWFyZG93bigpOwogICAgICB9CiAgICAgIGZvciAoaSA9IDAsIGwgPSB0aGlzLmNsZWFudXBzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHRoaXMuY2xlYW51cHNbaV0oKTsKICAgICAgfQogICAgICBpZiAodGhpcy5zY29wZXMpIHsKICAgICAgICBmb3IgKGkgPSAwLCBsID0gdGhpcy5zY29wZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgICB0aGlzLnNjb3Blc1tpXS5zdG9wKHRydWUpOwogICAgICAgIH0KICAgICAgfQogICAgICAvLyBuZXN0ZWQgc2NvcGUsIGRlcmVmZXJlbmNlIGZyb20gcGFyZW50IHRvIGF2b2lkIG1lbW9yeSBsZWFrcwogICAgICBpZiAoIXRoaXMuZGV0YWNoZWQgJiYgdGhpcy5wYXJlbnQgJiYgIWZyb21QYXJlbnQpIHsKICAgICAgICAvLyBvcHRpbWl6ZWQgTygxKSByZW1vdmFsCiAgICAgICAgdmFyIGxhc3QgPSB0aGlzLnBhcmVudC5zY29wZXMucG9wKCk7CiAgICAgICAgaWYgKGxhc3QgJiYgbGFzdCAhPT0gdGhpcykgewogICAgICAgICAgdGhpcy5wYXJlbnQuc2NvcGVzW3RoaXMuaW5kZXhdID0gbGFzdDsKICAgICAgICAgIGxhc3QuaW5kZXggPSB0aGlzLmluZGV4OwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnBhcmVudCA9IHVuZGVmaW5lZDsKICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTsKICAgIH0KICB9OwogIHJldHVybiBFZmZlY3RTY29wZTsKfSgpOwpmdW5jdGlvbiBlZmZlY3RTY29wZShkZXRhY2hlZCkgewogIHJldHVybiBuZXcgRWZmZWN0U2NvcGUoZGV0YWNoZWQpOwp9Ci8qKgogKiBAaW50ZXJuYWwKICovCmZ1bmN0aW9uIHJlY29yZEVmZmVjdFNjb3BlKGVmZmVjdCwgc2NvcGUpIHsKICBpZiAoc2NvcGUgPT09IHZvaWQgMCkgewogICAgc2NvcGUgPSBhY3RpdmVFZmZlY3RTY29wZTsKICB9CiAgaWYgKHNjb3BlICYmIHNjb3BlLmFjdGl2ZSkgewogICAgc2NvcGUuZWZmZWN0cy5wdXNoKGVmZmVjdCk7CiAgfQp9CmZ1bmN0aW9uIGdldEN1cnJlbnRTY29wZSgpIHsKICByZXR1cm4gYWN0aXZlRWZmZWN0U2NvcGU7Cn0KZnVuY3Rpb24gb25TY29wZURpc3Bvc2UoZm4pIHsKICBpZiAoYWN0aXZlRWZmZWN0U2NvcGUpIHsKICAgIGFjdGl2ZUVmZmVjdFNjb3BlLmNsZWFudXBzLnB1c2goZm4pOwogIH0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgd2Fybigib25TY29wZURpc3Bvc2UoKSBpcyBjYWxsZWQgd2hlbiB0aGVyZSBpcyBubyBhY3RpdmUgZWZmZWN0IHNjb3BlIiArICIgdG8gYmUgYXNzb2NpYXRlZCB3aXRoLiIpOwogIH0KfQpmdW5jdGlvbiBwcm92aWRlKGtleSwgdmFsdWUpIHsKICBpZiAoIWN1cnJlbnRJbnN0YW5jZSkgewogICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgICAgd2FybigicHJvdmlkZSgpIGNhbiBvbmx5IGJlIHVzZWQgaW5zaWRlIHNldHVwKCkuIik7CiAgICB9CiAgfSBlbHNlIHsKICAgIC8vIFRTIGRvZXNuJ3QgYWxsb3cgc3ltYm9sIGFzIGluZGV4IHR5cGUKICAgIHJlc29sdmVQcm92aWRlZChjdXJyZW50SW5zdGFuY2UpW2tleV0gPSB2YWx1ZTsKICB9Cn0KZnVuY3Rpb24gcmVzb2x2ZVByb3ZpZGVkKHZtKSB7CiAgLy8gYnkgZGVmYXVsdCBhbiBpbnN0YW5jZSBpbmhlcml0cyBpdHMgcGFyZW50J3MgcHJvdmlkZXMgb2JqZWN0CiAgLy8gYnV0IHdoZW4gaXQgbmVlZHMgdG8gcHJvdmlkZSB2YWx1ZXMgb2YgaXRzIG93biwgaXQgY3JlYXRlcyBpdHMKICAvLyBvd24gcHJvdmlkZXMgb2JqZWN0IHVzaW5nIHBhcmVudCBwcm92aWRlcyBvYmplY3QgYXMgcHJvdG90eXBlLgogIC8vIHRoaXMgd2F5IGluIGBpbmplY3RgIHdlIGNhbiBzaW1wbHkgbG9vayB1cCBpbmplY3Rpb25zIGZyb20gZGlyZWN0CiAgLy8gcGFyZW50IGFuZCBsZXQgdGhlIHByb3RvdHlwZSBjaGFpbiBkbyB0aGUgd29yay4KICB2YXIgZXhpc3RpbmcgPSB2bS5fcHJvdmlkZWQ7CiAgdmFyIHBhcmVudFByb3ZpZGVzID0gdm0uJHBhcmVudCAmJiB2bS4kcGFyZW50Ll9wcm92aWRlZDsKICBpZiAocGFyZW50UHJvdmlkZXMgPT09IGV4aXN0aW5nKSB7CiAgICByZXR1cm4gdm0uX3Byb3ZpZGVkID0gT2JqZWN0LmNyZWF0ZShwYXJlbnRQcm92aWRlcyk7CiAgfSBlbHNlIHsKICAgIHJldHVybiBleGlzdGluZzsKICB9Cn0KZnVuY3Rpb24gaW5qZWN0KGtleSwgZGVmYXVsdFZhbHVlLCB0cmVhdERlZmF1bHRBc0ZhY3RvcnkpIHsKICBpZiAodHJlYXREZWZhdWx0QXNGYWN0b3J5ID09PSB2b2lkIDApIHsKICAgIHRyZWF0RGVmYXVsdEFzRmFjdG9yeSA9IGZhbHNlOwogIH0KICAvLyBmYWxsYmFjayB0byBgY3VycmVudFJlbmRlcmluZ0luc3RhbmNlYCBzbyB0aGF0IHRoaXMgY2FuIGJlIGNhbGxlZCBpbgogIC8vIGEgZnVuY3Rpb25hbCBjb21wb25lbnQKICB2YXIgaW5zdGFuY2UgPSBjdXJyZW50SW5zdGFuY2U7CiAgaWYgKGluc3RhbmNlKSB7CiAgICAvLyAjMjQwMAogICAgLy8gdG8gc3VwcG9ydCBgYXBwLnVzZWAgcGx1Z2lucywKICAgIC8vIGZhbGxiYWNrIHRvIGFwcENvbnRleHQncyBgcHJvdmlkZXNgIGlmIHRoZSBpbnN0YW5jZSBpcyBhdCByb290CiAgICB2YXIgcHJvdmlkZXMgPSBpbnN0YW5jZS4kcGFyZW50ICYmIGluc3RhbmNlLiRwYXJlbnQuX3Byb3ZpZGVkOwogICAgaWYgKHByb3ZpZGVzICYmIGtleSBpbiBwcm92aWRlcykgewogICAgICAvLyBUUyBkb2Vzbid0IGFsbG93IHN5bWJvbCBhcyBpbmRleCB0eXBlCiAgICAgIHJldHVybiBwcm92aWRlc1trZXldOwogICAgfSBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkgewogICAgICByZXR1cm4gdHJlYXREZWZhdWx0QXNGYWN0b3J5ICYmIGlzRnVuY3Rpb24oZGVmYXVsdFZhbHVlKSA/IGRlZmF1bHRWYWx1ZS5jYWxsKGluc3RhbmNlKSA6IGRlZmF1bHRWYWx1ZTsKICAgIH0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICB3YXJuKCJpbmplY3Rpb24gXCIiLmNvbmNhdChTdHJpbmcoa2V5KSwgIlwiIG5vdCBmb3VuZC4iKSk7CiAgICB9CiAgfSBlbHNlIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICB3YXJuKCJpbmplY3QoKSBjYW4gb25seSBiZSB1c2VkIGluc2lkZSBzZXR1cCgpIG9yIGZ1bmN0aW9uYWwgY29tcG9uZW50cy4iKTsKICB9Cn0KdmFyIG5vcm1hbGl6ZUV2ZW50ID0gY2FjaGVkKGZ1bmN0aW9uIChuYW1lKSB7CiAgdmFyIHBhc3NpdmUgPSBuYW1lLmNoYXJBdCgwKSA9PT0gJyYnOwogIG5hbWUgPSBwYXNzaXZlID8gbmFtZS5zbGljZSgxKSA6IG5hbWU7CiAgdmFyIG9uY2UgPSBuYW1lLmNoYXJBdCgwKSA9PT0gJ34nOyAvLyBQcmVmaXhlZCBsYXN0LCBjaGVja2VkIGZpcnN0CiAgbmFtZSA9IG9uY2UgPyBuYW1lLnNsaWNlKDEpIDogbmFtZTsKICB2YXIgY2FwdHVyZSA9IG5hbWUuY2hhckF0KDApID09PSAnISc7CiAgbmFtZSA9IGNhcHR1cmUgPyBuYW1lLnNsaWNlKDEpIDogbmFtZTsKICByZXR1cm4gewogICAgbmFtZTogbmFtZSwKICAgIG9uY2U6IG9uY2UsCiAgICBjYXB0dXJlOiBjYXB0dXJlLAogICAgcGFzc2l2ZTogcGFzc2l2ZQogIH07Cn0pOwpmdW5jdGlvbiBjcmVhdGVGbkludm9rZXIoZm5zLCB2bSkgewogIGZ1bmN0aW9uIGludm9rZXIoKSB7CiAgICB2YXIgZm5zID0gaW52b2tlci5mbnM7CiAgICBpZiAoaXNBcnJheShmbnMpKSB7CiAgICAgIHZhciBjbG9uZWQgPSBmbnMuc2xpY2UoKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjbG9uZWQubGVuZ3RoOyBpKyspIHsKICAgICAgICBpbnZva2VXaXRoRXJyb3JIYW5kbGluZyhjbG9uZWRbaV0sIG51bGwsIGFyZ3VtZW50cywgdm0sICJ2LW9uIGhhbmRsZXIiKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgLy8gcmV0dXJuIGhhbmRsZXIgcmV0dXJuIHZhbHVlIGZvciBzaW5nbGUgaGFuZGxlcnMKICAgICAgcmV0dXJuIGludm9rZVdpdGhFcnJvckhhbmRsaW5nKGZucywgbnVsbCwgYXJndW1lbnRzLCB2bSwgInYtb24gaGFuZGxlciIpOwogICAgfQogIH0KICBpbnZva2VyLmZucyA9IGZuczsKICByZXR1cm4gaW52b2tlcjsKfQpmdW5jdGlvbiB1cGRhdGVMaXN0ZW5lcnMob24sIG9sZE9uLCBhZGQsIHJlbW92ZSwgY3JlYXRlT25jZUhhbmRsZXIsIHZtKSB7CiAgdmFyIG5hbWUsIGN1ciwgb2xkLCBldmVudDsKICBmb3IgKG5hbWUgaW4gb24pIHsKICAgIGN1ciA9IG9uW25hbWVdOwogICAgb2xkID0gb2xkT25bbmFtZV07CiAgICBldmVudCA9IG5vcm1hbGl6ZUV2ZW50KG5hbWUpOwogICAgaWYgKGlzVW5kZWYoY3VyKSkgewogICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm4oIkludmFsaWQgaGFuZGxlciBmb3IgZXZlbnQgXCIiLmNvbmNhdChldmVudC5uYW1lLCAiXCI6IGdvdCAiKSArIFN0cmluZyhjdXIpLCB2bSk7CiAgICB9IGVsc2UgaWYgKGlzVW5kZWYob2xkKSkgewogICAgICBpZiAoaXNVbmRlZihjdXIuZm5zKSkgewogICAgICAgIGN1ciA9IG9uW25hbWVdID0gY3JlYXRlRm5JbnZva2VyKGN1ciwgdm0pOwogICAgICB9CiAgICAgIGlmIChpc1RydWUoZXZlbnQub25jZSkpIHsKICAgICAgICBjdXIgPSBvbltuYW1lXSA9IGNyZWF0ZU9uY2VIYW5kbGVyKGV2ZW50Lm5hbWUsIGN1ciwgZXZlbnQuY2FwdHVyZSk7CiAgICAgIH0KICAgICAgYWRkKGV2ZW50Lm5hbWUsIGN1ciwgZXZlbnQuY2FwdHVyZSwgZXZlbnQucGFzc2l2ZSwgZXZlbnQucGFyYW1zKTsKICAgIH0gZWxzZSBpZiAoY3VyICE9PSBvbGQpIHsKICAgICAgb2xkLmZucyA9IGN1cjsKICAgICAgb25bbmFtZV0gPSBvbGQ7CiAgICB9CiAgfQogIGZvciAobmFtZSBpbiBvbGRPbikgewogICAgaWYgKGlzVW5kZWYob25bbmFtZV0pKSB7CiAgICAgIGV2ZW50ID0gbm9ybWFsaXplRXZlbnQobmFtZSk7CiAgICAgIHJlbW92ZShldmVudC5uYW1lLCBvbGRPbltuYW1lXSwgZXZlbnQuY2FwdHVyZSk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIG1lcmdlVk5vZGVIb29rKGRlZiwgaG9va0tleSwgaG9vaykgewogIGlmIChkZWYgaW5zdGFuY2VvZiBWTm9kZSkgewogICAgZGVmID0gZGVmLmRhdGEuaG9vayB8fCAoZGVmLmRhdGEuaG9vayA9IHt9KTsKICB9CiAgdmFyIGludm9rZXI7CiAgdmFyIG9sZEhvb2sgPSBkZWZbaG9va0tleV07CiAgZnVuY3Rpb24gd3JhcHBlZEhvb2soKSB7CiAgICBob29rLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAvLyBpbXBvcnRhbnQ6IHJlbW92ZSBtZXJnZWQgaG9vayB0byBlbnN1cmUgaXQncyBjYWxsZWQgb25seSBvbmNlCiAgICAvLyBhbmQgcHJldmVudCBtZW1vcnkgbGVhawogICAgcmVtb3ZlJDIoaW52b2tlci5mbnMsIHdyYXBwZWRIb29rKTsKICB9CiAgaWYgKGlzVW5kZWYob2xkSG9vaykpIHsKICAgIC8vIG5vIGV4aXN0aW5nIGhvb2sKICAgIGludm9rZXIgPSBjcmVhdGVGbkludm9rZXIoW3dyYXBwZWRIb29rXSk7CiAgfSBlbHNlIHsKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgaWYgKGlzRGVmKG9sZEhvb2suZm5zKSAmJiBpc1RydWUob2xkSG9vay5tZXJnZWQpKSB7CiAgICAgIC8vIGFscmVhZHkgYSBtZXJnZWQgaW52b2tlcgogICAgICBpbnZva2VyID0gb2xkSG9vazsKICAgICAgaW52b2tlci5mbnMucHVzaCh3cmFwcGVkSG9vayk7CiAgICB9IGVsc2UgewogICAgICAvLyBleGlzdGluZyBwbGFpbiBob29rCiAgICAgIGludm9rZXIgPSBjcmVhdGVGbkludm9rZXIoW29sZEhvb2ssIHdyYXBwZWRIb29rXSk7CiAgICB9CiAgfQogIGludm9rZXIubWVyZ2VkID0gdHJ1ZTsKICBkZWZbaG9va0tleV0gPSBpbnZva2VyOwp9CmZ1bmN0aW9uIGV4dHJhY3RQcm9wc0Zyb21WTm9kZURhdGEoZGF0YSwgQ3RvciwgdGFnKSB7CiAgLy8gd2UgYXJlIG9ubHkgZXh0cmFjdGluZyByYXcgdmFsdWVzIGhlcmUuCiAgLy8gdmFsaWRhdGlvbiBhbmQgZGVmYXVsdCB2YWx1ZXMgYXJlIGhhbmRsZWQgaW4gdGhlIGNoaWxkCiAgLy8gY29tcG9uZW50IGl0c2VsZi4KICB2YXIgcHJvcE9wdGlvbnMgPSBDdG9yLm9wdGlvbnMucHJvcHM7CiAgaWYgKGlzVW5kZWYocHJvcE9wdGlvbnMpKSB7CiAgICByZXR1cm47CiAgfQogIHZhciByZXMgPSB7fTsKICB2YXIgYXR0cnMgPSBkYXRhLmF0dHJzLAogICAgcHJvcHMgPSBkYXRhLnByb3BzOwogIGlmIChpc0RlZihhdHRycykgfHwgaXNEZWYocHJvcHMpKSB7CiAgICBmb3IgKHZhciBrZXkgaW4gcHJvcE9wdGlvbnMpIHsKICAgICAgdmFyIGFsdEtleSA9IGh5cGhlbmF0ZShrZXkpOwogICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICAgIHZhciBrZXlJbkxvd2VyQ2FzZSA9IGtleS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGlmIChrZXkgIT09IGtleUluTG93ZXJDYXNlICYmIGF0dHJzICYmIGhhc093bihhdHRycywga2V5SW5Mb3dlckNhc2UpKSB7CiAgICAgICAgICB0aXAoIlByb3AgXCIiLmNvbmNhdChrZXlJbkxvd2VyQ2FzZSwgIlwiIGlzIHBhc3NlZCB0byBjb21wb25lbnQgIikgKyAiIi5jb25jYXQoZm9ybWF0Q29tcG9uZW50TmFtZSgKICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgdGFnIGlzIHN0cmluZwogICAgICAgICAgdGFnIHx8IEN0b3IpLCAiLCBidXQgdGhlIGRlY2xhcmVkIHByb3AgbmFtZSBpcyIpICsgIiBcIiIuY29uY2F0KGtleSwgIlwiLiAiKSArICJOb3RlIHRoYXQgSFRNTCBhdHRyaWJ1dGVzIGFyZSBjYXNlLWluc2Vuc2l0aXZlIGFuZCBjYW1lbENhc2VkICIgKyAicHJvcHMgbmVlZCB0byB1c2UgdGhlaXIga2ViYWItY2FzZSBlcXVpdmFsZW50cyB3aGVuIHVzaW5nIGluLURPTSAiICsgInRlbXBsYXRlcy4gWW91IHNob3VsZCBwcm9iYWJseSB1c2UgXCIiLmNvbmNhdChhbHRLZXksICJcIiBpbnN0ZWFkIG9mIFwiIikuY29uY2F0KGtleSwgIlwiLiIpKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY2hlY2tQcm9wKHJlcywgcHJvcHMsIGtleSwgYWx0S2V5LCB0cnVlKSB8fCBjaGVja1Byb3AocmVzLCBhdHRycywga2V5LCBhbHRLZXksIGZhbHNlKTsKICAgIH0KICB9CiAgcmV0dXJuIHJlczsKfQpmdW5jdGlvbiBjaGVja1Byb3AocmVzLCBoYXNoLCBrZXksIGFsdEtleSwgcHJlc2VydmUpIHsKICBpZiAoaXNEZWYoaGFzaCkpIHsKICAgIGlmIChoYXNPd24oaGFzaCwga2V5KSkgewogICAgICByZXNba2V5XSA9IGhhc2hba2V5XTsKICAgICAgaWYgKCFwcmVzZXJ2ZSkgewogICAgICAgIGRlbGV0ZSBoYXNoW2tleV07CiAgICAgIH0KICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgaWYgKGhhc093bihoYXNoLCBhbHRLZXkpKSB7CiAgICAgIHJlc1trZXldID0gaGFzaFthbHRLZXldOwogICAgICBpZiAoIXByZXNlcnZlKSB7CiAgICAgICAgZGVsZXRlIGhhc2hbYWx0S2V5XTsKICAgICAgfQogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9CiAgcmV0dXJuIGZhbHNlOwp9CgovLyBUaGUgdGVtcGxhdGUgY29tcGlsZXIgYXR0ZW1wdHMgdG8gbWluaW1pemUgdGhlIG5lZWQgZm9yIG5vcm1hbGl6YXRpb24gYnkKLy8gc3RhdGljYWxseSBhbmFseXppbmcgdGhlIHRlbXBsYXRlIGF0IGNvbXBpbGUgdGltZS4KLy8KLy8gRm9yIHBsYWluIEhUTUwgbWFya3VwLCBub3JtYWxpemF0aW9uIGNhbiBiZSBjb21wbGV0ZWx5IHNraXBwZWQgYmVjYXVzZSB0aGUKLy8gZ2VuZXJhdGVkIHJlbmRlciBmdW5jdGlvbiBpcyBndWFyYW50ZWVkIHRvIHJldHVybiBBcnJheTxWTm9kZT4uIFRoZXJlIGFyZQovLyB0d28gY2FzZXMgd2hlcmUgZXh0cmEgbm9ybWFsaXphdGlvbiBpcyBuZWVkZWQ6Ci8vIDEuIFdoZW4gdGhlIGNoaWxkcmVuIGNvbnRhaW5zIGNvbXBvbmVudHMgLSBiZWNhdXNlIGEgZnVuY3Rpb25hbCBjb21wb25lbnQKLy8gbWF5IHJldHVybiBhbiBBcnJheSBpbnN0ZWFkIG9mIGEgc2luZ2xlIHJvb3QuIEluIHRoaXMgY2FzZSwganVzdCBhIHNpbXBsZQovLyBub3JtYWxpemF0aW9uIGlzIG5lZWRlZCAtIGlmIGFueSBjaGlsZCBpcyBhbiBBcnJheSwgd2UgZmxhdHRlbiB0aGUgd2hvbGUKLy8gdGhpbmcgd2l0aCBBcnJheS5wcm90b3R5cGUuY29uY2F0LiBJdCBpcyBndWFyYW50ZWVkIHRvIGJlIG9ubHkgMS1sZXZlbCBkZWVwCi8vIGJlY2F1c2UgZnVuY3Rpb25hbCBjb21wb25lbnRzIGFscmVhZHkgbm9ybWFsaXplIHRoZWlyIG93biBjaGlsZHJlbi4KZnVuY3Rpb24gc2ltcGxlTm9ybWFsaXplQ2hpbGRyZW4oY2hpbGRyZW4pIHsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7CiAgICBpZiAoaXNBcnJheShjaGlsZHJlbltpXSkpIHsKICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoW10sIGNoaWxkcmVuKTsKICAgIH0KICB9CiAgcmV0dXJuIGNoaWxkcmVuOwp9Ci8vIDIuIFdoZW4gdGhlIGNoaWxkcmVuIGNvbnRhaW5zIGNvbnN0cnVjdHMgdGhhdCBhbHdheXMgZ2VuZXJhdGVkIG5lc3RlZCBBcnJheXMsCi8vIGUuZy4gPHRlbXBsYXRlPiwgPHNsb3Q+LCB2LWZvciwgb3Igd2hlbiB0aGUgY2hpbGRyZW4gaXMgcHJvdmlkZWQgYnkgdXNlcgovLyB3aXRoIGhhbmQtd3JpdHRlbiByZW5kZXIgZnVuY3Rpb25zIC8gSlNYLiBJbiBzdWNoIGNhc2VzIGEgZnVsbCBub3JtYWxpemF0aW9uCi8vIGlzIG5lZWRlZCB0byBjYXRlciB0byBhbGwgcG9zc2libGUgdHlwZXMgb2YgY2hpbGRyZW4gdmFsdWVzLgpmdW5jdGlvbiBub3JtYWxpemVDaGlsZHJlbihjaGlsZHJlbikgewogIHJldHVybiBpc1ByaW1pdGl2ZShjaGlsZHJlbikgPyBbY3JlYXRlVGV4dFZOb2RlKGNoaWxkcmVuKV0gOiBpc0FycmF5KGNoaWxkcmVuKSA/IG5vcm1hbGl6ZUFycmF5Q2hpbGRyZW4oY2hpbGRyZW4pIDogdW5kZWZpbmVkOwp9CmZ1bmN0aW9uIGlzVGV4dE5vZGUobm9kZSkgewogIHJldHVybiBpc0RlZihub2RlKSAmJiBpc0RlZihub2RlLnRleHQpICYmIGlzRmFsc2Uobm9kZS5pc0NvbW1lbnQpOwp9CmZ1bmN0aW9uIG5vcm1hbGl6ZUFycmF5Q2hpbGRyZW4oY2hpbGRyZW4sIG5lc3RlZEluZGV4KSB7CiAgdmFyIHJlcyA9IFtdOwogIHZhciBpLCBjLCBsYXN0SW5kZXgsIGxhc3Q7CiAgZm9yIChpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7CiAgICBjID0gY2hpbGRyZW5baV07CiAgICBpZiAoaXNVbmRlZihjKSB8fCB0eXBlb2YgYyA9PT0gJ2Jvb2xlYW4nKSBjb250aW51ZTsKICAgIGxhc3RJbmRleCA9IHJlcy5sZW5ndGggLSAxOwogICAgbGFzdCA9IHJlc1tsYXN0SW5kZXhdOwogICAgLy8gIG5lc3RlZAogICAgaWYgKGlzQXJyYXkoYykpIHsKICAgICAgaWYgKGMubGVuZ3RoID4gMCkgewogICAgICAgIGMgPSBub3JtYWxpemVBcnJheUNoaWxkcmVuKGMsICIiLmNvbmNhdChuZXN0ZWRJbmRleCB8fCAnJywgIl8iKS5jb25jYXQoaSkpOwogICAgICAgIC8vIG1lcmdlIGFkamFjZW50IHRleHQgbm9kZXMKICAgICAgICBpZiAoaXNUZXh0Tm9kZShjWzBdKSAmJiBpc1RleHROb2RlKGxhc3QpKSB7CiAgICAgICAgICByZXNbbGFzdEluZGV4XSA9IGNyZWF0ZVRleHRWTm9kZShsYXN0LnRleHQgKyBjWzBdLnRleHQpOwogICAgICAgICAgYy5zaGlmdCgpOwogICAgICAgIH0KICAgICAgICByZXMucHVzaC5hcHBseShyZXMsIGMpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGlzUHJpbWl0aXZlKGMpKSB7CiAgICAgIGlmIChpc1RleHROb2RlKGxhc3QpKSB7CiAgICAgICAgLy8gbWVyZ2UgYWRqYWNlbnQgdGV4dCBub2RlcwogICAgICAgIC8vIHRoaXMgaXMgbmVjZXNzYXJ5IGZvciBTU1IgaHlkcmF0aW9uIGJlY2F1c2UgdGV4dCBub2RlcyBhcmUKICAgICAgICAvLyBlc3NlbnRpYWxseSBtZXJnZWQgd2hlbiByZW5kZXJlZCB0byBIVE1MIHN0cmluZ3MKICAgICAgICByZXNbbGFzdEluZGV4XSA9IGNyZWF0ZVRleHRWTm9kZShsYXN0LnRleHQgKyBjKTsKICAgICAgfSBlbHNlIGlmIChjICE9PSAnJykgewogICAgICAgIC8vIGNvbnZlcnQgcHJpbWl0aXZlIHRvIHZub2RlCiAgICAgICAgcmVzLnB1c2goY3JlYXRlVGV4dFZOb2RlKGMpKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKGlzVGV4dE5vZGUoYykgJiYgaXNUZXh0Tm9kZShsYXN0KSkgewogICAgICAgIC8vIG1lcmdlIGFkamFjZW50IHRleHQgbm9kZXMKICAgICAgICByZXNbbGFzdEluZGV4XSA9IGNyZWF0ZVRleHRWTm9kZShsYXN0LnRleHQgKyBjLnRleHQpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIGRlZmF1bHQga2V5IGZvciBuZXN0ZWQgYXJyYXkgY2hpbGRyZW4gKGxpa2VseSBnZW5lcmF0ZWQgYnkgdi1mb3IpCiAgICAgICAgaWYgKGlzVHJ1ZShjaGlsZHJlbi5faXNWTGlzdCkgJiYgaXNEZWYoYy50YWcpICYmIGlzVW5kZWYoYy5rZXkpICYmIGlzRGVmKG5lc3RlZEluZGV4KSkgewogICAgICAgICAgYy5rZXkgPSAiX192bGlzdCIuY29uY2F0KG5lc3RlZEluZGV4LCAiXyIpLmNvbmNhdChpLCAiX18iKTsKICAgICAgICB9CiAgICAgICAgcmVzLnB1c2goYyk7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIHJlczsKfQoKLyoqCiAqIFJ1bnRpbWUgaGVscGVyIGZvciByZW5kZXJpbmcgdi1mb3IgbGlzdHMuCiAqLwpmdW5jdGlvbiByZW5kZXJMaXN0KHZhbCwgcmVuZGVyKSB7CiAgdmFyIHJldCA9IG51bGwsCiAgICBpLAogICAgbCwKICAgIGtleXMsCiAgICBrZXk7CiAgaWYgKGlzQXJyYXkodmFsKSB8fCB0eXBlb2YgdmFsID09PSAnc3RyaW5nJykgewogICAgcmV0ID0gbmV3IEFycmF5KHZhbC5sZW5ndGgpOwogICAgZm9yIChpID0gMCwgbCA9IHZhbC5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgcmV0W2ldID0gcmVuZGVyKHZhbFtpXSwgaSk7CiAgICB9CiAgfSBlbHNlIGlmICh0eXBlb2YgdmFsID09PSAnbnVtYmVyJykgewogICAgcmV0ID0gbmV3IEFycmF5KHZhbCk7CiAgICBmb3IgKGkgPSAwOyBpIDwgdmFsOyBpKyspIHsKICAgICAgcmV0W2ldID0gcmVuZGVyKGkgKyAxLCBpKTsKICAgIH0KICB9IGVsc2UgaWYgKGlzT2JqZWN0KHZhbCkpIHsKICAgIGlmIChoYXNTeW1ib2wgJiYgdmFsW1N5bWJvbC5pdGVyYXRvcl0pIHsKICAgICAgcmV0ID0gW107CiAgICAgIHZhciBpdGVyYXRvciA9IHZhbFtTeW1ib2wuaXRlcmF0b3JdKCk7CiAgICAgIHZhciByZXN1bHQgPSBpdGVyYXRvci5uZXh0KCk7CiAgICAgIHdoaWxlICghcmVzdWx0LmRvbmUpIHsKICAgICAgICByZXQucHVzaChyZW5kZXIocmVzdWx0LnZhbHVlLCByZXQubGVuZ3RoKSk7CiAgICAgICAgcmVzdWx0ID0gaXRlcmF0b3IubmV4dCgpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBrZXlzID0gT2JqZWN0LmtleXModmFsKTsKICAgICAgcmV0ID0gbmV3IEFycmF5KGtleXMubGVuZ3RoKTsKICAgICAgZm9yIChpID0gMCwgbCA9IGtleXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAga2V5ID0ga2V5c1tpXTsKICAgICAgICByZXRbaV0gPSByZW5kZXIodmFsW2tleV0sIGtleSwgaSk7CiAgICAgIH0KICAgIH0KICB9CiAgaWYgKCFpc0RlZihyZXQpKSB7CiAgICByZXQgPSBbXTsKICB9CiAgcmV0Ll9pc1ZMaXN0ID0gdHJ1ZTsKICByZXR1cm4gcmV0Owp9CgovKioKICogUnVudGltZSBoZWxwZXIgZm9yIHJlbmRlcmluZyA8c2xvdD4KICovCmZ1bmN0aW9uIHJlbmRlclNsb3QobmFtZSwgZmFsbGJhY2tSZW5kZXIsIHByb3BzLCBiaW5kT2JqZWN0KSB7CiAgdmFyIHNjb3BlZFNsb3RGbiA9IHRoaXMuJHNjb3BlZFNsb3RzW25hbWVdOwogIHZhciBub2RlczsKICBpZiAoc2NvcGVkU2xvdEZuKSB7CiAgICAvLyBzY29wZWQgc2xvdAogICAgcHJvcHMgPSBwcm9wcyB8fCB7fTsKICAgIGlmIChiaW5kT2JqZWN0KSB7CiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmICFpc09iamVjdChiaW5kT2JqZWN0KSkgewogICAgICAgIHdhcm4oJ3Nsb3Qgdi1iaW5kIHdpdGhvdXQgYXJndW1lbnQgZXhwZWN0cyBhbiBPYmplY3QnLCB0aGlzKTsKICAgICAgfQogICAgICBwcm9wcyA9IGV4dGVuZChleHRlbmQoe30sIGJpbmRPYmplY3QpLCBwcm9wcyk7CiAgICB9CiAgICBub2RlcyA9IHNjb3BlZFNsb3RGbihwcm9wcykgfHwgKGlzRnVuY3Rpb24oZmFsbGJhY2tSZW5kZXIpID8gZmFsbGJhY2tSZW5kZXIoKSA6IGZhbGxiYWNrUmVuZGVyKTsKICB9IGVsc2UgewogICAgbm9kZXMgPSB0aGlzLiRzbG90c1tuYW1lXSB8fCAoaXNGdW5jdGlvbihmYWxsYmFja1JlbmRlcikgPyBmYWxsYmFja1JlbmRlcigpIDogZmFsbGJhY2tSZW5kZXIpOwogIH0KICB2YXIgdGFyZ2V0ID0gcHJvcHMgJiYgcHJvcHMuc2xvdDsKICBpZiAodGFyZ2V0KSB7CiAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudCgndGVtcGxhdGUnLCB7CiAgICAgIHNsb3Q6IHRhcmdldAogICAgfSwgbm9kZXMpOwogIH0gZWxzZSB7CiAgICByZXR1cm4gbm9kZXM7CiAgfQp9CgovKioKICogUnVudGltZSBoZWxwZXIgZm9yIHJlc29sdmluZyBmaWx0ZXJzCiAqLwpmdW5jdGlvbiByZXNvbHZlRmlsdGVyKGlkKSB7CiAgcmV0dXJuIHJlc29sdmVBc3NldCh0aGlzLiRvcHRpb25zLCAnZmlsdGVycycsIGlkLCB0cnVlKSB8fCBpZGVudGl0eTsKfQpmdW5jdGlvbiBpc0tleU5vdE1hdGNoKGV4cGVjdCwgYWN0dWFsKSB7CiAgaWYgKGlzQXJyYXkoZXhwZWN0KSkgewogICAgcmV0dXJuIGV4cGVjdC5pbmRleE9mKGFjdHVhbCkgPT09IC0xOwogIH0gZWxzZSB7CiAgICByZXR1cm4gZXhwZWN0ICE9PSBhY3R1YWw7CiAgfQp9Ci8qKgogKiBSdW50aW1lIGhlbHBlciBmb3IgY2hlY2tpbmcga2V5Q29kZXMgZnJvbSBjb25maWcuCiAqIGV4cG9zZWQgYXMgVnVlLnByb3RvdHlwZS5fawogKiBwYXNzaW5nIGluIGV2ZW50S2V5TmFtZSBhcyBsYXN0IGFyZ3VtZW50IHNlcGFyYXRlbHkgZm9yIGJhY2t3YXJkcyBjb21wYXQKICovCmZ1bmN0aW9uIGNoZWNrS2V5Q29kZXMoZXZlbnRLZXlDb2RlLCBrZXksIGJ1aWx0SW5LZXlDb2RlLCBldmVudEtleU5hbWUsIGJ1aWx0SW5LZXlOYW1lKSB7CiAgdmFyIG1hcHBlZEtleUNvZGUgPSBjb25maWcua2V5Q29kZXNba2V5XSB8fCBidWlsdEluS2V5Q29kZTsKICBpZiAoYnVpbHRJbktleU5hbWUgJiYgZXZlbnRLZXlOYW1lICYmICFjb25maWcua2V5Q29kZXNba2V5XSkgewogICAgcmV0dXJuIGlzS2V5Tm90TWF0Y2goYnVpbHRJbktleU5hbWUsIGV2ZW50S2V5TmFtZSk7CiAgfSBlbHNlIGlmIChtYXBwZWRLZXlDb2RlKSB7CiAgICByZXR1cm4gaXNLZXlOb3RNYXRjaChtYXBwZWRLZXlDb2RlLCBldmVudEtleUNvZGUpOwogIH0gZWxzZSBpZiAoZXZlbnRLZXlOYW1lKSB7CiAgICByZXR1cm4gaHlwaGVuYXRlKGV2ZW50S2V5TmFtZSkgIT09IGtleTsKICB9CiAgcmV0dXJuIGV2ZW50S2V5Q29kZSA9PT0gdW5kZWZpbmVkOwp9CgovKioKICogUnVudGltZSBoZWxwZXIgZm9yIG1lcmdpbmcgdi1iaW5kPSJvYmplY3QiIGludG8gYSBWTm9kZSdzIGRhdGEuCiAqLwpmdW5jdGlvbiBiaW5kT2JqZWN0UHJvcHMoZGF0YSwgdGFnLCB2YWx1ZSwgYXNQcm9wLCBpc1N5bmMpIHsKICBpZiAodmFsdWUpIHsKICAgIGlmICghaXNPYmplY3QodmFsdWUpKSB7CiAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgd2Fybigndi1iaW5kIHdpdGhvdXQgYXJndW1lbnQgZXhwZWN0cyBhbiBPYmplY3Qgb3IgQXJyYXkgdmFsdWUnLCB0aGlzKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChpc0FycmF5KHZhbHVlKSkgewogICAgICAgIHZhbHVlID0gdG9PYmplY3QodmFsdWUpOwogICAgICB9CiAgICAgIHZhciBoYXNoID0gdm9pZCAwOwogICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBpZiAoa2V5ID09PSAnY2xhc3MnIHx8IGtleSA9PT0gJ3N0eWxlJyB8fCBpc1Jlc2VydmVkQXR0cmlidXRlKGtleSkpIHsKICAgICAgICAgIGhhc2ggPSBkYXRhOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIgdHlwZSA9IGRhdGEuYXR0cnMgJiYgZGF0YS5hdHRycy50eXBlOwogICAgICAgICAgaGFzaCA9IGFzUHJvcCB8fCBjb25maWcubXVzdFVzZVByb3AodGFnLCB0eXBlLCBrZXkpID8gZGF0YS5kb21Qcm9wcyB8fCAoZGF0YS5kb21Qcm9wcyA9IHt9KSA6IGRhdGEuYXR0cnMgfHwgKGRhdGEuYXR0cnMgPSB7fSk7CiAgICAgICAgfQogICAgICAgIHZhciBjYW1lbGl6ZWRLZXkgPSBjYW1lbGl6ZShrZXkpOwogICAgICAgIHZhciBoeXBoZW5hdGVkS2V5ID0gaHlwaGVuYXRlKGtleSk7CiAgICAgICAgaWYgKCEoY2FtZWxpemVkS2V5IGluIGhhc2gpICYmICEoaHlwaGVuYXRlZEtleSBpbiBoYXNoKSkgewogICAgICAgICAgaGFzaFtrZXldID0gdmFsdWVba2V5XTsKICAgICAgICAgIGlmIChpc1N5bmMpIHsKICAgICAgICAgICAgdmFyIG9uID0gZGF0YS5vbiB8fCAoZGF0YS5vbiA9IHt9KTsKICAgICAgICAgICAgb25bInVwZGF0ZToiLmNvbmNhdChrZXkpXSA9IGZ1bmN0aW9uICgkZXZlbnQpIHsKICAgICAgICAgICAgICB2YWx1ZVtrZXldID0gJGV2ZW50OwogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKICAgICAgZm9yICh2YXIga2V5IGluIHZhbHVlKSB7CiAgICAgICAgX2xvb3BfMShrZXkpOwogICAgICB9CiAgICB9CiAgfQogIHJldHVybiBkYXRhOwp9CgovKioKICogUnVudGltZSBoZWxwZXIgZm9yIHJlbmRlcmluZyBzdGF0aWMgdHJlZXMuCiAqLwpmdW5jdGlvbiByZW5kZXJTdGF0aWMoaW5kZXgsIGlzSW5Gb3IpIHsKICB2YXIgY2FjaGVkID0gdGhpcy5fc3RhdGljVHJlZXMgfHwgKHRoaXMuX3N0YXRpY1RyZWVzID0gW10pOwogIHZhciB0cmVlID0gY2FjaGVkW2luZGV4XTsKICAvLyBpZiBoYXMgYWxyZWFkeS1yZW5kZXJlZCBzdGF0aWMgdHJlZSBhbmQgbm90IGluc2lkZSB2LWZvciwKICAvLyB3ZSBjYW4gcmV1c2UgdGhlIHNhbWUgdHJlZS4KICBpZiAodHJlZSAmJiAhaXNJbkZvcikgewogICAgcmV0dXJuIHRyZWU7CiAgfQogIC8vIG90aGVyd2lzZSwgcmVuZGVyIGEgZnJlc2ggdHJlZS4KICB0cmVlID0gY2FjaGVkW2luZGV4XSA9IHRoaXMuJG9wdGlvbnMuc3RhdGljUmVuZGVyRm5zW2luZGV4XS5jYWxsKHRoaXMuX3JlbmRlclByb3h5LCB0aGlzLl9jLCB0aGlzIC8vIGZvciByZW5kZXIgZm5zIGdlbmVyYXRlZCBmb3IgZnVuY3Rpb25hbCBjb21wb25lbnQgdGVtcGxhdGVzCiAgKTsKICBtYXJrU3RhdGljKHRyZWUsICJfX3N0YXRpY19fIi5jb25jYXQoaW5kZXgpLCBmYWxzZSk7CiAgcmV0dXJuIHRyZWU7Cn0KLyoqCiAqIFJ1bnRpbWUgaGVscGVyIGZvciB2LW9uY2UuCiAqIEVmZmVjdGl2ZWx5IGl0IG1lYW5zIG1hcmtpbmcgdGhlIG5vZGUgYXMgc3RhdGljIHdpdGggYSB1bmlxdWUga2V5LgogKi8KZnVuY3Rpb24gbWFya09uY2UodHJlZSwgaW5kZXgsIGtleSkgewogIG1hcmtTdGF0aWModHJlZSwgIl9fb25jZV9fIi5jb25jYXQoaW5kZXgpLmNvbmNhdChrZXkgPyAiXyIuY29uY2F0KGtleSkgOiAiIiksIHRydWUpOwogIHJldHVybiB0cmVlOwp9CmZ1bmN0aW9uIG1hcmtTdGF0aWModHJlZSwga2V5LCBpc09uY2UpIHsKICBpZiAoaXNBcnJheSh0cmVlKSkgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0cmVlLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmICh0cmVlW2ldICYmIHR5cGVvZiB0cmVlW2ldICE9PSAnc3RyaW5nJykgewogICAgICAgIG1hcmtTdGF0aWNOb2RlKHRyZWVbaV0sICIiLmNvbmNhdChrZXksICJfIikuY29uY2F0KGkpLCBpc09uY2UpOwogICAgICB9CiAgICB9CiAgfSBlbHNlIHsKICAgIG1hcmtTdGF0aWNOb2RlKHRyZWUsIGtleSwgaXNPbmNlKTsKICB9Cn0KZnVuY3Rpb24gbWFya1N0YXRpY05vZGUobm9kZSwga2V5LCBpc09uY2UpIHsKICBub2RlLmlzU3RhdGljID0gdHJ1ZTsKICBub2RlLmtleSA9IGtleTsKICBub2RlLmlzT25jZSA9IGlzT25jZTsKfQpmdW5jdGlvbiBiaW5kT2JqZWN0TGlzdGVuZXJzKGRhdGEsIHZhbHVlKSB7CiAgaWYgKHZhbHVlKSB7CiAgICBpZiAoIWlzUGxhaW5PYmplY3QodmFsdWUpKSB7CiAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgd2Fybigndi1vbiB3aXRob3V0IGFyZ3VtZW50IGV4cGVjdHMgYW4gT2JqZWN0IHZhbHVlJywgdGhpcyk7CiAgICB9IGVsc2UgewogICAgICB2YXIgb24gPSBkYXRhLm9uID0gZGF0YS5vbiA/IGV4dGVuZCh7fSwgZGF0YS5vbikgOiB7fTsKICAgICAgZm9yICh2YXIga2V5IGluIHZhbHVlKSB7CiAgICAgICAgdmFyIGV4aXN0aW5nID0gb25ba2V5XTsKICAgICAgICB2YXIgb3VycyA9IHZhbHVlW2tleV07CiAgICAgICAgb25ba2V5XSA9IGV4aXN0aW5nID8gW10uY29uY2F0KGV4aXN0aW5nLCBvdXJzKSA6IG91cnM7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIGRhdGE7Cn0KZnVuY3Rpb24gcmVzb2x2ZVNjb3BlZFNsb3RzKGZucywgcmVzLAovLyB0aGUgZm9sbG93aW5nIGFyZSBhZGRlZCBpbiAyLjYKaGFzRHluYW1pY0tleXMsIGNvbnRlbnRIYXNoS2V5KSB7CiAgcmVzID0gcmVzIHx8IHsKICAgICRzdGFibGU6ICFoYXNEeW5hbWljS2V5cwogIH07CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBmbnMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzbG90ID0gZm5zW2ldOwogICAgaWYgKGlzQXJyYXkoc2xvdCkpIHsKICAgICAgcmVzb2x2ZVNjb3BlZFNsb3RzKHNsb3QsIHJlcywgaGFzRHluYW1pY0tleXMpOwogICAgfSBlbHNlIGlmIChzbG90KSB7CiAgICAgIC8vIG1hcmtlciBmb3IgcmV2ZXJzZSBwcm94eWluZyB2LXNsb3Qgd2l0aG91dCBzY29wZSBvbiB0aGlzLiRzbG90cwogICAgICAvLyBAdHMtZXhwZWN0LWVycm9yCiAgICAgIGlmIChzbG90LnByb3h5KSB7CiAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvcgogICAgICAgIHNsb3QuZm4ucHJveHkgPSB0cnVlOwogICAgICB9CiAgICAgIHJlc1tzbG90LmtleV0gPSBzbG90LmZuOwogICAgfQogIH0KICBpZiAoY29udGVudEhhc2hLZXkpIHsKICAgIHJlcy4ka2V5ID0gY29udGVudEhhc2hLZXk7CiAgfQogIHJldHVybiByZXM7Cn0KCi8vIGhlbHBlciB0byBwcm9jZXNzIGR5bmFtaWMga2V5cyBmb3IgZHluYW1pYyBhcmd1bWVudHMgaW4gdi1iaW5kIGFuZCB2LW9uLgpmdW5jdGlvbiBiaW5kRHluYW1pY0tleXMoYmFzZU9iaiwgdmFsdWVzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZXMubGVuZ3RoOyBpICs9IDIpIHsKICAgIHZhciBrZXkgPSB2YWx1ZXNbaV07CiAgICBpZiAodHlwZW9mIGtleSA9PT0gJ3N0cmluZycgJiYga2V5KSB7CiAgICAgIGJhc2VPYmpbdmFsdWVzW2ldXSA9IHZhbHVlc1tpICsgMV07CiAgICB9IGVsc2UgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYga2V5ICE9PSAnJyAmJiBrZXkgIT09IG51bGwpIHsKICAgICAgLy8gbnVsbCBpcyBhIHNwZWNpYWwgdmFsdWUgZm9yIGV4cGxpY2l0bHkgcmVtb3ZpbmcgYSBiaW5kaW5nCiAgICAgIHdhcm4oIkludmFsaWQgdmFsdWUgZm9yIGR5bmFtaWMgZGlyZWN0aXZlIGFyZ3VtZW50IChleHBlY3RlZCBzdHJpbmcgb3IgbnVsbCk6ICIuY29uY2F0KGtleSksIHRoaXMpOwogICAgfQogIH0KICByZXR1cm4gYmFzZU9iajsKfQovLyBoZWxwZXIgdG8gZHluYW1pY2FsbHkgYXBwZW5kIG1vZGlmaWVyIHJ1bnRpbWUgbWFya2VycyB0byBldmVudCBuYW1lcy4KLy8gZW5zdXJlIG9ubHkgYXBwZW5kIHdoZW4gdmFsdWUgaXMgYWxyZWFkeSBzdHJpbmcsIG90aGVyd2lzZSBpdCB3aWxsIGJlIGNhc3QKLy8gdG8gc3RyaW5nIGFuZCBjYXVzZSB0aGUgdHlwZSBjaGVjayB0byBtaXNzLgpmdW5jdGlvbiBwcmVwZW5kTW9kaWZpZXIodmFsdWUsIHN5bWJvbCkgewogIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnID8gc3ltYm9sICsgdmFsdWUgOiB2YWx1ZTsKfQpmdW5jdGlvbiBpbnN0YWxsUmVuZGVySGVscGVycyh0YXJnZXQpIHsKICB0YXJnZXQuX28gPSBtYXJrT25jZTsKICB0YXJnZXQuX24gPSB0b051bWJlcjsKICB0YXJnZXQuX3MgPSB0b1N0cmluZzsKICB0YXJnZXQuX2wgPSByZW5kZXJMaXN0OwogIHRhcmdldC5fdCA9IHJlbmRlclNsb3Q7CiAgdGFyZ2V0Ll9xID0gbG9vc2VFcXVhbDsKICB0YXJnZXQuX2kgPSBsb29zZUluZGV4T2Y7CiAgdGFyZ2V0Ll9tID0gcmVuZGVyU3RhdGljOwogIHRhcmdldC5fZiA9IHJlc29sdmVGaWx0ZXI7CiAgdGFyZ2V0Ll9rID0gY2hlY2tLZXlDb2RlczsKICB0YXJnZXQuX2IgPSBiaW5kT2JqZWN0UHJvcHM7CiAgdGFyZ2V0Ll92ID0gY3JlYXRlVGV4dFZOb2RlOwogIHRhcmdldC5fZSA9IGNyZWF0ZUVtcHR5Vk5vZGU7CiAgdGFyZ2V0Ll91ID0gcmVzb2x2ZVNjb3BlZFNsb3RzOwogIHRhcmdldC5fZyA9IGJpbmRPYmplY3RMaXN0ZW5lcnM7CiAgdGFyZ2V0Ll9kID0gYmluZER5bmFtaWNLZXlzOwogIHRhcmdldC5fcCA9IHByZXBlbmRNb2RpZmllcjsKfQoKLyoqCiAqIFJ1bnRpbWUgaGVscGVyIGZvciByZXNvbHZpbmcgcmF3IGNoaWxkcmVuIFZOb2RlcyBpbnRvIGEgc2xvdCBvYmplY3QuCiAqLwpmdW5jdGlvbiByZXNvbHZlU2xvdHMoY2hpbGRyZW4sIGNvbnRleHQpIHsKICBpZiAoIWNoaWxkcmVuIHx8ICFjaGlsZHJlbi5sZW5ndGgpIHsKICAgIHJldHVybiB7fTsKICB9CiAgdmFyIHNsb3RzID0ge307CiAgZm9yICh2YXIgaSA9IDAsIGwgPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgIHZhciBjaGlsZCA9IGNoaWxkcmVuW2ldOwogICAgdmFyIGRhdGEgPSBjaGlsZC5kYXRhOwogICAgLy8gcmVtb3ZlIHNsb3QgYXR0cmlidXRlIGlmIHRoZSBub2RlIGlzIHJlc29sdmVkIGFzIGEgVnVlIHNsb3Qgbm9kZQogICAgaWYgKGRhdGEgJiYgZGF0YS5hdHRycyAmJiBkYXRhLmF0dHJzLnNsb3QpIHsKICAgICAgZGVsZXRlIGRhdGEuYXR0cnMuc2xvdDsKICAgIH0KICAgIC8vIG5hbWVkIHNsb3RzIHNob3VsZCBvbmx5IGJlIHJlc3BlY3RlZCBpZiB0aGUgdm5vZGUgd2FzIHJlbmRlcmVkIGluIHRoZQogICAgLy8gc2FtZSBjb250ZXh0LgogICAgaWYgKChjaGlsZC5jb250ZXh0ID09PSBjb250ZXh0IHx8IGNoaWxkLmZuQ29udGV4dCA9PT0gY29udGV4dCkgJiYgZGF0YSAmJiBkYXRhLnNsb3QgIT0gbnVsbCkgewogICAgICB2YXIgbmFtZV8xID0gZGF0YS5zbG90OwogICAgICB2YXIgc2xvdCA9IHNsb3RzW25hbWVfMV0gfHwgKHNsb3RzW25hbWVfMV0gPSBbXSk7CiAgICAgIGlmIChjaGlsZC50YWcgPT09ICd0ZW1wbGF0ZScpIHsKICAgICAgICBzbG90LnB1c2guYXBwbHkoc2xvdCwgY2hpbGQuY2hpbGRyZW4gfHwgW10pOwogICAgICB9IGVsc2UgewogICAgICAgIHNsb3QucHVzaChjaGlsZCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIChzbG90cy5kZWZhdWx0IHx8IChzbG90cy5kZWZhdWx0ID0gW10pKS5wdXNoKGNoaWxkKTsKICAgIH0KICB9CiAgLy8gaWdub3JlIHNsb3RzIHRoYXQgY29udGFpbnMgb25seSB3aGl0ZXNwYWNlCiAgZm9yICh2YXIgbmFtZV8yIGluIHNsb3RzKSB7CiAgICBpZiAoc2xvdHNbbmFtZV8yXS5ldmVyeShpc1doaXRlc3BhY2UpKSB7CiAgICAgIGRlbGV0ZSBzbG90c1tuYW1lXzJdOwogICAgfQogIH0KICByZXR1cm4gc2xvdHM7Cn0KZnVuY3Rpb24gaXNXaGl0ZXNwYWNlKG5vZGUpIHsKICByZXR1cm4gbm9kZS5pc0NvbW1lbnQgJiYgIW5vZGUuYXN5bmNGYWN0b3J5IHx8IG5vZGUudGV4dCA9PT0gJyAnOwp9CmZ1bmN0aW9uIGlzQXN5bmNQbGFjZWhvbGRlcihub2RlKSB7CiAgLy8gQHRzLWV4cGVjdC1lcnJvciBub3QgcmVhbGx5IGJvb2xlYW4gdHlwZQogIHJldHVybiBub2RlLmlzQ29tbWVudCAmJiBub2RlLmFzeW5jRmFjdG9yeTsKfQpmdW5jdGlvbiBub3JtYWxpemVTY29wZWRTbG90cyhvd25lclZtLCBzY29wZWRTbG90cywgbm9ybWFsU2xvdHMsIHByZXZTY29wZWRTbG90cykgewogIHZhciByZXM7CiAgdmFyIGhhc05vcm1hbFNsb3RzID0gT2JqZWN0LmtleXMobm9ybWFsU2xvdHMpLmxlbmd0aCA+IDA7CiAgdmFyIGlzU3RhYmxlID0gc2NvcGVkU2xvdHMgPyAhIXNjb3BlZFNsb3RzLiRzdGFibGUgOiAhaGFzTm9ybWFsU2xvdHM7CiAgdmFyIGtleSA9IHNjb3BlZFNsb3RzICYmIHNjb3BlZFNsb3RzLiRrZXk7CiAgaWYgKCFzY29wZWRTbG90cykgewogICAgcmVzID0ge307CiAgfSBlbHNlIGlmIChzY29wZWRTbG90cy5fbm9ybWFsaXplZCkgewogICAgLy8gZmFzdCBwYXRoIDE6IGNoaWxkIGNvbXBvbmVudCByZS1yZW5kZXIgb25seSwgcGFyZW50IGRpZCBub3QgY2hhbmdlCiAgICByZXR1cm4gc2NvcGVkU2xvdHMuX25vcm1hbGl6ZWQ7CiAgfSBlbHNlIGlmIChpc1N0YWJsZSAmJiBwcmV2U2NvcGVkU2xvdHMgJiYgcHJldlNjb3BlZFNsb3RzICE9PSBlbXB0eU9iamVjdCAmJiBrZXkgPT09IHByZXZTY29wZWRTbG90cy4ka2V5ICYmICFoYXNOb3JtYWxTbG90cyAmJiAhcHJldlNjb3BlZFNsb3RzLiRoYXNOb3JtYWwpIHsKICAgIC8vIGZhc3QgcGF0aCAyOiBzdGFibGUgc2NvcGVkIHNsb3RzIHcvIG5vIG5vcm1hbCBzbG90cyB0byBwcm94eSwKICAgIC8vIG9ubHkgbmVlZCB0byBub3JtYWxpemUgb25jZQogICAgcmV0dXJuIHByZXZTY29wZWRTbG90czsKICB9IGVsc2UgewogICAgcmVzID0ge307CiAgICBmb3IgKHZhciBrZXlfMSBpbiBzY29wZWRTbG90cykgewogICAgICBpZiAoc2NvcGVkU2xvdHNba2V5XzFdICYmIGtleV8xWzBdICE9PSAnJCcpIHsKICAgICAgICByZXNba2V5XzFdID0gbm9ybWFsaXplU2NvcGVkU2xvdChvd25lclZtLCBub3JtYWxTbG90cywga2V5XzEsIHNjb3BlZFNsb3RzW2tleV8xXSk7CiAgICAgIH0KICAgIH0KICB9CiAgLy8gZXhwb3NlIG5vcm1hbCBzbG90cyBvbiBzY29wZWRTbG90cwogIGZvciAodmFyIGtleV8yIGluIG5vcm1hbFNsb3RzKSB7CiAgICBpZiAoIShrZXlfMiBpbiByZXMpKSB7CiAgICAgIHJlc1trZXlfMl0gPSBwcm94eU5vcm1hbFNsb3Qobm9ybWFsU2xvdHMsIGtleV8yKTsKICAgIH0KICB9CiAgLy8gYXZvcmlheiBzZWVtcyB0byBtb2NrIGEgbm9uLWV4dGVuc2libGUgJHNjb3BlZFNsb3RzIG9iamVjdAogIC8vIGFuZCB3aGVuIHRoYXQgaXMgcGFzc2VkIGRvd24gdGhpcyB3b3VsZCBjYXVzZSBhbiBlcnJvcgogIGlmIChzY29wZWRTbG90cyAmJiBPYmplY3QuaXNFeHRlbnNpYmxlKHNjb3BlZFNsb3RzKSkgewogICAgc2NvcGVkU2xvdHMuX25vcm1hbGl6ZWQgPSByZXM7CiAgfQogIGRlZihyZXMsICckc3RhYmxlJywgaXNTdGFibGUpOwogIGRlZihyZXMsICcka2V5Jywga2V5KTsKICBkZWYocmVzLCAnJGhhc05vcm1hbCcsIGhhc05vcm1hbFNsb3RzKTsKICByZXR1cm4gcmVzOwp9CmZ1bmN0aW9uIG5vcm1hbGl6ZVNjb3BlZFNsb3Qodm0sIG5vcm1hbFNsb3RzLCBrZXksIGZuKSB7CiAgdmFyIG5vcm1hbGl6ZWQgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgY3VyID0gY3VycmVudEluc3RhbmNlOwogICAgc2V0Q3VycmVudEluc3RhbmNlKHZtKTsKICAgIHZhciByZXMgPSBhcmd1bWVudHMubGVuZ3RoID8gZm4uYXBwbHkobnVsbCwgYXJndW1lbnRzKSA6IGZuKHt9KTsKICAgIHJlcyA9IHJlcyAmJiB0eXBlb2YgcmVzID09PSAnb2JqZWN0JyAmJiAhaXNBcnJheShyZXMpID8gW3Jlc10gLy8gc2luZ2xlIHZub2RlCiAgICA6IG5vcm1hbGl6ZUNoaWxkcmVuKHJlcyk7CiAgICB2YXIgdm5vZGUgPSByZXMgJiYgcmVzWzBdOwogICAgc2V0Q3VycmVudEluc3RhbmNlKGN1cik7CiAgICByZXR1cm4gcmVzICYmICghdm5vZGUgfHwgcmVzLmxlbmd0aCA9PT0gMSAmJiB2bm9kZS5pc0NvbW1lbnQgJiYgIWlzQXN5bmNQbGFjZWhvbGRlcih2bm9kZSkpIC8vICM5NjU4LCAjMTAzOTEKICAgID8gdW5kZWZpbmVkIDogcmVzOwogIH07CiAgLy8gdGhpcyBpcyBhIHNsb3QgdXNpbmcgdGhlIG5ldyB2LXNsb3Qgc3ludGF4IHdpdGhvdXQgc2NvcGUuIGFsdGhvdWdoIGl0IGlzCiAgLy8gY29tcGlsZWQgYXMgYSBzY29wZWQgc2xvdCwgcmVuZGVyIGZuIHVzZXJzIHdvdWxkIGV4cGVjdCBpdCB0byBiZSBwcmVzZW50CiAgLy8gb24gdGhpcy4kc2xvdHMgYmVjYXVzZSB0aGUgdXNhZ2UgaXMgc2VtYW50aWNhbGx5IGEgbm9ybWFsIHNsb3QuCiAgaWYgKGZuLnByb3h5KSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobm9ybWFsU2xvdHMsIGtleSwgewogICAgICBnZXQ6IG5vcm1hbGl6ZWQsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZQogICAgfSk7CiAgfQogIHJldHVybiBub3JtYWxpemVkOwp9CmZ1bmN0aW9uIHByb3h5Tm9ybWFsU2xvdChzbG90cywga2V5KSB7CiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBzbG90c1trZXldOwogIH07Cn0KZnVuY3Rpb24gaW5pdFNldHVwKHZtKSB7CiAgdmFyIG9wdGlvbnMgPSB2bS4kb3B0aW9uczsKICB2YXIgc2V0dXAgPSBvcHRpb25zLnNldHVwOwogIGlmIChzZXR1cCkgewogICAgdmFyIGN0eCA9IHZtLl9zZXR1cENvbnRleHQgPSBjcmVhdGVTZXR1cENvbnRleHQodm0pOwogICAgc2V0Q3VycmVudEluc3RhbmNlKHZtKTsKICAgIHB1c2hUYXJnZXQoKTsKICAgIHZhciBzZXR1cFJlc3VsdCA9IGludm9rZVdpdGhFcnJvckhhbmRsaW5nKHNldHVwLCBudWxsLCBbdm0uX3Byb3BzIHx8IHNoYWxsb3dSZWFjdGl2ZSh7fSksIGN0eF0sIHZtLCAic2V0dXAiKTsKICAgIHBvcFRhcmdldCgpOwogICAgc2V0Q3VycmVudEluc3RhbmNlKCk7CiAgICBpZiAoaXNGdW5jdGlvbihzZXR1cFJlc3VsdCkpIHsKICAgICAgLy8gcmVuZGVyIGZ1bmN0aW9uCiAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgb3B0aW9ucy5yZW5kZXIgPSBzZXR1cFJlc3VsdDsKICAgIH0gZWxzZSBpZiAoaXNPYmplY3Qoc2V0dXBSZXN1bHQpKSB7CiAgICAgIC8vIGJpbmRpbmdzCiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHNldHVwUmVzdWx0IGluc3RhbmNlb2YgVk5vZGUpIHsKICAgICAgICB3YXJuKCJzZXR1cCgpIHNob3VsZCBub3QgcmV0dXJuIFZOb2RlcyBkaXJlY3RseSAtICIgKyAicmV0dXJuIGEgcmVuZGVyIGZ1bmN0aW9uIGluc3RlYWQuIik7CiAgICAgIH0KICAgICAgdm0uX3NldHVwU3RhdGUgPSBzZXR1cFJlc3VsdDsKICAgICAgLy8gX19zZmMgaW5kaWNhdGVzIGNvbXBpbGVkIGJpbmRpbmdzIGZyb20gPHNjcmlwdCBzZXR1cD4KICAgICAgaWYgKCFzZXR1cFJlc3VsdC5fX3NmYykgewogICAgICAgIGZvciAodmFyIGtleSBpbiBzZXR1cFJlc3VsdCkgewogICAgICAgICAgaWYgKCFpc1Jlc2VydmVkKGtleSkpIHsKICAgICAgICAgICAgcHJveHlXaXRoUmVmVW53cmFwKHZtLCBzZXR1cFJlc3VsdCwga2V5KTsKICAgICAgICAgIH0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICAgICAgICB3YXJuKCJBdm9pZCB1c2luZyB2YXJpYWJsZXMgdGhhdCBzdGFydCB3aXRoIF8gb3IgJCBpbiBzZXR1cCgpLiIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBleHBvc2VkIGZvciBjb21waWxlZCByZW5kZXIgZm4KICAgICAgICB2YXIgcHJveHkgPSB2bS5fc2V0dXBQcm94eSA9IHt9OwogICAgICAgIGZvciAodmFyIGtleSBpbiBzZXR1cFJlc3VsdCkgewogICAgICAgICAgaWYgKGtleSAhPT0gJ19fc2ZjJykgewogICAgICAgICAgICBwcm94eVdpdGhSZWZVbndyYXAocHJveHksIHNldHVwUmVzdWx0LCBrZXkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHNldHVwUmVzdWx0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgd2Fybigic2V0dXAoKSBzaG91bGQgcmV0dXJuIGFuIG9iamVjdC4gUmVjZWl2ZWQ6ICIuY29uY2F0KHNldHVwUmVzdWx0ID09PSBudWxsID8gJ251bGwnIDogdHlwZW9mIHNldHVwUmVzdWx0KSk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGNyZWF0ZVNldHVwQ29udGV4dCh2bSkgewogIHZhciBleHBvc2VDYWxsZWQgPSBmYWxzZTsKICByZXR1cm4gewogICAgZ2V0IGF0dHJzKCkgewogICAgICBpZiAoIXZtLl9hdHRyc1Byb3h5KSB7CiAgICAgICAgdmFyIHByb3h5ID0gdm0uX2F0dHJzUHJveHkgPSB7fTsKICAgICAgICBkZWYocHJveHksICdfdl9hdHRyX3Byb3h5JywgdHJ1ZSk7CiAgICAgICAgc3luY1NldHVwUHJveHkocHJveHksIHZtLiRhdHRycywgZW1wdHlPYmplY3QsIHZtLCAnJGF0dHJzJyk7CiAgICAgIH0KICAgICAgcmV0dXJuIHZtLl9hdHRyc1Byb3h5OwogICAgfSwKICAgIGdldCBsaXN0ZW5lcnMoKSB7CiAgICAgIGlmICghdm0uX2xpc3RlbmVyc1Byb3h5KSB7CiAgICAgICAgdmFyIHByb3h5ID0gdm0uX2xpc3RlbmVyc1Byb3h5ID0ge307CiAgICAgICAgc3luY1NldHVwUHJveHkocHJveHksIHZtLiRsaXN0ZW5lcnMsIGVtcHR5T2JqZWN0LCB2bSwgJyRsaXN0ZW5lcnMnKTsKICAgICAgfQogICAgICByZXR1cm4gdm0uX2xpc3RlbmVyc1Byb3h5OwogICAgfSwKICAgIGdldCBzbG90cygpIHsKICAgICAgcmV0dXJuIGluaXRTbG90c1Byb3h5KHZtKTsKICAgIH0sCiAgICBlbWl0OiBiaW5kKHZtLiRlbWl0LCB2bSksCiAgICBleHBvc2U6IGZ1bmN0aW9uIChleHBvc2VkKSB7CiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICAgICAgaWYgKGV4cG9zZUNhbGxlZCkgewogICAgICAgICAgd2FybigiZXhwb3NlKCkgc2hvdWxkIGJlIGNhbGxlZCBvbmx5IG9uY2UgcGVyIHNldHVwKCkuIiwgdm0pOwogICAgICAgIH0KICAgICAgICBleHBvc2VDYWxsZWQgPSB0cnVlOwogICAgICB9CiAgICAgIGlmIChleHBvc2VkKSB7CiAgICAgICAgT2JqZWN0LmtleXMoZXhwb3NlZCkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgICByZXR1cm4gcHJveHlXaXRoUmVmVW53cmFwKHZtLCBleHBvc2VkLCBrZXkpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfTsKfQpmdW5jdGlvbiBzeW5jU2V0dXBQcm94eSh0bywgZnJvbSwgcHJldiwgaW5zdGFuY2UsIHR5cGUpIHsKICB2YXIgY2hhbmdlZCA9IGZhbHNlOwogIGZvciAodmFyIGtleSBpbiBmcm9tKSB7CiAgICBpZiAoIShrZXkgaW4gdG8pKSB7CiAgICAgIGNoYW5nZWQgPSB0cnVlOwogICAgICBkZWZpbmVQcm94eUF0dHIodG8sIGtleSwgaW5zdGFuY2UsIHR5cGUpOwogICAgfSBlbHNlIGlmIChmcm9tW2tleV0gIT09IHByZXZba2V5XSkgewogICAgICBjaGFuZ2VkID0gdHJ1ZTsKICAgIH0KICB9CiAgZm9yICh2YXIga2V5IGluIHRvKSB7CiAgICBpZiAoIShrZXkgaW4gZnJvbSkpIHsKICAgICAgY2hhbmdlZCA9IHRydWU7CiAgICAgIGRlbGV0ZSB0b1trZXldOwogICAgfQogIH0KICByZXR1cm4gY2hhbmdlZDsKfQpmdW5jdGlvbiBkZWZpbmVQcm94eUF0dHIocHJveHksIGtleSwgaW5zdGFuY2UsIHR5cGUpIHsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkocHJveHksIGtleSwgewogICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgIGdldDogZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gaW5zdGFuY2VbdHlwZV1ba2V5XTsKICAgIH0KICB9KTsKfQpmdW5jdGlvbiBpbml0U2xvdHNQcm94eSh2bSkgewogIGlmICghdm0uX3Nsb3RzUHJveHkpIHsKICAgIHN5bmNTZXR1cFNsb3RzKHZtLl9zbG90c1Byb3h5ID0ge30sIHZtLiRzY29wZWRTbG90cyk7CiAgfQogIHJldHVybiB2bS5fc2xvdHNQcm94eTsKfQpmdW5jdGlvbiBzeW5jU2V0dXBTbG90cyh0bywgZnJvbSkgewogIGZvciAodmFyIGtleSBpbiBmcm9tKSB7CiAgICB0b1trZXldID0gZnJvbVtrZXldOwogIH0KICBmb3IgKHZhciBrZXkgaW4gdG8pIHsKICAgIGlmICghKGtleSBpbiBmcm9tKSkgewogICAgICBkZWxldGUgdG9ba2V5XTsKICAgIH0KICB9Cn0KLyoqCiAqIEBpbnRlcm5hbCB1c2UgbWFudWFsIHR5cGUgZGVmIGJlY2F1c2UgcHVibGljIHNldHVwIGNvbnRleHQgdHlwZSByZWxpZXMgb24KICogbGVnYWN5IFZOb2RlIHR5cGVzCiAqLwpmdW5jdGlvbiB1c2VTbG90cygpIHsKICByZXR1cm4gZ2V0Q29udGV4dCgpLnNsb3RzOwp9Ci8qKgogKiBAaW50ZXJuYWwgdXNlIG1hbnVhbCB0eXBlIGRlZiBiZWNhdXNlIHB1YmxpYyBzZXR1cCBjb250ZXh0IHR5cGUgcmVsaWVzIG9uCiAqIGxlZ2FjeSBWTm9kZSB0eXBlcwogKi8KZnVuY3Rpb24gdXNlQXR0cnMoKSB7CiAgcmV0dXJuIGdldENvbnRleHQoKS5hdHRyczsKfQovKioKICogVnVlIDIgb25seQogKiBAaW50ZXJuYWwgdXNlIG1hbnVhbCB0eXBlIGRlZiBiZWNhdXNlIHB1YmxpYyBzZXR1cCBjb250ZXh0IHR5cGUgcmVsaWVzIG9uCiAqIGxlZ2FjeSBWTm9kZSB0eXBlcwogKi8KZnVuY3Rpb24gdXNlTGlzdGVuZXJzKCkgewogIHJldHVybiBnZXRDb250ZXh0KCkubGlzdGVuZXJzOwp9CmZ1bmN0aW9uIGdldENvbnRleHQoKSB7CiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgIWN1cnJlbnRJbnN0YW5jZSkgewogICAgd2FybigidXNlQ29udGV4dCgpIGNhbGxlZCB3aXRob3V0IGFjdGl2ZSBpbnN0YW5jZS4iKTsKICB9CiAgdmFyIHZtID0gY3VycmVudEluc3RhbmNlOwogIHJldHVybiB2bS5fc2V0dXBDb250ZXh0IHx8ICh2bS5fc2V0dXBDb250ZXh0ID0gY3JlYXRlU2V0dXBDb250ZXh0KHZtKSk7Cn0KLyoqCiAqIFJ1bnRpbWUgaGVscGVyIGZvciBtZXJnaW5nIGRlZmF1bHQgZGVjbGFyYXRpb25zLiBJbXBvcnRlZCBieSBjb21waWxlZCBjb2RlCiAqIG9ubHkuCiAqIEBpbnRlcm5hbAogKi8KZnVuY3Rpb24gbWVyZ2VEZWZhdWx0cyhyYXcsIGRlZmF1bHRzKSB7CiAgdmFyIHByb3BzID0gaXNBcnJheShyYXcpID8gcmF3LnJlZHVjZShmdW5jdGlvbiAobm9ybWFsaXplZCwgcCkgewogICAgcmV0dXJuIG5vcm1hbGl6ZWRbcF0gPSB7fSwgbm9ybWFsaXplZDsKICB9LCB7fSkgOiByYXc7CiAgZm9yICh2YXIga2V5IGluIGRlZmF1bHRzKSB7CiAgICB2YXIgb3B0ID0gcHJvcHNba2V5XTsKICAgIGlmIChvcHQpIHsKICAgICAgaWYgKGlzQXJyYXkob3B0KSB8fCBpc0Z1bmN0aW9uKG9wdCkpIHsKICAgICAgICBwcm9wc1trZXldID0gewogICAgICAgICAgdHlwZTogb3B0LAogICAgICAgICAgZGVmYXVsdDogZGVmYXVsdHNba2V5XQogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb3B0LmRlZmF1bHQgPSBkZWZhdWx0c1trZXldOwogICAgICB9CiAgICB9IGVsc2UgaWYgKG9wdCA9PT0gbnVsbCkgewogICAgICBwcm9wc1trZXldID0gewogICAgICAgIGRlZmF1bHQ6IGRlZmF1bHRzW2tleV0KICAgICAgfTsKICAgIH0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICB3YXJuKCJwcm9wcyBkZWZhdWx0IGtleSBcIiIuY29uY2F0KGtleSwgIlwiIGhhcyBubyBjb3JyZXNwb25kaW5nIGRlY2xhcmF0aW9uLiIpKTsKICAgIH0KICB9CiAgcmV0dXJuIHByb3BzOwp9CmZ1bmN0aW9uIGluaXRSZW5kZXIodm0pIHsKICB2bS5fdm5vZGUgPSBudWxsOyAvLyB0aGUgcm9vdCBvZiB0aGUgY2hpbGQgdHJlZQogIHZtLl9zdGF0aWNUcmVlcyA9IG51bGw7IC8vIHYtb25jZSBjYWNoZWQgdHJlZXMKICB2YXIgb3B0aW9ucyA9IHZtLiRvcHRpb25zOwogIHZhciBwYXJlbnRWbm9kZSA9IHZtLiR2bm9kZSA9IG9wdGlvbnMuX3BhcmVudFZub2RlOyAvLyB0aGUgcGxhY2Vob2xkZXIgbm9kZSBpbiBwYXJlbnQgdHJlZQogIHZhciByZW5kZXJDb250ZXh0ID0gcGFyZW50Vm5vZGUgJiYgcGFyZW50Vm5vZGUuY29udGV4dDsKICB2bS4kc2xvdHMgPSByZXNvbHZlU2xvdHMob3B0aW9ucy5fcmVuZGVyQ2hpbGRyZW4sIHJlbmRlckNvbnRleHQpOwogIHZtLiRzY29wZWRTbG90cyA9IHBhcmVudFZub2RlID8gbm9ybWFsaXplU2NvcGVkU2xvdHModm0uJHBhcmVudCwgcGFyZW50Vm5vZGUuZGF0YS5zY29wZWRTbG90cywgdm0uJHNsb3RzKSA6IGVtcHR5T2JqZWN0OwogIC8vIGJpbmQgdGhlIGNyZWF0ZUVsZW1lbnQgZm4gdG8gdGhpcyBpbnN0YW5jZQogIC8vIHNvIHRoYXQgd2UgZ2V0IHByb3BlciByZW5kZXIgY29udGV4dCBpbnNpZGUgaXQuCiAgLy8gYXJncyBvcmRlcjogdGFnLCBkYXRhLCBjaGlsZHJlbiwgbm9ybWFsaXphdGlvblR5cGUsIGFsd2F5c05vcm1hbGl6ZQogIC8vIGludGVybmFsIHZlcnNpb24gaXMgdXNlZCBieSByZW5kZXIgZnVuY3Rpb25zIGNvbXBpbGVkIGZyb20gdGVtcGxhdGVzCiAgLy8gQHRzLWV4cGVjdC1lcnJvcgogIHZtLl9jID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHsKICAgIHJldHVybiBjcmVhdGVFbGVtZW50JDEodm0sIGEsIGIsIGMsIGQsIGZhbHNlKTsKICB9OwogIC8vIG5vcm1hbGl6YXRpb24gaXMgYWx3YXlzIGFwcGxpZWQgZm9yIHRoZSBwdWJsaWMgdmVyc2lvbiwgdXNlZCBpbgogIC8vIHVzZXItd3JpdHRlbiByZW5kZXIgZnVuY3Rpb25zLgogIC8vIEB0cy1leHBlY3QtZXJyb3IKICB2bS4kY3JlYXRlRWxlbWVudCA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7CiAgICByZXR1cm4gY3JlYXRlRWxlbWVudCQxKHZtLCBhLCBiLCBjLCBkLCB0cnVlKTsKICB9OwogIC8vICRhdHRycyAmICRsaXN0ZW5lcnMgYXJlIGV4cG9zZWQgZm9yIGVhc2llciBIT0MgY3JlYXRpb24uCiAgLy8gdGhleSBuZWVkIHRvIGJlIHJlYWN0aXZlIHNvIHRoYXQgSE9DcyB1c2luZyB0aGVtIGFyZSBhbHdheXMgdXBkYXRlZAogIHZhciBwYXJlbnREYXRhID0gcGFyZW50Vm5vZGUgJiYgcGFyZW50Vm5vZGUuZGF0YTsKICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqLwogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICBkZWZpbmVSZWFjdGl2ZSh2bSwgJyRhdHRycycsIHBhcmVudERhdGEgJiYgcGFyZW50RGF0YS5hdHRycyB8fCBlbXB0eU9iamVjdCwgZnVuY3Rpb24gKCkgewogICAgICAhaXNVcGRhdGluZ0NoaWxkQ29tcG9uZW50ICYmIHdhcm4oIiRhdHRycyBpcyByZWFkb25seS4iLCB2bSk7CiAgICB9LCB0cnVlKTsKICAgIGRlZmluZVJlYWN0aXZlKHZtLCAnJGxpc3RlbmVycycsIG9wdGlvbnMuX3BhcmVudExpc3RlbmVycyB8fCBlbXB0eU9iamVjdCwgZnVuY3Rpb24gKCkgewogICAgICAhaXNVcGRhdGluZ0NoaWxkQ29tcG9uZW50ICYmIHdhcm4oIiRsaXN0ZW5lcnMgaXMgcmVhZG9ubHkuIiwgdm0pOwogICAgfSwgdHJ1ZSk7CiAgfSBlbHNlIHsKICAgIGRlZmluZVJlYWN0aXZlKHZtLCAnJGF0dHJzJywgcGFyZW50RGF0YSAmJiBwYXJlbnREYXRhLmF0dHJzIHx8IGVtcHR5T2JqZWN0LCBudWxsLCB0cnVlKTsKICAgIGRlZmluZVJlYWN0aXZlKHZtLCAnJGxpc3RlbmVycycsIG9wdGlvbnMuX3BhcmVudExpc3RlbmVycyB8fCBlbXB0eU9iamVjdCwgbnVsbCwgdHJ1ZSk7CiAgfQp9CnZhciBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2UgPSBudWxsOwpmdW5jdGlvbiByZW5kZXJNaXhpbihWdWUpIHsKICAvLyBpbnN0YWxsIHJ1bnRpbWUgY29udmVuaWVuY2UgaGVscGVycwogIGluc3RhbGxSZW5kZXJIZWxwZXJzKFZ1ZS5wcm90b3R5cGUpOwogIFZ1ZS5wcm90b3R5cGUuJG5leHRUaWNrID0gZnVuY3Rpb24gKGZuKSB7CiAgICByZXR1cm4gbmV4dFRpY2soZm4sIHRoaXMpOwogIH07CiAgVnVlLnByb3RvdHlwZS5fcmVuZGVyID0gZnVuY3Rpb24gKCkgewogICAgdmFyIHZtID0gdGhpczsKICAgIHZhciBfYSA9IHZtLiRvcHRpb25zLAogICAgICByZW5kZXIgPSBfYS5yZW5kZXIsCiAgICAgIF9wYXJlbnRWbm9kZSA9IF9hLl9wYXJlbnRWbm9kZTsKICAgIGlmIChfcGFyZW50Vm5vZGUgJiYgdm0uX2lzTW91bnRlZCkgewogICAgICB2bS4kc2NvcGVkU2xvdHMgPSBub3JtYWxpemVTY29wZWRTbG90cyh2bS4kcGFyZW50LCBfcGFyZW50Vm5vZGUuZGF0YS5zY29wZWRTbG90cywgdm0uJHNsb3RzLCB2bS4kc2NvcGVkU2xvdHMpOwogICAgICBpZiAodm0uX3Nsb3RzUHJveHkpIHsKICAgICAgICBzeW5jU2V0dXBTbG90cyh2bS5fc2xvdHNQcm94eSwgdm0uJHNjb3BlZFNsb3RzKTsKICAgICAgfQogICAgfQogICAgLy8gc2V0IHBhcmVudCB2bm9kZS4gdGhpcyBhbGxvd3MgcmVuZGVyIGZ1bmN0aW9ucyB0byBoYXZlIGFjY2VzcwogICAgLy8gdG8gdGhlIGRhdGEgb24gdGhlIHBsYWNlaG9sZGVyIG5vZGUuCiAgICB2bS4kdm5vZGUgPSBfcGFyZW50Vm5vZGU7CiAgICAvLyByZW5kZXIgc2VsZgogICAgdmFyIHByZXZJbnN0ID0gY3VycmVudEluc3RhbmNlOwogICAgdmFyIHByZXZSZW5kZXJJbnN0ID0gY3VycmVudFJlbmRlcmluZ0luc3RhbmNlOwogICAgdmFyIHZub2RlOwogICAgdHJ5IHsKICAgICAgc2V0Q3VycmVudEluc3RhbmNlKHZtKTsKICAgICAgY3VycmVudFJlbmRlcmluZ0luc3RhbmNlID0gdm07CiAgICAgIHZub2RlID0gcmVuZGVyLmNhbGwodm0uX3JlbmRlclByb3h5LCB2bS4kY3JlYXRlRWxlbWVudCk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIGhhbmRsZUVycm9yKGUsIHZtLCAicmVuZGVyIik7CiAgICAgIC8vIHJldHVybiBlcnJvciByZW5kZXIgcmVzdWx0LAogICAgICAvLyBvciBwcmV2aW91cyB2bm9kZSB0byBwcmV2ZW50IHJlbmRlciBlcnJvciBjYXVzaW5nIGJsYW5rIGNvbXBvbmVudAogICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqLwogICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiB2bS4kb3B0aW9ucy5yZW5kZXJFcnJvcikgewogICAgICAgIHRyeSB7CiAgICAgICAgICB2bm9kZSA9IHZtLiRvcHRpb25zLnJlbmRlckVycm9yLmNhbGwodm0uX3JlbmRlclByb3h5LCB2bS4kY3JlYXRlRWxlbWVudCwgZSk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgaGFuZGxlRXJyb3IoZSwgdm0sICJyZW5kZXJFcnJvciIpOwogICAgICAgICAgdm5vZGUgPSB2bS5fdm5vZGU7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZub2RlID0gdm0uX3Zub2RlOwogICAgICB9CiAgICB9IGZpbmFsbHkgewogICAgICBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2UgPSBwcmV2UmVuZGVySW5zdDsKICAgICAgc2V0Q3VycmVudEluc3RhbmNlKHByZXZJbnN0KTsKICAgIH0KICAgIC8vIGlmIHRoZSByZXR1cm5lZCBhcnJheSBjb250YWlucyBvbmx5IGEgc2luZ2xlIG5vZGUsIGFsbG93IGl0CiAgICBpZiAoaXNBcnJheSh2bm9kZSkgJiYgdm5vZGUubGVuZ3RoID09PSAxKSB7CiAgICAgIHZub2RlID0gdm5vZGVbMF07CiAgICB9CiAgICAvLyByZXR1cm4gZW1wdHkgdm5vZGUgaW4gY2FzZSB0aGUgcmVuZGVyIGZ1bmN0aW9uIGVycm9yZWQgb3V0CiAgICBpZiAoISh2bm9kZSBpbnN0YW5jZW9mIFZOb2RlKSkgewogICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiBpc0FycmF5KHZub2RlKSkgewogICAgICAgIHdhcm4oJ011bHRpcGxlIHJvb3Qgbm9kZXMgcmV0dXJuZWQgZnJvbSByZW5kZXIgZnVuY3Rpb24uIFJlbmRlciBmdW5jdGlvbiAnICsgJ3Nob3VsZCByZXR1cm4gYSBzaW5nbGUgcm9vdCBub2RlLicsIHZtKTsKICAgICAgfQogICAgICB2bm9kZSA9IGNyZWF0ZUVtcHR5Vk5vZGUoKTsKICAgIH0KICAgIC8vIHNldCBwYXJlbnQKICAgIHZub2RlLnBhcmVudCA9IF9wYXJlbnRWbm9kZTsKICAgIHJldHVybiB2bm9kZTsKICB9Owp9CmZ1bmN0aW9uIGVuc3VyZUN0b3IoY29tcCwgYmFzZSkgewogIGlmIChjb21wLl9fZXNNb2R1bGUgfHwgaGFzU3ltYm9sICYmIGNvbXBbU3ltYm9sLnRvU3RyaW5nVGFnXSA9PT0gJ01vZHVsZScpIHsKICAgIGNvbXAgPSBjb21wLmRlZmF1bHQ7CiAgfQogIHJldHVybiBpc09iamVjdChjb21wKSA/IGJhc2UuZXh0ZW5kKGNvbXApIDogY29tcDsKfQpmdW5jdGlvbiBjcmVhdGVBc3luY1BsYWNlaG9sZGVyKGZhY3RvcnksIGRhdGEsIGNvbnRleHQsIGNoaWxkcmVuLCB0YWcpIHsKICB2YXIgbm9kZSA9IGNyZWF0ZUVtcHR5Vk5vZGUoKTsKICBub2RlLmFzeW5jRmFjdG9yeSA9IGZhY3Rvcnk7CiAgbm9kZS5hc3luY01ldGEgPSB7CiAgICBkYXRhOiBkYXRhLAogICAgY29udGV4dDogY29udGV4dCwKICAgIGNoaWxkcmVuOiBjaGlsZHJlbiwKICAgIHRhZzogdGFnCiAgfTsKICByZXR1cm4gbm9kZTsKfQpmdW5jdGlvbiByZXNvbHZlQXN5bmNDb21wb25lbnQoZmFjdG9yeSwgYmFzZUN0b3IpIHsKICBpZiAoaXNUcnVlKGZhY3RvcnkuZXJyb3IpICYmIGlzRGVmKGZhY3RvcnkuZXJyb3JDb21wKSkgewogICAgcmV0dXJuIGZhY3RvcnkuZXJyb3JDb21wOwogIH0KICBpZiAoaXNEZWYoZmFjdG9yeS5yZXNvbHZlZCkpIHsKICAgIHJldHVybiBmYWN0b3J5LnJlc29sdmVkOwogIH0KICB2YXIgb3duZXIgPSBjdXJyZW50UmVuZGVyaW5nSW5zdGFuY2U7CiAgaWYgKG93bmVyICYmIGlzRGVmKGZhY3Rvcnkub3duZXJzKSAmJiBmYWN0b3J5Lm93bmVycy5pbmRleE9mKG93bmVyKSA9PT0gLTEpIHsKICAgIC8vIGFscmVhZHkgcGVuZGluZwogICAgZmFjdG9yeS5vd25lcnMucHVzaChvd25lcik7CiAgfQogIGlmIChpc1RydWUoZmFjdG9yeS5sb2FkaW5nKSAmJiBpc0RlZihmYWN0b3J5LmxvYWRpbmdDb21wKSkgewogICAgcmV0dXJuIGZhY3RvcnkubG9hZGluZ0NvbXA7CiAgfQogIGlmIChvd25lciAmJiAhaXNEZWYoZmFjdG9yeS5vd25lcnMpKSB7CiAgICB2YXIgb3duZXJzXzEgPSBmYWN0b3J5Lm93bmVycyA9IFtvd25lcl07CiAgICB2YXIgc3luY18xID0gdHJ1ZTsKICAgIHZhciB0aW1lckxvYWRpbmdfMSA9IG51bGw7CiAgICB2YXIgdGltZXJUaW1lb3V0XzEgPSBudWxsOwogICAgb3duZXIuJG9uKCdob29rOmRlc3Ryb3llZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHJlbW92ZSQyKG93bmVyc18xLCBvd25lcik7CiAgICB9KTsKICAgIHZhciBmb3JjZVJlbmRlcl8xID0gZnVuY3Rpb24gKHJlbmRlckNvbXBsZXRlZCkgewogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IG93bmVyc18xLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIG93bmVyc18xW2ldLiRmb3JjZVVwZGF0ZSgpOwogICAgICB9CiAgICAgIGlmIChyZW5kZXJDb21wbGV0ZWQpIHsKICAgICAgICBvd25lcnNfMS5sZW5ndGggPSAwOwogICAgICAgIGlmICh0aW1lckxvYWRpbmdfMSAhPT0gbnVsbCkgewogICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyTG9hZGluZ18xKTsKICAgICAgICAgIHRpbWVyTG9hZGluZ18xID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgaWYgKHRpbWVyVGltZW91dF8xICE9PSBudWxsKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXJUaW1lb3V0XzEpOwogICAgICAgICAgdGltZXJUaW1lb3V0XzEgPSBudWxsOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIHZhciByZXNvbHZlID0gb25jZShmdW5jdGlvbiAocmVzKSB7CiAgICAgIC8vIGNhY2hlIHJlc29sdmVkCiAgICAgIGZhY3RvcnkucmVzb2x2ZWQgPSBlbnN1cmVDdG9yKHJlcywgYmFzZUN0b3IpOwogICAgICAvLyBpbnZva2UgY2FsbGJhY2tzIG9ubHkgaWYgdGhpcyBpcyBub3QgYSBzeW5jaHJvbm91cyByZXNvbHZlCiAgICAgIC8vIChhc3luYyByZXNvbHZlcyBhcmUgc2hpbW1lZCBhcyBzeW5jaHJvbm91cyBkdXJpbmcgU1NSKQogICAgICBpZiAoIXN5bmNfMSkgewogICAgICAgIGZvcmNlUmVuZGVyXzEodHJ1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb3duZXJzXzEubGVuZ3RoID0gMDsKICAgICAgfQogICAgfSk7CiAgICB2YXIgcmVqZWN0XzEgPSBvbmNlKGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuKCJGYWlsZWQgdG8gcmVzb2x2ZSBhc3luYyBjb21wb25lbnQ6ICIuY29uY2F0KFN0cmluZyhmYWN0b3J5KSkgKyAocmVhc29uID8gIlxuUmVhc29uOiAiLmNvbmNhdChyZWFzb24pIDogJycpKTsKICAgICAgaWYgKGlzRGVmKGZhY3RvcnkuZXJyb3JDb21wKSkgewogICAgICAgIGZhY3RvcnkuZXJyb3IgPSB0cnVlOwogICAgICAgIGZvcmNlUmVuZGVyXzEodHJ1ZSk7CiAgICAgIH0KICAgIH0pOwogICAgdmFyIHJlc18xID0gZmFjdG9yeShyZXNvbHZlLCByZWplY3RfMSk7CiAgICBpZiAoaXNPYmplY3QocmVzXzEpKSB7CiAgICAgIGlmIChpc1Byb21pc2UocmVzXzEpKSB7CiAgICAgICAgLy8gKCkgPT4gUHJvbWlzZQogICAgICAgIGlmIChpc1VuZGVmKGZhY3RvcnkucmVzb2x2ZWQpKSB7CiAgICAgICAgICByZXNfMS50aGVuKHJlc29sdmUsIHJlamVjdF8xKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoaXNQcm9taXNlKHJlc18xLmNvbXBvbmVudCkpIHsKICAgICAgICByZXNfMS5jb21wb25lbnQudGhlbihyZXNvbHZlLCByZWplY3RfMSk7CiAgICAgICAgaWYgKGlzRGVmKHJlc18xLmVycm9yKSkgewogICAgICAgICAgZmFjdG9yeS5lcnJvckNvbXAgPSBlbnN1cmVDdG9yKHJlc18xLmVycm9yLCBiYXNlQ3Rvcik7CiAgICAgICAgfQogICAgICAgIGlmIChpc0RlZihyZXNfMS5sb2FkaW5nKSkgewogICAgICAgICAgZmFjdG9yeS5sb2FkaW5nQ29tcCA9IGVuc3VyZUN0b3IocmVzXzEubG9hZGluZywgYmFzZUN0b3IpOwogICAgICAgICAgaWYgKHJlc18xLmRlbGF5ID09PSAwKSB7CiAgICAgICAgICAgIGZhY3RvcnkubG9hZGluZyA9IHRydWU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIE5vZGVKUyB0aW1lb3V0IHR5cGUKICAgICAgICAgICAgdGltZXJMb2FkaW5nXzEgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB0aW1lckxvYWRpbmdfMSA9IG51bGw7CiAgICAgICAgICAgICAgaWYgKGlzVW5kZWYoZmFjdG9yeS5yZXNvbHZlZCkgJiYgaXNVbmRlZihmYWN0b3J5LmVycm9yKSkgewogICAgICAgICAgICAgICAgZmFjdG9yeS5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGZvcmNlUmVuZGVyXzEoZmFsc2UpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgcmVzXzEuZGVsYXkgfHwgMjAwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGlzRGVmKHJlc18xLnRpbWVvdXQpKSB7CiAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIE5vZGVKUyB0aW1lb3V0IHR5cGUKICAgICAgICAgIHRpbWVyVGltZW91dF8xID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHRpbWVyVGltZW91dF8xID0gbnVsbDsKICAgICAgICAgICAgaWYgKGlzVW5kZWYoZmFjdG9yeS5yZXNvbHZlZCkpIHsKICAgICAgICAgICAgICByZWplY3RfMShwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nID8gInRpbWVvdXQgKCIuY29uY2F0KHJlc18xLnRpbWVvdXQsICJtcykiKSA6IG51bGwpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LCByZXNfMS50aW1lb3V0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIHN5bmNfMSA9IGZhbHNlOwogICAgLy8gcmV0dXJuIGluIGNhc2UgcmVzb2x2ZWQgc3luY2hyb25vdXNseQogICAgcmV0dXJuIGZhY3RvcnkubG9hZGluZyA/IGZhY3RvcnkubG9hZGluZ0NvbXAgOiBmYWN0b3J5LnJlc29sdmVkOwogIH0KfQpmdW5jdGlvbiBnZXRGaXJzdENvbXBvbmVudENoaWxkKGNoaWxkcmVuKSB7CiAgaWYgKGlzQXJyYXkoY2hpbGRyZW4pKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBjID0gY2hpbGRyZW5baV07CiAgICAgIGlmIChpc0RlZihjKSAmJiAoaXNEZWYoYy5jb21wb25lbnRPcHRpb25zKSB8fCBpc0FzeW5jUGxhY2Vob2xkZXIoYykpKSB7CiAgICAgICAgcmV0dXJuIGM7CiAgICAgIH0KICAgIH0KICB9Cn0KdmFyIFNJTVBMRV9OT1JNQUxJWkUgPSAxOwp2YXIgQUxXQVlTX05PUk1BTElaRSA9IDI7Ci8vIHdyYXBwZXIgZnVuY3Rpb24gZm9yIHByb3ZpZGluZyBhIG1vcmUgZmxleGlibGUgaW50ZXJmYWNlCi8vIHdpdGhvdXQgZ2V0dGluZyB5ZWxsZWQgYXQgYnkgZmxvdwpmdW5jdGlvbiBjcmVhdGVFbGVtZW50JDEoY29udGV4dCwgdGFnLCBkYXRhLCBjaGlsZHJlbiwgbm9ybWFsaXphdGlvblR5cGUsIGFsd2F5c05vcm1hbGl6ZSkgewogIGlmIChpc0FycmF5KGRhdGEpIHx8IGlzUHJpbWl0aXZlKGRhdGEpKSB7CiAgICBub3JtYWxpemF0aW9uVHlwZSA9IGNoaWxkcmVuOwogICAgY2hpbGRyZW4gPSBkYXRhOwogICAgZGF0YSA9IHVuZGVmaW5lZDsKICB9CiAgaWYgKGlzVHJ1ZShhbHdheXNOb3JtYWxpemUpKSB7CiAgICBub3JtYWxpemF0aW9uVHlwZSA9IEFMV0FZU19OT1JNQUxJWkU7CiAgfQogIHJldHVybiBfY3JlYXRlRWxlbWVudChjb250ZXh0LCB0YWcsIGRhdGEsIGNoaWxkcmVuLCBub3JtYWxpemF0aW9uVHlwZSk7Cn0KZnVuY3Rpb24gX2NyZWF0ZUVsZW1lbnQoY29udGV4dCwgdGFnLCBkYXRhLCBjaGlsZHJlbiwgbm9ybWFsaXphdGlvblR5cGUpIHsKICBpZiAoaXNEZWYoZGF0YSkgJiYgaXNEZWYoZGF0YS5fX29iX18pKSB7CiAgICBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm4oIkF2b2lkIHVzaW5nIG9ic2VydmVkIGRhdGEgb2JqZWN0IGFzIHZub2RlIGRhdGE6ICIuY29uY2F0KEpTT04uc3RyaW5naWZ5KGRhdGEpLCAiXG4iKSArICdBbHdheXMgY3JlYXRlIGZyZXNoIHZub2RlIGRhdGEgb2JqZWN0cyBpbiBlYWNoIHJlbmRlciEnLCBjb250ZXh0KTsKICAgIHJldHVybiBjcmVhdGVFbXB0eVZOb2RlKCk7CiAgfQogIC8vIG9iamVjdCBzeW50YXggaW4gdi1iaW5kCiAgaWYgKGlzRGVmKGRhdGEpICYmIGlzRGVmKGRhdGEuaXMpKSB7CiAgICB0YWcgPSBkYXRhLmlzOwogIH0KICBpZiAoIXRhZykgewogICAgLy8gaW4gY2FzZSBvZiBjb21wb25lbnQgOmlzIHNldCB0byBmYWxzeSB2YWx1ZQogICAgcmV0dXJuIGNyZWF0ZUVtcHR5Vk5vZGUoKTsKICB9CiAgLy8gd2FybiBhZ2FpbnN0IG5vbi1wcmltaXRpdmUga2V5CiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgaXNEZWYoZGF0YSkgJiYgaXNEZWYoZGF0YS5rZXkpICYmICFpc1ByaW1pdGl2ZShkYXRhLmtleSkpIHsKICAgIHdhcm4oJ0F2b2lkIHVzaW5nIG5vbi1wcmltaXRpdmUgdmFsdWUgYXMga2V5LCAnICsgJ3VzZSBzdHJpbmcvbnVtYmVyIHZhbHVlIGluc3RlYWQuJywgY29udGV4dCk7CiAgfQogIC8vIHN1cHBvcnQgc2luZ2xlIGZ1bmN0aW9uIGNoaWxkcmVuIGFzIGRlZmF1bHQgc2NvcGVkIHNsb3QKICBpZiAoaXNBcnJheShjaGlsZHJlbikgJiYgaXNGdW5jdGlvbihjaGlsZHJlblswXSkpIHsKICAgIGRhdGEgPSBkYXRhIHx8IHt9OwogICAgZGF0YS5zY29wZWRTbG90cyA9IHsKICAgICAgZGVmYXVsdDogY2hpbGRyZW5bMF0KICAgIH07CiAgICBjaGlsZHJlbi5sZW5ndGggPSAwOwogIH0KICBpZiAobm9ybWFsaXphdGlvblR5cGUgPT09IEFMV0FZU19OT1JNQUxJWkUpIHsKICAgIGNoaWxkcmVuID0gbm9ybWFsaXplQ2hpbGRyZW4oY2hpbGRyZW4pOwogIH0gZWxzZSBpZiAobm9ybWFsaXphdGlvblR5cGUgPT09IFNJTVBMRV9OT1JNQUxJWkUpIHsKICAgIGNoaWxkcmVuID0gc2ltcGxlTm9ybWFsaXplQ2hpbGRyZW4oY2hpbGRyZW4pOwogIH0KICB2YXIgdm5vZGUsIG5zOwogIGlmICh0eXBlb2YgdGFnID09PSAnc3RyaW5nJykgewogICAgdmFyIEN0b3IgPSB2b2lkIDA7CiAgICBucyA9IGNvbnRleHQuJHZub2RlICYmIGNvbnRleHQuJHZub2RlLm5zIHx8IGNvbmZpZy5nZXRUYWdOYW1lc3BhY2UodGFnKTsKICAgIGlmIChjb25maWcuaXNSZXNlcnZlZFRhZyh0YWcpKSB7CiAgICAgIC8vIHBsYXRmb3JtIGJ1aWx0LWluIGVsZW1lbnRzCiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIGlzRGVmKGRhdGEpICYmIGlzRGVmKGRhdGEubmF0aXZlT24pICYmIGRhdGEudGFnICE9PSAnY29tcG9uZW50JykgewogICAgICAgIHdhcm4oIlRoZSAubmF0aXZlIG1vZGlmaWVyIGZvciB2LW9uIGlzIG9ubHkgdmFsaWQgb24gY29tcG9uZW50cyBidXQgaXQgd2FzIHVzZWQgb24gPCIuY29uY2F0KHRhZywgIj4uIiksIGNvbnRleHQpOwogICAgICB9CiAgICAgIHZub2RlID0gbmV3IFZOb2RlKGNvbmZpZy5wYXJzZVBsYXRmb3JtVGFnTmFtZSh0YWcpLCBkYXRhLCBjaGlsZHJlbiwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNvbnRleHQpOwogICAgfSBlbHNlIGlmICgoIWRhdGEgfHwgIWRhdGEucHJlKSAmJiBpc0RlZihDdG9yID0gcmVzb2x2ZUFzc2V0KGNvbnRleHQuJG9wdGlvbnMsICdjb21wb25lbnRzJywgdGFnKSkpIHsKICAgICAgLy8gY29tcG9uZW50CiAgICAgIHZub2RlID0gY3JlYXRlQ29tcG9uZW50KEN0b3IsIGRhdGEsIGNvbnRleHQsIGNoaWxkcmVuLCB0YWcpOwogICAgfSBlbHNlIHsKICAgICAgLy8gdW5rbm93biBvciB1bmxpc3RlZCBuYW1lc3BhY2VkIGVsZW1lbnRzCiAgICAgIC8vIGNoZWNrIGF0IHJ1bnRpbWUgYmVjYXVzZSBpdCBtYXkgZ2V0IGFzc2lnbmVkIGEgbmFtZXNwYWNlIHdoZW4gaXRzCiAgICAgIC8vIHBhcmVudCBub3JtYWxpemVzIGNoaWxkcmVuCiAgICAgIHZub2RlID0gbmV3IFZOb2RlKHRhZywgZGF0YSwgY2hpbGRyZW4sIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBjb250ZXh0KTsKICAgIH0KICB9IGVsc2UgewogICAgLy8gZGlyZWN0IGNvbXBvbmVudCBvcHRpb25zIC8gY29uc3RydWN0b3IKICAgIHZub2RlID0gY3JlYXRlQ29tcG9uZW50KHRhZywgZGF0YSwgY29udGV4dCwgY2hpbGRyZW4pOwogIH0KICBpZiAoaXNBcnJheSh2bm9kZSkpIHsKICAgIHJldHVybiB2bm9kZTsKICB9IGVsc2UgaWYgKGlzRGVmKHZub2RlKSkgewogICAgaWYgKGlzRGVmKG5zKSkgYXBwbHlOUyh2bm9kZSwgbnMpOwogICAgaWYgKGlzRGVmKGRhdGEpKSByZWdpc3RlckRlZXBCaW5kaW5ncyhkYXRhKTsKICAgIHJldHVybiB2bm9kZTsKICB9IGVsc2UgewogICAgcmV0dXJuIGNyZWF0ZUVtcHR5Vk5vZGUoKTsKICB9Cn0KZnVuY3Rpb24gYXBwbHlOUyh2bm9kZSwgbnMsIGZvcmNlKSB7CiAgdm5vZGUubnMgPSBuczsKICBpZiAodm5vZGUudGFnID09PSAnZm9yZWlnbk9iamVjdCcpIHsKICAgIC8vIHVzZSBkZWZhdWx0IG5hbWVzcGFjZSBpbnNpZGUgZm9yZWlnbk9iamVjdAogICAgbnMgPSB1bmRlZmluZWQ7CiAgICBmb3JjZSA9IHRydWU7CiAgfQogIGlmIChpc0RlZih2bm9kZS5jaGlsZHJlbikpIHsKICAgIGZvciAodmFyIGkgPSAwLCBsID0gdm5vZGUuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIHZhciBjaGlsZCA9IHZub2RlLmNoaWxkcmVuW2ldOwogICAgICBpZiAoaXNEZWYoY2hpbGQudGFnKSAmJiAoaXNVbmRlZihjaGlsZC5ucykgfHwgaXNUcnVlKGZvcmNlKSAmJiBjaGlsZC50YWcgIT09ICdzdmcnKSkgewogICAgICAgIGFwcGx5TlMoY2hpbGQsIG5zLCBmb3JjZSk7CiAgICAgIH0KICAgIH0KICB9Cn0KLy8gcmVmICM1MzE4Ci8vIG5lY2Vzc2FyeSB0byBlbnN1cmUgcGFyZW50IHJlLXJlbmRlciB3aGVuIGRlZXAgYmluZGluZ3MgbGlrZSA6c3R5bGUgYW5kCi8vIDpjbGFzcyBhcmUgdXNlZCBvbiBzbG90IG5vZGVzCmZ1bmN0aW9uIHJlZ2lzdGVyRGVlcEJpbmRpbmdzKGRhdGEpIHsKICBpZiAoaXNPYmplY3QoZGF0YS5zdHlsZSkpIHsKICAgIHRyYXZlcnNlKGRhdGEuc3R5bGUpOwogIH0KICBpZiAoaXNPYmplY3QoZGF0YS5jbGFzcykpIHsKICAgIHRyYXZlcnNlKGRhdGEuY2xhc3MpOwogIH0KfQoKLyoqCiAqIEBpbnRlcm5hbCB0aGlzIGZ1bmN0aW9uIG5lZWRzIG1hbnVhbCBwdWJsaWMgdHlwZSBkZWNsYXJhdGlvbiBiZWNhdXNlIGl0IHJlbGllcwogKiBvbiBwcmV2aW91c2x5IG1hbnVhbGx5IGF1dGhvcmVkIHR5cGVzIGZyb20gVnVlIDIKICovCmZ1bmN0aW9uIGgodHlwZSwgcHJvcHMsIGNoaWxkcmVuKSB7CiAgaWYgKCFjdXJyZW50SW5zdGFuY2UpIHsKICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgd2FybigiZ2xvYmFsbHkgaW1wb3J0ZWQgaCgpIGNhbiBvbmx5IGJlIGludm9rZWQgd2hlbiB0aGVyZSBpcyBhbiBhY3RpdmUgIiArICJjb21wb25lbnQgaW5zdGFuY2UsIGUuZy4gc3luY2hyb25vdXNseSBpbiBhIGNvbXBvbmVudCdzIHJlbmRlciBvciBzZXR1cCBmdW5jdGlvbi4iKTsKICB9CiAgcmV0dXJuIGNyZWF0ZUVsZW1lbnQkMShjdXJyZW50SW5zdGFuY2UsIHR5cGUsIHByb3BzLCBjaGlsZHJlbiwgMiwgdHJ1ZSk7Cn0KZnVuY3Rpb24gaGFuZGxlRXJyb3IoZXJyLCB2bSwgaW5mbykgewogIC8vIERlYWN0aXZhdGUgZGVwcyB0cmFja2luZyB3aGlsZSBwcm9jZXNzaW5nIGVycm9yIGhhbmRsZXIgdG8gYXZvaWQgcG9zc2libGUgaW5maW5pdGUgcmVuZGVyaW5nLgogIC8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL3Z1ZWpzL3Z1ZXgvaXNzdWVzLzE1MDUKICBwdXNoVGFyZ2V0KCk7CiAgdHJ5IHsKICAgIGlmICh2bSkgewogICAgICB2YXIgY3VyID0gdm07CiAgICAgIHdoaWxlIChjdXIgPSBjdXIuJHBhcmVudCkgewogICAgICAgIHZhciBob29rcyA9IGN1ci4kb3B0aW9ucy5lcnJvckNhcHR1cmVkOwogICAgICAgIGlmIChob29rcykgewogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBob29rcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHZhciBjYXB0dXJlID0gaG9va3NbaV0uY2FsbChjdXIsIGVyciwgdm0sIGluZm8pID09PSBmYWxzZTsKICAgICAgICAgICAgICBpZiAoY2FwdHVyZSkgcmV0dXJuOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgZ2xvYmFsSGFuZGxlRXJyb3IoZSwgY3VyLCAnZXJyb3JDYXB0dXJlZCBob29rJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGdsb2JhbEhhbmRsZUVycm9yKGVyciwgdm0sIGluZm8pOwogIH0gZmluYWxseSB7CiAgICBwb3BUYXJnZXQoKTsKICB9Cn0KZnVuY3Rpb24gaW52b2tlV2l0aEVycm9ySGFuZGxpbmcoaGFuZGxlciwgY29udGV4dCwgYXJncywgdm0sIGluZm8pIHsKICB2YXIgcmVzOwogIHRyeSB7CiAgICByZXMgPSBhcmdzID8gaGFuZGxlci5hcHBseShjb250ZXh0LCBhcmdzKSA6IGhhbmRsZXIuY2FsbChjb250ZXh0KTsKICAgIGlmIChyZXMgJiYgIXJlcy5faXNWdWUgJiYgaXNQcm9taXNlKHJlcykgJiYgIXJlcy5faGFuZGxlZCkgewogICAgICByZXMuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gaGFuZGxlRXJyb3IoZSwgdm0sIGluZm8gKyAiIChQcm9taXNlL2FzeW5jKSIpOwogICAgICB9KTsKICAgICAgcmVzLl9oYW5kbGVkID0gdHJ1ZTsKICAgIH0KICB9IGNhdGNoIChlKSB7CiAgICBoYW5kbGVFcnJvcihlLCB2bSwgaW5mbyk7CiAgfQogIHJldHVybiByZXM7Cn0KZnVuY3Rpb24gZ2xvYmFsSGFuZGxlRXJyb3IoZXJyLCB2bSwgaW5mbykgewogIGlmIChjb25maWcuZXJyb3JIYW5kbGVyKSB7CiAgICB0cnkgewogICAgICByZXR1cm4gY29uZmlnLmVycm9ySGFuZGxlci5jYWxsKG51bGwsIGVyciwgdm0sIGluZm8pOwogICAgfSBjYXRjaCAoZSkgewogICAgICAvLyBpZiB0aGUgdXNlciBpbnRlbnRpb25hbGx5IHRocm93cyB0aGUgb3JpZ2luYWwgZXJyb3IgaW4gdGhlIGhhbmRsZXIsCiAgICAgIC8vIGRvIG5vdCBsb2cgaXQgdHdpY2UKICAgICAgaWYgKGUgIT09IGVycikgewogICAgICAgIGxvZ0Vycm9yKGUsIG51bGwsICdjb25maWcuZXJyb3JIYW5kbGVyJyk7CiAgICAgIH0KICAgIH0KICB9CiAgbG9nRXJyb3IoZXJyLCB2bSwgaW5mbyk7Cn0KZnVuY3Rpb24gbG9nRXJyb3IoZXJyLCB2bSwgaW5mbykgewogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICB3YXJuKCJFcnJvciBpbiAiLmNvbmNhdChpbmZvLCAiOiBcIiIpLmNvbmNhdChlcnIudG9TdHJpbmcoKSwgIlwiIiksIHZtKTsKICB9CiAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8KICBpZiAoaW5Ccm93c2VyICYmIHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJykgewogICAgY29uc29sZS5lcnJvcihlcnIpOwogIH0gZWxzZSB7CiAgICB0aHJvdyBlcnI7CiAgfQp9CgovKiBnbG9iYWxzIE11dGF0aW9uT2JzZXJ2ZXIgKi8KdmFyIGlzVXNpbmdNaWNyb1Rhc2sgPSBmYWxzZTsKdmFyIGNhbGxiYWNrcyA9IFtdOwp2YXIgcGVuZGluZyA9IGZhbHNlOwpmdW5jdGlvbiBmbHVzaENhbGxiYWNrcygpIHsKICBwZW5kaW5nID0gZmFsc2U7CiAgdmFyIGNvcGllcyA9IGNhbGxiYWNrcy5zbGljZSgwKTsKICBjYWxsYmFja3MubGVuZ3RoID0gMDsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNvcGllcy5sZW5ndGg7IGkrKykgewogICAgY29waWVzW2ldKCk7CiAgfQp9Ci8vIEhlcmUgd2UgaGF2ZSBhc3luYyBkZWZlcnJpbmcgd3JhcHBlcnMgdXNpbmcgbWljcm90YXNrcy4KLy8gSW4gMi41IHdlIHVzZWQgKG1hY3JvKSB0YXNrcyAoaW4gY29tYmluYXRpb24gd2l0aCBtaWNyb3Rhc2tzKS4KLy8gSG93ZXZlciwgaXQgaGFzIHN1YnRsZSBwcm9ibGVtcyB3aGVuIHN0YXRlIGlzIGNoYW5nZWQgcmlnaHQgYmVmb3JlIHJlcGFpbnQKLy8gKGUuZy4gIzY4MTMsIG91dC1pbiB0cmFuc2l0aW9ucykuCi8vIEFsc28sIHVzaW5nIChtYWNybykgdGFza3MgaW4gZXZlbnQgaGFuZGxlciB3b3VsZCBjYXVzZSBzb21lIHdlaXJkIGJlaGF2aW9ycwovLyB0aGF0IGNhbm5vdCBiZSBjaXJjdW12ZW50ZWQgKGUuZy4gIzcxMDksICM3MTUzLCAjNzU0NiwgIzc4MzQsICM4MTA5KS4KLy8gU28gd2Ugbm93IHVzZSBtaWNyb3Rhc2tzIGV2ZXJ5d2hlcmUsIGFnYWluLgovLyBBIG1ham9yIGRyYXdiYWNrIG9mIHRoaXMgdHJhZGVvZmYgaXMgdGhhdCB0aGVyZSBhcmUgc29tZSBzY2VuYXJpb3MKLy8gd2hlcmUgbWljcm90YXNrcyBoYXZlIHRvbyBoaWdoIGEgcHJpb3JpdHkgYW5kIGZpcmUgaW4gYmV0d2VlbiBzdXBwb3NlZGx5Ci8vIHNlcXVlbnRpYWwgZXZlbnRzIChlLmcuICM0NTIxLCAjNjY5MCwgd2hpY2ggaGF2ZSB3b3JrYXJvdW5kcykKLy8gb3IgZXZlbiBiZXR3ZWVuIGJ1YmJsaW5nIG9mIHRoZSBzYW1lIGV2ZW50ICgjNjU2NikuCnZhciB0aW1lckZ1bmM7Ci8vIFRoZSBuZXh0VGljayBiZWhhdmlvciBsZXZlcmFnZXMgdGhlIG1pY3JvdGFzayBxdWV1ZSwgd2hpY2ggY2FuIGJlIGFjY2Vzc2VkCi8vIHZpYSBlaXRoZXIgbmF0aXZlIFByb21pc2UudGhlbiBvciBNdXRhdGlvbk9ic2VydmVyLgovLyBNdXRhdGlvbk9ic2VydmVyIGhhcyB3aWRlciBzdXBwb3J0LCBob3dldmVyIGl0IGlzIHNlcmlvdXNseSBidWdnZWQgaW4KLy8gVUlXZWJWaWV3IGluIGlPUyA+PSA5LjMuMyB3aGVuIHRyaWdnZXJlZCBpbiB0b3VjaCBldmVudCBoYW5kbGVycy4gSXQKLy8gY29tcGxldGVseSBzdG9wcyB3b3JraW5nIGFmdGVyIHRyaWdnZXJpbmcgYSBmZXcgdGltZXMuLi4gc28sIGlmIG5hdGl2ZQovLyBQcm9taXNlIGlzIGF2YWlsYWJsZSwgd2Ugd2lsbCB1c2UgaXQ6Ci8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0LCAkZmxvdy1kaXNhYmxlLWxpbmUgKi8KaWYgKHR5cGVvZiBQcm9taXNlICE9PSAndW5kZWZpbmVkJyAmJiBpc05hdGl2ZShQcm9taXNlKSkgewogIHZhciBwXzEgPSBQcm9taXNlLnJlc29sdmUoKTsKICB0aW1lckZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICBwXzEudGhlbihmbHVzaENhbGxiYWNrcyk7CiAgICAvLyBJbiBwcm9ibGVtYXRpYyBVSVdlYlZpZXdzLCBQcm9taXNlLnRoZW4gZG9lc24ndCBjb21wbGV0ZWx5IGJyZWFrLCBidXQKICAgIC8vIGl0IGNhbiBnZXQgc3R1Y2sgaW4gYSB3ZWlyZCBzdGF0ZSB3aGVyZSBjYWxsYmFja3MgYXJlIHB1c2hlZCBpbnRvIHRoZQogICAgLy8gbWljcm90YXNrIHF1ZXVlIGJ1dCB0aGUgcXVldWUgaXNuJ3QgYmVpbmcgZmx1c2hlZCwgdW50aWwgdGhlIGJyb3dzZXIKICAgIC8vIG5lZWRzIHRvIGRvIHNvbWUgb3RoZXIgd29yaywgZS5nLiBoYW5kbGUgYSB0aW1lci4gVGhlcmVmb3JlIHdlIGNhbgogICAgLy8gImZvcmNlIiB0aGUgbWljcm90YXNrIHF1ZXVlIHRvIGJlIGZsdXNoZWQgYnkgYWRkaW5nIGFuIGVtcHR5IHRpbWVyLgogICAgaWYgKGlzSU9TKSBzZXRUaW1lb3V0KG5vb3ApOwogIH07CiAgaXNVc2luZ01pY3JvVGFzayA9IHRydWU7Cn0gZWxzZSBpZiAoIWlzSUUgJiYgdHlwZW9mIE11dGF0aW9uT2JzZXJ2ZXIgIT09ICd1bmRlZmluZWQnICYmIChpc05hdGl2ZShNdXRhdGlvbk9ic2VydmVyKSB8fAovLyBQaGFudG9tSlMgYW5kIGlPUyA3LngKTXV0YXRpb25PYnNlcnZlci50b1N0cmluZygpID09PSAnW29iamVjdCBNdXRhdGlvbk9ic2VydmVyQ29uc3RydWN0b3JdJykpIHsKICAvLyBVc2UgTXV0YXRpb25PYnNlcnZlciB3aGVyZSBuYXRpdmUgUHJvbWlzZSBpcyBub3QgYXZhaWxhYmxlLAogIC8vIGUuZy4gUGhhbnRvbUpTLCBpT1M3LCBBbmRyb2lkIDQuNAogIC8vICgjNjQ2NiBNdXRhdGlvbk9ic2VydmVyIGlzIHVucmVsaWFibGUgaW4gSUUxMSkKICB2YXIgY291bnRlcl8xID0gMTsKICB2YXIgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmbHVzaENhbGxiYWNrcyk7CiAgdmFyIHRleHROb2RlXzEgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShTdHJpbmcoY291bnRlcl8xKSk7CiAgb2JzZXJ2ZXIub2JzZXJ2ZSh0ZXh0Tm9kZV8xLCB7CiAgICBjaGFyYWN0ZXJEYXRhOiB0cnVlCiAgfSk7CiAgdGltZXJGdW5jID0gZnVuY3Rpb24gKCkgewogICAgY291bnRlcl8xID0gKGNvdW50ZXJfMSArIDEpICUgMjsKICAgIHRleHROb2RlXzEuZGF0YSA9IFN0cmluZyhjb3VudGVyXzEpOwogIH07CiAgaXNVc2luZ01pY3JvVGFzayA9IHRydWU7Cn0gZWxzZSBpZiAodHlwZW9mIHNldEltbWVkaWF0ZSAhPT0gJ3VuZGVmaW5lZCcgJiYgaXNOYXRpdmUoc2V0SW1tZWRpYXRlKSkgewogIC8vIEZhbGxiYWNrIHRvIHNldEltbWVkaWF0ZS4KICAvLyBUZWNobmljYWxseSBpdCBsZXZlcmFnZXMgdGhlIChtYWNybykgdGFzayBxdWV1ZSwKICAvLyBidXQgaXQgaXMgc3RpbGwgYSBiZXR0ZXIgY2hvaWNlIHRoYW4gc2V0VGltZW91dC4KICB0aW1lckZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICBzZXRJbW1lZGlhdGUoZmx1c2hDYWxsYmFja3MpOwogIH07Cn0gZWxzZSB7CiAgLy8gRmFsbGJhY2sgdG8gc2V0VGltZW91dC4KICB0aW1lckZ1bmMgPSBmdW5jdGlvbiAoKSB7CiAgICBzZXRUaW1lb3V0KGZsdXNoQ2FsbGJhY2tzLCAwKTsKICB9Owp9Ci8qKgogKiBAaW50ZXJuYWwKICovCmZ1bmN0aW9uIG5leHRUaWNrKGNiLCBjdHgpIHsKICB2YXIgX3Jlc29sdmU7CiAgY2FsbGJhY2tzLnB1c2goZnVuY3Rpb24gKCkgewogICAgaWYgKGNiKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY2IuY2FsbChjdHgpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgaGFuZGxlRXJyb3IoZSwgY3R4LCAnbmV4dFRpY2snKTsKICAgICAgfQogICAgfSBlbHNlIGlmIChfcmVzb2x2ZSkgewogICAgICBfcmVzb2x2ZShjdHgpOwogICAgfQogIH0pOwogIGlmICghcGVuZGluZykgewogICAgcGVuZGluZyA9IHRydWU7CiAgICB0aW1lckZ1bmMoKTsKICB9CiAgLy8gJGZsb3ctZGlzYWJsZS1saW5lCiAgaWYgKCFjYiAmJiB0eXBlb2YgUHJvbWlzZSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICBfcmVzb2x2ZSA9IHJlc29sdmU7CiAgICB9KTsKICB9Cn0KZnVuY3Rpb24gdXNlQ3NzTW9kdWxlKG5hbWUpIHsKICBpZiAobmFtZSA9PT0gdm9pZCAwKSB7CiAgICBuYW1lID0gJyRzdHlsZSc7CiAgfQogIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovCiAgewogICAgaWYgKCFjdXJyZW50SW5zdGFuY2UpIHsKICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuKCJ1c2VDc3NNb2R1bGUgbXVzdCBiZSBjYWxsZWQgaW5zaWRlIHNldHVwKCkiKTsKICAgICAgcmV0dXJuIGVtcHR5T2JqZWN0OwogICAgfQogICAgdmFyIG1vZCA9IGN1cnJlbnRJbnN0YW5jZVtuYW1lXTsKICAgIGlmICghbW9kKSB7CiAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgd2FybigiQ3VycmVudCBpbnN0YW5jZSBkb2VzIG5vdCBoYXZlIENTUyBtb2R1bGUgbmFtZWQgXCIiLmNvbmNhdChuYW1lLCAiXCIuIikpOwogICAgICByZXR1cm4gZW1wdHlPYmplY3Q7CiAgICB9CiAgICByZXR1cm4gbW9kOwogIH0KfQoKLyoqCiAqIFJ1bnRpbWUgaGVscGVyIGZvciBTRkMncyBDU1MgdmFyaWFibGUgaW5qZWN0aW9uIGZlYXR1cmUuCiAqIEBwcml2YXRlCiAqLwpmdW5jdGlvbiB1c2VDc3NWYXJzKGdldHRlcikgewogIGlmICghaW5Ccm93c2VyICYmICFmYWxzZSkgcmV0dXJuOwogIHZhciBpbnN0YW5jZSA9IGN1cnJlbnRJbnN0YW5jZTsKICBpZiAoIWluc3RhbmNlKSB7CiAgICBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm4oInVzZUNzc1ZhcnMgaXMgY2FsbGVkIHdpdGhvdXQgY3VycmVudCBhY3RpdmUgY29tcG9uZW50IGluc3RhbmNlLiIpOwogICAgcmV0dXJuOwogIH0KICB3YXRjaFBvc3RFZmZlY3QoZnVuY3Rpb24gKCkgewogICAgdmFyIGVsID0gaW5zdGFuY2UuJGVsOwogICAgdmFyIHZhcnMgPSBnZXR0ZXIoaW5zdGFuY2UsIGluc3RhbmNlLl9zZXR1cFByb3h5KTsKICAgIGlmIChlbCAmJiBlbC5ub2RlVHlwZSA9PT0gMSkgewogICAgICB2YXIgc3R5bGUgPSBlbC5zdHlsZTsKICAgICAgZm9yICh2YXIga2V5IGluIHZhcnMpIHsKICAgICAgICBzdHlsZS5zZXRQcm9wZXJ0eSgiLS0iLmNvbmNhdChrZXkpLCB2YXJzW2tleV0pOwogICAgICB9CiAgICB9CiAgfSk7Cn0KCi8qKgogKiB2My1jb21wYXRpYmxlIGFzeW5jIGNvbXBvbmVudCBBUEkuCiAqIEBpbnRlcm5hbCB0aGUgdHlwZSBpcyBtYW51YWxseSBkZWNsYXJlZCBpbiA8cm9vdD4vdHlwZXMvdjMtZGVmaW5lLWFzeW5jLWNvbXBvbmVudC5kLnRzCiAqIGJlY2F1c2UgaXQgcmVsaWVzIG9uIGV4aXN0aW5nIG1hbnVhbCB0eXBlcwogKi8KZnVuY3Rpb24gZGVmaW5lQXN5bmNDb21wb25lbnQoc291cmNlKSB7CiAgaWYgKGlzRnVuY3Rpb24oc291cmNlKSkgewogICAgc291cmNlID0gewogICAgICBsb2FkZXI6IHNvdXJjZQogICAgfTsKICB9CiAgdmFyIGxvYWRlciA9IHNvdXJjZS5sb2FkZXIsCiAgICBsb2FkaW5nQ29tcG9uZW50ID0gc291cmNlLmxvYWRpbmdDb21wb25lbnQsCiAgICBlcnJvckNvbXBvbmVudCA9IHNvdXJjZS5lcnJvckNvbXBvbmVudCwKICAgIF9hID0gc291cmNlLmRlbGF5LAogICAgZGVsYXkgPSBfYSA9PT0gdm9pZCAwID8gMjAwIDogX2EsCiAgICB0aW1lb3V0ID0gc291cmNlLnRpbWVvdXQsCiAgICAvLyB1bmRlZmluZWQgPSBuZXZlciB0aW1lcyBvdXQKICAgIF9iID0gc291cmNlLnN1c3BlbnNpYmxlLAogICAgLy8gdW5kZWZpbmVkID0gbmV2ZXIgdGltZXMgb3V0CiAgICBzdXNwZW5zaWJsZSA9IF9iID09PSB2b2lkIDAgPyBmYWxzZSA6IF9iLAogICAgLy8gaW4gVnVlIDMgZGVmYXVsdCBpcyB0cnVlCiAgICB1c2VyT25FcnJvciA9IHNvdXJjZS5vbkVycm9yOwogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHN1c3BlbnNpYmxlKSB7CiAgICB3YXJuKCJUaGUgc3VzcGVuc2libGUgb3B0aW9uIGZvciBhc3luYyBjb21wb25lbnRzIGlzIG5vdCBzdXBwb3J0ZWQgaW4gVnVlMi4gSXQgaXMgaWdub3JlZC4iKTsKICB9CiAgdmFyIHBlbmRpbmdSZXF1ZXN0ID0gbnVsbDsKICB2YXIgcmV0cmllcyA9IDA7CiAgdmFyIHJldHJ5ID0gZnVuY3Rpb24gKCkgewogICAgcmV0cmllcysrOwogICAgcGVuZGluZ1JlcXVlc3QgPSBudWxsOwogICAgcmV0dXJuIGxvYWQoKTsKICB9OwogIHZhciBsb2FkID0gZnVuY3Rpb24gKCkgewogICAgdmFyIHRoaXNSZXF1ZXN0OwogICAgcmV0dXJuIHBlbmRpbmdSZXF1ZXN0IHx8ICh0aGlzUmVxdWVzdCA9IHBlbmRpbmdSZXF1ZXN0ID0gbG9hZGVyKCkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICBlcnIgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyKSk7CiAgICAgIGlmICh1c2VyT25FcnJvcikgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICB2YXIgdXNlclJldHJ5ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShyZXRyeSgpKTsKICAgICAgICAgIH07CiAgICAgICAgICB2YXIgdXNlckZhaWwgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTsKICAgICAgICAgIH07CiAgICAgICAgICB1c2VyT25FcnJvcihlcnIsIHVzZXJSZXRyeSwgdXNlckZhaWwsIHJldHJpZXMgKyAxKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBlcnI7CiAgICAgIH0KICAgIH0pLnRoZW4oZnVuY3Rpb24gKGNvbXApIHsKICAgICAgaWYgKHRoaXNSZXF1ZXN0ICE9PSBwZW5kaW5nUmVxdWVzdCAmJiBwZW5kaW5nUmVxdWVzdCkgewogICAgICAgIHJldHVybiBwZW5kaW5nUmVxdWVzdDsKICAgICAgfQogICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiAhY29tcCkgewogICAgICAgIHdhcm4oIkFzeW5jIGNvbXBvbmVudCBsb2FkZXIgcmVzb2x2ZWQgdG8gdW5kZWZpbmVkLiAiICsgIklmIHlvdSBhcmUgdXNpbmcgcmV0cnkoKSwgbWFrZSBzdXJlIHRvIHJldHVybiBpdHMgcmV0dXJuIHZhbHVlLiIpOwogICAgICB9CiAgICAgIC8vIGludGVyb3AgbW9kdWxlIGRlZmF1bHQKICAgICAgaWYgKGNvbXAgJiYgKGNvbXAuX19lc01vZHVsZSB8fCBjb21wW1N5bWJvbC50b1N0cmluZ1RhZ10gPT09ICdNb2R1bGUnKSkgewogICAgICAgIGNvbXAgPSBjb21wLmRlZmF1bHQ7CiAgICAgIH0KICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgY29tcCAmJiAhaXNPYmplY3QoY29tcCkgJiYgIWlzRnVuY3Rpb24oY29tcCkpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgYXN5bmMgY29tcG9uZW50IGxvYWQgcmVzdWx0OiAiLmNvbmNhdChjb21wKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGNvbXA7CiAgICB9KSk7CiAgfTsKICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgdmFyIGNvbXBvbmVudCA9IGxvYWQoKTsKICAgIHJldHVybiB7CiAgICAgIGNvbXBvbmVudDogY29tcG9uZW50LAogICAgICBkZWxheTogZGVsYXksCiAgICAgIHRpbWVvdXQ6IHRpbWVvdXQsCiAgICAgIGVycm9yOiBlcnJvckNvbXBvbmVudCwKICAgICAgbG9hZGluZzogbG9hZGluZ0NvbXBvbmVudAogICAgfTsKICB9Owp9CmZ1bmN0aW9uIGNyZWF0ZUxpZmVDeWNsZShob29rTmFtZSkgewogIHJldHVybiBmdW5jdGlvbiAoZm4sIHRhcmdldCkgewogICAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICAgIHRhcmdldCA9IGN1cnJlbnRJbnN0YW5jZTsKICAgIH0KICAgIGlmICghdGFyZ2V0KSB7CiAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgd2FybigiIi5jb25jYXQoZm9ybWF0TmFtZShob29rTmFtZSksICIgaXMgY2FsbGVkIHdoZW4gdGhlcmUgaXMgbm8gYWN0aXZlIGNvbXBvbmVudCBpbnN0YW5jZSB0byBiZSAiKSArICJhc3NvY2lhdGVkIHdpdGguICIgKyAiTGlmZWN5Y2xlIGluamVjdGlvbiBBUElzIGNhbiBvbmx5IGJlIHVzZWQgZHVyaW5nIGV4ZWN1dGlvbiBvZiBzZXR1cCgpLiIpOwogICAgICByZXR1cm47CiAgICB9CiAgICByZXR1cm4gaW5qZWN0SG9vayh0YXJnZXQsIGhvb2tOYW1lLCBmbik7CiAgfTsKfQpmdW5jdGlvbiBmb3JtYXROYW1lKG5hbWUpIHsKICBpZiAobmFtZSA9PT0gJ2JlZm9yZURlc3Ryb3knKSB7CiAgICBuYW1lID0gJ2JlZm9yZVVubW91bnQnOwogIH0gZWxzZSBpZiAobmFtZSA9PT0gJ2Rlc3Ryb3llZCcpIHsKICAgIG5hbWUgPSAndW5tb3VudGVkJzsKICB9CiAgcmV0dXJuICJvbiIuY29uY2F0KG5hbWVbMF0udG9VcHBlckNhc2UoKSArIG5hbWUuc2xpY2UoMSkpOwp9CmZ1bmN0aW9uIGluamVjdEhvb2soaW5zdGFuY2UsIGhvb2tOYW1lLCBmbikgewogIHZhciBvcHRpb25zID0gaW5zdGFuY2UuJG9wdGlvbnM7CiAgb3B0aW9uc1tob29rTmFtZV0gPSBtZXJnZUxpZmVjeWNsZUhvb2sob3B0aW9uc1tob29rTmFtZV0sIGZuKTsKfQp2YXIgb25CZWZvcmVNb3VudCA9IGNyZWF0ZUxpZmVDeWNsZSgnYmVmb3JlTW91bnQnKTsKdmFyIG9uTW91bnRlZCA9IGNyZWF0ZUxpZmVDeWNsZSgnbW91bnRlZCcpOwp2YXIgb25CZWZvcmVVcGRhdGUgPSBjcmVhdGVMaWZlQ3ljbGUoJ2JlZm9yZVVwZGF0ZScpOwp2YXIgb25VcGRhdGVkID0gY3JlYXRlTGlmZUN5Y2xlKCd1cGRhdGVkJyk7CnZhciBvbkJlZm9yZVVubW91bnQgPSBjcmVhdGVMaWZlQ3ljbGUoJ2JlZm9yZURlc3Ryb3knKTsKdmFyIG9uVW5tb3VudGVkID0gY3JlYXRlTGlmZUN5Y2xlKCdkZXN0cm95ZWQnKTsKdmFyIG9uQWN0aXZhdGVkID0gY3JlYXRlTGlmZUN5Y2xlKCdhY3RpdmF0ZWQnKTsKdmFyIG9uRGVhY3RpdmF0ZWQgPSBjcmVhdGVMaWZlQ3ljbGUoJ2RlYWN0aXZhdGVkJyk7CnZhciBvblNlcnZlclByZWZldGNoID0gY3JlYXRlTGlmZUN5Y2xlKCdzZXJ2ZXJQcmVmZXRjaCcpOwp2YXIgb25SZW5kZXJUcmFja2VkID0gY3JlYXRlTGlmZUN5Y2xlKCdyZW5kZXJUcmFja2VkJyk7CnZhciBvblJlbmRlclRyaWdnZXJlZCA9IGNyZWF0ZUxpZmVDeWNsZSgncmVuZGVyVHJpZ2dlcmVkJyk7CnZhciBpbmplY3RFcnJvckNhcHR1cmVkSG9vayA9IGNyZWF0ZUxpZmVDeWNsZSgnZXJyb3JDYXB0dXJlZCcpOwpmdW5jdGlvbiBvbkVycm9yQ2FwdHVyZWQoaG9vaywgdGFyZ2V0KSB7CiAgaWYgKHRhcmdldCA9PT0gdm9pZCAwKSB7CiAgICB0YXJnZXQgPSBjdXJyZW50SW5zdGFuY2U7CiAgfQogIGluamVjdEVycm9yQ2FwdHVyZWRIb29rKGhvb2ssIHRhcmdldCk7Cn0KCi8qKgogKiBOb3RlOiBhbHNvIHVwZGF0ZSBkaXN0L3Z1ZS5ydW50aW1lLm1qcyB3aGVuIGFkZGluZyBuZXcgZXhwb3J0cyB0byB0aGlzIGZpbGUuCiAqLwp2YXIgdmVyc2lvbiA9ICcyLjcuMTYnOwovKioKICogQGludGVybmFsIHR5cGUgaXMgbWFudWFsbHkgZGVjbGFyZWQgaW4gPHJvb3Q+L3R5cGVzL3YzLWRlZmluZS1jb21wb25lbnQuZC50cwogKi8KZnVuY3Rpb24gZGVmaW5lQ29tcG9uZW50KG9wdGlvbnMpIHsKICByZXR1cm4gb3B0aW9uczsKfQp2YXIgc2Vlbk9iamVjdHMgPSBuZXcgX1NldCgpOwovKioKICogUmVjdXJzaXZlbHkgdHJhdmVyc2UgYW4gb2JqZWN0IHRvIGV2b2tlIGFsbCBjb252ZXJ0ZWQKICogZ2V0dGVycywgc28gdGhhdCBldmVyeSBuZXN0ZWQgcHJvcGVydHkgaW5zaWRlIHRoZSBvYmplY3QKICogaXMgY29sbGVjdGVkIGFzIGEgImRlZXAiIGRlcGVuZGVuY3kuCiAqLwpmdW5jdGlvbiB0cmF2ZXJzZSh2YWwpIHsKICBfdHJhdmVyc2UodmFsLCBzZWVuT2JqZWN0cyk7CiAgc2Vlbk9iamVjdHMuY2xlYXIoKTsKICByZXR1cm4gdmFsOwp9CmZ1bmN0aW9uIF90cmF2ZXJzZSh2YWwsIHNlZW4pIHsKICB2YXIgaSwga2V5czsKICB2YXIgaXNBID0gaXNBcnJheSh2YWwpOwogIGlmICghaXNBICYmICFpc09iamVjdCh2YWwpIHx8IHZhbC5fX3Zfc2tpcCAvKiBSZWFjdGl2ZUZsYWdzLlNLSVAgKi8gfHwgT2JqZWN0LmlzRnJvemVuKHZhbCkgfHwgdmFsIGluc3RhbmNlb2YgVk5vZGUpIHsKICAgIHJldHVybjsKICB9CiAgaWYgKHZhbC5fX29iX18pIHsKICAgIHZhciBkZXBJZCA9IHZhbC5fX29iX18uZGVwLmlkOwogICAgaWYgKHNlZW4uaGFzKGRlcElkKSkgewogICAgICByZXR1cm47CiAgICB9CiAgICBzZWVuLmFkZChkZXBJZCk7CiAgfQogIGlmIChpc0EpIHsKICAgIGkgPSB2YWwubGVuZ3RoOwogICAgd2hpbGUgKGktLSkgX3RyYXZlcnNlKHZhbFtpXSwgc2Vlbik7CiAgfSBlbHNlIGlmIChpc1JlZih2YWwpKSB7CiAgICBfdHJhdmVyc2UodmFsLnZhbHVlLCBzZWVuKTsKICB9IGVsc2UgewogICAga2V5cyA9IE9iamVjdC5rZXlzKHZhbCk7CiAgICBpID0ga2V5cy5sZW5ndGg7CiAgICB3aGlsZSAoaS0tKSBfdHJhdmVyc2UodmFsW2tleXNbaV1dLCBzZWVuKTsKICB9Cn0KdmFyIHVpZCQxID0gMDsKLyoqCiAqIEEgd2F0Y2hlciBwYXJzZXMgYW4gZXhwcmVzc2lvbiwgY29sbGVjdHMgZGVwZW5kZW5jaWVzLAogKiBhbmQgZmlyZXMgY2FsbGJhY2sgd2hlbiB0aGUgZXhwcmVzc2lvbiB2YWx1ZSBjaGFuZ2VzLgogKiBUaGlzIGlzIHVzZWQgZm9yIGJvdGggdGhlICR3YXRjaCgpIGFwaSBhbmQgZGlyZWN0aXZlcy4KICogQGludGVybmFsCiAqLwp2YXIgV2F0Y2hlciA9IC8qKiBAY2xhc3MgKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gV2F0Y2hlcih2bSwgZXhwT3JGbiwgY2IsIG9wdGlvbnMsIGlzUmVuZGVyV2F0Y2hlcikgewogICAgcmVjb3JkRWZmZWN0U2NvcGUodGhpcywKICAgIC8vIGlmIHRoZSBhY3RpdmUgZWZmZWN0IHNjb3BlIGlzIG1hbnVhbGx5IGNyZWF0ZWQgKG5vdCBhIGNvbXBvbmVudCBzY29wZSksCiAgICAvLyBwcmlvcml0aXplIGl0CiAgICBhY3RpdmVFZmZlY3RTY29wZSAmJiAhYWN0aXZlRWZmZWN0U2NvcGUuX3ZtID8gYWN0aXZlRWZmZWN0U2NvcGUgOiB2bSA/IHZtLl9zY29wZSA6IHVuZGVmaW5lZCk7CiAgICBpZiAoKHRoaXMudm0gPSB2bSkgJiYgaXNSZW5kZXJXYXRjaGVyKSB7CiAgICAgIHZtLl93YXRjaGVyID0gdGhpczsKICAgIH0KICAgIC8vIG9wdGlvbnMKICAgIGlmIChvcHRpb25zKSB7CiAgICAgIHRoaXMuZGVlcCA9ICEhb3B0aW9ucy5kZWVwOwogICAgICB0aGlzLnVzZXIgPSAhIW9wdGlvbnMudXNlcjsKICAgICAgdGhpcy5sYXp5ID0gISFvcHRpb25zLmxhenk7CiAgICAgIHRoaXMuc3luYyA9ICEhb3B0aW9ucy5zeW5jOwogICAgICB0aGlzLmJlZm9yZSA9IG9wdGlvbnMuYmVmb3JlOwogICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICAgIHRoaXMub25UcmFjayA9IG9wdGlvbnMub25UcmFjazsKICAgICAgICB0aGlzLm9uVHJpZ2dlciA9IG9wdGlvbnMub25UcmlnZ2VyOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRlZXAgPSB0aGlzLnVzZXIgPSB0aGlzLmxhenkgPSB0aGlzLnN5bmMgPSBmYWxzZTsKICAgIH0KICAgIHRoaXMuY2IgPSBjYjsKICAgIHRoaXMuaWQgPSArK3VpZCQxOyAvLyB1aWQgZm9yIGJhdGNoaW5nCiAgICB0aGlzLmFjdGl2ZSA9IHRydWU7CiAgICB0aGlzLnBvc3QgPSBmYWxzZTsKICAgIHRoaXMuZGlydHkgPSB0aGlzLmxhenk7IC8vIGZvciBsYXp5IHdhdGNoZXJzCiAgICB0aGlzLmRlcHMgPSBbXTsKICAgIHRoaXMubmV3RGVwcyA9IFtdOwogICAgdGhpcy5kZXBJZHMgPSBuZXcgX1NldCgpOwogICAgdGhpcy5uZXdEZXBJZHMgPSBuZXcgX1NldCgpOwogICAgdGhpcy5leHByZXNzaW9uID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyA/IGV4cE9yRm4udG9TdHJpbmcoKSA6ICcnOwogICAgLy8gcGFyc2UgZXhwcmVzc2lvbiBmb3IgZ2V0dGVyCiAgICBpZiAoaXNGdW5jdGlvbihleHBPckZuKSkgewogICAgICB0aGlzLmdldHRlciA9IGV4cE9yRm47CiAgICB9IGVsc2UgewogICAgICB0aGlzLmdldHRlciA9IHBhcnNlUGF0aChleHBPckZuKTsKICAgICAgaWYgKCF0aGlzLmdldHRlcikgewogICAgICAgIHRoaXMuZ2V0dGVyID0gbm9vcDsKICAgICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm4oIkZhaWxlZCB3YXRjaGluZyBwYXRoOiBcIiIuY29uY2F0KGV4cE9yRm4sICJcIiAiKSArICdXYXRjaGVyIG9ubHkgYWNjZXB0cyBzaW1wbGUgZG90LWRlbGltaXRlZCBwYXRocy4gJyArICdGb3IgZnVsbCBjb250cm9sLCB1c2UgYSBmdW5jdGlvbiBpbnN0ZWFkLicsIHZtKTsKICAgICAgfQogICAgfQogICAgdGhpcy52YWx1ZSA9IHRoaXMubGF6eSA/IHVuZGVmaW5lZCA6IHRoaXMuZ2V0KCk7CiAgfQogIC8qKgogICAqIEV2YWx1YXRlIHRoZSBnZXR0ZXIsIGFuZCByZS1jb2xsZWN0IGRlcGVuZGVuY2llcy4KICAgKi8KICBXYXRjaGVyLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoKSB7CiAgICBwdXNoVGFyZ2V0KHRoaXMpOwogICAgdmFyIHZhbHVlOwogICAgdmFyIHZtID0gdGhpcy52bTsKICAgIHRyeSB7CiAgICAgIHZhbHVlID0gdGhpcy5nZXR0ZXIuY2FsbCh2bSwgdm0pOwogICAgfSBjYXRjaCAoZSkgewogICAgICBpZiAodGhpcy51c2VyKSB7CiAgICAgICAgaGFuZGxlRXJyb3IoZSwgdm0sICJnZXR0ZXIgZm9yIHdhdGNoZXIgXCIiLmNvbmNhdCh0aGlzLmV4cHJlc3Npb24sICJcIiIpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBlOwogICAgICB9CiAgICB9IGZpbmFsbHkgewogICAgICAvLyAidG91Y2giIGV2ZXJ5IHByb3BlcnR5IHNvIHRoZXkgYXJlIGFsbCB0cmFja2VkIGFzCiAgICAgIC8vIGRlcGVuZGVuY2llcyBmb3IgZGVlcCB3YXRjaGluZwogICAgICBpZiAodGhpcy5kZWVwKSB7CiAgICAgICAgdHJhdmVyc2UodmFsdWUpOwogICAgICB9CiAgICAgIHBvcFRhcmdldCgpOwogICAgICB0aGlzLmNsZWFudXBEZXBzKCk7CiAgICB9CiAgICByZXR1cm4gdmFsdWU7CiAgfTsKICAvKioKICAgKiBBZGQgYSBkZXBlbmRlbmN5IHRvIHRoaXMgZGlyZWN0aXZlLgogICAqLwogIFdhdGNoZXIucHJvdG90eXBlLmFkZERlcCA9IGZ1bmN0aW9uIChkZXApIHsKICAgIHZhciBpZCA9IGRlcC5pZDsKICAgIGlmICghdGhpcy5uZXdEZXBJZHMuaGFzKGlkKSkgewogICAgICB0aGlzLm5ld0RlcElkcy5hZGQoaWQpOwogICAgICB0aGlzLm5ld0RlcHMucHVzaChkZXApOwogICAgICBpZiAoIXRoaXMuZGVwSWRzLmhhcyhpZCkpIHsKICAgICAgICBkZXAuYWRkU3ViKHRoaXMpOwogICAgICB9CiAgICB9CiAgfTsKICAvKioKICAgKiBDbGVhbiB1cCBmb3IgZGVwZW5kZW5jeSBjb2xsZWN0aW9uLgogICAqLwogIFdhdGNoZXIucHJvdG90eXBlLmNsZWFudXBEZXBzID0gZnVuY3Rpb24gKCkgewogICAgdmFyIGkgPSB0aGlzLmRlcHMubGVuZ3RoOwogICAgd2hpbGUgKGktLSkgewogICAgICB2YXIgZGVwID0gdGhpcy5kZXBzW2ldOwogICAgICBpZiAoIXRoaXMubmV3RGVwSWRzLmhhcyhkZXAuaWQpKSB7CiAgICAgICAgZGVwLnJlbW92ZVN1Yih0aGlzKTsKICAgICAgfQogICAgfQogICAgdmFyIHRtcCA9IHRoaXMuZGVwSWRzOwogICAgdGhpcy5kZXBJZHMgPSB0aGlzLm5ld0RlcElkczsKICAgIHRoaXMubmV3RGVwSWRzID0gdG1wOwogICAgdGhpcy5uZXdEZXBJZHMuY2xlYXIoKTsKICAgIHRtcCA9IHRoaXMuZGVwczsKICAgIHRoaXMuZGVwcyA9IHRoaXMubmV3RGVwczsKICAgIHRoaXMubmV3RGVwcyA9IHRtcDsKICAgIHRoaXMubmV3RGVwcy5sZW5ndGggPSAwOwogIH07CiAgLyoqCiAgICogU3Vic2NyaWJlciBpbnRlcmZhY2UuCiAgICogV2lsbCBiZSBjYWxsZWQgd2hlbiBhIGRlcGVuZGVuY3kgY2hhbmdlcy4KICAgKi8KICBXYXRjaGVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7CiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqLwogICAgaWYgKHRoaXMubGF6eSkgewogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0gZWxzZSBpZiAodGhpcy5zeW5jKSB7CiAgICAgIHRoaXMucnVuKCk7CiAgICB9IGVsc2UgewogICAgICBxdWV1ZVdhdGNoZXIodGhpcyk7CiAgICB9CiAgfTsKICAvKioKICAgKiBTY2hlZHVsZXIgam9iIGludGVyZmFjZS4KICAgKiBXaWxsIGJlIGNhbGxlZCBieSB0aGUgc2NoZWR1bGVyLgogICAqLwogIFdhdGNoZXIucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLmFjdGl2ZSkgewogICAgICB2YXIgdmFsdWUgPSB0aGlzLmdldCgpOwogICAgICBpZiAodmFsdWUgIT09IHRoaXMudmFsdWUgfHwKICAgICAgLy8gRGVlcCB3YXRjaGVycyBhbmQgd2F0Y2hlcnMgb24gT2JqZWN0L0FycmF5cyBzaG91bGQgZmlyZSBldmVuCiAgICAgIC8vIHdoZW4gdGhlIHZhbHVlIGlzIHRoZSBzYW1lLCBiZWNhdXNlIHRoZSB2YWx1ZSBtYXkKICAgICAgLy8gaGF2ZSBtdXRhdGVkLgogICAgICBpc09iamVjdCh2YWx1ZSkgfHwgdGhpcy5kZWVwKSB7CiAgICAgICAgLy8gc2V0IG5ldyB2YWx1ZQogICAgICAgIHZhciBvbGRWYWx1ZSA9IHRoaXMudmFsdWU7CiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlOwogICAgICAgIGlmICh0aGlzLnVzZXIpIHsKICAgICAgICAgIHZhciBpbmZvID0gImNhbGxiYWNrIGZvciB3YXRjaGVyIFwiIi5jb25jYXQodGhpcy5leHByZXNzaW9uLCAiXCIiKTsKICAgICAgICAgIGludm9rZVdpdGhFcnJvckhhbmRsaW5nKHRoaXMuY2IsIHRoaXMudm0sIFt2YWx1ZSwgb2xkVmFsdWVdLCB0aGlzLnZtLCBpbmZvKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5jYi5jYWxsKHRoaXMudm0sIHZhbHVlLCBvbGRWYWx1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfTsKICAvKioKICAgKiBFdmFsdWF0ZSB0aGUgdmFsdWUgb2YgdGhlIHdhdGNoZXIuCiAgICogVGhpcyBvbmx5IGdldHMgY2FsbGVkIGZvciBsYXp5IHdhdGNoZXJzLgogICAqLwogIFdhdGNoZXIucHJvdG90eXBlLmV2YWx1YXRlID0gZnVuY3Rpb24gKCkgewogICAgdGhpcy52YWx1ZSA9IHRoaXMuZ2V0KCk7CiAgICB0aGlzLmRpcnR5ID0gZmFsc2U7CiAgfTsKICAvKioKICAgKiBEZXBlbmQgb24gYWxsIGRlcHMgY29sbGVjdGVkIGJ5IHRoaXMgd2F0Y2hlci4KICAgKi8KICBXYXRjaGVyLnByb3RvdHlwZS5kZXBlbmQgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgaSA9IHRoaXMuZGVwcy5sZW5ndGg7CiAgICB3aGlsZSAoaS0tKSB7CiAgICAgIHRoaXMuZGVwc1tpXS5kZXBlbmQoKTsKICAgIH0KICB9OwogIC8qKgogICAqIFJlbW92ZSBzZWxmIGZyb20gYWxsIGRlcGVuZGVuY2llcycgc3Vic2NyaWJlciBsaXN0LgogICAqLwogIFdhdGNoZXIucHJvdG90eXBlLnRlYXJkb3duID0gZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMudm0gJiYgIXRoaXMudm0uX2lzQmVpbmdEZXN0cm95ZWQpIHsKICAgICAgcmVtb3ZlJDIodGhpcy52bS5fc2NvcGUuZWZmZWN0cywgdGhpcyk7CiAgICB9CiAgICBpZiAodGhpcy5hY3RpdmUpIHsKICAgICAgdmFyIGkgPSB0aGlzLmRlcHMubGVuZ3RoOwogICAgICB3aGlsZSAoaS0tKSB7CiAgICAgICAgdGhpcy5kZXBzW2ldLnJlbW92ZVN1Yih0aGlzKTsKICAgICAgfQogICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlOwogICAgICBpZiAodGhpcy5vblN0b3ApIHsKICAgICAgICB0aGlzLm9uU3RvcCgpOwogICAgICB9CiAgICB9CiAgfTsKICByZXR1cm4gV2F0Y2hlcjsKfSgpOwp2YXIgbWFyazsKdmFyIG1lYXN1cmU7CmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgdmFyIHBlcmZfMSA9IGluQnJvd3NlciAmJiB3aW5kb3cucGVyZm9ybWFuY2U7CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKHBlcmZfMSAmJgogIC8vIEB0cy1pZ25vcmUKICBwZXJmXzEubWFyayAmJgogIC8vIEB0cy1pZ25vcmUKICBwZXJmXzEubWVhc3VyZSAmJgogIC8vIEB0cy1pZ25vcmUKICBwZXJmXzEuY2xlYXJNYXJrcyAmJgogIC8vIEB0cy1pZ25vcmUKICBwZXJmXzEuY2xlYXJNZWFzdXJlcykgewogICAgbWFyayA9IGZ1bmN0aW9uICh0YWcpIHsKICAgICAgcmV0dXJuIHBlcmZfMS5tYXJrKHRhZyk7CiAgICB9OwogICAgbWVhc3VyZSA9IGZ1bmN0aW9uIChuYW1lLCBzdGFydFRhZywgZW5kVGFnKSB7CiAgICAgIHBlcmZfMS5tZWFzdXJlKG5hbWUsIHN0YXJ0VGFnLCBlbmRUYWcpOwogICAgICBwZXJmXzEuY2xlYXJNYXJrcyhzdGFydFRhZyk7CiAgICAgIHBlcmZfMS5jbGVhck1hcmtzKGVuZFRhZyk7CiAgICAgIC8vIHBlcmYuY2xlYXJNZWFzdXJlcyhuYW1lKQogICAgfTsKICB9Cn0KZnVuY3Rpb24gaW5pdEV2ZW50cyh2bSkgewogIHZtLl9ldmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIHZtLl9oYXNIb29rRXZlbnQgPSBmYWxzZTsKICAvLyBpbml0IHBhcmVudCBhdHRhY2hlZCBldmVudHMKICB2YXIgbGlzdGVuZXJzID0gdm0uJG9wdGlvbnMuX3BhcmVudExpc3RlbmVyczsKICBpZiAobGlzdGVuZXJzKSB7CiAgICB1cGRhdGVDb21wb25lbnRMaXN0ZW5lcnModm0sIGxpc3RlbmVycyk7CiAgfQp9CnZhciB0YXJnZXQkMTsKZnVuY3Rpb24gYWRkJDEoZXZlbnQsIGZuKSB7CiAgdGFyZ2V0JDEuJG9uKGV2ZW50LCBmbik7Cn0KZnVuY3Rpb24gcmVtb3ZlJDEoZXZlbnQsIGZuKSB7CiAgdGFyZ2V0JDEuJG9mZihldmVudCwgZm4pOwp9CmZ1bmN0aW9uIGNyZWF0ZU9uY2VIYW5kbGVyJDEoZXZlbnQsIGZuKSB7CiAgdmFyIF90YXJnZXQgPSB0YXJnZXQkMTsKICByZXR1cm4gZnVuY3Rpb24gb25jZUhhbmRsZXIoKSB7CiAgICB2YXIgcmVzID0gZm4uYXBwbHkobnVsbCwgYXJndW1lbnRzKTsKICAgIGlmIChyZXMgIT09IG51bGwpIHsKICAgICAgX3RhcmdldC4kb2ZmKGV2ZW50LCBvbmNlSGFuZGxlcik7CiAgICB9CiAgfTsKfQpmdW5jdGlvbiB1cGRhdGVDb21wb25lbnRMaXN0ZW5lcnModm0sIGxpc3RlbmVycywgb2xkTGlzdGVuZXJzKSB7CiAgdGFyZ2V0JDEgPSB2bTsKICB1cGRhdGVMaXN0ZW5lcnMobGlzdGVuZXJzLCBvbGRMaXN0ZW5lcnMgfHwge30sIGFkZCQxLCByZW1vdmUkMSwgY3JlYXRlT25jZUhhbmRsZXIkMSwgdm0pOwogIHRhcmdldCQxID0gdW5kZWZpbmVkOwp9CmZ1bmN0aW9uIGV2ZW50c01peGluKFZ1ZSkgewogIHZhciBob29rUkUgPSAvXmhvb2s6LzsKICBWdWUucHJvdG90eXBlLiRvbiA9IGZ1bmN0aW9uIChldmVudCwgZm4pIHsKICAgIHZhciB2bSA9IHRoaXM7CiAgICBpZiAoaXNBcnJheShldmVudCkpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBldmVudC5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICB2bS4kb24oZXZlbnRbaV0sIGZuKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgKHZtLl9ldmVudHNbZXZlbnRdIHx8ICh2bS5fZXZlbnRzW2V2ZW50XSA9IFtdKSkucHVzaChmbik7CiAgICAgIC8vIG9wdGltaXplIGhvb2s6ZXZlbnQgY29zdCBieSB1c2luZyBhIGJvb2xlYW4gZmxhZyBtYXJrZWQgYXQgcmVnaXN0cmF0aW9uCiAgICAgIC8vIGluc3RlYWQgb2YgYSBoYXNoIGxvb2t1cAogICAgICBpZiAoaG9va1JFLnRlc3QoZXZlbnQpKSB7CiAgICAgICAgdm0uX2hhc0hvb2tFdmVudCA9IHRydWU7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB2bTsKICB9OwogIFZ1ZS5wcm90b3R5cGUuJG9uY2UgPSBmdW5jdGlvbiAoZXZlbnQsIGZuKSB7CiAgICB2YXIgdm0gPSB0aGlzOwogICAgZnVuY3Rpb24gb24oKSB7CiAgICAgIHZtLiRvZmYoZXZlbnQsIG9uKTsKICAgICAgZm4uYXBwbHkodm0sIGFyZ3VtZW50cyk7CiAgICB9CiAgICBvbi5mbiA9IGZuOwogICAgdm0uJG9uKGV2ZW50LCBvbik7CiAgICByZXR1cm4gdm07CiAgfTsKICBWdWUucHJvdG90eXBlLiRvZmYgPSBmdW5jdGlvbiAoZXZlbnQsIGZuKSB7CiAgICB2YXIgdm0gPSB0aGlzOwogICAgLy8gYWxsCiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgdm0uX2V2ZW50cyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgICAgIHJldHVybiB2bTsKICAgIH0KICAgIC8vIGFycmF5IG9mIGV2ZW50cwogICAgaWYgKGlzQXJyYXkoZXZlbnQpKSB7CiAgICAgIGZvciAodmFyIGlfMSA9IDAsIGwgPSBldmVudC5sZW5ndGg7IGlfMSA8IGw7IGlfMSsrKSB7CiAgICAgICAgdm0uJG9mZihldmVudFtpXzFdLCBmbik7CiAgICAgIH0KICAgICAgcmV0dXJuIHZtOwogICAgfQogICAgLy8gc3BlY2lmaWMgZXZlbnQKICAgIHZhciBjYnMgPSB2bS5fZXZlbnRzW2V2ZW50XTsKICAgIGlmICghY2JzKSB7CiAgICAgIHJldHVybiB2bTsKICAgIH0KICAgIGlmICghZm4pIHsKICAgICAgdm0uX2V2ZW50c1tldmVudF0gPSBudWxsOwogICAgICByZXR1cm4gdm07CiAgICB9CiAgICAvLyBzcGVjaWZpYyBoYW5kbGVyCiAgICB2YXIgY2I7CiAgICB2YXIgaSA9IGNicy5sZW5ndGg7CiAgICB3aGlsZSAoaS0tKSB7CiAgICAgIGNiID0gY2JzW2ldOwogICAgICBpZiAoY2IgPT09IGZuIHx8IGNiLmZuID09PSBmbikgewogICAgICAgIGNicy5zcGxpY2UoaSwgMSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB2bTsKICB9OwogIFZ1ZS5wcm90b3R5cGUuJGVtaXQgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgIHZhciB2bSA9IHRoaXM7CiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICB2YXIgbG93ZXJDYXNlRXZlbnQgPSBldmVudC50b0xvd2VyQ2FzZSgpOwogICAgICBpZiAobG93ZXJDYXNlRXZlbnQgIT09IGV2ZW50ICYmIHZtLl9ldmVudHNbbG93ZXJDYXNlRXZlbnRdKSB7CiAgICAgICAgdGlwKCJFdmVudCBcIiIuY29uY2F0KGxvd2VyQ2FzZUV2ZW50LCAiXCIgaXMgZW1pdHRlZCBpbiBjb21wb25lbnQgIikgKyAiIi5jb25jYXQoZm9ybWF0Q29tcG9uZW50TmFtZSh2bSksICIgYnV0IHRoZSBoYW5kbGVyIGlzIHJlZ2lzdGVyZWQgZm9yIFwiIikuY29uY2F0KGV2ZW50LCAiXCIuICIpICsgIk5vdGUgdGhhdCBIVE1MIGF0dHJpYnV0ZXMgYXJlIGNhc2UtaW5zZW5zaXRpdmUgYW5kIHlvdSBjYW5ub3QgdXNlICIgKyAidi1vbiB0byBsaXN0ZW4gdG8gY2FtZWxDYXNlIGV2ZW50cyB3aGVuIHVzaW5nIGluLURPTSB0ZW1wbGF0ZXMuICIgKyAiWW91IHNob3VsZCBwcm9iYWJseSB1c2UgXCIiLmNvbmNhdChoeXBoZW5hdGUoZXZlbnQpLCAiXCIgaW5zdGVhZCBvZiBcIiIpLmNvbmNhdChldmVudCwgIlwiLiIpKTsKICAgICAgfQogICAgfQogICAgdmFyIGNicyA9IHZtLl9ldmVudHNbZXZlbnRdOwogICAgaWYgKGNicykgewogICAgICBjYnMgPSBjYnMubGVuZ3RoID4gMSA/IHRvQXJyYXkoY2JzKSA6IGNiczsKICAgICAgdmFyIGFyZ3MgPSB0b0FycmF5KGFyZ3VtZW50cywgMSk7CiAgICAgIHZhciBpbmZvID0gImV2ZW50IGhhbmRsZXIgZm9yIFwiIi5jb25jYXQoZXZlbnQsICJcIiIpOwogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNicy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBpbnZva2VXaXRoRXJyb3JIYW5kbGluZyhjYnNbaV0sIHZtLCBhcmdzLCB2bSwgaW5mbyk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB2bTsKICB9Owp9CnZhciBhY3RpdmVJbnN0YW5jZSA9IG51bGw7CnZhciBpc1VwZGF0aW5nQ2hpbGRDb21wb25lbnQgPSBmYWxzZTsKZnVuY3Rpb24gc2V0QWN0aXZlSW5zdGFuY2Uodm0pIHsKICB2YXIgcHJldkFjdGl2ZUluc3RhbmNlID0gYWN0aXZlSW5zdGFuY2U7CiAgYWN0aXZlSW5zdGFuY2UgPSB2bTsKICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgYWN0aXZlSW5zdGFuY2UgPSBwcmV2QWN0aXZlSW5zdGFuY2U7CiAgfTsKfQpmdW5jdGlvbiBpbml0TGlmZWN5Y2xlKHZtKSB7CiAgdmFyIG9wdGlvbnMgPSB2bS4kb3B0aW9uczsKICAvLyBsb2NhdGUgZmlyc3Qgbm9uLWFic3RyYWN0IHBhcmVudAogIHZhciBwYXJlbnQgPSBvcHRpb25zLnBhcmVudDsKICBpZiAocGFyZW50ICYmICFvcHRpb25zLmFic3RyYWN0KSB7CiAgICB3aGlsZSAocGFyZW50LiRvcHRpb25zLmFic3RyYWN0ICYmIHBhcmVudC4kcGFyZW50KSB7CiAgICAgIHBhcmVudCA9IHBhcmVudC4kcGFyZW50OwogICAgfQogICAgcGFyZW50LiRjaGlsZHJlbi5wdXNoKHZtKTsKICB9CiAgdm0uJHBhcmVudCA9IHBhcmVudDsKICB2bS4kcm9vdCA9IHBhcmVudCA/IHBhcmVudC4kcm9vdCA6IHZtOwogIHZtLiRjaGlsZHJlbiA9IFtdOwogIHZtLiRyZWZzID0ge307CiAgdm0uX3Byb3ZpZGVkID0gcGFyZW50ID8gcGFyZW50Ll9wcm92aWRlZCA6IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgdm0uX3dhdGNoZXIgPSBudWxsOwogIHZtLl9pbmFjdGl2ZSA9IG51bGw7CiAgdm0uX2RpcmVjdEluYWN0aXZlID0gZmFsc2U7CiAgdm0uX2lzTW91bnRlZCA9IGZhbHNlOwogIHZtLl9pc0Rlc3Ryb3llZCA9IGZhbHNlOwogIHZtLl9pc0JlaW5nRGVzdHJveWVkID0gZmFsc2U7Cn0KZnVuY3Rpb24gbGlmZWN5Y2xlTWl4aW4oVnVlKSB7CiAgVnVlLnByb3RvdHlwZS5fdXBkYXRlID0gZnVuY3Rpb24gKHZub2RlLCBoeWRyYXRpbmcpIHsKICAgIHZhciB2bSA9IHRoaXM7CiAgICB2YXIgcHJldkVsID0gdm0uJGVsOwogICAgdmFyIHByZXZWbm9kZSA9IHZtLl92bm9kZTsKICAgIHZhciByZXN0b3JlQWN0aXZlSW5zdGFuY2UgPSBzZXRBY3RpdmVJbnN0YW5jZSh2bSk7CiAgICB2bS5fdm5vZGUgPSB2bm9kZTsKICAgIC8vIFZ1ZS5wcm90b3R5cGUuX19wYXRjaF9fIGlzIGluamVjdGVkIGluIGVudHJ5IHBvaW50cwogICAgLy8gYmFzZWQgb24gdGhlIHJlbmRlcmluZyBiYWNrZW5kIHVzZWQuCiAgICBpZiAoIXByZXZWbm9kZSkgewogICAgICAvLyBpbml0aWFsIHJlbmRlcgogICAgICB2bS4kZWwgPSB2bS5fX3BhdGNoX18odm0uJGVsLCB2bm9kZSwgaHlkcmF0aW5nLCBmYWxzZSAvKiByZW1vdmVPbmx5ICovKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIHVwZGF0ZXMKICAgICAgdm0uJGVsID0gdm0uX19wYXRjaF9fKHByZXZWbm9kZSwgdm5vZGUpOwogICAgfQogICAgcmVzdG9yZUFjdGl2ZUluc3RhbmNlKCk7CiAgICAvLyB1cGRhdGUgX192dWVfXyByZWZlcmVuY2UKICAgIGlmIChwcmV2RWwpIHsKICAgICAgcHJldkVsLl9fdnVlX18gPSBudWxsOwogICAgfQogICAgaWYgKHZtLiRlbCkgewogICAgICB2bS4kZWwuX192dWVfXyA9IHZtOwogICAgfQogICAgLy8gaWYgcGFyZW50IGlzIGFuIEhPQywgdXBkYXRlIGl0cyAkZWwgYXMgd2VsbAogICAgdmFyIHdyYXBwZXIgPSB2bTsKICAgIHdoaWxlICh3cmFwcGVyICYmIHdyYXBwZXIuJHZub2RlICYmIHdyYXBwZXIuJHBhcmVudCAmJiB3cmFwcGVyLiR2bm9kZSA9PT0gd3JhcHBlci4kcGFyZW50Ll92bm9kZSkgewogICAgICB3cmFwcGVyLiRwYXJlbnQuJGVsID0gd3JhcHBlci4kZWw7CiAgICAgIHdyYXBwZXIgPSB3cmFwcGVyLiRwYXJlbnQ7CiAgICB9CiAgICAvLyB1cGRhdGVkIGhvb2sgaXMgY2FsbGVkIGJ5IHRoZSBzY2hlZHVsZXIgdG8gZW5zdXJlIHRoYXQgY2hpbGRyZW4gYXJlCiAgICAvLyB1cGRhdGVkIGluIGEgcGFyZW50J3MgdXBkYXRlZCBob29rLgogIH07CiAgVnVlLnByb3RvdHlwZS4kZm9yY2VVcGRhdGUgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgdm0gPSB0aGlzOwogICAgaWYgKHZtLl93YXRjaGVyKSB7CiAgICAgIHZtLl93YXRjaGVyLnVwZGF0ZSgpOwogICAgfQogIH07CiAgVnVlLnByb3RvdHlwZS4kZGVzdHJveSA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciB2bSA9IHRoaXM7CiAgICBpZiAodm0uX2lzQmVpbmdEZXN0cm95ZWQpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgY2FsbEhvb2skMSh2bSwgJ2JlZm9yZURlc3Ryb3knKTsKICAgIHZtLl9pc0JlaW5nRGVzdHJveWVkID0gdHJ1ZTsKICAgIC8vIHJlbW92ZSBzZWxmIGZyb20gcGFyZW50CiAgICB2YXIgcGFyZW50ID0gdm0uJHBhcmVudDsKICAgIGlmIChwYXJlbnQgJiYgIXBhcmVudC5faXNCZWluZ0Rlc3Ryb3llZCAmJiAhdm0uJG9wdGlvbnMuYWJzdHJhY3QpIHsKICAgICAgcmVtb3ZlJDIocGFyZW50LiRjaGlsZHJlbiwgdm0pOwogICAgfQogICAgLy8gdGVhcmRvd24gc2NvcGUuIHRoaXMgaW5jbHVkZXMgYm90aCB0aGUgcmVuZGVyIHdhdGNoZXIgYW5kIG90aGVyCiAgICAvLyB3YXRjaGVycyBjcmVhdGVkCiAgICB2bS5fc2NvcGUuc3RvcCgpOwogICAgLy8gcmVtb3ZlIHJlZmVyZW5jZSBmcm9tIGRhdGEgb2IKICAgIC8vIGZyb3plbiBvYmplY3QgbWF5IG5vdCBoYXZlIG9ic2VydmVyLgogICAgaWYgKHZtLl9kYXRhLl9fb2JfXykgewogICAgICB2bS5fZGF0YS5fX29iX18udm1Db3VudC0tOwogICAgfQogICAgLy8gY2FsbCB0aGUgbGFzdCBob29rLi4uCiAgICB2bS5faXNEZXN0cm95ZWQgPSB0cnVlOwogICAgLy8gaW52b2tlIGRlc3Ryb3kgaG9va3Mgb24gY3VycmVudCByZW5kZXJlZCB0cmVlCiAgICB2bS5fX3BhdGNoX18odm0uX3Zub2RlLCBudWxsKTsKICAgIC8vIGZpcmUgZGVzdHJveWVkIGhvb2sKICAgIGNhbGxIb29rJDEodm0sICdkZXN0cm95ZWQnKTsKICAgIC8vIHR1cm4gb2ZmIGFsbCBpbnN0YW5jZSBsaXN0ZW5lcnMuCiAgICB2bS4kb2ZmKCk7CiAgICAvLyByZW1vdmUgX192dWVfXyByZWZlcmVuY2UKICAgIGlmICh2bS4kZWwpIHsKICAgICAgdm0uJGVsLl9fdnVlX18gPSBudWxsOwogICAgfQogICAgLy8gcmVsZWFzZSBjaXJjdWxhciByZWZlcmVuY2UgKCM2NzU5KQogICAgaWYgKHZtLiR2bm9kZSkgewogICAgICB2bS4kdm5vZGUucGFyZW50ID0gbnVsbDsKICAgIH0KICB9Owp9CmZ1bmN0aW9uIG1vdW50Q29tcG9uZW50KHZtLCBlbCwgaHlkcmF0aW5nKSB7CiAgdm0uJGVsID0gZWw7CiAgaWYgKCF2bS4kb3B0aW9ucy5yZW5kZXIpIHsKICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgaW52YWxpZCB0eXBlCiAgICB2bS4kb3B0aW9ucy5yZW5kZXIgPSBjcmVhdGVFbXB0eVZOb2RlOwogICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgICAgIGlmICh2bS4kb3B0aW9ucy50ZW1wbGF0ZSAmJiB2bS4kb3B0aW9ucy50ZW1wbGF0ZS5jaGFyQXQoMCkgIT09ICcjJyB8fCB2bS4kb3B0aW9ucy5lbCB8fCBlbCkgewogICAgICAgIHdhcm4oJ1lvdSBhcmUgdXNpbmcgdGhlIHJ1bnRpbWUtb25seSBidWlsZCBvZiBWdWUgd2hlcmUgdGhlIHRlbXBsYXRlICcgKyAnY29tcGlsZXIgaXMgbm90IGF2YWlsYWJsZS4gRWl0aGVyIHByZS1jb21waWxlIHRoZSB0ZW1wbGF0ZXMgaW50byAnICsgJ3JlbmRlciBmdW5jdGlvbnMsIG9yIHVzZSB0aGUgY29tcGlsZXItaW5jbHVkZWQgYnVpbGQuJywgdm0pOwogICAgICB9IGVsc2UgewogICAgICAgIHdhcm4oJ0ZhaWxlZCB0byBtb3VudCBjb21wb25lbnQ6IHRlbXBsYXRlIG9yIHJlbmRlciBmdW5jdGlvbiBub3QgZGVmaW5lZC4nLCB2bSk7CiAgICAgIH0KICAgIH0KICB9CiAgY2FsbEhvb2skMSh2bSwgJ2JlZm9yZU1vdW50Jyk7CiAgdmFyIHVwZGF0ZUNvbXBvbmVudDsKICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiBjb25maWcucGVyZm9ybWFuY2UgJiYgbWFyaykgewogICAgdXBkYXRlQ29tcG9uZW50ID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgbmFtZSA9IHZtLl9uYW1lOwogICAgICB2YXIgaWQgPSB2bS5fdWlkOwogICAgICB2YXIgc3RhcnRUYWcgPSAidnVlLXBlcmYtc3RhcnQ6Ii5jb25jYXQoaWQpOwogICAgICB2YXIgZW5kVGFnID0gInZ1ZS1wZXJmLWVuZDoiLmNvbmNhdChpZCk7CiAgICAgIG1hcmsoc3RhcnRUYWcpOwogICAgICB2YXIgdm5vZGUgPSB2bS5fcmVuZGVyKCk7CiAgICAgIG1hcmsoZW5kVGFnKTsKICAgICAgbWVhc3VyZSgidnVlICIuY29uY2F0KG5hbWUsICIgcmVuZGVyIiksIHN0YXJ0VGFnLCBlbmRUYWcpOwogICAgICBtYXJrKHN0YXJ0VGFnKTsKICAgICAgdm0uX3VwZGF0ZSh2bm9kZSwgaHlkcmF0aW5nKTsKICAgICAgbWFyayhlbmRUYWcpOwogICAgICBtZWFzdXJlKCJ2dWUgIi5jb25jYXQobmFtZSwgIiBwYXRjaCIpLCBzdGFydFRhZywgZW5kVGFnKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIHVwZGF0ZUNvbXBvbmVudCA9IGZ1bmN0aW9uICgpIHsKICAgICAgdm0uX3VwZGF0ZSh2bS5fcmVuZGVyKCksIGh5ZHJhdGluZyk7CiAgICB9OwogIH0KICB2YXIgd2F0Y2hlck9wdGlvbnMgPSB7CiAgICBiZWZvcmU6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHZtLl9pc01vdW50ZWQgJiYgIXZtLl9pc0Rlc3Ryb3llZCkgewogICAgICAgIGNhbGxIb29rJDEodm0sICdiZWZvcmVVcGRhdGUnKTsKICAgICAgfQogICAgfQogIH07CiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgIHdhdGNoZXJPcHRpb25zLm9uVHJhY2sgPSBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gY2FsbEhvb2skMSh2bSwgJ3JlbmRlclRyYWNrZWQnLCBbZV0pOwogICAgfTsKICAgIHdhdGNoZXJPcHRpb25zLm9uVHJpZ2dlciA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBjYWxsSG9vayQxKHZtLCAncmVuZGVyVHJpZ2dlcmVkJywgW2VdKTsKICAgIH07CiAgfQogIC8vIHdlIHNldCB0aGlzIHRvIHZtLl93YXRjaGVyIGluc2lkZSB0aGUgd2F0Y2hlcidzIGNvbnN0cnVjdG9yCiAgLy8gc2luY2UgdGhlIHdhdGNoZXIncyBpbml0aWFsIHBhdGNoIG1heSBjYWxsICRmb3JjZVVwZGF0ZSAoZS5nLiBpbnNpZGUgY2hpbGQKICAvLyBjb21wb25lbnQncyBtb3VudGVkIGhvb2spLCB3aGljaCByZWxpZXMgb24gdm0uX3dhdGNoZXIgYmVpbmcgYWxyZWFkeSBkZWZpbmVkCiAgbmV3IFdhdGNoZXIodm0sIHVwZGF0ZUNvbXBvbmVudCwgbm9vcCwgd2F0Y2hlck9wdGlvbnMsIHRydWUgLyogaXNSZW5kZXJXYXRjaGVyICovKTsKICBoeWRyYXRpbmcgPSBmYWxzZTsKICAvLyBmbHVzaCBidWZmZXIgZm9yIGZsdXNoOiAicHJlIiB3YXRjaGVycyBxdWV1ZWQgaW4gc2V0dXAoKQogIHZhciBwcmVXYXRjaGVycyA9IHZtLl9wcmVXYXRjaGVyczsKICBpZiAocHJlV2F0Y2hlcnMpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJlV2F0Y2hlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgcHJlV2F0Y2hlcnNbaV0ucnVuKCk7CiAgICB9CiAgfQogIC8vIG1hbnVhbGx5IG1vdW50ZWQgaW5zdGFuY2UsIGNhbGwgbW91bnRlZCBvbiBzZWxmCiAgLy8gbW91bnRlZCBpcyBjYWxsZWQgZm9yIHJlbmRlci1jcmVhdGVkIGNoaWxkIGNvbXBvbmVudHMgaW4gaXRzIGluc2VydGVkIGhvb2sKICBpZiAodm0uJHZub2RlID09IG51bGwpIHsKICAgIHZtLl9pc01vdW50ZWQgPSB0cnVlOwogICAgY2FsbEhvb2skMSh2bSwgJ21vdW50ZWQnKTsKICB9CiAgcmV0dXJuIHZtOwp9CmZ1bmN0aW9uIHVwZGF0ZUNoaWxkQ29tcG9uZW50KHZtLCBwcm9wc0RhdGEsIGxpc3RlbmVycywgcGFyZW50Vm5vZGUsIHJlbmRlckNoaWxkcmVuKSB7CiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgIGlzVXBkYXRpbmdDaGlsZENvbXBvbmVudCA9IHRydWU7CiAgfQogIC8vIGRldGVybWluZSB3aGV0aGVyIGNvbXBvbmVudCBoYXMgc2xvdCBjaGlsZHJlbgogIC8vIHdlIG5lZWQgdG8gZG8gdGhpcyBiZWZvcmUgb3ZlcndyaXRpbmcgJG9wdGlvbnMuX3JlbmRlckNoaWxkcmVuLgogIC8vIGNoZWNrIGlmIHRoZXJlIGFyZSBkeW5hbWljIHNjb3BlZFNsb3RzIChoYW5kLXdyaXR0ZW4gb3IgY29tcGlsZWQgYnV0IHdpdGgKICAvLyBkeW5hbWljIHNsb3QgbmFtZXMpLiBTdGF0aWMgc2NvcGVkIHNsb3RzIGNvbXBpbGVkIGZyb20gdGVtcGxhdGUgaGFzIHRoZQogIC8vICIkc3RhYmxlIiBtYXJrZXIuCiAgdmFyIG5ld1Njb3BlZFNsb3RzID0gcGFyZW50Vm5vZGUuZGF0YS5zY29wZWRTbG90czsKICB2YXIgb2xkU2NvcGVkU2xvdHMgPSB2bS4kc2NvcGVkU2xvdHM7CiAgdmFyIGhhc0R5bmFtaWNTY29wZWRTbG90ID0gISEobmV3U2NvcGVkU2xvdHMgJiYgIW5ld1Njb3BlZFNsb3RzLiRzdGFibGUgfHwgb2xkU2NvcGVkU2xvdHMgIT09IGVtcHR5T2JqZWN0ICYmICFvbGRTY29wZWRTbG90cy4kc3RhYmxlIHx8IG5ld1Njb3BlZFNsb3RzICYmIHZtLiRzY29wZWRTbG90cy4ka2V5ICE9PSBuZXdTY29wZWRTbG90cy4ka2V5IHx8ICFuZXdTY29wZWRTbG90cyAmJiB2bS4kc2NvcGVkU2xvdHMuJGtleSk7CiAgLy8gQW55IHN0YXRpYyBzbG90IGNoaWxkcmVuIGZyb20gdGhlIHBhcmVudCBtYXkgaGF2ZSBjaGFuZ2VkIGR1cmluZyBwYXJlbnQncwogIC8vIHVwZGF0ZS4gRHluYW1pYyBzY29wZWQgc2xvdHMgbWF5IGFsc28gaGF2ZSBjaGFuZ2VkLiBJbiBzdWNoIGNhc2VzLCBhIGZvcmNlZAogIC8vIHVwZGF0ZSBpcyBuZWNlc3NhcnkgdG8gZW5zdXJlIGNvcnJlY3RuZXNzLgogIHZhciBuZWVkc0ZvcmNlVXBkYXRlID0gISEocmVuZGVyQ2hpbGRyZW4gfHwKICAvLyBoYXMgbmV3IHN0YXRpYyBzbG90cwogIHZtLiRvcHRpb25zLl9yZW5kZXJDaGlsZHJlbiB8fAogIC8vIGhhcyBvbGQgc3RhdGljIHNsb3RzCiAgaGFzRHluYW1pY1Njb3BlZFNsb3QpOwogIHZhciBwcmV2Vk5vZGUgPSB2bS4kdm5vZGU7CiAgdm0uJG9wdGlvbnMuX3BhcmVudFZub2RlID0gcGFyZW50Vm5vZGU7CiAgdm0uJHZub2RlID0gcGFyZW50Vm5vZGU7IC8vIHVwZGF0ZSB2bSdzIHBsYWNlaG9sZGVyIG5vZGUgd2l0aG91dCByZS1yZW5kZXIKICBpZiAodm0uX3Zub2RlKSB7CiAgICAvLyB1cGRhdGUgY2hpbGQgdHJlZSdzIHBhcmVudAogICAgdm0uX3Zub2RlLnBhcmVudCA9IHBhcmVudFZub2RlOwogIH0KICB2bS4kb3B0aW9ucy5fcmVuZGVyQ2hpbGRyZW4gPSByZW5kZXJDaGlsZHJlbjsKICAvLyB1cGRhdGUgJGF0dHJzIGFuZCAkbGlzdGVuZXJzIGhhc2gKICAvLyB0aGVzZSBhcmUgYWxzbyByZWFjdGl2ZSBzbyB0aGV5IG1heSB0cmlnZ2VyIGNoaWxkIHVwZGF0ZSBpZiB0aGUgY2hpbGQKICAvLyB1c2VkIHRoZW0gZHVyaW5nIHJlbmRlcgogIHZhciBhdHRycyA9IHBhcmVudFZub2RlLmRhdGEuYXR0cnMgfHwgZW1wdHlPYmplY3Q7CiAgaWYgKHZtLl9hdHRyc1Byb3h5KSB7CiAgICAvLyBmb3JjZSB1cGRhdGUgaWYgYXR0cnMgYXJlIGFjY2Vzc2VkIGFuZCBoYXMgY2hhbmdlZCBzaW5jZSBpdCBtYXkgYmUKICAgIC8vIHBhc3NlZCB0byBhIGNoaWxkIGNvbXBvbmVudC4KICAgIGlmIChzeW5jU2V0dXBQcm94eSh2bS5fYXR0cnNQcm94eSwgYXR0cnMsIHByZXZWTm9kZS5kYXRhICYmIHByZXZWTm9kZS5kYXRhLmF0dHJzIHx8IGVtcHR5T2JqZWN0LCB2bSwgJyRhdHRycycpKSB7CiAgICAgIG5lZWRzRm9yY2VVcGRhdGUgPSB0cnVlOwogICAgfQogIH0KICB2bS4kYXR0cnMgPSBhdHRyczsKICAvLyB1cGRhdGUgbGlzdGVuZXJzCiAgbGlzdGVuZXJzID0gbGlzdGVuZXJzIHx8IGVtcHR5T2JqZWN0OwogIHZhciBwcmV2TGlzdGVuZXJzID0gdm0uJG9wdGlvbnMuX3BhcmVudExpc3RlbmVyczsKICBpZiAodm0uX2xpc3RlbmVyc1Byb3h5KSB7CiAgICBzeW5jU2V0dXBQcm94eSh2bS5fbGlzdGVuZXJzUHJveHksIGxpc3RlbmVycywgcHJldkxpc3RlbmVycyB8fCBlbXB0eU9iamVjdCwgdm0sICckbGlzdGVuZXJzJyk7CiAgfQogIHZtLiRsaXN0ZW5lcnMgPSB2bS4kb3B0aW9ucy5fcGFyZW50TGlzdGVuZXJzID0gbGlzdGVuZXJzOwogIHVwZGF0ZUNvbXBvbmVudExpc3RlbmVycyh2bSwgbGlzdGVuZXJzLCBwcmV2TGlzdGVuZXJzKTsKICAvLyB1cGRhdGUgcHJvcHMKICBpZiAocHJvcHNEYXRhICYmIHZtLiRvcHRpb25zLnByb3BzKSB7CiAgICB0b2dnbGVPYnNlcnZpbmcoZmFsc2UpOwogICAgdmFyIHByb3BzID0gdm0uX3Byb3BzOwogICAgdmFyIHByb3BLZXlzID0gdm0uJG9wdGlvbnMuX3Byb3BLZXlzIHx8IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wS2V5cy5sZW5ndGg7IGkrKykgewogICAgICB2YXIga2V5ID0gcHJvcEtleXNbaV07CiAgICAgIHZhciBwcm9wT3B0aW9ucyA9IHZtLiRvcHRpb25zLnByb3BzOyAvLyB3dGYgZmxvdz8KICAgICAgcHJvcHNba2V5XSA9IHZhbGlkYXRlUHJvcChrZXksIHByb3BPcHRpb25zLCBwcm9wc0RhdGEsIHZtKTsKICAgIH0KICAgIHRvZ2dsZU9ic2VydmluZyh0cnVlKTsKICAgIC8vIGtlZXAgYSBjb3B5IG9mIHJhdyBwcm9wc0RhdGEKICAgIHZtLiRvcHRpb25zLnByb3BzRGF0YSA9IHByb3BzRGF0YTsKICB9CiAgLy8gcmVzb2x2ZSBzbG90cyArIGZvcmNlIHVwZGF0ZSBpZiBoYXMgY2hpbGRyZW4KICBpZiAobmVlZHNGb3JjZVVwZGF0ZSkgewogICAgdm0uJHNsb3RzID0gcmVzb2x2ZVNsb3RzKHJlbmRlckNoaWxkcmVuLCBwYXJlbnRWbm9kZS5jb250ZXh0KTsKICAgIHZtLiRmb3JjZVVwZGF0ZSgpOwogIH0KICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgaXNVcGRhdGluZ0NoaWxkQ29tcG9uZW50ID0gZmFsc2U7CiAgfQp9CmZ1bmN0aW9uIGlzSW5JbmFjdGl2ZVRyZWUodm0pIHsKICB3aGlsZSAodm0gJiYgKHZtID0gdm0uJHBhcmVudCkpIHsKICAgIGlmICh2bS5faW5hY3RpdmUpIHJldHVybiB0cnVlOwogIH0KICByZXR1cm4gZmFsc2U7Cn0KZnVuY3Rpb24gYWN0aXZhdGVDaGlsZENvbXBvbmVudCh2bSwgZGlyZWN0KSB7CiAgaWYgKGRpcmVjdCkgewogICAgdm0uX2RpcmVjdEluYWN0aXZlID0gZmFsc2U7CiAgICBpZiAoaXNJbkluYWN0aXZlVHJlZSh2bSkpIHsKICAgICAgcmV0dXJuOwogICAgfQogIH0gZWxzZSBpZiAodm0uX2RpcmVjdEluYWN0aXZlKSB7CiAgICByZXR1cm47CiAgfQogIGlmICh2bS5faW5hY3RpdmUgfHwgdm0uX2luYWN0aXZlID09PSBudWxsKSB7CiAgICB2bS5faW5hY3RpdmUgPSBmYWxzZTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdm0uJGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7CiAgICAgIGFjdGl2YXRlQ2hpbGRDb21wb25lbnQodm0uJGNoaWxkcmVuW2ldKTsKICAgIH0KICAgIGNhbGxIb29rJDEodm0sICdhY3RpdmF0ZWQnKTsKICB9Cn0KZnVuY3Rpb24gZGVhY3RpdmF0ZUNoaWxkQ29tcG9uZW50KHZtLCBkaXJlY3QpIHsKICBpZiAoZGlyZWN0KSB7CiAgICB2bS5fZGlyZWN0SW5hY3RpdmUgPSB0cnVlOwogICAgaWYgKGlzSW5JbmFjdGl2ZVRyZWUodm0pKSB7CiAgICAgIHJldHVybjsKICAgIH0KICB9CiAgaWYgKCF2bS5faW5hY3RpdmUpIHsKICAgIHZtLl9pbmFjdGl2ZSA9IHRydWU7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZtLiRjaGlsZHJlbi5sZW5ndGg7IGkrKykgewogICAgICBkZWFjdGl2YXRlQ2hpbGRDb21wb25lbnQodm0uJGNoaWxkcmVuW2ldKTsKICAgIH0KICAgIGNhbGxIb29rJDEodm0sICdkZWFjdGl2YXRlZCcpOwogIH0KfQpmdW5jdGlvbiBjYWxsSG9vayQxKHZtLCBob29rLCBhcmdzLCBzZXRDb250ZXh0KSB7CiAgaWYgKHNldENvbnRleHQgPT09IHZvaWQgMCkgewogICAgc2V0Q29udGV4dCA9IHRydWU7CiAgfQogIC8vICM3NTczIGRpc2FibGUgZGVwIGNvbGxlY3Rpb24gd2hlbiBpbnZva2luZyBsaWZlY3ljbGUgaG9va3MKICBwdXNoVGFyZ2V0KCk7CiAgdmFyIHByZXZJbnN0ID0gY3VycmVudEluc3RhbmNlOwogIHZhciBwcmV2U2NvcGUgPSBnZXRDdXJyZW50U2NvcGUoKTsKICBzZXRDb250ZXh0ICYmIHNldEN1cnJlbnRJbnN0YW5jZSh2bSk7CiAgdmFyIGhhbmRsZXJzID0gdm0uJG9wdGlvbnNbaG9va107CiAgdmFyIGluZm8gPSAiIi5jb25jYXQoaG9vaywgIiBob29rIik7CiAgaWYgKGhhbmRsZXJzKSB7CiAgICBmb3IgKHZhciBpID0gMCwgaiA9IGhhbmRsZXJzLmxlbmd0aDsgaSA8IGo7IGkrKykgewogICAgICBpbnZva2VXaXRoRXJyb3JIYW5kbGluZyhoYW5kbGVyc1tpXSwgdm0sIGFyZ3MgfHwgbnVsbCwgdm0sIGluZm8pOwogICAgfQogIH0KICBpZiAodm0uX2hhc0hvb2tFdmVudCkgewogICAgdm0uJGVtaXQoJ2hvb2s6JyArIGhvb2spOwogIH0KICBpZiAoc2V0Q29udGV4dCkgewogICAgc2V0Q3VycmVudEluc3RhbmNlKHByZXZJbnN0KTsKICAgIHByZXZTY29wZSAmJiBwcmV2U2NvcGUub24oKTsKICB9CiAgcG9wVGFyZ2V0KCk7Cn0KdmFyIE1BWF9VUERBVEVfQ09VTlQgPSAxMDA7CnZhciBxdWV1ZSA9IFtdOwp2YXIgYWN0aXZhdGVkQ2hpbGRyZW4gPSBbXTsKdmFyIGhhcyA9IHt9Owp2YXIgY2lyY3VsYXIgPSB7fTsKdmFyIHdhaXRpbmcgPSBmYWxzZTsKdmFyIGZsdXNoaW5nID0gZmFsc2U7CnZhciBpbmRleCA9IDA7Ci8qKgogKiBSZXNldCB0aGUgc2NoZWR1bGVyJ3Mgc3RhdGUuCiAqLwpmdW5jdGlvbiByZXNldFNjaGVkdWxlclN0YXRlKCkgewogIGluZGV4ID0gcXVldWUubGVuZ3RoID0gYWN0aXZhdGVkQ2hpbGRyZW4ubGVuZ3RoID0gMDsKICBoYXMgPSB7fTsKICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgY2lyY3VsYXIgPSB7fTsKICB9CiAgd2FpdGluZyA9IGZsdXNoaW5nID0gZmFsc2U7Cn0KLy8gQXN5bmMgZWRnZSBjYXNlICM2NTY2IHJlcXVpcmVzIHNhdmluZyB0aGUgdGltZXN0YW1wIHdoZW4gZXZlbnQgbGlzdGVuZXJzIGFyZQovLyBhdHRhY2hlZC4gSG93ZXZlciwgY2FsbGluZyBwZXJmb3JtYW5jZS5ub3coKSBoYXMgYSBwZXJmIG92ZXJoZWFkIGVzcGVjaWFsbHkKLy8gaWYgdGhlIHBhZ2UgaGFzIHRob3VzYW5kcyBvZiBldmVudCBsaXN0ZW5lcnMuIEluc3RlYWQsIHdlIHRha2UgYSB0aW1lc3RhbXAKLy8gZXZlcnkgdGltZSB0aGUgc2NoZWR1bGVyIGZsdXNoZXMgYW5kIHVzZSB0aGF0IGZvciBhbGwgZXZlbnQgbGlzdGVuZXJzCi8vIGF0dGFjaGVkIGR1cmluZyB0aGF0IGZsdXNoLgp2YXIgY3VycmVudEZsdXNoVGltZXN0YW1wID0gMDsKLy8gQXN5bmMgZWRnZSBjYXNlIGZpeCByZXF1aXJlcyBzdG9yaW5nIGFuIGV2ZW50IGxpc3RlbmVyJ3MgYXR0YWNoIHRpbWVzdGFtcC4KdmFyIGdldE5vdyA9IERhdGUubm93OwovLyBEZXRlcm1pbmUgd2hhdCBldmVudCB0aW1lc3RhbXAgdGhlIGJyb3dzZXIgaXMgdXNpbmcuIEFubm95aW5nbHksIHRoZQovLyB0aW1lc3RhbXAgY2FuIGVpdGhlciBiZSBoaS1yZXMgKHJlbGF0aXZlIHRvIHBhZ2UgbG9hZCkgb3IgbG93LXJlcwovLyAocmVsYXRpdmUgdG8gVU5JWCBlcG9jaCksIHNvIGluIG9yZGVyIHRvIGNvbXBhcmUgdGltZSB3ZSBoYXZlIHRvIHVzZSB0aGUKLy8gc2FtZSB0aW1lc3RhbXAgdHlwZSB3aGVuIHNhdmluZyB0aGUgZmx1c2ggdGltZXN0YW1wLgovLyBBbGwgSUUgdmVyc2lvbnMgdXNlIGxvdy1yZXMgZXZlbnQgdGltZXN0YW1wcywgYW5kIGhhdmUgcHJvYmxlbWF0aWMgY2xvY2sKLy8gaW1wbGVtZW50YXRpb25zICgjOTYzMikKaWYgKGluQnJvd3NlciAmJiAhaXNJRSkgewogIHZhciBwZXJmb3JtYW5jZV8xID0gd2luZG93LnBlcmZvcm1hbmNlOwogIGlmIChwZXJmb3JtYW5jZV8xICYmIHR5cGVvZiBwZXJmb3JtYW5jZV8xLm5vdyA9PT0gJ2Z1bmN0aW9uJyAmJiBnZXROb3coKSA+IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpLnRpbWVTdGFtcCkgewogICAgLy8gaWYgdGhlIGV2ZW50IHRpbWVzdGFtcCwgYWx0aG91Z2ggZXZhbHVhdGVkIEFGVEVSIHRoZSBEYXRlLm5vdygpLCBpcwogICAgLy8gc21hbGxlciB0aGFuIGl0LCBpdCBtZWFucyB0aGUgZXZlbnQgaXMgdXNpbmcgYSBoaS1yZXMgdGltZXN0YW1wLAogICAgLy8gYW5kIHdlIG5lZWQgdG8gdXNlIHRoZSBoaS1yZXMgdmVyc2lvbiBmb3IgZXZlbnQgbGlzdGVuZXIgdGltZXN0YW1wcyBhcwogICAgLy8gd2VsbC4KICAgIGdldE5vdyA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHBlcmZvcm1hbmNlXzEubm93KCk7CiAgICB9OwogIH0KfQp2YXIgc29ydENvbXBhcmVGbiA9IGZ1bmN0aW9uIChhLCBiKSB7CiAgaWYgKGEucG9zdCkgewogICAgaWYgKCFiLnBvc3QpIHJldHVybiAxOwogIH0gZWxzZSBpZiAoYi5wb3N0KSB7CiAgICByZXR1cm4gLTE7CiAgfQogIHJldHVybiBhLmlkIC0gYi5pZDsKfTsKLyoqCiAqIEZsdXNoIGJvdGggcXVldWVzIGFuZCBydW4gdGhlIHdhdGNoZXJzLgogKi8KZnVuY3Rpb24gZmx1c2hTY2hlZHVsZXJRdWV1ZSgpIHsKICBjdXJyZW50Rmx1c2hUaW1lc3RhbXAgPSBnZXROb3coKTsKICBmbHVzaGluZyA9IHRydWU7CiAgdmFyIHdhdGNoZXIsIGlkOwogIC8vIFNvcnQgcXVldWUgYmVmb3JlIGZsdXNoLgogIC8vIFRoaXMgZW5zdXJlcyB0aGF0OgogIC8vIDEuIENvbXBvbmVudHMgYXJlIHVwZGF0ZWQgZnJvbSBwYXJlbnQgdG8gY2hpbGQuIChiZWNhdXNlIHBhcmVudCBpcyBhbHdheXMKICAvLyAgICBjcmVhdGVkIGJlZm9yZSB0aGUgY2hpbGQpCiAgLy8gMi4gQSBjb21wb25lbnQncyB1c2VyIHdhdGNoZXJzIGFyZSBydW4gYmVmb3JlIGl0cyByZW5kZXIgd2F0Y2hlciAoYmVjYXVzZQogIC8vICAgIHVzZXIgd2F0Y2hlcnMgYXJlIGNyZWF0ZWQgYmVmb3JlIHRoZSByZW5kZXIgd2F0Y2hlcikKICAvLyAzLiBJZiBhIGNvbXBvbmVudCBpcyBkZXN0cm95ZWQgZHVyaW5nIGEgcGFyZW50IGNvbXBvbmVudCdzIHdhdGNoZXIgcnVuLAogIC8vICAgIGl0cyB3YXRjaGVycyBjYW4gYmUgc2tpcHBlZC4KICBxdWV1ZS5zb3J0KHNvcnRDb21wYXJlRm4pOwogIC8vIGRvIG5vdCBjYWNoZSBsZW5ndGggYmVjYXVzZSBtb3JlIHdhdGNoZXJzIG1pZ2h0IGJlIHB1c2hlZAogIC8vIGFzIHdlIHJ1biBleGlzdGluZyB3YXRjaGVycwogIGZvciAoaW5kZXggPSAwOyBpbmRleCA8IHF1ZXVlLmxlbmd0aDsgaW5kZXgrKykgewogICAgd2F0Y2hlciA9IHF1ZXVlW2luZGV4XTsKICAgIGlmICh3YXRjaGVyLmJlZm9yZSkgewogICAgICB3YXRjaGVyLmJlZm9yZSgpOwogICAgfQogICAgaWQgPSB3YXRjaGVyLmlkOwogICAgaGFzW2lkXSA9IG51bGw7CiAgICB3YXRjaGVyLnJ1bigpOwogICAgLy8gaW4gZGV2IGJ1aWxkLCBjaGVjayBhbmQgc3RvcCBjaXJjdWxhciB1cGRhdGVzLgogICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgaGFzW2lkXSAhPSBudWxsKSB7CiAgICAgIGNpcmN1bGFyW2lkXSA9IChjaXJjdWxhcltpZF0gfHwgMCkgKyAxOwogICAgICBpZiAoY2lyY3VsYXJbaWRdID4gTUFYX1VQREFURV9DT1VOVCkgewogICAgICAgIHdhcm4oJ1lvdSBtYXkgaGF2ZSBhbiBpbmZpbml0ZSB1cGRhdGUgbG9vcCAnICsgKHdhdGNoZXIudXNlciA/ICJpbiB3YXRjaGVyIHdpdGggZXhwcmVzc2lvbiBcIiIuY29uY2F0KHdhdGNoZXIuZXhwcmVzc2lvbiwgIlwiIikgOiAiaW4gYSBjb21wb25lbnQgcmVuZGVyIGZ1bmN0aW9uLiIpLCB3YXRjaGVyLnZtKTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0KICAvLyBrZWVwIGNvcGllcyBvZiBwb3N0IHF1ZXVlcyBiZWZvcmUgcmVzZXR0aW5nIHN0YXRlCiAgdmFyIGFjdGl2YXRlZFF1ZXVlID0gYWN0aXZhdGVkQ2hpbGRyZW4uc2xpY2UoKTsKICB2YXIgdXBkYXRlZFF1ZXVlID0gcXVldWUuc2xpY2UoKTsKICByZXNldFNjaGVkdWxlclN0YXRlKCk7CiAgLy8gY2FsbCBjb21wb25lbnQgdXBkYXRlZCBhbmQgYWN0aXZhdGVkIGhvb2tzCiAgY2FsbEFjdGl2YXRlZEhvb2tzKGFjdGl2YXRlZFF1ZXVlKTsKICBjYWxsVXBkYXRlZEhvb2tzKHVwZGF0ZWRRdWV1ZSk7CiAgY2xlYW51cERlcHMoKTsKICAvLyBkZXZ0b29sIGhvb2sKICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICBpZiAoZGV2dG9vbHMgJiYgY29uZmlnLmRldnRvb2xzKSB7CiAgICBkZXZ0b29scy5lbWl0KCdmbHVzaCcpOwogIH0KfQpmdW5jdGlvbiBjYWxsVXBkYXRlZEhvb2tzKHF1ZXVlKSB7CiAgdmFyIGkgPSBxdWV1ZS5sZW5ndGg7CiAgd2hpbGUgKGktLSkgewogICAgdmFyIHdhdGNoZXIgPSBxdWV1ZVtpXTsKICAgIHZhciB2bSA9IHdhdGNoZXIudm07CiAgICBpZiAodm0gJiYgdm0uX3dhdGNoZXIgPT09IHdhdGNoZXIgJiYgdm0uX2lzTW91bnRlZCAmJiAhdm0uX2lzRGVzdHJveWVkKSB7CiAgICAgIGNhbGxIb29rJDEodm0sICd1cGRhdGVkJyk7CiAgICB9CiAgfQp9Ci8qKgogKiBRdWV1ZSBhIGtlcHQtYWxpdmUgY29tcG9uZW50IHRoYXQgd2FzIGFjdGl2YXRlZCBkdXJpbmcgcGF0Y2guCiAqIFRoZSBxdWV1ZSB3aWxsIGJlIHByb2Nlc3NlZCBhZnRlciB0aGUgZW50aXJlIHRyZWUgaGFzIGJlZW4gcGF0Y2hlZC4KICovCmZ1bmN0aW9uIHF1ZXVlQWN0aXZhdGVkQ29tcG9uZW50KHZtKSB7CiAgLy8gc2V0dGluZyBfaW5hY3RpdmUgdG8gZmFsc2UgaGVyZSBzbyB0aGF0IGEgcmVuZGVyIGZ1bmN0aW9uIGNhbgogIC8vIHJlbHkgb24gY2hlY2tpbmcgd2hldGhlciBpdCdzIGluIGFuIGluYWN0aXZlIHRyZWUgKGUuZy4gcm91dGVyLXZpZXcpCiAgdm0uX2luYWN0aXZlID0gZmFsc2U7CiAgYWN0aXZhdGVkQ2hpbGRyZW4ucHVzaCh2bSk7Cn0KZnVuY3Rpb24gY2FsbEFjdGl2YXRlZEhvb2tzKHF1ZXVlKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykgewogICAgcXVldWVbaV0uX2luYWN0aXZlID0gdHJ1ZTsKICAgIGFjdGl2YXRlQ2hpbGRDb21wb25lbnQocXVldWVbaV0sIHRydWUgLyogdHJ1ZSAqLyk7CiAgfQp9Ci8qKgogKiBQdXNoIGEgd2F0Y2hlciBpbnRvIHRoZSB3YXRjaGVyIHF1ZXVlLgogKiBKb2JzIHdpdGggZHVwbGljYXRlIElEcyB3aWxsIGJlIHNraXBwZWQgdW5sZXNzIGl0J3MKICogcHVzaGVkIHdoZW4gdGhlIHF1ZXVlIGlzIGJlaW5nIGZsdXNoZWQuCiAqLwpmdW5jdGlvbiBxdWV1ZVdhdGNoZXIod2F0Y2hlcikgewogIHZhciBpZCA9IHdhdGNoZXIuaWQ7CiAgaWYgKGhhc1tpZF0gIT0gbnVsbCkgewogICAgcmV0dXJuOwogIH0KICBpZiAod2F0Y2hlciA9PT0gRGVwLnRhcmdldCAmJiB3YXRjaGVyLm5vUmVjdXJzZSkgewogICAgcmV0dXJuOwogIH0KICBoYXNbaWRdID0gdHJ1ZTsKICBpZiAoIWZsdXNoaW5nKSB7CiAgICBxdWV1ZS5wdXNoKHdhdGNoZXIpOwogIH0gZWxzZSB7CiAgICAvLyBpZiBhbHJlYWR5IGZsdXNoaW5nLCBzcGxpY2UgdGhlIHdhdGNoZXIgYmFzZWQgb24gaXRzIGlkCiAgICAvLyBpZiBhbHJlYWR5IHBhc3QgaXRzIGlkLCBpdCB3aWxsIGJlIHJ1biBuZXh0IGltbWVkaWF0ZWx5LgogICAgdmFyIGkgPSBxdWV1ZS5sZW5ndGggLSAxOwogICAgd2hpbGUgKGkgPiBpbmRleCAmJiBxdWV1ZVtpXS5pZCA+IHdhdGNoZXIuaWQpIHsKICAgICAgaS0tOwogICAgfQogICAgcXVldWUuc3BsaWNlKGkgKyAxLCAwLCB3YXRjaGVyKTsKICB9CiAgLy8gcXVldWUgdGhlIGZsdXNoCiAgaWYgKCF3YWl0aW5nKSB7CiAgICB3YWl0aW5nID0gdHJ1ZTsKICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmICFjb25maWcuYXN5bmMpIHsKICAgICAgZmx1c2hTY2hlZHVsZXJRdWV1ZSgpOwogICAgICByZXR1cm47CiAgICB9CiAgICBuZXh0VGljayhmbHVzaFNjaGVkdWxlclF1ZXVlKTsKICB9Cn0KZnVuY3Rpb24gaW5pdFByb3ZpZGUodm0pIHsKICB2YXIgcHJvdmlkZU9wdGlvbiA9IHZtLiRvcHRpb25zLnByb3ZpZGU7CiAgaWYgKHByb3ZpZGVPcHRpb24pIHsKICAgIHZhciBwcm92aWRlZCA9IGlzRnVuY3Rpb24ocHJvdmlkZU9wdGlvbikgPyBwcm92aWRlT3B0aW9uLmNhbGwodm0pIDogcHJvdmlkZU9wdGlvbjsKICAgIGlmICghaXNPYmplY3QocHJvdmlkZWQpKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHZhciBzb3VyY2UgPSByZXNvbHZlUHJvdmlkZWQodm0pOwogICAgLy8gSUU5IGRvZXNuJ3Qgc3VwcG9ydCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyBzbyB3ZSBoYXZlIHRvCiAgICAvLyBpdGVyYXRlIHRoZSBrZXlzIG91cnNlbHZlcy4KICAgIHZhciBrZXlzID0gaGFzU3ltYm9sID8gUmVmbGVjdC5vd25LZXlzKHByb3ZpZGVkKSA6IE9iamVjdC5rZXlzKHByb3ZpZGVkKTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgICB2YXIga2V5ID0ga2V5c1tpXTsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNvdXJjZSwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHByb3ZpZGVkLCBrZXkpKTsKICAgIH0KICB9Cn0KZnVuY3Rpb24gaW5pdEluamVjdGlvbnModm0pIHsKICB2YXIgcmVzdWx0ID0gcmVzb2x2ZUluamVjdCh2bS4kb3B0aW9ucy5pbmplY3QsIHZtKTsKICBpZiAocmVzdWx0KSB7CiAgICB0b2dnbGVPYnNlcnZpbmcoZmFsc2UpOwogICAgT2JqZWN0LmtleXMocmVzdWx0KS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8KICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgICAgICBkZWZpbmVSZWFjdGl2ZSh2bSwga2V5LCByZXN1bHRba2V5XSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgd2FybigiQXZvaWQgbXV0YXRpbmcgYW4gaW5qZWN0ZWQgdmFsdWUgZGlyZWN0bHkgc2luY2UgdGhlIGNoYW5nZXMgd2lsbCBiZSAiICsgIm92ZXJ3cml0dGVuIHdoZW5ldmVyIHRoZSBwcm92aWRlZCBjb21wb25lbnQgcmUtcmVuZGVycy4gIiArICJpbmplY3Rpb24gYmVpbmcgbXV0YXRlZDogXCIiLmNvbmNhdChrZXksICJcIiIpLCB2bSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGVmaW5lUmVhY3RpdmUodm0sIGtleSwgcmVzdWx0W2tleV0pOwogICAgICB9CiAgICB9KTsKICAgIHRvZ2dsZU9ic2VydmluZyh0cnVlKTsKICB9Cn0KZnVuY3Rpb24gcmVzb2x2ZUluamVjdChpbmplY3QsIHZtKSB7CiAgaWYgKGluamVjdCkgewogICAgLy8gaW5qZWN0IGlzIDphbnkgYmVjYXVzZSBmbG93IGlzIG5vdCBzbWFydCBlbm91Z2ggdG8gZmlndXJlIG91dCBjYWNoZWQKICAgIHZhciByZXN1bHQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdmFyIGtleXMgPSBoYXNTeW1ib2wgPyBSZWZsZWN0Lm93bktleXMoaW5qZWN0KSA6IE9iamVjdC5rZXlzKGluamVjdCk7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIGtleSA9IGtleXNbaV07CiAgICAgIC8vICM2NTc0IGluIGNhc2UgdGhlIGluamVjdCBvYmplY3QgaXMgb2JzZXJ2ZWQuLi4KICAgICAgaWYgKGtleSA9PT0gJ19fb2JfXycpIGNvbnRpbnVlOwogICAgICB2YXIgcHJvdmlkZUtleSA9IGluamVjdFtrZXldLmZyb207CiAgICAgIGlmIChwcm92aWRlS2V5IGluIHZtLl9wcm92aWRlZCkgewogICAgICAgIHJlc3VsdFtrZXldID0gdm0uX3Byb3ZpZGVkW3Byb3ZpZGVLZXldOwogICAgICB9IGVsc2UgaWYgKCdkZWZhdWx0JyBpbiBpbmplY3Rba2V5XSkgewogICAgICAgIHZhciBwcm92aWRlRGVmYXVsdCA9IGluamVjdFtrZXldLmRlZmF1bHQ7CiAgICAgICAgcmVzdWx0W2tleV0gPSBpc0Z1bmN0aW9uKHByb3ZpZGVEZWZhdWx0KSA/IHByb3ZpZGVEZWZhdWx0LmNhbGwodm0pIDogcHJvdmlkZURlZmF1bHQ7CiAgICAgIH0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICAgIHdhcm4oIkluamVjdGlvbiBcIiIuY29uY2F0KGtleSwgIlwiIG5vdCBmb3VuZCIpLCB2bSk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiByZXN1bHQ7CiAgfQp9CmZ1bmN0aW9uIEZ1bmN0aW9uYWxSZW5kZXJDb250ZXh0KGRhdGEsIHByb3BzLCBjaGlsZHJlbiwgcGFyZW50LCBDdG9yKSB7CiAgdmFyIF90aGlzID0gdGhpczsKICB2YXIgb3B0aW9ucyA9IEN0b3Iub3B0aW9uczsKICAvLyBlbnN1cmUgdGhlIGNyZWF0ZUVsZW1lbnQgZnVuY3Rpb24gaW4gZnVuY3Rpb25hbCBjb21wb25lbnRzCiAgLy8gZ2V0cyBhIHVuaXF1ZSBjb250ZXh0IC0gdGhpcyBpcyBuZWNlc3NhcnkgZm9yIGNvcnJlY3QgbmFtZWQgc2xvdCBjaGVjawogIHZhciBjb250ZXh0Vm07CiAgaWYgKGhhc093bihwYXJlbnQsICdfdWlkJykpIHsKICAgIGNvbnRleHRWbSA9IE9iamVjdC5jcmVhdGUocGFyZW50KTsKICAgIGNvbnRleHRWbS5fb3JpZ2luYWwgPSBwYXJlbnQ7CiAgfSBlbHNlIHsKICAgIC8vIHRoZSBjb250ZXh0IHZtIHBhc3NlZCBpbiBpcyBhIGZ1bmN0aW9uYWwgY29udGV4dCBhcyB3ZWxsLgogICAgLy8gaW4gdGhpcyBjYXNlIHdlIHdhbnQgdG8gbWFrZSBzdXJlIHdlIGFyZSBhYmxlIHRvIGdldCBhIGhvbGQgdG8gdGhlCiAgICAvLyByZWFsIGNvbnRleHQgaW5zdGFuY2UuCiAgICBjb250ZXh0Vm0gPSBwYXJlbnQ7CiAgICAvLyBAdHMtaWdub3JlCiAgICBwYXJlbnQgPSBwYXJlbnQuX29yaWdpbmFsOwogIH0KICB2YXIgaXNDb21waWxlZCA9IGlzVHJ1ZShvcHRpb25zLl9jb21waWxlZCk7CiAgdmFyIG5lZWROb3JtYWxpemF0aW9uID0gIWlzQ29tcGlsZWQ7CiAgdGhpcy5kYXRhID0gZGF0YTsKICB0aGlzLnByb3BzID0gcHJvcHM7CiAgdGhpcy5jaGlsZHJlbiA9IGNoaWxkcmVuOwogIHRoaXMucGFyZW50ID0gcGFyZW50OwogIHRoaXMubGlzdGVuZXJzID0gZGF0YS5vbiB8fCBlbXB0eU9iamVjdDsKICB0aGlzLmluamVjdGlvbnMgPSByZXNvbHZlSW5qZWN0KG9wdGlvbnMuaW5qZWN0LCBwYXJlbnQpOwogIHRoaXMuc2xvdHMgPSBmdW5jdGlvbiAoKSB7CiAgICBpZiAoIV90aGlzLiRzbG90cykgewogICAgICBub3JtYWxpemVTY29wZWRTbG90cyhwYXJlbnQsIGRhdGEuc2NvcGVkU2xvdHMsIF90aGlzLiRzbG90cyA9IHJlc29sdmVTbG90cyhjaGlsZHJlbiwgcGFyZW50KSk7CiAgICB9CiAgICByZXR1cm4gX3RoaXMuJHNsb3RzOwogIH07CiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdzY29wZWRTbG90cycsIHsKICAgIGVudW1lcmFibGU6IHRydWUsCiAgICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIG5vcm1hbGl6ZVNjb3BlZFNsb3RzKHBhcmVudCwgZGF0YS5zY29wZWRTbG90cywgdGhpcy5zbG90cygpKTsKICAgIH0KICB9KTsKICAvLyBzdXBwb3J0IGZvciBjb21waWxlZCBmdW5jdGlvbmFsIHRlbXBsYXRlCiAgaWYgKGlzQ29tcGlsZWQpIHsKICAgIC8vIGV4cG9zaW5nICRvcHRpb25zIGZvciByZW5kZXJTdGF0aWMoKQogICAgdGhpcy4kb3B0aW9ucyA9IG9wdGlvbnM7CiAgICAvLyBwcmUtcmVzb2x2ZSBzbG90cyBmb3IgcmVuZGVyU2xvdCgpCiAgICB0aGlzLiRzbG90cyA9IHRoaXMuc2xvdHMoKTsKICAgIHRoaXMuJHNjb3BlZFNsb3RzID0gbm9ybWFsaXplU2NvcGVkU2xvdHMocGFyZW50LCBkYXRhLnNjb3BlZFNsb3RzLCB0aGlzLiRzbG90cyk7CiAgfQogIGlmIChvcHRpb25zLl9zY29wZUlkKSB7CiAgICB0aGlzLl9jID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHsKICAgICAgdmFyIHZub2RlID0gY3JlYXRlRWxlbWVudCQxKGNvbnRleHRWbSwgYSwgYiwgYywgZCwgbmVlZE5vcm1hbGl6YXRpb24pOwogICAgICBpZiAodm5vZGUgJiYgIWlzQXJyYXkodm5vZGUpKSB7CiAgICAgICAgdm5vZGUuZm5TY29wZUlkID0gb3B0aW9ucy5fc2NvcGVJZDsKICAgICAgICB2bm9kZS5mbkNvbnRleHQgPSBwYXJlbnQ7CiAgICAgIH0KICAgICAgcmV0dXJuIHZub2RlOwogICAgfTsKICB9IGVsc2UgewogICAgdGhpcy5fYyA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7CiAgICAgIHJldHVybiBjcmVhdGVFbGVtZW50JDEoY29udGV4dFZtLCBhLCBiLCBjLCBkLCBuZWVkTm9ybWFsaXphdGlvbik7CiAgICB9OwogIH0KfQppbnN0YWxsUmVuZGVySGVscGVycyhGdW5jdGlvbmFsUmVuZGVyQ29udGV4dC5wcm90b3R5cGUpOwpmdW5jdGlvbiBjcmVhdGVGdW5jdGlvbmFsQ29tcG9uZW50KEN0b3IsIHByb3BzRGF0YSwgZGF0YSwgY29udGV4dFZtLCBjaGlsZHJlbikgewogIHZhciBvcHRpb25zID0gQ3Rvci5vcHRpb25zOwogIHZhciBwcm9wcyA9IHt9OwogIHZhciBwcm9wT3B0aW9ucyA9IG9wdGlvbnMucHJvcHM7CiAgaWYgKGlzRGVmKHByb3BPcHRpb25zKSkgewogICAgZm9yICh2YXIga2V5IGluIHByb3BPcHRpb25zKSB7CiAgICAgIHByb3BzW2tleV0gPSB2YWxpZGF0ZVByb3Aoa2V5LCBwcm9wT3B0aW9ucywgcHJvcHNEYXRhIHx8IGVtcHR5T2JqZWN0KTsKICAgIH0KICB9IGVsc2UgewogICAgaWYgKGlzRGVmKGRhdGEuYXR0cnMpKSBtZXJnZVByb3BzKHByb3BzLCBkYXRhLmF0dHJzKTsKICAgIGlmIChpc0RlZihkYXRhLnByb3BzKSkgbWVyZ2VQcm9wcyhwcm9wcywgZGF0YS5wcm9wcyk7CiAgfQogIHZhciByZW5kZXJDb250ZXh0ID0gbmV3IEZ1bmN0aW9uYWxSZW5kZXJDb250ZXh0KGRhdGEsIHByb3BzLCBjaGlsZHJlbiwgY29udGV4dFZtLCBDdG9yKTsKICB2YXIgdm5vZGUgPSBvcHRpb25zLnJlbmRlci5jYWxsKG51bGwsIHJlbmRlckNvbnRleHQuX2MsIHJlbmRlckNvbnRleHQpOwogIGlmICh2bm9kZSBpbnN0YW5jZW9mIFZOb2RlKSB7CiAgICByZXR1cm4gY2xvbmVBbmRNYXJrRnVuY3Rpb25hbFJlc3VsdCh2bm9kZSwgZGF0YSwgcmVuZGVyQ29udGV4dC5wYXJlbnQsIG9wdGlvbnMsIHJlbmRlckNvbnRleHQpOwogIH0gZWxzZSBpZiAoaXNBcnJheSh2bm9kZSkpIHsKICAgIHZhciB2bm9kZXMgPSBub3JtYWxpemVDaGlsZHJlbih2bm9kZSkgfHwgW107CiAgICB2YXIgcmVzID0gbmV3IEFycmF5KHZub2Rlcy5sZW5ndGgpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2bm9kZXMubGVuZ3RoOyBpKyspIHsKICAgICAgcmVzW2ldID0gY2xvbmVBbmRNYXJrRnVuY3Rpb25hbFJlc3VsdCh2bm9kZXNbaV0sIGRhdGEsIHJlbmRlckNvbnRleHQucGFyZW50LCBvcHRpb25zLCByZW5kZXJDb250ZXh0KTsKICAgIH0KICAgIHJldHVybiByZXM7CiAgfQp9CmZ1bmN0aW9uIGNsb25lQW5kTWFya0Z1bmN0aW9uYWxSZXN1bHQodm5vZGUsIGRhdGEsIGNvbnRleHRWbSwgb3B0aW9ucywgcmVuZGVyQ29udGV4dCkgewogIC8vICM3ODE3IGNsb25lIG5vZGUgYmVmb3JlIHNldHRpbmcgZm5Db250ZXh0LCBvdGhlcndpc2UgaWYgdGhlIG5vZGUgaXMgcmV1c2VkCiAgLy8gKGUuZy4gaXQgd2FzIGZyb20gYSBjYWNoZWQgbm9ybWFsIHNsb3QpIHRoZSBmbkNvbnRleHQgY2F1c2VzIG5hbWVkIHNsb3RzCiAgLy8gdGhhdCBzaG91bGQgbm90IGJlIG1hdGNoZWQgdG8gbWF0Y2guCiAgdmFyIGNsb25lID0gY2xvbmVWTm9kZSh2bm9kZSk7CiAgY2xvbmUuZm5Db250ZXh0ID0gY29udGV4dFZtOwogIGNsb25lLmZuT3B0aW9ucyA9IG9wdGlvbnM7CiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgIChjbG9uZS5kZXZ0b29sc01ldGEgPSBjbG9uZS5kZXZ0b29sc01ldGEgfHwge30pLnJlbmRlckNvbnRleHQgPSByZW5kZXJDb250ZXh0OwogIH0KICBpZiAoZGF0YS5zbG90KSB7CiAgICAoY2xvbmUuZGF0YSB8fCAoY2xvbmUuZGF0YSA9IHt9KSkuc2xvdCA9IGRhdGEuc2xvdDsKICB9CiAgcmV0dXJuIGNsb25lOwp9CmZ1bmN0aW9uIG1lcmdlUHJvcHModG8sIGZyb20pIHsKICBmb3IgKHZhciBrZXkgaW4gZnJvbSkgewogICAgdG9bY2FtZWxpemUoa2V5KV0gPSBmcm9tW2tleV07CiAgfQp9CmZ1bmN0aW9uIGdldENvbXBvbmVudE5hbWUob3B0aW9ucykgewogIHJldHVybiBvcHRpb25zLm5hbWUgfHwgb3B0aW9ucy5fX25hbWUgfHwgb3B0aW9ucy5fY29tcG9uZW50VGFnOwp9Ci8vIGlubGluZSBob29rcyB0byBiZSBpbnZva2VkIG9uIGNvbXBvbmVudCBWTm9kZXMgZHVyaW5nIHBhdGNoCnZhciBjb21wb25lbnRWTm9kZUhvb2tzID0gewogIGluaXQ6IGZ1bmN0aW9uICh2bm9kZSwgaHlkcmF0aW5nKSB7CiAgICBpZiAodm5vZGUuY29tcG9uZW50SW5zdGFuY2UgJiYgIXZub2RlLmNvbXBvbmVudEluc3RhbmNlLl9pc0Rlc3Ryb3llZCAmJiB2bm9kZS5kYXRhLmtlZXBBbGl2ZSkgewogICAgICAvLyBrZXB0LWFsaXZlIGNvbXBvbmVudHMsIHRyZWF0IGFzIGEgcGF0Y2gKICAgICAgdmFyIG1vdW50ZWROb2RlID0gdm5vZGU7IC8vIHdvcmsgYXJvdW5kIGZsb3cKICAgICAgY29tcG9uZW50Vk5vZGVIb29rcy5wcmVwYXRjaChtb3VudGVkTm9kZSwgbW91bnRlZE5vZGUpOwogICAgfSBlbHNlIHsKICAgICAgdmFyIGNoaWxkID0gdm5vZGUuY29tcG9uZW50SW5zdGFuY2UgPSBjcmVhdGVDb21wb25lbnRJbnN0YW5jZUZvclZub2RlKHZub2RlLCBhY3RpdmVJbnN0YW5jZSk7CiAgICAgIGNoaWxkLiRtb3VudChoeWRyYXRpbmcgPyB2bm9kZS5lbG0gOiB1bmRlZmluZWQsIGh5ZHJhdGluZyk7CiAgICB9CiAgfSwKICBwcmVwYXRjaDogZnVuY3Rpb24gKG9sZFZub2RlLCB2bm9kZSkgewogICAgdmFyIG9wdGlvbnMgPSB2bm9kZS5jb21wb25lbnRPcHRpb25zOwogICAgdmFyIGNoaWxkID0gdm5vZGUuY29tcG9uZW50SW5zdGFuY2UgPSBvbGRWbm9kZS5jb21wb25lbnRJbnN0YW5jZTsKICAgIHVwZGF0ZUNoaWxkQ29tcG9uZW50KGNoaWxkLCBvcHRpb25zLnByb3BzRGF0YSwKICAgIC8vIHVwZGF0ZWQgcHJvcHMKICAgIG9wdGlvbnMubGlzdGVuZXJzLAogICAgLy8gdXBkYXRlZCBsaXN0ZW5lcnMKICAgIHZub2RlLAogICAgLy8gbmV3IHBhcmVudCB2bm9kZQogICAgb3B0aW9ucy5jaGlsZHJlbiAvLyBuZXcgY2hpbGRyZW4KICAgICk7CiAgfSwKICBpbnNlcnQ6IGZ1bmN0aW9uICh2bm9kZSkgewogICAgdmFyIGNvbnRleHQgPSB2bm9kZS5jb250ZXh0LAogICAgICBjb21wb25lbnRJbnN0YW5jZSA9IHZub2RlLmNvbXBvbmVudEluc3RhbmNlOwogICAgaWYgKCFjb21wb25lbnRJbnN0YW5jZS5faXNNb3VudGVkKSB7CiAgICAgIGNvbXBvbmVudEluc3RhbmNlLl9pc01vdW50ZWQgPSB0cnVlOwogICAgICBjYWxsSG9vayQxKGNvbXBvbmVudEluc3RhbmNlLCAnbW91bnRlZCcpOwogICAgfQogICAgaWYgKHZub2RlLmRhdGEua2VlcEFsaXZlKSB7CiAgICAgIGlmIChjb250ZXh0Ll9pc01vdW50ZWQpIHsKICAgICAgICAvLyB2dWUtcm91dGVyIzEyMTIKICAgICAgICAvLyBEdXJpbmcgdXBkYXRlcywgYSBrZXB0LWFsaXZlIGNvbXBvbmVudCdzIGNoaWxkIGNvbXBvbmVudHMgbWF5CiAgICAgICAgLy8gY2hhbmdlLCBzbyBkaXJlY3RseSB3YWxraW5nIHRoZSB0cmVlIGhlcmUgbWF5IGNhbGwgYWN0aXZhdGVkIGhvb2tzCiAgICAgICAgLy8gb24gaW5jb3JyZWN0IGNoaWxkcmVuLiBJbnN0ZWFkIHdlIHB1c2ggdGhlbSBpbnRvIGEgcXVldWUgd2hpY2ggd2lsbAogICAgICAgIC8vIGJlIHByb2Nlc3NlZCBhZnRlciB0aGUgd2hvbGUgcGF0Y2ggcHJvY2VzcyBlbmRlZC4KICAgICAgICBxdWV1ZUFjdGl2YXRlZENvbXBvbmVudChjb21wb25lbnRJbnN0YW5jZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWN0aXZhdGVDaGlsZENvbXBvbmVudChjb21wb25lbnRJbnN0YW5jZSwgdHJ1ZSAvKiBkaXJlY3QgKi8pOwogICAgICB9CiAgICB9CiAgfSwKICBkZXN0cm95OiBmdW5jdGlvbiAodm5vZGUpIHsKICAgIHZhciBjb21wb25lbnRJbnN0YW5jZSA9IHZub2RlLmNvbXBvbmVudEluc3RhbmNlOwogICAgaWYgKCFjb21wb25lbnRJbnN0YW5jZS5faXNEZXN0cm95ZWQpIHsKICAgICAgaWYgKCF2bm9kZS5kYXRhLmtlZXBBbGl2ZSkgewogICAgICAgIGNvbXBvbmVudEluc3RhbmNlLiRkZXN0cm95KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGVhY3RpdmF0ZUNoaWxkQ29tcG9uZW50KGNvbXBvbmVudEluc3RhbmNlLCB0cnVlIC8qIGRpcmVjdCAqLyk7CiAgICAgIH0KICAgIH0KICB9Cn07CnZhciBob29rc1RvTWVyZ2UgPSBPYmplY3Qua2V5cyhjb21wb25lbnRWTm9kZUhvb2tzKTsKZnVuY3Rpb24gY3JlYXRlQ29tcG9uZW50KEN0b3IsIGRhdGEsIGNvbnRleHQsIGNoaWxkcmVuLCB0YWcpIHsKICBpZiAoaXNVbmRlZihDdG9yKSkgewogICAgcmV0dXJuOwogIH0KICB2YXIgYmFzZUN0b3IgPSBjb250ZXh0LiRvcHRpb25zLl9iYXNlOwogIC8vIHBsYWluIG9wdGlvbnMgb2JqZWN0OiB0dXJuIGl0IGludG8gYSBjb25zdHJ1Y3RvcgogIGlmIChpc09iamVjdChDdG9yKSkgewogICAgQ3RvciA9IGJhc2VDdG9yLmV4dGVuZChDdG9yKTsKICB9CiAgLy8gaWYgYXQgdGhpcyBzdGFnZSBpdCdzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIGFuIGFzeW5jIGNvbXBvbmVudCBmYWN0b3J5LAogIC8vIHJlamVjdC4KICBpZiAodHlwZW9mIEN0b3IgIT09ICdmdW5jdGlvbicpIHsKICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICAgIHdhcm4oIkludmFsaWQgQ29tcG9uZW50IGRlZmluaXRpb246ICIuY29uY2F0KFN0cmluZyhDdG9yKSksIGNvbnRleHQpOwogICAgfQogICAgcmV0dXJuOwogIH0KICAvLyBhc3luYyBjb21wb25lbnQKICB2YXIgYXN5bmNGYWN0b3J5OwogIC8vIEB0cy1leHBlY3QtZXJyb3IKICBpZiAoaXNVbmRlZihDdG9yLmNpZCkpIHsKICAgIGFzeW5jRmFjdG9yeSA9IEN0b3I7CiAgICBDdG9yID0gcmVzb2x2ZUFzeW5jQ29tcG9uZW50KGFzeW5jRmFjdG9yeSwgYmFzZUN0b3IpOwogICAgaWYgKEN0b3IgPT09IHVuZGVmaW5lZCkgewogICAgICAvLyByZXR1cm4gYSBwbGFjZWhvbGRlciBub2RlIGZvciBhc3luYyBjb21wb25lbnQsIHdoaWNoIGlzIHJlbmRlcmVkCiAgICAgIC8vIGFzIGEgY29tbWVudCBub2RlIGJ1dCBwcmVzZXJ2ZXMgYWxsIHRoZSByYXcgaW5mb3JtYXRpb24gZm9yIHRoZSBub2RlLgogICAgICAvLyB0aGUgaW5mb3JtYXRpb24gd2lsbCBiZSB1c2VkIGZvciBhc3luYyBzZXJ2ZXItcmVuZGVyaW5nIGFuZCBoeWRyYXRpb24uCiAgICAgIHJldHVybiBjcmVhdGVBc3luY1BsYWNlaG9sZGVyKGFzeW5jRmFjdG9yeSwgZGF0YSwgY29udGV4dCwgY2hpbGRyZW4sIHRhZyk7CiAgICB9CiAgfQogIGRhdGEgPSBkYXRhIHx8IHt9OwogIC8vIHJlc29sdmUgY29uc3RydWN0b3Igb3B0aW9ucyBpbiBjYXNlIGdsb2JhbCBtaXhpbnMgYXJlIGFwcGxpZWQgYWZ0ZXIKICAvLyBjb21wb25lbnQgY29uc3RydWN0b3IgY3JlYXRpb24KICByZXNvbHZlQ29uc3RydWN0b3JPcHRpb25zKEN0b3IpOwogIC8vIHRyYW5zZm9ybSBjb21wb25lbnQgdi1tb2RlbCBkYXRhIGludG8gcHJvcHMgJiBldmVudHMKICBpZiAoaXNEZWYoZGF0YS5tb2RlbCkpIHsKICAgIC8vIEB0cy1leHBlY3QtZXJyb3IKICAgIHRyYW5zZm9ybU1vZGVsKEN0b3Iub3B0aW9ucywgZGF0YSk7CiAgfQogIC8vIGV4dHJhY3QgcHJvcHMKICAvLyBAdHMtZXhwZWN0LWVycm9yCiAgdmFyIHByb3BzRGF0YSA9IGV4dHJhY3RQcm9wc0Zyb21WTm9kZURhdGEoZGF0YSwgQ3RvciwgdGFnKTsKICAvLyBmdW5jdGlvbmFsIGNvbXBvbmVudAogIC8vIEB0cy1leHBlY3QtZXJyb3IKICBpZiAoaXNUcnVlKEN0b3Iub3B0aW9ucy5mdW5jdGlvbmFsKSkgewogICAgcmV0dXJuIGNyZWF0ZUZ1bmN0aW9uYWxDb21wb25lbnQoQ3RvciwgcHJvcHNEYXRhLCBkYXRhLCBjb250ZXh0LCBjaGlsZHJlbik7CiAgfQogIC8vIGV4dHJhY3QgbGlzdGVuZXJzLCBzaW5jZSB0aGVzZSBuZWVkcyB0byBiZSB0cmVhdGVkIGFzCiAgLy8gY2hpbGQgY29tcG9uZW50IGxpc3RlbmVycyBpbnN0ZWFkIG9mIERPTSBsaXN0ZW5lcnMKICB2YXIgbGlzdGVuZXJzID0gZGF0YS5vbjsKICAvLyByZXBsYWNlIHdpdGggbGlzdGVuZXJzIHdpdGggLm5hdGl2ZSBtb2RpZmllcgogIC8vIHNvIGl0IGdldHMgcHJvY2Vzc2VkIGR1cmluZyBwYXJlbnQgY29tcG9uZW50IHBhdGNoLgogIGRhdGEub24gPSBkYXRhLm5hdGl2ZU9uOwogIC8vIEB0cy1leHBlY3QtZXJyb3IKICBpZiAoaXNUcnVlKEN0b3Iub3B0aW9ucy5hYnN0cmFjdCkpIHsKICAgIC8vIGFic3RyYWN0IGNvbXBvbmVudHMgZG8gbm90IGtlZXAgYW55dGhpbmcKICAgIC8vIG90aGVyIHRoYW4gcHJvcHMgJiBsaXN0ZW5lcnMgJiBzbG90CiAgICAvLyB3b3JrIGFyb3VuZCBmbG93CiAgICB2YXIgc2xvdCA9IGRhdGEuc2xvdDsKICAgIGRhdGEgPSB7fTsKICAgIGlmIChzbG90KSB7CiAgICAgIGRhdGEuc2xvdCA9IHNsb3Q7CiAgICB9CiAgfQogIC8vIGluc3RhbGwgY29tcG9uZW50IG1hbmFnZW1lbnQgaG9va3Mgb250byB0aGUgcGxhY2Vob2xkZXIgbm9kZQogIGluc3RhbGxDb21wb25lbnRIb29rcyhkYXRhKTsKICAvLyByZXR1cm4gYSBwbGFjZWhvbGRlciB2bm9kZQogIC8vIEB0cy1leHBlY3QtZXJyb3IKICB2YXIgbmFtZSA9IGdldENvbXBvbmVudE5hbWUoQ3Rvci5vcHRpb25zKSB8fCB0YWc7CiAgdmFyIHZub2RlID0gbmV3IFZOb2RlKAogIC8vIEB0cy1leHBlY3QtZXJyb3IKICAidnVlLWNvbXBvbmVudC0iLmNvbmNhdChDdG9yLmNpZCkuY29uY2F0KG5hbWUgPyAiLSIuY29uY2F0KG5hbWUpIDogJycpLCBkYXRhLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBjb250ZXh0LAogIC8vIEB0cy1leHBlY3QtZXJyb3IKICB7CiAgICBDdG9yOiBDdG9yLAogICAgcHJvcHNEYXRhOiBwcm9wc0RhdGEsCiAgICBsaXN0ZW5lcnM6IGxpc3RlbmVycywKICAgIHRhZzogdGFnLAogICAgY2hpbGRyZW46IGNoaWxkcmVuCiAgfSwgYXN5bmNGYWN0b3J5KTsKICByZXR1cm4gdm5vZGU7Cn0KZnVuY3Rpb24gY3JlYXRlQ29tcG9uZW50SW5zdGFuY2VGb3JWbm9kZSgKLy8gd2Uga25vdyBpdCdzIE1vdW50ZWRDb21wb25lbnRWTm9kZSBidXQgZmxvdyBkb2Vzbid0CnZub2RlLAovLyBhY3RpdmVJbnN0YW5jZSBpbiBsaWZlY3ljbGUgc3RhdGUKcGFyZW50KSB7CiAgdmFyIG9wdGlvbnMgPSB7CiAgICBfaXNDb21wb25lbnQ6IHRydWUsCiAgICBfcGFyZW50Vm5vZGU6IHZub2RlLAogICAgcGFyZW50OiBwYXJlbnQKICB9OwogIC8vIGNoZWNrIGlubGluZS10ZW1wbGF0ZSByZW5kZXIgZnVuY3Rpb25zCiAgdmFyIGlubGluZVRlbXBsYXRlID0gdm5vZGUuZGF0YS5pbmxpbmVUZW1wbGF0ZTsKICBpZiAoaXNEZWYoaW5saW5lVGVtcGxhdGUpKSB7CiAgICBvcHRpb25zLnJlbmRlciA9IGlubGluZVRlbXBsYXRlLnJlbmRlcjsKICAgIG9wdGlvbnMuc3RhdGljUmVuZGVyRm5zID0gaW5saW5lVGVtcGxhdGUuc3RhdGljUmVuZGVyRm5zOwogIH0KICByZXR1cm4gbmV3IHZub2RlLmNvbXBvbmVudE9wdGlvbnMuQ3RvcihvcHRpb25zKTsKfQpmdW5jdGlvbiBpbnN0YWxsQ29tcG9uZW50SG9va3MoZGF0YSkgewogIHZhciBob29rcyA9IGRhdGEuaG9vayB8fCAoZGF0YS5ob29rID0ge30pOwogIGZvciAodmFyIGkgPSAwOyBpIDwgaG9va3NUb01lcmdlLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIga2V5ID0gaG9va3NUb01lcmdlW2ldOwogICAgdmFyIGV4aXN0aW5nID0gaG9va3Nba2V5XTsKICAgIHZhciB0b01lcmdlID0gY29tcG9uZW50Vk5vZGVIb29rc1trZXldOwogICAgLy8gQHRzLWV4cGVjdC1lcnJvcgogICAgaWYgKGV4aXN0aW5nICE9PSB0b01lcmdlICYmICEoZXhpc3RpbmcgJiYgZXhpc3RpbmcuX21lcmdlZCkpIHsKICAgICAgaG9va3Nba2V5XSA9IGV4aXN0aW5nID8gbWVyZ2VIb29rKHRvTWVyZ2UsIGV4aXN0aW5nKSA6IHRvTWVyZ2U7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIG1lcmdlSG9vayhmMSwgZjIpIHsKICB2YXIgbWVyZ2VkID0gZnVuY3Rpb24gKGEsIGIpIHsKICAgIC8vIGZsb3cgY29tcGxhaW5zIGFib3V0IGV4dHJhIGFyZ3Mgd2hpY2ggaXMgd2h5IHdlIHVzZSBhbnkKICAgIGYxKGEsIGIpOwogICAgZjIoYSwgYik7CiAgfTsKICBtZXJnZWQuX21lcmdlZCA9IHRydWU7CiAgcmV0dXJuIG1lcmdlZDsKfQovLyB0cmFuc2Zvcm0gY29tcG9uZW50IHYtbW9kZWwgaW5mbyAodmFsdWUgYW5kIGNhbGxiYWNrKSBpbnRvCi8vIHByb3AgYW5kIGV2ZW50IGhhbmRsZXIgcmVzcGVjdGl2ZWx5LgpmdW5jdGlvbiB0cmFuc2Zvcm1Nb2RlbChvcHRpb25zLCBkYXRhKSB7CiAgdmFyIHByb3AgPSBvcHRpb25zLm1vZGVsICYmIG9wdGlvbnMubW9kZWwucHJvcCB8fCAndmFsdWUnOwogIHZhciBldmVudCA9IG9wdGlvbnMubW9kZWwgJiYgb3B0aW9ucy5tb2RlbC5ldmVudCB8fCAnaW5wdXQnOwogIChkYXRhLmF0dHJzIHx8IChkYXRhLmF0dHJzID0ge30pKVtwcm9wXSA9IGRhdGEubW9kZWwudmFsdWU7CiAgdmFyIG9uID0gZGF0YS5vbiB8fCAoZGF0YS5vbiA9IHt9KTsKICB2YXIgZXhpc3RpbmcgPSBvbltldmVudF07CiAgdmFyIGNhbGxiYWNrID0gZGF0YS5tb2RlbC5jYWxsYmFjazsKICBpZiAoaXNEZWYoZXhpc3RpbmcpKSB7CiAgICBpZiAoaXNBcnJheShleGlzdGluZykgPyBleGlzdGluZy5pbmRleE9mKGNhbGxiYWNrKSA9PT0gLTEgOiBleGlzdGluZyAhPT0gY2FsbGJhY2spIHsKICAgICAgb25bZXZlbnRdID0gW2NhbGxiYWNrXS5jb25jYXQoZXhpc3RpbmcpOwogICAgfQogIH0gZWxzZSB7CiAgICBvbltldmVudF0gPSBjYWxsYmFjazsKICB9Cn0KdmFyIHdhcm4gPSBub29wOwp2YXIgdGlwID0gbm9vcDsKdmFyIGdlbmVyYXRlQ29tcG9uZW50VHJhY2U7IC8vIHdvcmsgYXJvdW5kIGZsb3cgY2hlY2sKdmFyIGZvcm1hdENvbXBvbmVudE5hbWU7CmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgdmFyIGhhc0NvbnNvbGVfMSA9IHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJzsKICB2YXIgY2xhc3NpZnlSRV8xID0gLyg/Ol58Wy1fXSkoXHcpL2c7CiAgdmFyIGNsYXNzaWZ5XzEgPSBmdW5jdGlvbiAoc3RyKSB7CiAgICByZXR1cm4gc3RyLnJlcGxhY2UoY2xhc3NpZnlSRV8xLCBmdW5jdGlvbiAoYykgewogICAgICByZXR1cm4gYy50b1VwcGVyQ2FzZSgpOwogICAgfSkucmVwbGFjZSgvWy1fXS9nLCAnJyk7CiAgfTsKICB3YXJuID0gZnVuY3Rpb24gKG1zZywgdm0pIHsKICAgIGlmICh2bSA9PT0gdm9pZCAwKSB7CiAgICAgIHZtID0gY3VycmVudEluc3RhbmNlOwogICAgfQogICAgdmFyIHRyYWNlID0gdm0gPyBnZW5lcmF0ZUNvbXBvbmVudFRyYWNlKHZtKSA6ICcnOwogICAgaWYgKGNvbmZpZy53YXJuSGFuZGxlcikgewogICAgICBjb25maWcud2FybkhhbmRsZXIuY2FsbChudWxsLCBtc2csIHZtLCB0cmFjZSk7CiAgICB9IGVsc2UgaWYgKGhhc0NvbnNvbGVfMSAmJiAhY29uZmlnLnNpbGVudCkgewogICAgICBjb25zb2xlLmVycm9yKCJbVnVlIHdhcm5dOiAiLmNvbmNhdChtc2cpLmNvbmNhdCh0cmFjZSkpOwogICAgfQogIH07CiAgdGlwID0gZnVuY3Rpb24gKG1zZywgdm0pIHsKICAgIGlmIChoYXNDb25zb2xlXzEgJiYgIWNvbmZpZy5zaWxlbnQpIHsKICAgICAgY29uc29sZS53YXJuKCJbVnVlIHRpcF06ICIuY29uY2F0KG1zZykgKyAodm0gPyBnZW5lcmF0ZUNvbXBvbmVudFRyYWNlKHZtKSA6ICcnKSk7CiAgICB9CiAgfTsKICBmb3JtYXRDb21wb25lbnROYW1lID0gZnVuY3Rpb24gKHZtLCBpbmNsdWRlRmlsZSkgewogICAgaWYgKHZtLiRyb290ID09PSB2bSkgewogICAgICByZXR1cm4gJzxSb290Pic7CiAgICB9CiAgICB2YXIgb3B0aW9ucyA9IGlzRnVuY3Rpb24odm0pICYmIHZtLmNpZCAhPSBudWxsID8gdm0ub3B0aW9ucyA6IHZtLl9pc1Z1ZSA/IHZtLiRvcHRpb25zIHx8IHZtLmNvbnN0cnVjdG9yLm9wdGlvbnMgOiB2bTsKICAgIHZhciBuYW1lID0gZ2V0Q29tcG9uZW50TmFtZShvcHRpb25zKTsKICAgIHZhciBmaWxlID0gb3B0aW9ucy5fX2ZpbGU7CiAgICBpZiAoIW5hbWUgJiYgZmlsZSkgewogICAgICB2YXIgbWF0Y2ggPSBmaWxlLm1hdGNoKC8oW14vXFxdKylcLnZ1ZSQvKTsKICAgICAgbmFtZSA9IG1hdGNoICYmIG1hdGNoWzFdOwogICAgfQogICAgcmV0dXJuIChuYW1lID8gIjwiLmNvbmNhdChjbGFzc2lmeV8xKG5hbWUpLCAiPiIpIDogIjxBbm9ueW1vdXM+IikgKyAoZmlsZSAmJiBpbmNsdWRlRmlsZSAhPT0gZmFsc2UgPyAiIGF0ICIuY29uY2F0KGZpbGUpIDogJycpOwogIH07CiAgdmFyIHJlcGVhdF8xID0gZnVuY3Rpb24gKHN0ciwgbikgewogICAgdmFyIHJlcyA9ICcnOwogICAgd2hpbGUgKG4pIHsKICAgICAgaWYgKG4gJSAyID09PSAxKSByZXMgKz0gc3RyOwogICAgICBpZiAobiA+IDEpIHN0ciArPSBzdHI7CiAgICAgIG4gPj49IDE7CiAgICB9CiAgICByZXR1cm4gcmVzOwogIH07CiAgZ2VuZXJhdGVDb21wb25lbnRUcmFjZSA9IGZ1bmN0aW9uICh2bSkgewogICAgaWYgKHZtLl9pc1Z1ZSAmJiB2bS4kcGFyZW50KSB7CiAgICAgIHZhciB0cmVlID0gW107CiAgICAgIHZhciBjdXJyZW50UmVjdXJzaXZlU2VxdWVuY2UgPSAwOwogICAgICB3aGlsZSAodm0pIHsKICAgICAgICBpZiAodHJlZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICB2YXIgbGFzdCA9IHRyZWVbdHJlZS5sZW5ndGggLSAxXTsKICAgICAgICAgIGlmIChsYXN0LmNvbnN0cnVjdG9yID09PSB2bS5jb25zdHJ1Y3RvcikgewogICAgICAgICAgICBjdXJyZW50UmVjdXJzaXZlU2VxdWVuY2UrKzsKICAgICAgICAgICAgdm0gPSB2bS4kcGFyZW50OwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFJlY3Vyc2l2ZVNlcXVlbmNlID4gMCkgewogICAgICAgICAgICB0cmVlW3RyZWUubGVuZ3RoIC0gMV0gPSBbbGFzdCwgY3VycmVudFJlY3Vyc2l2ZVNlcXVlbmNlXTsKICAgICAgICAgICAgY3VycmVudFJlY3Vyc2l2ZVNlcXVlbmNlID0gMDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdHJlZS5wdXNoKHZtKTsKICAgICAgICB2bSA9IHZtLiRwYXJlbnQ7CiAgICAgIH0KICAgICAgcmV0dXJuICdcblxuZm91bmQgaW5cblxuJyArIHRyZWUubWFwKGZ1bmN0aW9uICh2bSwgaSkgewogICAgICAgIHJldHVybiAiIi5jb25jYXQoaSA9PT0gMCA/ICctLS0+ICcgOiByZXBlYXRfMSgnICcsIDUgKyBpICogMikpLmNvbmNhdChpc0FycmF5KHZtKSA/ICIiLmNvbmNhdChmb3JtYXRDb21wb25lbnROYW1lKHZtWzBdKSwgIi4uLiAoIikuY29uY2F0KHZtWzFdLCAiIHJlY3Vyc2l2ZSBjYWxscykiKSA6IGZvcm1hdENvbXBvbmVudE5hbWUodm0pKTsKICAgICAgfSkuam9pbignXG4nKTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiAiXG5cbihmb3VuZCBpbiAiLmNvbmNhdChmb3JtYXRDb21wb25lbnROYW1lKHZtKSwgIikiKTsKICAgIH0KICB9Owp9CgovKioKICogT3B0aW9uIG92ZXJ3cml0aW5nIHN0cmF0ZWdpZXMgYXJlIGZ1bmN0aW9ucyB0aGF0IGhhbmRsZQogKiBob3cgdG8gbWVyZ2UgYSBwYXJlbnQgb3B0aW9uIHZhbHVlIGFuZCBhIGNoaWxkIG9wdGlvbgogKiB2YWx1ZSBpbnRvIHRoZSBmaW5hbCB2YWx1ZS4KICovCnZhciBzdHJhdHMgPSBjb25maWcub3B0aW9uTWVyZ2VTdHJhdGVnaWVzOwovKioKICogT3B0aW9ucyB3aXRoIHJlc3RyaWN0aW9ucwogKi8KaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICBzdHJhdHMuZWwgPSBzdHJhdHMucHJvcHNEYXRhID0gZnVuY3Rpb24gKHBhcmVudCwgY2hpbGQsIHZtLCBrZXkpIHsKICAgIGlmICghdm0pIHsKICAgICAgd2Fybigib3B0aW9uIFwiIi5jb25jYXQoa2V5LCAiXCIgY2FuIG9ubHkgYmUgdXNlZCBkdXJpbmcgaW5zdGFuY2UgIikgKyAnY3JlYXRpb24gd2l0aCB0aGUgYG5ld2Aga2V5d29yZC4nKTsKICAgIH0KICAgIHJldHVybiBkZWZhdWx0U3RyYXQocGFyZW50LCBjaGlsZCk7CiAgfTsKfQovKioKICogSGVscGVyIHRoYXQgcmVjdXJzaXZlbHkgbWVyZ2VzIHR3byBkYXRhIG9iamVjdHMgdG9nZXRoZXIuCiAqLwpmdW5jdGlvbiBtZXJnZURhdGEodG8sIGZyb20sIHJlY3Vyc2l2ZSkgewogIGlmIChyZWN1cnNpdmUgPT09IHZvaWQgMCkgewogICAgcmVjdXJzaXZlID0gdHJ1ZTsKICB9CiAgaWYgKCFmcm9tKSByZXR1cm4gdG87CiAgdmFyIGtleSwgdG9WYWwsIGZyb21WYWw7CiAgdmFyIGtleXMgPSBoYXNTeW1ib2wgPyBSZWZsZWN0Lm93bktleXMoZnJvbSkgOiBPYmplY3Qua2V5cyhmcm9tKTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgIGtleSA9IGtleXNbaV07CiAgICAvLyBpbiBjYXNlIHRoZSBvYmplY3QgaXMgYWxyZWFkeSBvYnNlcnZlZC4uLgogICAgaWYgKGtleSA9PT0gJ19fb2JfXycpIGNvbnRpbnVlOwogICAgdG9WYWwgPSB0b1trZXldOwogICAgZnJvbVZhbCA9IGZyb21ba2V5XTsKICAgIGlmICghcmVjdXJzaXZlIHx8ICFoYXNPd24odG8sIGtleSkpIHsKICAgICAgc2V0KHRvLCBrZXksIGZyb21WYWwpOwogICAgfSBlbHNlIGlmICh0b1ZhbCAhPT0gZnJvbVZhbCAmJiBpc1BsYWluT2JqZWN0KHRvVmFsKSAmJiBpc1BsYWluT2JqZWN0KGZyb21WYWwpKSB7CiAgICAgIG1lcmdlRGF0YSh0b1ZhbCwgZnJvbVZhbCk7CiAgICB9CiAgfQogIHJldHVybiB0bzsKfQovKioKICogRGF0YQogKi8KZnVuY3Rpb24gbWVyZ2VEYXRhT3JGbihwYXJlbnRWYWwsIGNoaWxkVmFsLCB2bSkgewogIGlmICghdm0pIHsKICAgIC8vIGluIGEgVnVlLmV4dGVuZCBtZXJnZSwgYm90aCBzaG91bGQgYmUgZnVuY3Rpb25zCiAgICBpZiAoIWNoaWxkVmFsKSB7CiAgICAgIHJldHVybiBwYXJlbnRWYWw7CiAgICB9CiAgICBpZiAoIXBhcmVudFZhbCkgewogICAgICByZXR1cm4gY2hpbGRWYWw7CiAgICB9CiAgICAvLyB3aGVuIHBhcmVudFZhbCAmIGNoaWxkVmFsIGFyZSBib3RoIHByZXNlbnQsCiAgICAvLyB3ZSBuZWVkIHRvIHJldHVybiBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUKICAgIC8vIG1lcmdlZCByZXN1bHQgb2YgYm90aCBmdW5jdGlvbnMuLi4gbm8gbmVlZCB0bwogICAgLy8gY2hlY2sgaWYgcGFyZW50VmFsIGlzIGEgZnVuY3Rpb24gaGVyZSBiZWNhdXNlCiAgICAvLyBpdCBoYXMgdG8gYmUgYSBmdW5jdGlvbiB0byBwYXNzIHByZXZpb3VzIG1lcmdlcy4KICAgIHJldHVybiBmdW5jdGlvbiBtZXJnZWREYXRhRm4oKSB7CiAgICAgIHJldHVybiBtZXJnZURhdGEoaXNGdW5jdGlvbihjaGlsZFZhbCkgPyBjaGlsZFZhbC5jYWxsKHRoaXMsIHRoaXMpIDogY2hpbGRWYWwsIGlzRnVuY3Rpb24ocGFyZW50VmFsKSA/IHBhcmVudFZhbC5jYWxsKHRoaXMsIHRoaXMpIDogcGFyZW50VmFsKTsKICAgIH07CiAgfSBlbHNlIHsKICAgIHJldHVybiBmdW5jdGlvbiBtZXJnZWRJbnN0YW5jZURhdGFGbigpIHsKICAgICAgLy8gaW5zdGFuY2UgbWVyZ2UKICAgICAgdmFyIGluc3RhbmNlRGF0YSA9IGlzRnVuY3Rpb24oY2hpbGRWYWwpID8gY2hpbGRWYWwuY2FsbCh2bSwgdm0pIDogY2hpbGRWYWw7CiAgICAgIHZhciBkZWZhdWx0RGF0YSA9IGlzRnVuY3Rpb24ocGFyZW50VmFsKSA/IHBhcmVudFZhbC5jYWxsKHZtLCB2bSkgOiBwYXJlbnRWYWw7CiAgICAgIGlmIChpbnN0YW5jZURhdGEpIHsKICAgICAgICByZXR1cm4gbWVyZ2VEYXRhKGluc3RhbmNlRGF0YSwgZGVmYXVsdERhdGEpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBkZWZhdWx0RGF0YTsKICAgICAgfQogICAgfTsKICB9Cn0Kc3RyYXRzLmRhdGEgPSBmdW5jdGlvbiAocGFyZW50VmFsLCBjaGlsZFZhbCwgdm0pIHsKICBpZiAoIXZtKSB7CiAgICBpZiAoY2hpbGRWYWwgJiYgdHlwZW9mIGNoaWxkVmFsICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgd2FybignVGhlICJkYXRhIiBvcHRpb24gc2hvdWxkIGJlIGEgZnVuY3Rpb24gJyArICd0aGF0IHJldHVybnMgYSBwZXItaW5zdGFuY2UgdmFsdWUgaW4gY29tcG9uZW50ICcgKyAnZGVmaW5pdGlvbnMuJywgdm0pOwogICAgICByZXR1cm4gcGFyZW50VmFsOwogICAgfQogICAgcmV0dXJuIG1lcmdlRGF0YU9yRm4ocGFyZW50VmFsLCBjaGlsZFZhbCk7CiAgfQogIHJldHVybiBtZXJnZURhdGFPckZuKHBhcmVudFZhbCwgY2hpbGRWYWwsIHZtKTsKfTsKLyoqCiAqIEhvb2tzIGFuZCBwcm9wcyBhcmUgbWVyZ2VkIGFzIGFycmF5cy4KICovCmZ1bmN0aW9uIG1lcmdlTGlmZWN5Y2xlSG9vayhwYXJlbnRWYWwsIGNoaWxkVmFsKSB7CiAgdmFyIHJlcyA9IGNoaWxkVmFsID8gcGFyZW50VmFsID8gcGFyZW50VmFsLmNvbmNhdChjaGlsZFZhbCkgOiBpc0FycmF5KGNoaWxkVmFsKSA/IGNoaWxkVmFsIDogW2NoaWxkVmFsXSA6IHBhcmVudFZhbDsKICByZXR1cm4gcmVzID8gZGVkdXBlSG9va3MocmVzKSA6IHJlczsKfQpmdW5jdGlvbiBkZWR1cGVIb29rcyhob29rcykgewogIHZhciByZXMgPSBbXTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGhvb2tzLmxlbmd0aDsgaSsrKSB7CiAgICBpZiAocmVzLmluZGV4T2YoaG9va3NbaV0pID09PSAtMSkgewogICAgICByZXMucHVzaChob29rc1tpXSk7CiAgICB9CiAgfQogIHJldHVybiByZXM7Cn0KTElGRUNZQ0xFX0hPT0tTLmZvckVhY2goZnVuY3Rpb24gKGhvb2spIHsKICBzdHJhdHNbaG9va10gPSBtZXJnZUxpZmVjeWNsZUhvb2s7Cn0pOwovKioKICogQXNzZXRzCiAqCiAqIFdoZW4gYSB2bSBpcyBwcmVzZW50IChpbnN0YW5jZSBjcmVhdGlvbiksIHdlIG5lZWQgdG8gZG8KICogYSB0aHJlZS13YXkgbWVyZ2UgYmV0d2VlbiBjb25zdHJ1Y3RvciBvcHRpb25zLCBpbnN0YW5jZQogKiBvcHRpb25zIGFuZCBwYXJlbnQgb3B0aW9ucy4KICovCmZ1bmN0aW9uIG1lcmdlQXNzZXRzKHBhcmVudFZhbCwgY2hpbGRWYWwsIHZtLCBrZXkpIHsKICB2YXIgcmVzID0gT2JqZWN0LmNyZWF0ZShwYXJlbnRWYWwgfHwgbnVsbCk7CiAgaWYgKGNoaWxkVmFsKSB7CiAgICBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIGFzc2VydE9iamVjdFR5cGUoa2V5LCBjaGlsZFZhbCwgdm0pOwogICAgcmV0dXJuIGV4dGVuZChyZXMsIGNoaWxkVmFsKTsKICB9IGVsc2UgewogICAgcmV0dXJuIHJlczsKICB9Cn0KQVNTRVRfVFlQRVMuZm9yRWFjaChmdW5jdGlvbiAodHlwZSkgewogIHN0cmF0c1t0eXBlICsgJ3MnXSA9IG1lcmdlQXNzZXRzOwp9KTsKLyoqCiAqIFdhdGNoZXJzLgogKgogKiBXYXRjaGVycyBoYXNoZXMgc2hvdWxkIG5vdCBvdmVyd3JpdGUgb25lCiAqIGFub3RoZXIsIHNvIHdlIG1lcmdlIHRoZW0gYXMgYXJyYXlzLgogKi8Kc3RyYXRzLndhdGNoID0gZnVuY3Rpb24gKHBhcmVudFZhbCwgY2hpbGRWYWwsIHZtLCBrZXkpIHsKICAvLyB3b3JrIGFyb3VuZCBGaXJlZm94J3MgT2JqZWN0LnByb3RvdHlwZS53YXRjaC4uLgogIC8vQHRzLWV4cGVjdC1lcnJvciB3b3JrIGFyb3VuZAogIGlmIChwYXJlbnRWYWwgPT09IG5hdGl2ZVdhdGNoKSBwYXJlbnRWYWwgPSB1bmRlZmluZWQ7CiAgLy9AdHMtZXhwZWN0LWVycm9yIHdvcmsgYXJvdW5kCiAgaWYgKGNoaWxkVmFsID09PSBuYXRpdmVXYXRjaCkgY2hpbGRWYWwgPSB1bmRlZmluZWQ7CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKCFjaGlsZFZhbCkgcmV0dXJuIE9iamVjdC5jcmVhdGUocGFyZW50VmFsIHx8IG51bGwpOwogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICBhc3NlcnRPYmplY3RUeXBlKGtleSwgY2hpbGRWYWwsIHZtKTsKICB9CiAgaWYgKCFwYXJlbnRWYWwpIHJldHVybiBjaGlsZFZhbDsKICB2YXIgcmV0ID0ge307CiAgZXh0ZW5kKHJldCwgcGFyZW50VmFsKTsKICBmb3IgKHZhciBrZXlfMSBpbiBjaGlsZFZhbCkgewogICAgdmFyIHBhcmVudF8xID0gcmV0W2tleV8xXTsKICAgIHZhciBjaGlsZCA9IGNoaWxkVmFsW2tleV8xXTsKICAgIGlmIChwYXJlbnRfMSAmJiAhaXNBcnJheShwYXJlbnRfMSkpIHsKICAgICAgcGFyZW50XzEgPSBbcGFyZW50XzFdOwogICAgfQogICAgcmV0W2tleV8xXSA9IHBhcmVudF8xID8gcGFyZW50XzEuY29uY2F0KGNoaWxkKSA6IGlzQXJyYXkoY2hpbGQpID8gY2hpbGQgOiBbY2hpbGRdOwogIH0KICByZXR1cm4gcmV0Owp9OwovKioKICogT3RoZXIgb2JqZWN0IGhhc2hlcy4KICovCnN0cmF0cy5wcm9wcyA9IHN0cmF0cy5tZXRob2RzID0gc3RyYXRzLmluamVjdCA9IHN0cmF0cy5jb21wdXRlZCA9IGZ1bmN0aW9uIChwYXJlbnRWYWwsIGNoaWxkVmFsLCB2bSwga2V5KSB7CiAgaWYgKGNoaWxkVmFsICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgIGFzc2VydE9iamVjdFR5cGUoa2V5LCBjaGlsZFZhbCwgdm0pOwogIH0KICBpZiAoIXBhcmVudFZhbCkgcmV0dXJuIGNoaWxkVmFsOwogIHZhciByZXQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIGV4dGVuZChyZXQsIHBhcmVudFZhbCk7CiAgaWYgKGNoaWxkVmFsKSBleHRlbmQocmV0LCBjaGlsZFZhbCk7CiAgcmV0dXJuIHJldDsKfTsKc3RyYXRzLnByb3ZpZGUgPSBmdW5jdGlvbiAocGFyZW50VmFsLCBjaGlsZFZhbCkgewogIGlmICghcGFyZW50VmFsKSByZXR1cm4gY2hpbGRWYWw7CiAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgIHZhciByZXQgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgbWVyZ2VEYXRhKHJldCwgaXNGdW5jdGlvbihwYXJlbnRWYWwpID8gcGFyZW50VmFsLmNhbGwodGhpcykgOiBwYXJlbnRWYWwpOwogICAgaWYgKGNoaWxkVmFsKSB7CiAgICAgIG1lcmdlRGF0YShyZXQsIGlzRnVuY3Rpb24oY2hpbGRWYWwpID8gY2hpbGRWYWwuY2FsbCh0aGlzKSA6IGNoaWxkVmFsLCBmYWxzZSAvLyBub24tcmVjdXJzaXZlCiAgICAgICk7CiAgICB9CiAgICByZXR1cm4gcmV0OwogIH07Cn07Ci8qKgogKiBEZWZhdWx0IHN0cmF0ZWd5LgogKi8KdmFyIGRlZmF1bHRTdHJhdCA9IGZ1bmN0aW9uIChwYXJlbnRWYWwsIGNoaWxkVmFsKSB7CiAgcmV0dXJuIGNoaWxkVmFsID09PSB1bmRlZmluZWQgPyBwYXJlbnRWYWwgOiBjaGlsZFZhbDsKfTsKLyoqCiAqIFZhbGlkYXRlIGNvbXBvbmVudCBuYW1lcwogKi8KZnVuY3Rpb24gY2hlY2tDb21wb25lbnRzKG9wdGlvbnMpIHsKICBmb3IgKHZhciBrZXkgaW4gb3B0aW9ucy5jb21wb25lbnRzKSB7CiAgICB2YWxpZGF0ZUNvbXBvbmVudE5hbWUoa2V5KTsKICB9Cn0KZnVuY3Rpb24gdmFsaWRhdGVDb21wb25lbnROYW1lKG5hbWUpIHsKICBpZiAoIW5ldyBSZWdFeHAoIl5bYS16QS1aXVtcXC1cXC4wLTlfIi5jb25jYXQodW5pY29kZVJlZ0V4cC5zb3VyY2UsICJdKiQiKSkudGVzdChuYW1lKSkgewogICAgd2FybignSW52YWxpZCBjb21wb25lbnQgbmFtZTogIicgKyBuYW1lICsgJyIuIENvbXBvbmVudCBuYW1lcyAnICsgJ3Nob3VsZCBjb25mb3JtIHRvIHZhbGlkIGN1c3RvbSBlbGVtZW50IG5hbWUgaW4gaHRtbDUgc3BlY2lmaWNhdGlvbi4nKTsKICB9CiAgaWYgKGlzQnVpbHRJblRhZyhuYW1lKSB8fCBjb25maWcuaXNSZXNlcnZlZFRhZyhuYW1lKSkgewogICAgd2FybignRG8gbm90IHVzZSBidWlsdC1pbiBvciByZXNlcnZlZCBIVE1MIGVsZW1lbnRzIGFzIGNvbXBvbmVudCAnICsgJ2lkOiAnICsgbmFtZSk7CiAgfQp9Ci8qKgogKiBFbnN1cmUgYWxsIHByb3BzIG9wdGlvbiBzeW50YXggYXJlIG5vcm1hbGl6ZWQgaW50byB0aGUKICogT2JqZWN0LWJhc2VkIGZvcm1hdC4KICovCmZ1bmN0aW9uIG5vcm1hbGl6ZVByb3BzKG9wdGlvbnMsIHZtKSB7CiAgdmFyIHByb3BzID0gb3B0aW9ucy5wcm9wczsKICBpZiAoIXByb3BzKSByZXR1cm47CiAgdmFyIHJlcyA9IHt9OwogIHZhciBpLCB2YWwsIG5hbWU7CiAgaWYgKGlzQXJyYXkocHJvcHMpKSB7CiAgICBpID0gcHJvcHMubGVuZ3RoOwogICAgd2hpbGUgKGktLSkgewogICAgICB2YWwgPSBwcm9wc1tpXTsKICAgICAgaWYgKHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgbmFtZSA9IGNhbWVsaXplKHZhbCk7CiAgICAgICAgcmVzW25hbWVdID0gewogICAgICAgICAgdHlwZTogbnVsbAogICAgICAgIH07CiAgICAgIH0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICAgIHdhcm4oJ3Byb3BzIG11c3QgYmUgc3RyaW5ncyB3aGVuIHVzaW5nIGFycmF5IHN5bnRheC4nKTsKICAgICAgfQogICAgfQogIH0gZWxzZSBpZiAoaXNQbGFpbk9iamVjdChwcm9wcykpIHsKICAgIGZvciAodmFyIGtleSBpbiBwcm9wcykgewogICAgICB2YWwgPSBwcm9wc1trZXldOwogICAgICBuYW1lID0gY2FtZWxpemUoa2V5KTsKICAgICAgcmVzW25hbWVdID0gaXNQbGFpbk9iamVjdCh2YWwpID8gdmFsIDogewogICAgICAgIHR5cGU6IHZhbAogICAgICB9OwogICAgfQogIH0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgd2FybigiSW52YWxpZCB2YWx1ZSBmb3Igb3B0aW9uIFwicHJvcHNcIjogZXhwZWN0ZWQgYW4gQXJyYXkgb3IgYW4gT2JqZWN0LCAiICsgImJ1dCBnb3QgIi5jb25jYXQodG9SYXdUeXBlKHByb3BzKSwgIi4iKSwgdm0pOwogIH0KICBvcHRpb25zLnByb3BzID0gcmVzOwp9Ci8qKgogKiBOb3JtYWxpemUgYWxsIGluamVjdGlvbnMgaW50byBPYmplY3QtYmFzZWQgZm9ybWF0CiAqLwpmdW5jdGlvbiBub3JtYWxpemVJbmplY3Qob3B0aW9ucywgdm0pIHsKICB2YXIgaW5qZWN0ID0gb3B0aW9ucy5pbmplY3Q7CiAgaWYgKCFpbmplY3QpIHJldHVybjsKICB2YXIgbm9ybWFsaXplZCA9IG9wdGlvbnMuaW5qZWN0ID0ge307CiAgaWYgKGlzQXJyYXkoaW5qZWN0KSkgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmplY3QubGVuZ3RoOyBpKyspIHsKICAgICAgbm9ybWFsaXplZFtpbmplY3RbaV1dID0gewogICAgICAgIGZyb206IGluamVjdFtpXQogICAgICB9OwogICAgfQogIH0gZWxzZSBpZiAoaXNQbGFpbk9iamVjdChpbmplY3QpKSB7CiAgICBmb3IgKHZhciBrZXkgaW4gaW5qZWN0KSB7CiAgICAgIHZhciB2YWwgPSBpbmplY3Rba2V5XTsKICAgICAgbm9ybWFsaXplZFtrZXldID0gaXNQbGFpbk9iamVjdCh2YWwpID8gZXh0ZW5kKHsKICAgICAgICBmcm9tOiBrZXkKICAgICAgfSwgdmFsKSA6IHsKICAgICAgICBmcm9tOiB2YWwKICAgICAgfTsKICAgIH0KICB9IGVsc2UgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgIHdhcm4oIkludmFsaWQgdmFsdWUgZm9yIG9wdGlvbiBcImluamVjdFwiOiBleHBlY3RlZCBhbiBBcnJheSBvciBhbiBPYmplY3QsICIgKyAiYnV0IGdvdCAiLmNvbmNhdCh0b1Jhd1R5cGUoaW5qZWN0KSwgIi4iKSwgdm0pOwogIH0KfQovKioKICogTm9ybWFsaXplIHJhdyBmdW5jdGlvbiBkaXJlY3RpdmVzIGludG8gb2JqZWN0IGZvcm1hdC4KICovCmZ1bmN0aW9uIG5vcm1hbGl6ZURpcmVjdGl2ZXMkMShvcHRpb25zKSB7CiAgdmFyIGRpcnMgPSBvcHRpb25zLmRpcmVjdGl2ZXM7CiAgaWYgKGRpcnMpIHsKICAgIGZvciAodmFyIGtleSBpbiBkaXJzKSB7CiAgICAgIHZhciBkZWYgPSBkaXJzW2tleV07CiAgICAgIGlmIChpc0Z1bmN0aW9uKGRlZikpIHsKICAgICAgICBkaXJzW2tleV0gPSB7CiAgICAgICAgICBiaW5kOiBkZWYsCiAgICAgICAgICB1cGRhdGU6IGRlZgogICAgICAgIH07CiAgICAgIH0KICAgIH0KICB9Cn0KZnVuY3Rpb24gYXNzZXJ0T2JqZWN0VHlwZShuYW1lLCB2YWx1ZSwgdm0pIHsKICBpZiAoIWlzUGxhaW5PYmplY3QodmFsdWUpKSB7CiAgICB3YXJuKCJJbnZhbGlkIHZhbHVlIGZvciBvcHRpb24gXCIiLmNvbmNhdChuYW1lLCAiXCI6IGV4cGVjdGVkIGFuIE9iamVjdCwgIikgKyAiYnV0IGdvdCAiLmNvbmNhdCh0b1Jhd1R5cGUodmFsdWUpLCAiLiIpLCB2bSk7CiAgfQp9Ci8qKgogKiBNZXJnZSB0d28gb3B0aW9uIG9iamVjdHMgaW50byBhIG5ldyBvbmUuCiAqIENvcmUgdXRpbGl0eSB1c2VkIGluIGJvdGggaW5zdGFudGlhdGlvbiBhbmQgaW5oZXJpdGFuY2UuCiAqLwpmdW5jdGlvbiBtZXJnZU9wdGlvbnMocGFyZW50LCBjaGlsZCwgdm0pIHsKICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgY2hlY2tDb21wb25lbnRzKGNoaWxkKTsKICB9CiAgaWYgKGlzRnVuY3Rpb24oY2hpbGQpKSB7CiAgICAvLyBAdHMtZXhwZWN0LWVycm9yCiAgICBjaGlsZCA9IGNoaWxkLm9wdGlvbnM7CiAgfQogIG5vcm1hbGl6ZVByb3BzKGNoaWxkLCB2bSk7CiAgbm9ybWFsaXplSW5qZWN0KGNoaWxkLCB2bSk7CiAgbm9ybWFsaXplRGlyZWN0aXZlcyQxKGNoaWxkKTsKICAvLyBBcHBseSBleHRlbmRzIGFuZCBtaXhpbnMgb24gdGhlIGNoaWxkIG9wdGlvbnMsCiAgLy8gYnV0IG9ubHkgaWYgaXQgaXMgYSByYXcgb3B0aW9ucyBvYmplY3QgdGhhdCBpc24ndAogIC8vIHRoZSByZXN1bHQgb2YgYW5vdGhlciBtZXJnZU9wdGlvbnMgY2FsbC4KICAvLyBPbmx5IG1lcmdlZCBvcHRpb25zIGhhcyB0aGUgX2Jhc2UgcHJvcGVydHkuCiAgaWYgKCFjaGlsZC5fYmFzZSkgewogICAgaWYgKGNoaWxkLmV4dGVuZHMpIHsKICAgICAgcGFyZW50ID0gbWVyZ2VPcHRpb25zKHBhcmVudCwgY2hpbGQuZXh0ZW5kcywgdm0pOwogICAgfQogICAgaWYgKGNoaWxkLm1peGlucykgewogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNoaWxkLm1peGlucy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBwYXJlbnQgPSBtZXJnZU9wdGlvbnMocGFyZW50LCBjaGlsZC5taXhpbnNbaV0sIHZtKTsKICAgICAgfQogICAgfQogIH0KICB2YXIgb3B0aW9ucyA9IHt9OwogIHZhciBrZXk7CiAgZm9yIChrZXkgaW4gcGFyZW50KSB7CiAgICBtZXJnZUZpZWxkKGtleSk7CiAgfQogIGZvciAoa2V5IGluIGNoaWxkKSB7CiAgICBpZiAoIWhhc093bihwYXJlbnQsIGtleSkpIHsKICAgICAgbWVyZ2VGaWVsZChrZXkpOwogICAgfQogIH0KICBmdW5jdGlvbiBtZXJnZUZpZWxkKGtleSkgewogICAgdmFyIHN0cmF0ID0gc3RyYXRzW2tleV0gfHwgZGVmYXVsdFN0cmF0OwogICAgb3B0aW9uc1trZXldID0gc3RyYXQocGFyZW50W2tleV0sIGNoaWxkW2tleV0sIHZtLCBrZXkpOwogIH0KICByZXR1cm4gb3B0aW9uczsKfQovKioKICogUmVzb2x2ZSBhbiBhc3NldC4KICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIGJlY2F1c2UgY2hpbGQgaW5zdGFuY2VzIG5lZWQgYWNjZXNzCiAqIHRvIGFzc2V0cyBkZWZpbmVkIGluIGl0cyBhbmNlc3RvciBjaGFpbi4KICovCmZ1bmN0aW9uIHJlc29sdmVBc3NldChvcHRpb25zLCB0eXBlLCBpZCwgd2Fybk1pc3NpbmcpIHsKICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICBpZiAodHlwZW9mIGlkICE9PSAnc3RyaW5nJykgewogICAgcmV0dXJuOwogIH0KICB2YXIgYXNzZXRzID0gb3B0aW9uc1t0eXBlXTsKICAvLyBjaGVjayBsb2NhbCByZWdpc3RyYXRpb24gdmFyaWF0aW9ucyBmaXJzdAogIGlmIChoYXNPd24oYXNzZXRzLCBpZCkpIHJldHVybiBhc3NldHNbaWRdOwogIHZhciBjYW1lbGl6ZWRJZCA9IGNhbWVsaXplKGlkKTsKICBpZiAoaGFzT3duKGFzc2V0cywgY2FtZWxpemVkSWQpKSByZXR1cm4gYXNzZXRzW2NhbWVsaXplZElkXTsKICB2YXIgUGFzY2FsQ2FzZUlkID0gY2FwaXRhbGl6ZShjYW1lbGl6ZWRJZCk7CiAgaWYgKGhhc093bihhc3NldHMsIFBhc2NhbENhc2VJZCkpIHJldHVybiBhc3NldHNbUGFzY2FsQ2FzZUlkXTsKICAvLyBmYWxsYmFjayB0byBwcm90b3R5cGUgY2hhaW4KICB2YXIgcmVzID0gYXNzZXRzW2lkXSB8fCBhc3NldHNbY2FtZWxpemVkSWRdIHx8IGFzc2V0c1tQYXNjYWxDYXNlSWRdOwogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm5NaXNzaW5nICYmICFyZXMpIHsKICAgIHdhcm4oJ0ZhaWxlZCB0byByZXNvbHZlICcgKyB0eXBlLnNsaWNlKDAsIC0xKSArICc6ICcgKyBpZCk7CiAgfQogIHJldHVybiByZXM7Cn0KZnVuY3Rpb24gdmFsaWRhdGVQcm9wKGtleSwgcHJvcE9wdGlvbnMsIHByb3BzRGF0YSwgdm0pIHsKICB2YXIgcHJvcCA9IHByb3BPcHRpb25zW2tleV07CiAgdmFyIGFic2VudCA9ICFoYXNPd24ocHJvcHNEYXRhLCBrZXkpOwogIHZhciB2YWx1ZSA9IHByb3BzRGF0YVtrZXldOwogIC8vIGJvb2xlYW4gY2FzdGluZwogIHZhciBib29sZWFuSW5kZXggPSBnZXRUeXBlSW5kZXgoQm9vbGVhbiwgcHJvcC50eXBlKTsKICBpZiAoYm9vbGVhbkluZGV4ID4gLTEpIHsKICAgIGlmIChhYnNlbnQgJiYgIWhhc093bihwcm9wLCAnZGVmYXVsdCcpKSB7CiAgICAgIHZhbHVlID0gZmFsc2U7CiAgICB9IGVsc2UgaWYgKHZhbHVlID09PSAnJyB8fCB2YWx1ZSA9PT0gaHlwaGVuYXRlKGtleSkpIHsKICAgICAgLy8gb25seSBjYXN0IGVtcHR5IHN0cmluZyAvIHNhbWUgbmFtZSB0byBib29sZWFuIGlmCiAgICAgIC8vIGJvb2xlYW4gaGFzIGhpZ2hlciBwcmlvcml0eQogICAgICB2YXIgc3RyaW5nSW5kZXggPSBnZXRUeXBlSW5kZXgoU3RyaW5nLCBwcm9wLnR5cGUpOwogICAgICBpZiAoc3RyaW5nSW5kZXggPCAwIHx8IGJvb2xlYW5JbmRleCA8IHN0cmluZ0luZGV4KSB7CiAgICAgICAgdmFsdWUgPSB0cnVlOwogICAgICB9CiAgICB9CiAgfQogIC8vIGNoZWNrIGRlZmF1bHQgdmFsdWUKICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgdmFsdWUgPSBnZXRQcm9wRGVmYXVsdFZhbHVlKHZtLCBwcm9wLCBrZXkpOwogICAgLy8gc2luY2UgdGhlIGRlZmF1bHQgdmFsdWUgaXMgYSBmcmVzaCBjb3B5LAogICAgLy8gbWFrZSBzdXJlIHRvIG9ic2VydmUgaXQuCiAgICB2YXIgcHJldlNob3VsZE9ic2VydmUgPSBzaG91bGRPYnNlcnZlOwogICAgdG9nZ2xlT2JzZXJ2aW5nKHRydWUpOwogICAgb2JzZXJ2ZSh2YWx1ZSk7CiAgICB0b2dnbGVPYnNlcnZpbmcocHJldlNob3VsZE9ic2VydmUpOwogIH0KICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgYXNzZXJ0UHJvcChwcm9wLCBrZXksIHZhbHVlLCB2bSwgYWJzZW50KTsKICB9CiAgcmV0dXJuIHZhbHVlOwp9Ci8qKgogKiBHZXQgdGhlIGRlZmF1bHQgdmFsdWUgb2YgYSBwcm9wLgogKi8KZnVuY3Rpb24gZ2V0UHJvcERlZmF1bHRWYWx1ZSh2bSwgcHJvcCwga2V5KSB7CiAgLy8gbm8gZGVmYXVsdCwgcmV0dXJuIHVuZGVmaW5lZAogIGlmICghaGFzT3duKHByb3AsICdkZWZhdWx0JykpIHsKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQogIHZhciBkZWYgPSBwcm9wLmRlZmF1bHQ7CiAgLy8gd2FybiBhZ2FpbnN0IG5vbi1mYWN0b3J5IGRlZmF1bHRzIGZvciBPYmplY3QgJiBBcnJheQogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIGlzT2JqZWN0KGRlZikpIHsKICAgIHdhcm4oJ0ludmFsaWQgZGVmYXVsdCB2YWx1ZSBmb3IgcHJvcCAiJyArIGtleSArICciOiAnICsgJ1Byb3BzIHdpdGggdHlwZSBPYmplY3QvQXJyYXkgbXVzdCB1c2UgYSBmYWN0b3J5IGZ1bmN0aW9uICcgKyAndG8gcmV0dXJuIHRoZSBkZWZhdWx0IHZhbHVlLicsIHZtKTsKICB9CiAgLy8gdGhlIHJhdyBwcm9wIHZhbHVlIHdhcyBhbHNvIHVuZGVmaW5lZCBmcm9tIHByZXZpb3VzIHJlbmRlciwKICAvLyByZXR1cm4gcHJldmlvdXMgZGVmYXVsdCB2YWx1ZSB0byBhdm9pZCB1bm5lY2Vzc2FyeSB3YXRjaGVyIHRyaWdnZXIKICBpZiAodm0gJiYgdm0uJG9wdGlvbnMucHJvcHNEYXRhICYmIHZtLiRvcHRpb25zLnByb3BzRGF0YVtrZXldID09PSB1bmRlZmluZWQgJiYgdm0uX3Byb3BzW2tleV0gIT09IHVuZGVmaW5lZCkgewogICAgcmV0dXJuIHZtLl9wcm9wc1trZXldOwogIH0KICAvLyBjYWxsIGZhY3RvcnkgZnVuY3Rpb24gZm9yIG5vbi1GdW5jdGlvbiB0eXBlcwogIC8vIGEgdmFsdWUgaXMgRnVuY3Rpb24gaWYgaXRzIHByb3RvdHlwZSBpcyBmdW5jdGlvbiBldmVuIGFjcm9zcyBkaWZmZXJlbnQgZXhlY3V0aW9uIGNvbnRleHQKICByZXR1cm4gaXNGdW5jdGlvbihkZWYpICYmIGdldFR5cGUocHJvcC50eXBlKSAhPT0gJ0Z1bmN0aW9uJyA/IGRlZi5jYWxsKHZtKSA6IGRlZjsKfQovKioKICogQXNzZXJ0IHdoZXRoZXIgYSBwcm9wIGlzIHZhbGlkLgogKi8KZnVuY3Rpb24gYXNzZXJ0UHJvcChwcm9wLCBuYW1lLCB2YWx1ZSwgdm0sIGFic2VudCkgewogIGlmIChwcm9wLnJlcXVpcmVkICYmIGFic2VudCkgewogICAgd2FybignTWlzc2luZyByZXF1aXJlZCBwcm9wOiAiJyArIG5hbWUgKyAnIicsIHZtKTsKICAgIHJldHVybjsKICB9CiAgaWYgKHZhbHVlID09IG51bGwgJiYgIXByb3AucmVxdWlyZWQpIHsKICAgIHJldHVybjsKICB9CiAgdmFyIHR5cGUgPSBwcm9wLnR5cGU7CiAgdmFyIHZhbGlkID0gIXR5cGUgfHwgdHlwZSA9PT0gdHJ1ZTsKICB2YXIgZXhwZWN0ZWRUeXBlcyA9IFtdOwogIGlmICh0eXBlKSB7CiAgICBpZiAoIWlzQXJyYXkodHlwZSkpIHsKICAgICAgdHlwZSA9IFt0eXBlXTsKICAgIH0KICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdHlwZS5sZW5ndGggJiYgIXZhbGlkOyBpKyspIHsKICAgICAgdmFyIGFzc2VydGVkVHlwZSA9IGFzc2VydFR5cGUodmFsdWUsIHR5cGVbaV0sIHZtKTsKICAgICAgZXhwZWN0ZWRUeXBlcy5wdXNoKGFzc2VydGVkVHlwZS5leHBlY3RlZFR5cGUgfHwgJycpOwogICAgICB2YWxpZCA9IGFzc2VydGVkVHlwZS52YWxpZDsKICAgIH0KICB9CiAgdmFyIGhhdmVFeHBlY3RlZFR5cGVzID0gZXhwZWN0ZWRUeXBlcy5zb21lKGZ1bmN0aW9uICh0KSB7CiAgICByZXR1cm4gdDsKICB9KTsKICBpZiAoIXZhbGlkICYmIGhhdmVFeHBlY3RlZFR5cGVzKSB7CiAgICB3YXJuKGdldEludmFsaWRUeXBlTWVzc2FnZShuYW1lLCB2YWx1ZSwgZXhwZWN0ZWRUeXBlcyksIHZtKTsKICAgIHJldHVybjsKICB9CiAgdmFyIHZhbGlkYXRvciA9IHByb3AudmFsaWRhdG9yOwogIGlmICh2YWxpZGF0b3IpIHsKICAgIGlmICghdmFsaWRhdG9yKHZhbHVlKSkgewogICAgICB3YXJuKCdJbnZhbGlkIHByb3A6IGN1c3RvbSB2YWxpZGF0b3IgY2hlY2sgZmFpbGVkIGZvciBwcm9wICInICsgbmFtZSArICciLicsIHZtKTsKICAgIH0KICB9Cn0KdmFyIHNpbXBsZUNoZWNrUkUgPSAvXihTdHJpbmd8TnVtYmVyfEJvb2xlYW58RnVuY3Rpb258U3ltYm9sfEJpZ0ludCkkLzsKZnVuY3Rpb24gYXNzZXJ0VHlwZSh2YWx1ZSwgdHlwZSwgdm0pIHsKICB2YXIgdmFsaWQ7CiAgdmFyIGV4cGVjdGVkVHlwZSA9IGdldFR5cGUodHlwZSk7CiAgaWYgKHNpbXBsZUNoZWNrUkUudGVzdChleHBlY3RlZFR5cGUpKSB7CiAgICB2YXIgdCA9IHR5cGVvZiB2YWx1ZTsKICAgIHZhbGlkID0gdCA9PT0gZXhwZWN0ZWRUeXBlLnRvTG93ZXJDYXNlKCk7CiAgICAvLyBmb3IgcHJpbWl0aXZlIHdyYXBwZXIgb2JqZWN0cwogICAgaWYgKCF2YWxpZCAmJiB0ID09PSAnb2JqZWN0JykgewogICAgICB2YWxpZCA9IHZhbHVlIGluc3RhbmNlb2YgdHlwZTsKICAgIH0KICB9IGVsc2UgaWYgKGV4cGVjdGVkVHlwZSA9PT0gJ09iamVjdCcpIHsKICAgIHZhbGlkID0gaXNQbGFpbk9iamVjdCh2YWx1ZSk7CiAgfSBlbHNlIGlmIChleHBlY3RlZFR5cGUgPT09ICdBcnJheScpIHsKICAgIHZhbGlkID0gaXNBcnJheSh2YWx1ZSk7CiAgfSBlbHNlIHsKICAgIHRyeSB7CiAgICAgIHZhbGlkID0gdmFsdWUgaW5zdGFuY2VvZiB0eXBlOwogICAgfSBjYXRjaCAoZSkgewogICAgICB3YXJuKCdJbnZhbGlkIHByb3AgdHlwZTogIicgKyBTdHJpbmcodHlwZSkgKyAnIiBpcyBub3QgYSBjb25zdHJ1Y3RvcicsIHZtKTsKICAgICAgdmFsaWQgPSBmYWxzZTsKICAgIH0KICB9CiAgcmV0dXJuIHsKICAgIHZhbGlkOiB2YWxpZCwKICAgIGV4cGVjdGVkVHlwZTogZXhwZWN0ZWRUeXBlCiAgfTsKfQp2YXIgZnVuY3Rpb25UeXBlQ2hlY2tSRSA9IC9eXHMqZnVuY3Rpb24gKFx3KykvOwovKioKICogVXNlIGZ1bmN0aW9uIHN0cmluZyBuYW1lIHRvIGNoZWNrIGJ1aWx0LWluIHR5cGVzLAogKiBiZWNhdXNlIGEgc2ltcGxlIGVxdWFsaXR5IGNoZWNrIHdpbGwgZmFpbCB3aGVuIHJ1bm5pbmcKICogYWNyb3NzIGRpZmZlcmVudCB2bXMgLyBpZnJhbWVzLgogKi8KZnVuY3Rpb24gZ2V0VHlwZShmbikgewogIHZhciBtYXRjaCA9IGZuICYmIGZuLnRvU3RyaW5nKCkubWF0Y2goZnVuY3Rpb25UeXBlQ2hlY2tSRSk7CiAgcmV0dXJuIG1hdGNoID8gbWF0Y2hbMV0gOiAnJzsKfQpmdW5jdGlvbiBpc1NhbWVUeXBlKGEsIGIpIHsKICByZXR1cm4gZ2V0VHlwZShhKSA9PT0gZ2V0VHlwZShiKTsKfQpmdW5jdGlvbiBnZXRUeXBlSW5kZXgodHlwZSwgZXhwZWN0ZWRUeXBlcykgewogIGlmICghaXNBcnJheShleHBlY3RlZFR5cGVzKSkgewogICAgcmV0dXJuIGlzU2FtZVR5cGUoZXhwZWN0ZWRUeXBlcywgdHlwZSkgPyAwIDogLTE7CiAgfQogIGZvciAodmFyIGkgPSAwLCBsZW4gPSBleHBlY3RlZFR5cGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICBpZiAoaXNTYW1lVHlwZShleHBlY3RlZFR5cGVzW2ldLCB0eXBlKSkgewogICAgICByZXR1cm4gaTsKICAgIH0KICB9CiAgcmV0dXJuIC0xOwp9CmZ1bmN0aW9uIGdldEludmFsaWRUeXBlTWVzc2FnZShuYW1lLCB2YWx1ZSwgZXhwZWN0ZWRUeXBlcykgewogIHZhciBtZXNzYWdlID0gIkludmFsaWQgcHJvcDogdHlwZSBjaGVjayBmYWlsZWQgZm9yIHByb3AgXCIiLmNvbmNhdChuYW1lLCAiXCIuIikgKyAiIEV4cGVjdGVkICIuY29uY2F0KGV4cGVjdGVkVHlwZXMubWFwKGNhcGl0YWxpemUpLmpvaW4oJywgJykpOwogIHZhciBleHBlY3RlZFR5cGUgPSBleHBlY3RlZFR5cGVzWzBdOwogIHZhciByZWNlaXZlZFR5cGUgPSB0b1Jhd1R5cGUodmFsdWUpOwogIC8vIGNoZWNrIGlmIHdlIG5lZWQgdG8gc3BlY2lmeSBleHBlY3RlZCB2YWx1ZQogIGlmIChleHBlY3RlZFR5cGVzLmxlbmd0aCA9PT0gMSAmJiBpc0V4cGxpY2FibGUoZXhwZWN0ZWRUeXBlKSAmJiBpc0V4cGxpY2FibGUodHlwZW9mIHZhbHVlKSAmJiAhaXNCb29sZWFuKGV4cGVjdGVkVHlwZSwgcmVjZWl2ZWRUeXBlKSkgewogICAgbWVzc2FnZSArPSAiIHdpdGggdmFsdWUgIi5jb25jYXQoc3R5bGVWYWx1ZSh2YWx1ZSwgZXhwZWN0ZWRUeXBlKSk7CiAgfQogIG1lc3NhZ2UgKz0gIiwgZ290ICIuY29uY2F0KHJlY2VpdmVkVHlwZSwgIiAiKTsKICAvLyBjaGVjayBpZiB3ZSBuZWVkIHRvIHNwZWNpZnkgcmVjZWl2ZWQgdmFsdWUKICBpZiAoaXNFeHBsaWNhYmxlKHJlY2VpdmVkVHlwZSkpIHsKICAgIG1lc3NhZ2UgKz0gIndpdGggdmFsdWUgIi5jb25jYXQoc3R5bGVWYWx1ZSh2YWx1ZSwgcmVjZWl2ZWRUeXBlKSwgIi4iKTsKICB9CiAgcmV0dXJuIG1lc3NhZ2U7Cn0KZnVuY3Rpb24gc3R5bGVWYWx1ZSh2YWx1ZSwgdHlwZSkgewogIGlmICh0eXBlID09PSAnU3RyaW5nJykgewogICAgcmV0dXJuICJcIiIuY29uY2F0KHZhbHVlLCAiXCIiKTsKICB9IGVsc2UgaWYgKHR5cGUgPT09ICdOdW1iZXInKSB7CiAgICByZXR1cm4gIiIuY29uY2F0KE51bWJlcih2YWx1ZSkpOwogIH0gZWxzZSB7CiAgICByZXR1cm4gIiIuY29uY2F0KHZhbHVlKTsKICB9Cn0KdmFyIEVYUExJQ0FCTEVfVFlQRVMgPSBbJ3N0cmluZycsICdudW1iZXInLCAnYm9vbGVhbiddOwpmdW5jdGlvbiBpc0V4cGxpY2FibGUodmFsdWUpIHsKICByZXR1cm4gRVhQTElDQUJMRV9UWVBFUy5zb21lKGZ1bmN0aW9uIChlbGVtKSB7CiAgICByZXR1cm4gdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gZWxlbTsKICB9KTsKfQpmdW5jdGlvbiBpc0Jvb2xlYW4oKSB7CiAgdmFyIGFyZ3MgPSBbXTsKICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewogICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldOwogIH0KICByZXR1cm4gYXJncy5zb21lKGZ1bmN0aW9uIChlbGVtKSB7CiAgICByZXR1cm4gZWxlbS50b0xvd2VyQ2FzZSgpID09PSAnYm9vbGVhbic7CiAgfSk7Cn0KCi8qIG5vdCB0eXBlIGNoZWNraW5nIHRoaXMgZmlsZSBiZWNhdXNlIGZsb3cgZG9lc24ndCBwbGF5IHdlbGwgd2l0aCBQcm94eSAqLwp2YXIgaW5pdFByb3h5OwppZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogIHZhciBhbGxvd2VkR2xvYmFsc18xID0gbWFrZU1hcCgnSW5maW5pdHksdW5kZWZpbmVkLE5hTixpc0Zpbml0ZSxpc05hTiwnICsgJ3BhcnNlRmxvYXQscGFyc2VJbnQsZGVjb2RlVVJJLGRlY29kZVVSSUNvbXBvbmVudCxlbmNvZGVVUkksZW5jb2RlVVJJQ29tcG9uZW50LCcgKyAnTWF0aCxOdW1iZXIsRGF0ZSxBcnJheSxPYmplY3QsQm9vbGVhbixTdHJpbmcsUmVnRXhwLE1hcCxTZXQsSlNPTixJbnRsLEJpZ0ludCwnICsgJ3JlcXVpcmUnIC8vIGZvciBXZWJwYWNrL0Jyb3dzZXJpZnkKICApOwogIHZhciB3YXJuTm9uUHJlc2VudF8xID0gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7CiAgICB3YXJuKCJQcm9wZXJ0eSBvciBtZXRob2QgXCIiLmNvbmNhdChrZXksICJcIiBpcyBub3QgZGVmaW5lZCBvbiB0aGUgaW5zdGFuY2UgYnV0ICIpICsgJ3JlZmVyZW5jZWQgZHVyaW5nIHJlbmRlci4gTWFrZSBzdXJlIHRoYXQgdGhpcyBwcm9wZXJ0eSBpcyByZWFjdGl2ZSwgJyArICdlaXRoZXIgaW4gdGhlIGRhdGEgb3B0aW9uLCBvciBmb3IgY2xhc3MtYmFzZWQgY29tcG9uZW50cywgYnkgJyArICdpbml0aWFsaXppbmcgdGhlIHByb3BlcnR5LiAnICsgJ1NlZTogaHR0cHM6Ly92Mi52dWVqcy5vcmcvdjIvZ3VpZGUvcmVhY3Rpdml0eS5odG1sI0RlY2xhcmluZy1SZWFjdGl2ZS1Qcm9wZXJ0aWVzLicsIHRhcmdldCk7CiAgfTsKICB2YXIgd2FyblJlc2VydmVkUHJlZml4XzEgPSBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsKICAgIHdhcm4oIlByb3BlcnR5IFwiIi5jb25jYXQoa2V5LCAiXCIgbXVzdCBiZSBhY2Nlc3NlZCB3aXRoIFwiJGRhdGEuIikuY29uY2F0KGtleSwgIlwiIGJlY2F1c2UgIikgKyAncHJvcGVydGllcyBzdGFydGluZyB3aXRoICIkIiBvciAiXyIgYXJlIG5vdCBwcm94aWVkIGluIHRoZSBWdWUgaW5zdGFuY2UgdG8gJyArICdwcmV2ZW50IGNvbmZsaWN0cyB3aXRoIFZ1ZSBpbnRlcm5hbHMuICcgKyAnU2VlOiBodHRwczovL3YyLnZ1ZWpzLm9yZy92Mi9hcGkvI2RhdGEnLCB0YXJnZXQpOwogIH07CiAgdmFyIGhhc1Byb3h5XzEgPSB0eXBlb2YgUHJveHkgIT09ICd1bmRlZmluZWQnICYmIGlzTmF0aXZlKFByb3h5KTsKICBpZiAoaGFzUHJveHlfMSkgewogICAgdmFyIGlzQnVpbHRJbk1vZGlmaWVyXzEgPSBtYWtlTWFwKCdzdG9wLHByZXZlbnQsc2VsZixjdHJsLHNoaWZ0LGFsdCxtZXRhLGV4YWN0Jyk7CiAgICBjb25maWcua2V5Q29kZXMgPSBuZXcgUHJveHkoY29uZmlnLmtleUNvZGVzLCB7CiAgICAgIHNldDogZnVuY3Rpb24gKHRhcmdldCwga2V5LCB2YWx1ZSkgewogICAgICAgIGlmIChpc0J1aWx0SW5Nb2RpZmllcl8xKGtleSkpIHsKICAgICAgICAgIHdhcm4oIkF2b2lkIG92ZXJ3cml0aW5nIGJ1aWx0LWluIG1vZGlmaWVyIGluIGNvbmZpZy5rZXlDb2RlczogLiIuY29uY2F0KGtleSkpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0YXJnZXRba2V5XSA9IHZhbHVlOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9CiAgdmFyIGhhc0hhbmRsZXJfMSA9IHsKICAgIGhhczogZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7CiAgICAgIHZhciBoYXMgPSBrZXkgaW4gdGFyZ2V0OwogICAgICB2YXIgaXNBbGxvd2VkID0gYWxsb3dlZEdsb2JhbHNfMShrZXkpIHx8IHR5cGVvZiBrZXkgPT09ICdzdHJpbmcnICYmIGtleS5jaGFyQXQoMCkgPT09ICdfJyAmJiAhKGtleSBpbiB0YXJnZXQuJGRhdGEpOwogICAgICBpZiAoIWhhcyAmJiAhaXNBbGxvd2VkKSB7CiAgICAgICAgaWYgKGtleSBpbiB0YXJnZXQuJGRhdGEpIHdhcm5SZXNlcnZlZFByZWZpeF8xKHRhcmdldCwga2V5KTtlbHNlIHdhcm5Ob25QcmVzZW50XzEodGFyZ2V0LCBrZXkpOwogICAgICB9CiAgICAgIHJldHVybiBoYXMgfHwgIWlzQWxsb3dlZDsKICAgIH0KICB9OwogIHZhciBnZXRIYW5kbGVyXzEgPSB7CiAgICBnZXQ6IGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgewogICAgICBpZiAodHlwZW9mIGtleSA9PT0gJ3N0cmluZycgJiYgIShrZXkgaW4gdGFyZ2V0KSkgewogICAgICAgIGlmIChrZXkgaW4gdGFyZ2V0LiRkYXRhKSB3YXJuUmVzZXJ2ZWRQcmVmaXhfMSh0YXJnZXQsIGtleSk7ZWxzZSB3YXJuTm9uUHJlc2VudF8xKHRhcmdldCwga2V5KTsKICAgICAgfQogICAgICByZXR1cm4gdGFyZ2V0W2tleV07CiAgICB9CiAgfTsKICBpbml0UHJveHkgPSBmdW5jdGlvbiBpbml0UHJveHkodm0pIHsKICAgIGlmIChoYXNQcm94eV8xKSB7CiAgICAgIC8vIGRldGVybWluZSB3aGljaCBwcm94eSBoYW5kbGVyIHRvIHVzZQogICAgICB2YXIgb3B0aW9ucyA9IHZtLiRvcHRpb25zOwogICAgICB2YXIgaGFuZGxlcnMgPSBvcHRpb25zLnJlbmRlciAmJiBvcHRpb25zLnJlbmRlci5fd2l0aFN0cmlwcGVkID8gZ2V0SGFuZGxlcl8xIDogaGFzSGFuZGxlcl8xOwogICAgICB2bS5fcmVuZGVyUHJveHkgPSBuZXcgUHJveHkodm0sIGhhbmRsZXJzKTsKICAgIH0gZWxzZSB7CiAgICAgIHZtLl9yZW5kZXJQcm94eSA9IHZtOwogICAgfQogIH07Cn0KdmFyIHNoYXJlZFByb3BlcnR5RGVmaW5pdGlvbiA9IHsKICBlbnVtZXJhYmxlOiB0cnVlLAogIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICBnZXQ6IG5vb3AsCiAgc2V0OiBub29wCn07CmZ1bmN0aW9uIHByb3h5KHRhcmdldCwgc291cmNlS2V5LCBrZXkpIHsKICBzaGFyZWRQcm9wZXJ0eURlZmluaXRpb24uZ2V0ID0gZnVuY3Rpb24gcHJveHlHZXR0ZXIoKSB7CiAgICByZXR1cm4gdGhpc1tzb3VyY2VLZXldW2tleV07CiAgfTsKICBzaGFyZWRQcm9wZXJ0eURlZmluaXRpb24uc2V0ID0gZnVuY3Rpb24gcHJveHlTZXR0ZXIodmFsKSB7CiAgICB0aGlzW3NvdXJjZUtleV1ba2V5XSA9IHZhbDsKICB9OwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc2hhcmVkUHJvcGVydHlEZWZpbml0aW9uKTsKfQpmdW5jdGlvbiBpbml0U3RhdGUodm0pIHsKICB2YXIgb3B0cyA9IHZtLiRvcHRpb25zOwogIGlmIChvcHRzLnByb3BzKSBpbml0UHJvcHMkMSh2bSwgb3B0cy5wcm9wcyk7CiAgLy8gQ29tcG9zaXRpb24gQVBJCiAgaW5pdFNldHVwKHZtKTsKICBpZiAob3B0cy5tZXRob2RzKSBpbml0TWV0aG9kcyh2bSwgb3B0cy5tZXRob2RzKTsKICBpZiAob3B0cy5kYXRhKSB7CiAgICBpbml0RGF0YSh2bSk7CiAgfSBlbHNlIHsKICAgIHZhciBvYiA9IG9ic2VydmUodm0uX2RhdGEgPSB7fSk7CiAgICBvYiAmJiBvYi52bUNvdW50Kys7CiAgfQogIGlmIChvcHRzLmNvbXB1dGVkKSBpbml0Q29tcHV0ZWQkMSh2bSwgb3B0cy5jb21wdXRlZCk7CiAgaWYgKG9wdHMud2F0Y2ggJiYgb3B0cy53YXRjaCAhPT0gbmF0aXZlV2F0Y2gpIHsKICAgIGluaXRXYXRjaCh2bSwgb3B0cy53YXRjaCk7CiAgfQp9CmZ1bmN0aW9uIGluaXRQcm9wcyQxKHZtLCBwcm9wc09wdGlvbnMpIHsKICB2YXIgcHJvcHNEYXRhID0gdm0uJG9wdGlvbnMucHJvcHNEYXRhIHx8IHt9OwogIHZhciBwcm9wcyA9IHZtLl9wcm9wcyA9IHNoYWxsb3dSZWFjdGl2ZSh7fSk7CiAgLy8gY2FjaGUgcHJvcCBrZXlzIHNvIHRoYXQgZnV0dXJlIHByb3BzIHVwZGF0ZXMgY2FuIGl0ZXJhdGUgdXNpbmcgQXJyYXkKICAvLyBpbnN0ZWFkIG9mIGR5bmFtaWMgb2JqZWN0IGtleSBlbnVtZXJhdGlvbi4KICB2YXIga2V5cyA9IHZtLiRvcHRpb25zLl9wcm9wS2V5cyA9IFtdOwogIHZhciBpc1Jvb3QgPSAhdm0uJHBhcmVudDsKICAvLyByb290IGluc3RhbmNlIHByb3BzIHNob3VsZCBiZSBjb252ZXJ0ZWQKICBpZiAoIWlzUm9vdCkgewogICAgdG9nZ2xlT2JzZXJ2aW5nKGZhbHNlKTsKICB9CiAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoa2V5KSB7CiAgICBrZXlzLnB1c2goa2V5KTsKICAgIHZhciB2YWx1ZSA9IHZhbGlkYXRlUHJvcChrZXksIHByb3BzT3B0aW9ucywgcHJvcHNEYXRhLCB2bSk7CiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqLwogICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgICAgdmFyIGh5cGhlbmF0ZWRLZXkgPSBoeXBoZW5hdGUoa2V5KTsKICAgICAgaWYgKGlzUmVzZXJ2ZWRBdHRyaWJ1dGUoaHlwaGVuYXRlZEtleSkgfHwgY29uZmlnLmlzUmVzZXJ2ZWRBdHRyKGh5cGhlbmF0ZWRLZXkpKSB7CiAgICAgICAgd2FybigiXCIiLmNvbmNhdChoeXBoZW5hdGVkS2V5LCAiXCIgaXMgYSByZXNlcnZlZCBhdHRyaWJ1dGUgYW5kIGNhbm5vdCBiZSB1c2VkIGFzIGNvbXBvbmVudCBwcm9wLiIpLCB2bSk7CiAgICAgIH0KICAgICAgZGVmaW5lUmVhY3RpdmUocHJvcHMsIGtleSwgdmFsdWUsIGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIWlzUm9vdCAmJiAhaXNVcGRhdGluZ0NoaWxkQ29tcG9uZW50KSB7CiAgICAgICAgICB3YXJuKCJBdm9pZCBtdXRhdGluZyBhIHByb3AgZGlyZWN0bHkgc2luY2UgdGhlIHZhbHVlIHdpbGwgYmUgIiArICJvdmVyd3JpdHRlbiB3aGVuZXZlciB0aGUgcGFyZW50IGNvbXBvbmVudCByZS1yZW5kZXJzLiAiICsgIkluc3RlYWQsIHVzZSBhIGRhdGEgb3IgY29tcHV0ZWQgcHJvcGVydHkgYmFzZWQgb24gdGhlIHByb3AncyAiICsgInZhbHVlLiBQcm9wIGJlaW5nIG11dGF0ZWQ6IFwiIi5jb25jYXQoa2V5LCAiXCIiKSwgdm0pOwogICAgICAgIH0KICAgICAgfSwgdHJ1ZSAvKiBzaGFsbG93ICovKTsKICAgIH0gZWxzZSB7CiAgICAgIGRlZmluZVJlYWN0aXZlKHByb3BzLCBrZXksIHZhbHVlLCB1bmRlZmluZWQsIHRydWUgLyogc2hhbGxvdyAqLyk7CiAgICB9CiAgICAvLyBzdGF0aWMgcHJvcHMgYXJlIGFscmVhZHkgcHJveGllZCBvbiB0aGUgY29tcG9uZW50J3MgcHJvdG90eXBlCiAgICAvLyBkdXJpbmcgVnVlLmV4dGVuZCgpLiBXZSBvbmx5IG5lZWQgdG8gcHJveHkgcHJvcHMgZGVmaW5lZCBhdAogICAgLy8gaW5zdGFudGlhdGlvbiBoZXJlLgogICAgaWYgKCEoa2V5IGluIHZtKSkgewogICAgICBwcm94eSh2bSwgIl9wcm9wcyIsIGtleSk7CiAgICB9CiAgfTsKICBmb3IgKHZhciBrZXkgaW4gcHJvcHNPcHRpb25zKSB7CiAgICBfbG9vcF8xKGtleSk7CiAgfQogIHRvZ2dsZU9ic2VydmluZyh0cnVlKTsKfQpmdW5jdGlvbiBpbml0RGF0YSh2bSkgewogIHZhciBkYXRhID0gdm0uJG9wdGlvbnMuZGF0YTsKICBkYXRhID0gdm0uX2RhdGEgPSBpc0Z1bmN0aW9uKGRhdGEpID8gZ2V0RGF0YShkYXRhLCB2bSkgOiBkYXRhIHx8IHt9OwogIGlmICghaXNQbGFpbk9iamVjdChkYXRhKSkgewogICAgZGF0YSA9IHt9OwogICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuKCdkYXRhIGZ1bmN0aW9ucyBzaG91bGQgcmV0dXJuIGFuIG9iamVjdDpcbicgKyAnaHR0cHM6Ly92Mi52dWVqcy5vcmcvdjIvZ3VpZGUvY29tcG9uZW50cy5odG1sI2RhdGEtTXVzdC1CZS1hLUZ1bmN0aW9uJywgdm0pOwogIH0KICAvLyBwcm94eSBkYXRhIG9uIGluc3RhbmNlCiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhkYXRhKTsKICB2YXIgcHJvcHMgPSB2bS4kb3B0aW9ucy5wcm9wczsKICB2YXIgbWV0aG9kcyA9IHZtLiRvcHRpb25zLm1ldGhvZHM7CiAgdmFyIGkgPSBrZXlzLmxlbmd0aDsKICB3aGlsZSAoaS0tKSB7CiAgICB2YXIga2V5ID0ga2V5c1tpXTsKICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICAgIGlmIChtZXRob2RzICYmIGhhc093bihtZXRob2RzLCBrZXkpKSB7CiAgICAgICAgd2FybigiTWV0aG9kIFwiIi5jb25jYXQoa2V5LCAiXCIgaGFzIGFscmVhZHkgYmVlbiBkZWZpbmVkIGFzIGEgZGF0YSBwcm9wZXJ0eS4iKSwgdm0pOwogICAgICB9CiAgICB9CiAgICBpZiAocHJvcHMgJiYgaGFzT3duKHByb3BzLCBrZXkpKSB7CiAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgd2FybigiVGhlIGRhdGEgcHJvcGVydHkgXCIiLmNvbmNhdChrZXksICJcIiBpcyBhbHJlYWR5IGRlY2xhcmVkIGFzIGEgcHJvcC4gIikgKyAiVXNlIHByb3AgZGVmYXVsdCB2YWx1ZSBpbnN0ZWFkLiIsIHZtKTsKICAgIH0gZWxzZSBpZiAoIWlzUmVzZXJ2ZWQoa2V5KSkgewogICAgICBwcm94eSh2bSwgIl9kYXRhIiwga2V5KTsKICAgIH0KICB9CiAgLy8gb2JzZXJ2ZSBkYXRhCiAgdmFyIG9iID0gb2JzZXJ2ZShkYXRhKTsKICBvYiAmJiBvYi52bUNvdW50Kys7Cn0KZnVuY3Rpb24gZ2V0RGF0YShkYXRhLCB2bSkgewogIC8vICM3NTczIGRpc2FibGUgZGVwIGNvbGxlY3Rpb24gd2hlbiBpbnZva2luZyBkYXRhIGdldHRlcnMKICBwdXNoVGFyZ2V0KCk7CiAgdHJ5IHsKICAgIHJldHVybiBkYXRhLmNhbGwodm0sIHZtKTsKICB9IGNhdGNoIChlKSB7CiAgICBoYW5kbGVFcnJvcihlLCB2bSwgImRhdGEoKSIpOwogICAgcmV0dXJuIHt9OwogIH0gZmluYWxseSB7CiAgICBwb3BUYXJnZXQoKTsKICB9Cn0KdmFyIGNvbXB1dGVkV2F0Y2hlck9wdGlvbnMgPSB7CiAgbGF6eTogdHJ1ZQp9OwpmdW5jdGlvbiBpbml0Q29tcHV0ZWQkMSh2bSwgY29tcHV0ZWQpIHsKICAvLyAkZmxvdy1kaXNhYmxlLWxpbmUKICB2YXIgd2F0Y2hlcnMgPSB2bS5fY29tcHV0ZWRXYXRjaGVycyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgLy8gY29tcHV0ZWQgcHJvcGVydGllcyBhcmUganVzdCBnZXR0ZXJzIGR1cmluZyBTU1IKICB2YXIgaXNTU1IgPSBpc1NlcnZlclJlbmRlcmluZygpOwogIGZvciAodmFyIGtleSBpbiBjb21wdXRlZCkgewogICAgdmFyIHVzZXJEZWYgPSBjb21wdXRlZFtrZXldOwogICAgdmFyIGdldHRlciA9IGlzRnVuY3Rpb24odXNlckRlZikgPyB1c2VyRGVmIDogdXNlckRlZi5nZXQ7CiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiBnZXR0ZXIgPT0gbnVsbCkgewogICAgICB3YXJuKCJHZXR0ZXIgaXMgbWlzc2luZyBmb3IgY29tcHV0ZWQgcHJvcGVydHkgXCIiLmNvbmNhdChrZXksICJcIi4iKSwgdm0pOwogICAgfQogICAgaWYgKCFpc1NTUikgewogICAgICAvLyBjcmVhdGUgaW50ZXJuYWwgd2F0Y2hlciBmb3IgdGhlIGNvbXB1dGVkIHByb3BlcnR5LgogICAgICB3YXRjaGVyc1trZXldID0gbmV3IFdhdGNoZXIodm0sIGdldHRlciB8fCBub29wLCBub29wLCBjb21wdXRlZFdhdGNoZXJPcHRpb25zKTsKICAgIH0KICAgIC8vIGNvbXBvbmVudC1kZWZpbmVkIGNvbXB1dGVkIHByb3BlcnRpZXMgYXJlIGFscmVhZHkgZGVmaW5lZCBvbiB0aGUKICAgIC8vIGNvbXBvbmVudCBwcm90b3R5cGUuIFdlIG9ubHkgbmVlZCB0byBkZWZpbmUgY29tcHV0ZWQgcHJvcGVydGllcyBkZWZpbmVkCiAgICAvLyBhdCBpbnN0YW50aWF0aW9uIGhlcmUuCiAgICBpZiAoIShrZXkgaW4gdm0pKSB7CiAgICAgIGRlZmluZUNvbXB1dGVkKHZtLCBrZXksIHVzZXJEZWYpOwogICAgfSBlbHNlIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICAgIGlmIChrZXkgaW4gdm0uJGRhdGEpIHsKICAgICAgICB3YXJuKCJUaGUgY29tcHV0ZWQgcHJvcGVydHkgXCIiLmNvbmNhdChrZXksICJcIiBpcyBhbHJlYWR5IGRlZmluZWQgaW4gZGF0YS4iKSwgdm0pOwogICAgICB9IGVsc2UgaWYgKHZtLiRvcHRpb25zLnByb3BzICYmIGtleSBpbiB2bS4kb3B0aW9ucy5wcm9wcykgewogICAgICAgIHdhcm4oIlRoZSBjb21wdXRlZCBwcm9wZXJ0eSBcIiIuY29uY2F0KGtleSwgIlwiIGlzIGFscmVhZHkgZGVmaW5lZCBhcyBhIHByb3AuIiksIHZtKTsKICAgICAgfSBlbHNlIGlmICh2bS4kb3B0aW9ucy5tZXRob2RzICYmIGtleSBpbiB2bS4kb3B0aW9ucy5tZXRob2RzKSB7CiAgICAgICAgd2FybigiVGhlIGNvbXB1dGVkIHByb3BlcnR5IFwiIi5jb25jYXQoa2V5LCAiXCIgaXMgYWxyZWFkeSBkZWZpbmVkIGFzIGEgbWV0aG9kLiIpLCB2bSk7CiAgICAgIH0KICAgIH0KICB9Cn0KZnVuY3Rpb24gZGVmaW5lQ29tcHV0ZWQodGFyZ2V0LCBrZXksIHVzZXJEZWYpIHsKICB2YXIgc2hvdWxkQ2FjaGUgPSAhaXNTZXJ2ZXJSZW5kZXJpbmcoKTsKICBpZiAoaXNGdW5jdGlvbih1c2VyRGVmKSkgewogICAgc2hhcmVkUHJvcGVydHlEZWZpbml0aW9uLmdldCA9IHNob3VsZENhY2hlID8gY3JlYXRlQ29tcHV0ZWRHZXR0ZXIoa2V5KSA6IGNyZWF0ZUdldHRlckludm9rZXIodXNlckRlZik7CiAgICBzaGFyZWRQcm9wZXJ0eURlZmluaXRpb24uc2V0ID0gbm9vcDsKICB9IGVsc2UgewogICAgc2hhcmVkUHJvcGVydHlEZWZpbml0aW9uLmdldCA9IHVzZXJEZWYuZ2V0ID8gc2hvdWxkQ2FjaGUgJiYgdXNlckRlZi5jYWNoZSAhPT0gZmFsc2UgPyBjcmVhdGVDb21wdXRlZEdldHRlcihrZXkpIDogY3JlYXRlR2V0dGVySW52b2tlcih1c2VyRGVmLmdldCkgOiBub29wOwogICAgc2hhcmVkUHJvcGVydHlEZWZpbml0aW9uLnNldCA9IHVzZXJEZWYuc2V0IHx8IG5vb3A7CiAgfQogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHNoYXJlZFByb3BlcnR5RGVmaW5pdGlvbi5zZXQgPT09IG5vb3ApIHsKICAgIHNoYXJlZFByb3BlcnR5RGVmaW5pdGlvbi5zZXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHdhcm4oIkNvbXB1dGVkIHByb3BlcnR5IFwiIi5jb25jYXQoa2V5LCAiXCIgd2FzIGFzc2lnbmVkIHRvIGJ1dCBpdCBoYXMgbm8gc2V0dGVyLiIpLCB0aGlzKTsKICAgIH07CiAgfQogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc2hhcmVkUHJvcGVydHlEZWZpbml0aW9uKTsKfQpmdW5jdGlvbiBjcmVhdGVDb21wdXRlZEdldHRlcihrZXkpIHsKICByZXR1cm4gZnVuY3Rpb24gY29tcHV0ZWRHZXR0ZXIoKSB7CiAgICB2YXIgd2F0Y2hlciA9IHRoaXMuX2NvbXB1dGVkV2F0Y2hlcnMgJiYgdGhpcy5fY29tcHV0ZWRXYXRjaGVyc1trZXldOwogICAgaWYgKHdhdGNoZXIpIHsKICAgICAgaWYgKHdhdGNoZXIuZGlydHkpIHsKICAgICAgICB3YXRjaGVyLmV2YWx1YXRlKCk7CiAgICAgIH0KICAgICAgaWYgKERlcC50YXJnZXQpIHsKICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiBEZXAudGFyZ2V0Lm9uVHJhY2spIHsKICAgICAgICAgIERlcC50YXJnZXQub25UcmFjayh7CiAgICAgICAgICAgIGVmZmVjdDogRGVwLnRhcmdldCwKICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLAogICAgICAgICAgICB0eXBlOiAiZ2V0IiAvKiBUcmFja09wVHlwZXMuR0VUICovLAogICAgICAgICAgICBrZXk6IGtleQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHdhdGNoZXIuZGVwZW5kKCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHdhdGNoZXIudmFsdWU7CiAgICB9CiAgfTsKfQpmdW5jdGlvbiBjcmVhdGVHZXR0ZXJJbnZva2VyKGZuKSB7CiAgcmV0dXJuIGZ1bmN0aW9uIGNvbXB1dGVkR2V0dGVyKCkgewogICAgcmV0dXJuIGZuLmNhbGwodGhpcywgdGhpcyk7CiAgfTsKfQpmdW5jdGlvbiBpbml0TWV0aG9kcyh2bSwgbWV0aG9kcykgewogIHZhciBwcm9wcyA9IHZtLiRvcHRpb25zLnByb3BzOwogIGZvciAodmFyIGtleSBpbiBtZXRob2RzKSB7CiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICBpZiAodHlwZW9mIG1ldGhvZHNba2V5XSAhPT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHdhcm4oIk1ldGhvZCBcIiIuY29uY2F0KGtleSwgIlwiIGhhcyB0eXBlIFwiIikuY29uY2F0KHR5cGVvZiBtZXRob2RzW2tleV0sICJcIiBpbiB0aGUgY29tcG9uZW50IGRlZmluaXRpb24uICIpICsgIkRpZCB5b3UgcmVmZXJlbmNlIHRoZSBmdW5jdGlvbiBjb3JyZWN0bHk/Iiwgdm0pOwogICAgICB9CiAgICAgIGlmIChwcm9wcyAmJiBoYXNPd24ocHJvcHMsIGtleSkpIHsKICAgICAgICB3YXJuKCJNZXRob2QgXCIiLmNvbmNhdChrZXksICJcIiBoYXMgYWxyZWFkeSBiZWVuIGRlZmluZWQgYXMgYSBwcm9wLiIpLCB2bSk7CiAgICAgIH0KICAgICAgaWYgKGtleSBpbiB2bSAmJiBpc1Jlc2VydmVkKGtleSkpIHsKICAgICAgICB3YXJuKCJNZXRob2QgXCIiLmNvbmNhdChrZXksICJcIiBjb25mbGljdHMgd2l0aCBhbiBleGlzdGluZyBWdWUgaW5zdGFuY2UgbWV0aG9kLiAiKSArICJBdm9pZCBkZWZpbmluZyBjb21wb25lbnQgbWV0aG9kcyB0aGF0IHN0YXJ0IHdpdGggXyBvciAkLiIpOwogICAgICB9CiAgICB9CiAgICB2bVtrZXldID0gdHlwZW9mIG1ldGhvZHNba2V5XSAhPT0gJ2Z1bmN0aW9uJyA/IG5vb3AgOiBiaW5kKG1ldGhvZHNba2V5XSwgdm0pOwogIH0KfQpmdW5jdGlvbiBpbml0V2F0Y2godm0sIHdhdGNoKSB7CiAgZm9yICh2YXIga2V5IGluIHdhdGNoKSB7CiAgICB2YXIgaGFuZGxlciA9IHdhdGNoW2tleV07CiAgICBpZiAoaXNBcnJheShoYW5kbGVyKSkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhhbmRsZXIubGVuZ3RoOyBpKyspIHsKICAgICAgICBjcmVhdGVXYXRjaGVyKHZtLCBrZXksIGhhbmRsZXJbaV0pOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBjcmVhdGVXYXRjaGVyKHZtLCBrZXksIGhhbmRsZXIpOwogICAgfQogIH0KfQpmdW5jdGlvbiBjcmVhdGVXYXRjaGVyKHZtLCBleHBPckZuLCBoYW5kbGVyLCBvcHRpb25zKSB7CiAgaWYgKGlzUGxhaW5PYmplY3QoaGFuZGxlcikpIHsKICAgIG9wdGlvbnMgPSBoYW5kbGVyOwogICAgaGFuZGxlciA9IGhhbmRsZXIuaGFuZGxlcjsKICB9CiAgaWYgKHR5cGVvZiBoYW5kbGVyID09PSAnc3RyaW5nJykgewogICAgaGFuZGxlciA9IHZtW2hhbmRsZXJdOwogIH0KICByZXR1cm4gdm0uJHdhdGNoKGV4cE9yRm4sIGhhbmRsZXIsIG9wdGlvbnMpOwp9CmZ1bmN0aW9uIHN0YXRlTWl4aW4oVnVlKSB7CiAgLy8gZmxvdyBzb21laG93IGhhcyBwcm9ibGVtcyB3aXRoIGRpcmVjdGx5IGRlY2xhcmVkIGRlZmluaXRpb24gb2JqZWN0CiAgLy8gd2hlbiB1c2luZyBPYmplY3QuZGVmaW5lUHJvcGVydHksIHNvIHdlIGhhdmUgdG8gcHJvY2VkdXJhbGx5IGJ1aWxkIHVwCiAgLy8gdGhlIG9iamVjdCBoZXJlLgogIHZhciBkYXRhRGVmID0ge307CiAgZGF0YURlZi5nZXQgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5fZGF0YTsKICB9OwogIHZhciBwcm9wc0RlZiA9IHt9OwogIHByb3BzRGVmLmdldCA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzLl9wcm9wczsKICB9OwogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICBkYXRhRGVmLnNldCA9IGZ1bmN0aW9uICgpIHsKICAgICAgd2FybignQXZvaWQgcmVwbGFjaW5nIGluc3RhbmNlIHJvb3QgJGRhdGEuICcgKyAnVXNlIG5lc3RlZCBkYXRhIHByb3BlcnRpZXMgaW5zdGVhZC4nLCB0aGlzKTsKICAgIH07CiAgICBwcm9wc0RlZi5zZXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHdhcm4oIiRwcm9wcyBpcyByZWFkb25seS4iLCB0aGlzKTsKICAgIH07CiAgfQogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWdWUucHJvdG90eXBlLCAnJGRhdGEnLCBkYXRhRGVmKTsKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVnVlLnByb3RvdHlwZSwgJyRwcm9wcycsIHByb3BzRGVmKTsKICBWdWUucHJvdG90eXBlLiRzZXQgPSBzZXQ7CiAgVnVlLnByb3RvdHlwZS4kZGVsZXRlID0gZGVsOwogIFZ1ZS5wcm90b3R5cGUuJHdhdGNoID0gZnVuY3Rpb24gKGV4cE9yRm4sIGNiLCBvcHRpb25zKSB7CiAgICB2YXIgdm0gPSB0aGlzOwogICAgaWYgKGlzUGxhaW5PYmplY3QoY2IpKSB7CiAgICAgIHJldHVybiBjcmVhdGVXYXRjaGVyKHZtLCBleHBPckZuLCBjYiwgb3B0aW9ucyk7CiAgICB9CiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgIG9wdGlvbnMudXNlciA9IHRydWU7CiAgICB2YXIgd2F0Y2hlciA9IG5ldyBXYXRjaGVyKHZtLCBleHBPckZuLCBjYiwgb3B0aW9ucyk7CiAgICBpZiAob3B0aW9ucy5pbW1lZGlhdGUpIHsKICAgICAgdmFyIGluZm8gPSAiY2FsbGJhY2sgZm9yIGltbWVkaWF0ZSB3YXRjaGVyIFwiIi5jb25jYXQod2F0Y2hlci5leHByZXNzaW9uLCAiXCIiKTsKICAgICAgcHVzaFRhcmdldCgpOwogICAgICBpbnZva2VXaXRoRXJyb3JIYW5kbGluZyhjYiwgdm0sIFt3YXRjaGVyLnZhbHVlXSwgdm0sIGluZm8pOwogICAgICBwb3BUYXJnZXQoKTsKICAgIH0KICAgIHJldHVybiBmdW5jdGlvbiB1bndhdGNoRm4oKSB7CiAgICAgIHdhdGNoZXIudGVhcmRvd24oKTsKICAgIH07CiAgfTsKfQp2YXIgdWlkID0gMDsKZnVuY3Rpb24gaW5pdE1peGluJDEoVnVlKSB7CiAgVnVlLnByb3RvdHlwZS5faW5pdCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgICB2YXIgdm0gPSB0aGlzOwogICAgLy8gYSB1aWQKICAgIHZtLl91aWQgPSB1aWQrKzsKICAgIHZhciBzdGFydFRhZywgZW5kVGFnOwogICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiBjb25maWcucGVyZm9ybWFuY2UgJiYgbWFyaykgewogICAgICBzdGFydFRhZyA9ICJ2dWUtcGVyZi1zdGFydDoiLmNvbmNhdCh2bS5fdWlkKTsKICAgICAgZW5kVGFnID0gInZ1ZS1wZXJmLWVuZDoiLmNvbmNhdCh2bS5fdWlkKTsKICAgICAgbWFyayhzdGFydFRhZyk7CiAgICB9CiAgICAvLyBhIGZsYWcgdG8gbWFyayB0aGlzIGFzIGEgVnVlIGluc3RhbmNlIHdpdGhvdXQgaGF2aW5nIHRvIGRvIGluc3RhbmNlb2YKICAgIC8vIGNoZWNrCiAgICB2bS5faXNWdWUgPSB0cnVlOwogICAgLy8gYXZvaWQgaW5zdGFuY2VzIGZyb20gYmVpbmcgb2JzZXJ2ZWQKICAgIHZtLl9fdl9za2lwID0gdHJ1ZTsKICAgIC8vIGVmZmVjdCBzY29wZQogICAgdm0uX3Njb3BlID0gbmV3IEVmZmVjdFNjb3BlKHRydWUgLyogZGV0YWNoZWQgKi8pOwogICAgLy8gIzEzMTM0IGVkZ2UgY2FzZSB3aGVyZSBhIGNoaWxkIGNvbXBvbmVudCBpcyBtYW51YWxseSBjcmVhdGVkIGR1cmluZyB0aGUKICAgIC8vIHJlbmRlciBvZiBhIHBhcmVudCBjb21wb25lbnQKICAgIHZtLl9zY29wZS5wYXJlbnQgPSB1bmRlZmluZWQ7CiAgICB2bS5fc2NvcGUuX3ZtID0gdHJ1ZTsKICAgIC8vIG1lcmdlIG9wdGlvbnMKICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuX2lzQ29tcG9uZW50KSB7CiAgICAgIC8vIG9wdGltaXplIGludGVybmFsIGNvbXBvbmVudCBpbnN0YW50aWF0aW9uCiAgICAgIC8vIHNpbmNlIGR5bmFtaWMgb3B0aW9ucyBtZXJnaW5nIGlzIHByZXR0eSBzbG93LCBhbmQgbm9uZSBvZiB0aGUKICAgICAgLy8gaW50ZXJuYWwgY29tcG9uZW50IG9wdGlvbnMgbmVlZHMgc3BlY2lhbCB0cmVhdG1lbnQuCiAgICAgIGluaXRJbnRlcm5hbENvbXBvbmVudCh2bSwgb3B0aW9ucyk7CiAgICB9IGVsc2UgewogICAgICB2bS4kb3B0aW9ucyA9IG1lcmdlT3B0aW9ucyhyZXNvbHZlQ29uc3RydWN0b3JPcHRpb25zKHZtLmNvbnN0cnVjdG9yKSwgb3B0aW9ucyB8fCB7fSwgdm0pOwogICAgfQogICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8KICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICAgIGluaXRQcm94eSh2bSk7CiAgICB9IGVsc2UgewogICAgICB2bS5fcmVuZGVyUHJveHkgPSB2bTsKICAgIH0KICAgIC8vIGV4cG9zZSByZWFsIHNlbGYKICAgIHZtLl9zZWxmID0gdm07CiAgICBpbml0TGlmZWN5Y2xlKHZtKTsKICAgIGluaXRFdmVudHModm0pOwogICAgaW5pdFJlbmRlcih2bSk7CiAgICBjYWxsSG9vayQxKHZtLCAnYmVmb3JlQ3JlYXRlJywgdW5kZWZpbmVkLCBmYWxzZSAvKiBzZXRDb250ZXh0ICovKTsKICAgIGluaXRJbmplY3Rpb25zKHZtKTsgLy8gcmVzb2x2ZSBpbmplY3Rpb25zIGJlZm9yZSBkYXRhL3Byb3BzCiAgICBpbml0U3RhdGUodm0pOwogICAgaW5pdFByb3ZpZGUodm0pOyAvLyByZXNvbHZlIHByb3ZpZGUgYWZ0ZXIgZGF0YS9wcm9wcwogICAgY2FsbEhvb2skMSh2bSwgJ2NyZWF0ZWQnKTsKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgY29uZmlnLnBlcmZvcm1hbmNlICYmIG1hcmspIHsKICAgICAgdm0uX25hbWUgPSBmb3JtYXRDb21wb25lbnROYW1lKHZtLCBmYWxzZSk7CiAgICAgIG1hcmsoZW5kVGFnKTsKICAgICAgbWVhc3VyZSgidnVlICIuY29uY2F0KHZtLl9uYW1lLCAiIGluaXQiKSwgc3RhcnRUYWcsIGVuZFRhZyk7CiAgICB9CiAgICBpZiAodm0uJG9wdGlvbnMuZWwpIHsKICAgICAgdm0uJG1vdW50KHZtLiRvcHRpb25zLmVsKTsKICAgIH0KICB9Owp9CmZ1bmN0aW9uIGluaXRJbnRlcm5hbENvbXBvbmVudCh2bSwgb3B0aW9ucykgewogIHZhciBvcHRzID0gdm0uJG9wdGlvbnMgPSBPYmplY3QuY3JlYXRlKHZtLmNvbnN0cnVjdG9yLm9wdGlvbnMpOwogIC8vIGRvaW5nIHRoaXMgYmVjYXVzZSBpdCdzIGZhc3RlciB0aGFuIGR5bmFtaWMgZW51bWVyYXRpb24uCiAgdmFyIHBhcmVudFZub2RlID0gb3B0aW9ucy5fcGFyZW50Vm5vZGU7CiAgb3B0cy5wYXJlbnQgPSBvcHRpb25zLnBhcmVudDsKICBvcHRzLl9wYXJlbnRWbm9kZSA9IHBhcmVudFZub2RlOwogIHZhciB2bm9kZUNvbXBvbmVudE9wdGlvbnMgPSBwYXJlbnRWbm9kZS5jb21wb25lbnRPcHRpb25zOwogIG9wdHMucHJvcHNEYXRhID0gdm5vZGVDb21wb25lbnRPcHRpb25zLnByb3BzRGF0YTsKICBvcHRzLl9wYXJlbnRMaXN0ZW5lcnMgPSB2bm9kZUNvbXBvbmVudE9wdGlvbnMubGlzdGVuZXJzOwogIG9wdHMuX3JlbmRlckNoaWxkcmVuID0gdm5vZGVDb21wb25lbnRPcHRpb25zLmNoaWxkcmVuOwogIG9wdHMuX2NvbXBvbmVudFRhZyA9IHZub2RlQ29tcG9uZW50T3B0aW9ucy50YWc7CiAgaWYgKG9wdGlvbnMucmVuZGVyKSB7CiAgICBvcHRzLnJlbmRlciA9IG9wdGlvbnMucmVuZGVyOwogICAgb3B0cy5zdGF0aWNSZW5kZXJGbnMgPSBvcHRpb25zLnN0YXRpY1JlbmRlckZuczsKICB9Cn0KZnVuY3Rpb24gcmVzb2x2ZUNvbnN0cnVjdG9yT3B0aW9ucyhDdG9yKSB7CiAgdmFyIG9wdGlvbnMgPSBDdG9yLm9wdGlvbnM7CiAgaWYgKEN0b3Iuc3VwZXIpIHsKICAgIHZhciBzdXBlck9wdGlvbnMgPSByZXNvbHZlQ29uc3RydWN0b3JPcHRpb25zKEN0b3Iuc3VwZXIpOwogICAgdmFyIGNhY2hlZFN1cGVyT3B0aW9ucyA9IEN0b3Iuc3VwZXJPcHRpb25zOwogICAgaWYgKHN1cGVyT3B0aW9ucyAhPT0gY2FjaGVkU3VwZXJPcHRpb25zKSB7CiAgICAgIC8vIHN1cGVyIG9wdGlvbiBjaGFuZ2VkLAogICAgICAvLyBuZWVkIHRvIHJlc29sdmUgbmV3IG9wdGlvbnMuCiAgICAgIEN0b3Iuc3VwZXJPcHRpb25zID0gc3VwZXJPcHRpb25zOwogICAgICAvLyBjaGVjayBpZiB0aGVyZSBhcmUgYW55IGxhdGUtbW9kaWZpZWQvYXR0YWNoZWQgb3B0aW9ucyAoIzQ5NzYpCiAgICAgIHZhciBtb2RpZmllZE9wdGlvbnMgPSByZXNvbHZlTW9kaWZpZWRPcHRpb25zKEN0b3IpOwogICAgICAvLyB1cGRhdGUgYmFzZSBleHRlbmQgb3B0aW9ucwogICAgICBpZiAobW9kaWZpZWRPcHRpb25zKSB7CiAgICAgICAgZXh0ZW5kKEN0b3IuZXh0ZW5kT3B0aW9ucywgbW9kaWZpZWRPcHRpb25zKTsKICAgICAgfQogICAgICBvcHRpb25zID0gQ3Rvci5vcHRpb25zID0gbWVyZ2VPcHRpb25zKHN1cGVyT3B0aW9ucywgQ3Rvci5leHRlbmRPcHRpb25zKTsKICAgICAgaWYgKG9wdGlvbnMubmFtZSkgewogICAgICAgIG9wdGlvbnMuY29tcG9uZW50c1tvcHRpb25zLm5hbWVdID0gQ3RvcjsKICAgICAgfQogICAgfQogIH0KICByZXR1cm4gb3B0aW9uczsKfQpmdW5jdGlvbiByZXNvbHZlTW9kaWZpZWRPcHRpb25zKEN0b3IpIHsKICB2YXIgbW9kaWZpZWQ7CiAgdmFyIGxhdGVzdCA9IEN0b3Iub3B0aW9uczsKICB2YXIgc2VhbGVkID0gQ3Rvci5zZWFsZWRPcHRpb25zOwogIGZvciAodmFyIGtleSBpbiBsYXRlc3QpIHsKICAgIGlmIChsYXRlc3Rba2V5XSAhPT0gc2VhbGVkW2tleV0pIHsKICAgICAgaWYgKCFtb2RpZmllZCkgbW9kaWZpZWQgPSB7fTsKICAgICAgbW9kaWZpZWRba2V5XSA9IGxhdGVzdFtrZXldOwogICAgfQogIH0KICByZXR1cm4gbW9kaWZpZWQ7Cn0KZnVuY3Rpb24gVnVlKG9wdGlvbnMpIHsKICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiAhKHRoaXMgaW5zdGFuY2VvZiBWdWUpKSB7CiAgICB3YXJuKCdWdWUgaXMgYSBjb25zdHJ1Y3RvciBhbmQgc2hvdWxkIGJlIGNhbGxlZCB3aXRoIHRoZSBgbmV3YCBrZXl3b3JkJyk7CiAgfQogIHRoaXMuX2luaXQob3B0aW9ucyk7Cn0KLy9AdHMtZXhwZWN0LWVycm9yIFZ1ZSBoYXMgZnVuY3Rpb24gdHlwZQppbml0TWl4aW4kMShWdWUpOwovL0B0cy1leHBlY3QtZXJyb3IgVnVlIGhhcyBmdW5jdGlvbiB0eXBlCnN0YXRlTWl4aW4oVnVlKTsKLy9AdHMtZXhwZWN0LWVycm9yIFZ1ZSBoYXMgZnVuY3Rpb24gdHlwZQpldmVudHNNaXhpbihWdWUpOwovL0B0cy1leHBlY3QtZXJyb3IgVnVlIGhhcyBmdW5jdGlvbiB0eXBlCmxpZmVjeWNsZU1peGluKFZ1ZSk7Ci8vQHRzLWV4cGVjdC1lcnJvciBWdWUgaGFzIGZ1bmN0aW9uIHR5cGUKcmVuZGVyTWl4aW4oVnVlKTsKZnVuY3Rpb24gaW5pdFVzZShWdWUpIHsKICBWdWUudXNlID0gZnVuY3Rpb24gKHBsdWdpbikgewogICAgdmFyIGluc3RhbGxlZFBsdWdpbnMgPSB0aGlzLl9pbnN0YWxsZWRQbHVnaW5zIHx8ICh0aGlzLl9pbnN0YWxsZWRQbHVnaW5zID0gW10pOwogICAgaWYgKGluc3RhbGxlZFBsdWdpbnMuaW5kZXhPZihwbHVnaW4pID4gLTEpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvLyBhZGRpdGlvbmFsIHBhcmFtZXRlcnMKICAgIHZhciBhcmdzID0gdG9BcnJheShhcmd1bWVudHMsIDEpOwogICAgYXJncy51bnNoaWZ0KHRoaXMpOwogICAgaWYgKGlzRnVuY3Rpb24ocGx1Z2luLmluc3RhbGwpKSB7CiAgICAgIHBsdWdpbi5pbnN0YWxsLmFwcGx5KHBsdWdpbiwgYXJncyk7CiAgICB9IGVsc2UgaWYgKGlzRnVuY3Rpb24ocGx1Z2luKSkgewogICAgICBwbHVnaW4uYXBwbHkobnVsbCwgYXJncyk7CiAgICB9CiAgICBpbnN0YWxsZWRQbHVnaW5zLnB1c2gocGx1Z2luKTsKICAgIHJldHVybiB0aGlzOwogIH07Cn0KZnVuY3Rpb24gaW5pdE1peGluKFZ1ZSkgewogIFZ1ZS5taXhpbiA9IGZ1bmN0aW9uIChtaXhpbikgewogICAgdGhpcy5vcHRpb25zID0gbWVyZ2VPcHRpb25zKHRoaXMub3B0aW9ucywgbWl4aW4pOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKfQpmdW5jdGlvbiBpbml0RXh0ZW5kKFZ1ZSkgewogIC8qKgogICAqIEVhY2ggaW5zdGFuY2UgY29uc3RydWN0b3IsIGluY2x1ZGluZyBWdWUsIGhhcyBhIHVuaXF1ZQogICAqIGNpZC4gVGhpcyBlbmFibGVzIHVzIHRvIGNyZWF0ZSB3cmFwcGVkICJjaGlsZAogICAqIGNvbnN0cnVjdG9ycyIgZm9yIHByb3RvdHlwYWwgaW5oZXJpdGFuY2UgYW5kIGNhY2hlIHRoZW0uCiAgICovCiAgVnVlLmNpZCA9IDA7CiAgdmFyIGNpZCA9IDE7CiAgLyoqCiAgICogQ2xhc3MgaW5oZXJpdGFuY2UKICAgKi8KICBWdWUuZXh0ZW5kID0gZnVuY3Rpb24gKGV4dGVuZE9wdGlvbnMpIHsKICAgIGV4dGVuZE9wdGlvbnMgPSBleHRlbmRPcHRpb25zIHx8IHt9OwogICAgdmFyIFN1cGVyID0gdGhpczsKICAgIHZhciBTdXBlcklkID0gU3VwZXIuY2lkOwogICAgdmFyIGNhY2hlZEN0b3JzID0gZXh0ZW5kT3B0aW9ucy5fQ3RvciB8fCAoZXh0ZW5kT3B0aW9ucy5fQ3RvciA9IHt9KTsKICAgIGlmIChjYWNoZWRDdG9yc1tTdXBlcklkXSkgewogICAgICByZXR1cm4gY2FjaGVkQ3RvcnNbU3VwZXJJZF07CiAgICB9CiAgICB2YXIgbmFtZSA9IGdldENvbXBvbmVudE5hbWUoZXh0ZW5kT3B0aW9ucykgfHwgZ2V0Q29tcG9uZW50TmFtZShTdXBlci5vcHRpb25zKTsKICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIG5hbWUpIHsKICAgICAgdmFsaWRhdGVDb21wb25lbnROYW1lKG5hbWUpOwogICAgfQogICAgdmFyIFN1YiA9IGZ1bmN0aW9uIFZ1ZUNvbXBvbmVudChvcHRpb25zKSB7CiAgICAgIHRoaXMuX2luaXQob3B0aW9ucyk7CiAgICB9OwogICAgU3ViLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU3VwZXIucHJvdG90eXBlKTsKICAgIFN1Yi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBTdWI7CiAgICBTdWIuY2lkID0gY2lkKys7CiAgICBTdWIub3B0aW9ucyA9IG1lcmdlT3B0aW9ucyhTdXBlci5vcHRpb25zLCBleHRlbmRPcHRpb25zKTsKICAgIFN1Ylsnc3VwZXInXSA9IFN1cGVyOwogICAgLy8gRm9yIHByb3BzIGFuZCBjb21wdXRlZCBwcm9wZXJ0aWVzLCB3ZSBkZWZpbmUgdGhlIHByb3h5IGdldHRlcnMgb24KICAgIC8vIHRoZSBWdWUgaW5zdGFuY2VzIGF0IGV4dGVuc2lvbiB0aW1lLCBvbiB0aGUgZXh0ZW5kZWQgcHJvdG90eXBlLiBUaGlzCiAgICAvLyBhdm9pZHMgT2JqZWN0LmRlZmluZVByb3BlcnR5IGNhbGxzIGZvciBlYWNoIGluc3RhbmNlIGNyZWF0ZWQuCiAgICBpZiAoU3ViLm9wdGlvbnMucHJvcHMpIHsKICAgICAgaW5pdFByb3BzKFN1Yik7CiAgICB9CiAgICBpZiAoU3ViLm9wdGlvbnMuY29tcHV0ZWQpIHsKICAgICAgaW5pdENvbXB1dGVkKFN1Yik7CiAgICB9CiAgICAvLyBhbGxvdyBmdXJ0aGVyIGV4dGVuc2lvbi9taXhpbi9wbHVnaW4gdXNhZ2UKICAgIFN1Yi5leHRlbmQgPSBTdXBlci5leHRlbmQ7CiAgICBTdWIubWl4aW4gPSBTdXBlci5taXhpbjsKICAgIFN1Yi51c2UgPSBTdXBlci51c2U7CiAgICAvLyBjcmVhdGUgYXNzZXQgcmVnaXN0ZXJzLCBzbyBleHRlbmRlZCBjbGFzc2VzCiAgICAvLyBjYW4gaGF2ZSB0aGVpciBwcml2YXRlIGFzc2V0cyB0b28uCiAgICBBU1NFVF9UWVBFUy5mb3JFYWNoKGZ1bmN0aW9uICh0eXBlKSB7CiAgICAgIFN1Ylt0eXBlXSA9IFN1cGVyW3R5cGVdOwogICAgfSk7CiAgICAvLyBlbmFibGUgcmVjdXJzaXZlIHNlbGYtbG9va3VwCiAgICBpZiAobmFtZSkgewogICAgICBTdWIub3B0aW9ucy5jb21wb25lbnRzW25hbWVdID0gU3ViOwogICAgfQogICAgLy8ga2VlcCBhIHJlZmVyZW5jZSB0byB0aGUgc3VwZXIgb3B0aW9ucyBhdCBleHRlbnNpb24gdGltZS4KICAgIC8vIGxhdGVyIGF0IGluc3RhbnRpYXRpb24gd2UgY2FuIGNoZWNrIGlmIFN1cGVyJ3Mgb3B0aW9ucyBoYXZlCiAgICAvLyBiZWVuIHVwZGF0ZWQuCiAgICBTdWIuc3VwZXJPcHRpb25zID0gU3VwZXIub3B0aW9uczsKICAgIFN1Yi5leHRlbmRPcHRpb25zID0gZXh0ZW5kT3B0aW9uczsKICAgIFN1Yi5zZWFsZWRPcHRpb25zID0gZXh0ZW5kKHt9LCBTdWIub3B0aW9ucyk7CiAgICAvLyBjYWNoZSBjb25zdHJ1Y3RvcgogICAgY2FjaGVkQ3RvcnNbU3VwZXJJZF0gPSBTdWI7CiAgICByZXR1cm4gU3ViOwogIH07Cn0KZnVuY3Rpb24gaW5pdFByb3BzKENvbXApIHsKICB2YXIgcHJvcHMgPSBDb21wLm9wdGlvbnMucHJvcHM7CiAgZm9yICh2YXIga2V5IGluIHByb3BzKSB7CiAgICBwcm94eShDb21wLnByb3RvdHlwZSwgIl9wcm9wcyIsIGtleSk7CiAgfQp9CmZ1bmN0aW9uIGluaXRDb21wdXRlZChDb21wKSB7CiAgdmFyIGNvbXB1dGVkID0gQ29tcC5vcHRpb25zLmNvbXB1dGVkOwogIGZvciAodmFyIGtleSBpbiBjb21wdXRlZCkgewogICAgZGVmaW5lQ29tcHV0ZWQoQ29tcC5wcm90b3R5cGUsIGtleSwgY29tcHV0ZWRba2V5XSk7CiAgfQp9CmZ1bmN0aW9uIGluaXRBc3NldFJlZ2lzdGVycyhWdWUpIHsKICAvKioKICAgKiBDcmVhdGUgYXNzZXQgcmVnaXN0cmF0aW9uIG1ldGhvZHMuCiAgICovCiAgQVNTRVRfVFlQRVMuZm9yRWFjaChmdW5jdGlvbiAodHlwZSkgewogICAgLy8gQHRzLWV4cGVjdC1lcnJvciBmdW5jdGlvbiBpcyBub3QgZXhhY3Qgc2FtZSB0eXBlCiAgICBWdWVbdHlwZV0gPSBmdW5jdGlvbiAoaWQsIGRlZmluaXRpb24pIHsKICAgICAgaWYgKCFkZWZpbml0aW9uKSB7CiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uc1t0eXBlICsgJ3MnXVtpZF07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgdHlwZSA9PT0gJ2NvbXBvbmVudCcpIHsKICAgICAgICAgIHZhbGlkYXRlQ29tcG9uZW50TmFtZShpZCk7CiAgICAgICAgfQogICAgICAgIGlmICh0eXBlID09PSAnY29tcG9uZW50JyAmJiBpc1BsYWluT2JqZWN0KGRlZmluaXRpb24pKSB7CiAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yCiAgICAgICAgICBkZWZpbml0aW9uLm5hbWUgPSBkZWZpbml0aW9uLm5hbWUgfHwgaWQ7CiAgICAgICAgICBkZWZpbml0aW9uID0gdGhpcy5vcHRpb25zLl9iYXNlLmV4dGVuZChkZWZpbml0aW9uKTsKICAgICAgICB9CiAgICAgICAgaWYgKHR5cGUgPT09ICdkaXJlY3RpdmUnICYmIGlzRnVuY3Rpb24oZGVmaW5pdGlvbikpIHsKICAgICAgICAgIGRlZmluaXRpb24gPSB7CiAgICAgICAgICAgIGJpbmQ6IGRlZmluaXRpb24sCiAgICAgICAgICAgIHVwZGF0ZTogZGVmaW5pdGlvbgogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgICAgdGhpcy5vcHRpb25zW3R5cGUgKyAncyddW2lkXSA9IGRlZmluaXRpb247CiAgICAgICAgcmV0dXJuIGRlZmluaXRpb247CiAgICAgIH0KICAgIH07CiAgfSk7Cn0KZnVuY3Rpb24gX2dldENvbXBvbmVudE5hbWUob3B0cykgewogIHJldHVybiBvcHRzICYmIChnZXRDb21wb25lbnROYW1lKG9wdHMuQ3Rvci5vcHRpb25zKSB8fCBvcHRzLnRhZyk7Cn0KZnVuY3Rpb24gbWF0Y2hlcyhwYXR0ZXJuLCBuYW1lKSB7CiAgaWYgKGlzQXJyYXkocGF0dGVybikpIHsKICAgIHJldHVybiBwYXR0ZXJuLmluZGV4T2YobmFtZSkgPiAtMTsKICB9IGVsc2UgaWYgKHR5cGVvZiBwYXR0ZXJuID09PSAnc3RyaW5nJykgewogICAgcmV0dXJuIHBhdHRlcm4uc3BsaXQoJywnKS5pbmRleE9mKG5hbWUpID4gLTE7CiAgfSBlbHNlIGlmIChpc1JlZ0V4cChwYXR0ZXJuKSkgewogICAgcmV0dXJuIHBhdHRlcm4udGVzdChuYW1lKTsKICB9CiAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KICByZXR1cm4gZmFsc2U7Cn0KZnVuY3Rpb24gcHJ1bmVDYWNoZShrZWVwQWxpdmVJbnN0YW5jZSwgZmlsdGVyKSB7CiAgdmFyIGNhY2hlID0ga2VlcEFsaXZlSW5zdGFuY2UuY2FjaGUsCiAgICBrZXlzID0ga2VlcEFsaXZlSW5zdGFuY2Uua2V5cywKICAgIF92bm9kZSA9IGtlZXBBbGl2ZUluc3RhbmNlLl92bm9kZSwKICAgICR2bm9kZSA9IGtlZXBBbGl2ZUluc3RhbmNlLiR2bm9kZTsKICBmb3IgKHZhciBrZXkgaW4gY2FjaGUpIHsKICAgIHZhciBlbnRyeSA9IGNhY2hlW2tleV07CiAgICBpZiAoZW50cnkpIHsKICAgICAgdmFyIG5hbWVfMSA9IGVudHJ5Lm5hbWU7CiAgICAgIGlmIChuYW1lXzEgJiYgIWZpbHRlcihuYW1lXzEpKSB7CiAgICAgICAgcHJ1bmVDYWNoZUVudHJ5KGNhY2hlLCBrZXksIGtleXMsIF92bm9kZSk7CiAgICAgIH0KICAgIH0KICB9CiAgJHZub2RlLmNvbXBvbmVudE9wdGlvbnMuY2hpbGRyZW4gPSB1bmRlZmluZWQ7Cn0KZnVuY3Rpb24gcHJ1bmVDYWNoZUVudHJ5KGNhY2hlLCBrZXksIGtleXMsIGN1cnJlbnQpIHsKICB2YXIgZW50cnkgPSBjYWNoZVtrZXldOwogIGlmIChlbnRyeSAmJiAoIWN1cnJlbnQgfHwgZW50cnkudGFnICE9PSBjdXJyZW50LnRhZykpIHsKICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgY2FuIGJlIHVuZGVmaW5lZAogICAgZW50cnkuY29tcG9uZW50SW5zdGFuY2UuJGRlc3Ryb3koKTsKICB9CiAgY2FjaGVba2V5XSA9IG51bGw7CiAgcmVtb3ZlJDIoa2V5cywga2V5KTsKfQp2YXIgcGF0dGVyblR5cGVzID0gW1N0cmluZywgUmVnRXhwLCBBcnJheV07Ci8vIFRPRE8gZGVmaW5lQ29tcG9uZW50CnZhciBLZWVwQWxpdmUgPSB7CiAgbmFtZTogJ2tlZXAtYWxpdmUnLAogIGFic3RyYWN0OiB0cnVlLAogIHByb3BzOiB7CiAgICBpbmNsdWRlOiBwYXR0ZXJuVHlwZXMsCiAgICBleGNsdWRlOiBwYXR0ZXJuVHlwZXMsCiAgICBtYXg6IFtTdHJpbmcsIE51bWJlcl0KICB9LAogIG1ldGhvZHM6IHsKICAgIGNhY2hlVk5vZGU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9hID0gdGhpcywKICAgICAgICBjYWNoZSA9IF9hLmNhY2hlLAogICAgICAgIGtleXMgPSBfYS5rZXlzLAogICAgICAgIHZub2RlVG9DYWNoZSA9IF9hLnZub2RlVG9DYWNoZSwKICAgICAgICBrZXlUb0NhY2hlID0gX2Eua2V5VG9DYWNoZTsKICAgICAgaWYgKHZub2RlVG9DYWNoZSkgewogICAgICAgIHZhciB0YWcgPSB2bm9kZVRvQ2FjaGUudGFnLAogICAgICAgICAgY29tcG9uZW50SW5zdGFuY2UgPSB2bm9kZVRvQ2FjaGUuY29tcG9uZW50SW5zdGFuY2UsCiAgICAgICAgICBjb21wb25lbnRPcHRpb25zID0gdm5vZGVUb0NhY2hlLmNvbXBvbmVudE9wdGlvbnM7CiAgICAgICAgY2FjaGVba2V5VG9DYWNoZV0gPSB7CiAgICAgICAgICBuYW1lOiBfZ2V0Q29tcG9uZW50TmFtZShjb21wb25lbnRPcHRpb25zKSwKICAgICAgICAgIHRhZzogdGFnLAogICAgICAgICAgY29tcG9uZW50SW5zdGFuY2U6IGNvbXBvbmVudEluc3RhbmNlCiAgICAgICAgfTsKICAgICAgICBrZXlzLnB1c2goa2V5VG9DYWNoZSk7CiAgICAgICAgLy8gcHJ1bmUgb2xkZXN0IGVudHJ5CiAgICAgICAgaWYgKHRoaXMubWF4ICYmIGtleXMubGVuZ3RoID4gcGFyc2VJbnQodGhpcy5tYXgpKSB7CiAgICAgICAgICBwcnVuZUNhY2hlRW50cnkoY2FjaGUsIGtleXNbMF0sIGtleXMsIHRoaXMuX3Zub2RlKTsKICAgICAgICB9CiAgICAgICAgdGhpcy52bm9kZVRvQ2FjaGUgPSBudWxsOwogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmNhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHRoaXMua2V5cyA9IFtdOwogIH0sCiAgZGVzdHJveWVkOiBmdW5jdGlvbiAoKSB7CiAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5jYWNoZSkgewogICAgICBwcnVuZUNhY2hlRW50cnkodGhpcy5jYWNoZSwga2V5LCB0aGlzLmtleXMpOwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKICAgIHRoaXMuY2FjaGVWTm9kZSgpOwogICAgdGhpcy4kd2F0Y2goJ2luY2x1ZGUnLCBmdW5jdGlvbiAodmFsKSB7CiAgICAgIHBydW5lQ2FjaGUoX3RoaXMsIGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgcmV0dXJuIG1hdGNoZXModmFsLCBuYW1lKTsKICAgICAgfSk7CiAgICB9KTsKICAgIHRoaXMuJHdhdGNoKCdleGNsdWRlJywgZnVuY3Rpb24gKHZhbCkgewogICAgICBwcnVuZUNhY2hlKF90aGlzLCBmdW5jdGlvbiAobmFtZSkgewogICAgICAgIHJldHVybiAhbWF0Y2hlcyh2YWwsIG5hbWUpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgdXBkYXRlZDogZnVuY3Rpb24gKCkgewogICAgdGhpcy5jYWNoZVZOb2RlKCk7CiAgfSwKICByZW5kZXI6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBzbG90ID0gdGhpcy4kc2xvdHMuZGVmYXVsdDsKICAgIHZhciB2bm9kZSA9IGdldEZpcnN0Q29tcG9uZW50Q2hpbGQoc2xvdCk7CiAgICB2YXIgY29tcG9uZW50T3B0aW9ucyA9IHZub2RlICYmIHZub2RlLmNvbXBvbmVudE9wdGlvbnM7CiAgICBpZiAoY29tcG9uZW50T3B0aW9ucykgewogICAgICAvLyBjaGVjayBwYXR0ZXJuCiAgICAgIHZhciBuYW1lXzIgPSBfZ2V0Q29tcG9uZW50TmFtZShjb21wb25lbnRPcHRpb25zKTsKICAgICAgdmFyIF9hID0gdGhpcywKICAgICAgICBpbmNsdWRlID0gX2EuaW5jbHVkZSwKICAgICAgICBleGNsdWRlID0gX2EuZXhjbHVkZTsKICAgICAgaWYgKAogICAgICAvLyBub3QgaW5jbHVkZWQKICAgICAgaW5jbHVkZSAmJiAoIW5hbWVfMiB8fCAhbWF0Y2hlcyhpbmNsdWRlLCBuYW1lXzIpKSB8fAogICAgICAvLyBleGNsdWRlZAogICAgICBleGNsdWRlICYmIG5hbWVfMiAmJiBtYXRjaGVzKGV4Y2x1ZGUsIG5hbWVfMikpIHsKICAgICAgICByZXR1cm4gdm5vZGU7CiAgICAgIH0KICAgICAgdmFyIF9iID0gdGhpcywKICAgICAgICBjYWNoZSA9IF9iLmNhY2hlLAogICAgICAgIGtleXMgPSBfYi5rZXlzOwogICAgICB2YXIga2V5ID0gdm5vZGUua2V5ID09IG51bGwgPwogICAgICAvLyBzYW1lIGNvbnN0cnVjdG9yIG1heSBnZXQgcmVnaXN0ZXJlZCBhcyBkaWZmZXJlbnQgbG9jYWwgY29tcG9uZW50cwogICAgICAvLyBzbyBjaWQgYWxvbmUgaXMgbm90IGVub3VnaCAoIzMyNjkpCiAgICAgIGNvbXBvbmVudE9wdGlvbnMuQ3Rvci5jaWQgKyAoY29tcG9uZW50T3B0aW9ucy50YWcgPyAiOjoiLmNvbmNhdChjb21wb25lbnRPcHRpb25zLnRhZykgOiAnJykgOiB2bm9kZS5rZXk7CiAgICAgIGlmIChjYWNoZVtrZXldKSB7CiAgICAgICAgdm5vZGUuY29tcG9uZW50SW5zdGFuY2UgPSBjYWNoZVtrZXldLmNvbXBvbmVudEluc3RhbmNlOwogICAgICAgIC8vIG1ha2UgY3VycmVudCBrZXkgZnJlc2hlc3QKICAgICAgICByZW1vdmUkMihrZXlzLCBrZXkpOwogICAgICAgIGtleXMucHVzaChrZXkpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIGRlbGF5IHNldHRpbmcgdGhlIGNhY2hlIHVudGlsIHVwZGF0ZQogICAgICAgIHRoaXMudm5vZGVUb0NhY2hlID0gdm5vZGU7CiAgICAgICAgdGhpcy5rZXlUb0NhY2hlID0ga2V5OwogICAgICB9CiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgY2FuIHZub2RlLmRhdGEgY2FuIGJlIHVuZGVmaW5lZAogICAgICB2bm9kZS5kYXRhLmtlZXBBbGl2ZSA9IHRydWU7CiAgICB9CiAgICByZXR1cm4gdm5vZGUgfHwgc2xvdCAmJiBzbG90WzBdOwogIH0KfTsKdmFyIGJ1aWx0SW5Db21wb25lbnRzID0gewogIEtlZXBBbGl2ZTogS2VlcEFsaXZlCn07CmZ1bmN0aW9uIGluaXRHbG9iYWxBUEkoVnVlKSB7CiAgLy8gY29uZmlnCiAgdmFyIGNvbmZpZ0RlZiA9IHt9OwogIGNvbmZpZ0RlZi5nZXQgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gY29uZmlnOwogIH07CiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgIGNvbmZpZ0RlZi5zZXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHdhcm4oJ0RvIG5vdCByZXBsYWNlIHRoZSBWdWUuY29uZmlnIG9iamVjdCwgc2V0IGluZGl2aWR1YWwgZmllbGRzIGluc3RlYWQuJyk7CiAgICB9OwogIH0KICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVnVlLCAnY29uZmlnJywgY29uZmlnRGVmKTsKICAvLyBleHBvc2VkIHV0aWwgbWV0aG9kcy4KICAvLyBOT1RFOiB0aGVzZSBhcmUgbm90IGNvbnNpZGVyZWQgcGFydCBvZiB0aGUgcHVibGljIEFQSSAtIGF2b2lkIHJlbHlpbmcgb24KICAvLyB0aGVtIHVubGVzcyB5b3UgYXJlIGF3YXJlIG9mIHRoZSByaXNrLgogIFZ1ZS51dGlsID0gewogICAgd2Fybjogd2FybiwKICAgIGV4dGVuZDogZXh0ZW5kLAogICAgbWVyZ2VPcHRpb25zOiBtZXJnZU9wdGlvbnMsCiAgICBkZWZpbmVSZWFjdGl2ZTogZGVmaW5lUmVhY3RpdmUKICB9OwogIFZ1ZS5zZXQgPSBzZXQ7CiAgVnVlLmRlbGV0ZSA9IGRlbDsKICBWdWUubmV4dFRpY2sgPSBuZXh0VGljazsKICAvLyAyLjYgZXhwbGljaXQgb2JzZXJ2YWJsZSBBUEkKICBWdWUub2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChvYmopIHsKICAgIG9ic2VydmUob2JqKTsKICAgIHJldHVybiBvYmo7CiAgfTsKICBWdWUub3B0aW9ucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgQVNTRVRfVFlQRVMuZm9yRWFjaChmdW5jdGlvbiAodHlwZSkgewogICAgVnVlLm9wdGlvbnNbdHlwZSArICdzJ10gPSBPYmplY3QuY3JlYXRlKG51bGwpOwogIH0pOwogIC8vIHRoaXMgaXMgdXNlZCB0byBpZGVudGlmeSB0aGUgImJhc2UiIGNvbnN0cnVjdG9yIHRvIGV4dGVuZCBhbGwgcGxhaW4tb2JqZWN0CiAgLy8gY29tcG9uZW50cyB3aXRoIGluIFdlZXgncyBtdWx0aS1pbnN0YW5jZSBzY2VuYXJpb3MuCiAgVnVlLm9wdGlvbnMuX2Jhc2UgPSBWdWU7CiAgZXh0ZW5kKFZ1ZS5vcHRpb25zLmNvbXBvbmVudHMsIGJ1aWx0SW5Db21wb25lbnRzKTsKICBpbml0VXNlKFZ1ZSk7CiAgaW5pdE1peGluKFZ1ZSk7CiAgaW5pdEV4dGVuZChWdWUpOwogIGluaXRBc3NldFJlZ2lzdGVycyhWdWUpOwp9CmluaXRHbG9iYWxBUEkoVnVlKTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KFZ1ZS5wcm90b3R5cGUsICckaXNTZXJ2ZXInLCB7CiAgZ2V0OiBpc1NlcnZlclJlbmRlcmluZwp9KTsKT2JqZWN0LmRlZmluZVByb3BlcnR5KFZ1ZS5wcm90b3R5cGUsICckc3NyQ29udGV4dCcsIHsKICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICByZXR1cm4gdGhpcy4kdm5vZGUgJiYgdGhpcy4kdm5vZGUuc3NyQ29udGV4dDsKICB9Cn0pOwovLyBleHBvc2UgRnVuY3Rpb25hbFJlbmRlckNvbnRleHQgZm9yIHNzciBydW50aW1lIGhlbHBlciBpbnN0YWxsYXRpb24KT2JqZWN0LmRlZmluZVByb3BlcnR5KFZ1ZSwgJ0Z1bmN0aW9uYWxSZW5kZXJDb250ZXh0JywgewogIHZhbHVlOiBGdW5jdGlvbmFsUmVuZGVyQ29udGV4dAp9KTsKVnVlLnZlcnNpb24gPSB2ZXJzaW9uOwoKLy8gdGhlc2UgYXJlIHJlc2VydmVkIGZvciB3ZWIgYmVjYXVzZSB0aGV5IGFyZSBkaXJlY3RseSBjb21waWxlZCBhd2F5Ci8vIGR1cmluZyB0ZW1wbGF0ZSBjb21waWxhdGlvbgp2YXIgaXNSZXNlcnZlZEF0dHIgPSBtYWtlTWFwKCdzdHlsZSxjbGFzcycpOwovLyBhdHRyaWJ1dGVzIHRoYXQgc2hvdWxkIGJlIHVzaW5nIHByb3BzIGZvciBiaW5kaW5nCnZhciBhY2NlcHRWYWx1ZSA9IG1ha2VNYXAoJ2lucHV0LHRleHRhcmVhLG9wdGlvbixzZWxlY3QscHJvZ3Jlc3MnKTsKdmFyIG11c3RVc2VQcm9wID0gZnVuY3Rpb24gKHRhZywgdHlwZSwgYXR0cikgewogIHJldHVybiBhdHRyID09PSAndmFsdWUnICYmIGFjY2VwdFZhbHVlKHRhZykgJiYgdHlwZSAhPT0gJ2J1dHRvbicgfHwgYXR0ciA9PT0gJ3NlbGVjdGVkJyAmJiB0YWcgPT09ICdvcHRpb24nIHx8IGF0dHIgPT09ICdjaGVja2VkJyAmJiB0YWcgPT09ICdpbnB1dCcgfHwgYXR0ciA9PT0gJ211dGVkJyAmJiB0YWcgPT09ICd2aWRlbyc7Cn07CnZhciBpc0VudW1lcmF0ZWRBdHRyID0gbWFrZU1hcCgnY29udGVudGVkaXRhYmxlLGRyYWdnYWJsZSxzcGVsbGNoZWNrJyk7CnZhciBpc1ZhbGlkQ29udGVudEVkaXRhYmxlVmFsdWUgPSBtYWtlTWFwKCdldmVudHMsY2FyZXQsdHlwaW5nLHBsYWludGV4dC1vbmx5Jyk7CnZhciBjb252ZXJ0RW51bWVyYXRlZFZhbHVlID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICByZXR1cm4gaXNGYWxzeUF0dHJWYWx1ZSh2YWx1ZSkgfHwgdmFsdWUgPT09ICdmYWxzZScgPyAnZmFsc2UnIDoKICAvLyBhbGxvdyBhcmJpdHJhcnkgc3RyaW5nIHZhbHVlIGZvciBjb250ZW50ZWRpdGFibGUKICBrZXkgPT09ICdjb250ZW50ZWRpdGFibGUnICYmIGlzVmFsaWRDb250ZW50RWRpdGFibGVWYWx1ZSh2YWx1ZSkgPyB2YWx1ZSA6ICd0cnVlJzsKfTsKdmFyIGlzQm9vbGVhbkF0dHIgPSBtYWtlTWFwKCdhbGxvd2Z1bGxzY3JlZW4sYXN5bmMsYXV0b2ZvY3VzLGF1dG9wbGF5LGNoZWNrZWQsY29tcGFjdCxjb250cm9scyxkZWNsYXJlLCcgKyAnZGVmYXVsdCxkZWZhdWx0Y2hlY2tlZCxkZWZhdWx0bXV0ZWQsZGVmYXVsdHNlbGVjdGVkLGRlZmVyLGRpc2FibGVkLCcgKyAnZW5hYmxlZCxmb3Jtbm92YWxpZGF0ZSxoaWRkZW4saW5kZXRlcm1pbmF0ZSxpbmVydCxpc21hcCxpdGVtc2NvcGUsbG9vcCxtdWx0aXBsZSwnICsgJ211dGVkLG5vaHJlZixub3Jlc2l6ZSxub3NoYWRlLG5vdmFsaWRhdGUsbm93cmFwLG9wZW4scGF1c2VvbmV4aXQscmVhZG9ubHksJyArICdyZXF1aXJlZCxyZXZlcnNlZCxzY29wZWQsc2VhbWxlc3Msc2VsZWN0ZWQsc29ydGFibGUsJyArICd0cnVlc3BlZWQsdHlwZW11c3RtYXRjaCx2aXNpYmxlJyk7CnZhciB4bGlua05TID0gJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnOwp2YXIgaXNYbGluayA9IGZ1bmN0aW9uIChuYW1lKSB7CiAgcmV0dXJuIG5hbWUuY2hhckF0KDUpID09PSAnOicgJiYgbmFtZS5zbGljZSgwLCA1KSA9PT0gJ3hsaW5rJzsKfTsKdmFyIGdldFhsaW5rUHJvcCA9IGZ1bmN0aW9uIChuYW1lKSB7CiAgcmV0dXJuIGlzWGxpbmsobmFtZSkgPyBuYW1lLnNsaWNlKDYsIG5hbWUubGVuZ3RoKSA6ICcnOwp9Owp2YXIgaXNGYWxzeUF0dHJWYWx1ZSA9IGZ1bmN0aW9uICh2YWwpIHsKICByZXR1cm4gdmFsID09IG51bGwgfHwgdmFsID09PSBmYWxzZTsKfTsKZnVuY3Rpb24gZ2VuQ2xhc3NGb3JWbm9kZSh2bm9kZSkgewogIHZhciBkYXRhID0gdm5vZGUuZGF0YTsKICB2YXIgcGFyZW50Tm9kZSA9IHZub2RlOwogIHZhciBjaGlsZE5vZGUgPSB2bm9kZTsKICB3aGlsZSAoaXNEZWYoY2hpbGROb2RlLmNvbXBvbmVudEluc3RhbmNlKSkgewogICAgY2hpbGROb2RlID0gY2hpbGROb2RlLmNvbXBvbmVudEluc3RhbmNlLl92bm9kZTsKICAgIGlmIChjaGlsZE5vZGUgJiYgY2hpbGROb2RlLmRhdGEpIHsKICAgICAgZGF0YSA9IG1lcmdlQ2xhc3NEYXRhKGNoaWxkTm9kZS5kYXRhLCBkYXRhKTsKICAgIH0KICB9CiAgLy8gQHRzLWV4cGVjdC1lcnJvciBwYXJlbnROb2RlLnBhcmVudCBub3QgVk5vZGVXaXRoRGF0YQogIHdoaWxlIChpc0RlZihwYXJlbnROb2RlID0gcGFyZW50Tm9kZS5wYXJlbnQpKSB7CiAgICBpZiAocGFyZW50Tm9kZSAmJiBwYXJlbnROb2RlLmRhdGEpIHsKICAgICAgZGF0YSA9IG1lcmdlQ2xhc3NEYXRhKGRhdGEsIHBhcmVudE5vZGUuZGF0YSk7CiAgICB9CiAgfQogIHJldHVybiByZW5kZXJDbGFzcyhkYXRhLnN0YXRpY0NsYXNzLCBkYXRhLmNsYXNzKTsKfQpmdW5jdGlvbiBtZXJnZUNsYXNzRGF0YShjaGlsZCwgcGFyZW50KSB7CiAgcmV0dXJuIHsKICAgIHN0YXRpY0NsYXNzOiBjb25jYXQoY2hpbGQuc3RhdGljQ2xhc3MsIHBhcmVudC5zdGF0aWNDbGFzcyksCiAgICBjbGFzczogaXNEZWYoY2hpbGQuY2xhc3MpID8gW2NoaWxkLmNsYXNzLCBwYXJlbnQuY2xhc3NdIDogcGFyZW50LmNsYXNzCiAgfTsKfQpmdW5jdGlvbiByZW5kZXJDbGFzcyhzdGF0aWNDbGFzcywgZHluYW1pY0NsYXNzKSB7CiAgaWYgKGlzRGVmKHN0YXRpY0NsYXNzKSB8fCBpc0RlZihkeW5hbWljQ2xhc3MpKSB7CiAgICByZXR1cm4gY29uY2F0KHN0YXRpY0NsYXNzLCBzdHJpbmdpZnlDbGFzcyhkeW5hbWljQ2xhc3MpKTsKICB9CiAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KICByZXR1cm4gJyc7Cn0KZnVuY3Rpb24gY29uY2F0KGEsIGIpIHsKICByZXR1cm4gYSA/IGIgPyBhICsgJyAnICsgYiA6IGEgOiBiIHx8ICcnOwp9CmZ1bmN0aW9uIHN0cmluZ2lmeUNsYXNzKHZhbHVlKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICByZXR1cm4gc3RyaW5naWZ5QXJyYXkodmFsdWUpOwogIH0KICBpZiAoaXNPYmplY3QodmFsdWUpKSB7CiAgICByZXR1cm4gc3RyaW5naWZ5T2JqZWN0KHZhbHVlKTsKICB9CiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHsKICAgIHJldHVybiB2YWx1ZTsKICB9CiAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KICByZXR1cm4gJyc7Cn0KZnVuY3Rpb24gc3RyaW5naWZ5QXJyYXkodmFsdWUpIHsKICB2YXIgcmVzID0gJyc7CiAgdmFyIHN0cmluZ2lmaWVkOwogIGZvciAodmFyIGkgPSAwLCBsID0gdmFsdWUubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICBpZiAoaXNEZWYoc3RyaW5naWZpZWQgPSBzdHJpbmdpZnlDbGFzcyh2YWx1ZVtpXSkpICYmIHN0cmluZ2lmaWVkICE9PSAnJykgewogICAgICBpZiAocmVzKSByZXMgKz0gJyAnOwogICAgICByZXMgKz0gc3RyaW5naWZpZWQ7CiAgICB9CiAgfQogIHJldHVybiByZXM7Cn0KZnVuY3Rpb24gc3RyaW5naWZ5T2JqZWN0KHZhbHVlKSB7CiAgdmFyIHJlcyA9ICcnOwogIGZvciAodmFyIGtleSBpbiB2YWx1ZSkgewogICAgaWYgKHZhbHVlW2tleV0pIHsKICAgICAgaWYgKHJlcykgcmVzICs9ICcgJzsKICAgICAgcmVzICs9IGtleTsKICAgIH0KICB9CiAgcmV0dXJuIHJlczsKfQp2YXIgbmFtZXNwYWNlTWFwID0gewogIHN2ZzogJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywKICBtYXRoOiAnaHR0cDovL3d3dy53My5vcmcvMTk5OC9NYXRoL01hdGhNTCcKfTsKdmFyIGlzSFRNTFRhZyA9IG1ha2VNYXAoJ2h0bWwsYm9keSxiYXNlLGhlYWQsbGluayxtZXRhLHN0eWxlLHRpdGxlLCcgKyAnYWRkcmVzcyxhcnRpY2xlLGFzaWRlLGZvb3RlcixoZWFkZXIsaDEsaDIsaDMsaDQsaDUsaDYsaGdyb3VwLG5hdixzZWN0aW9uLCcgKyAnZGl2LGRkLGRsLGR0LGZpZ2NhcHRpb24sZmlndXJlLHBpY3R1cmUsaHIsaW1nLGxpLG1haW4sb2wscCxwcmUsdWwsJyArICdhLGIsYWJicixiZGksYmRvLGJyLGNpdGUsY29kZSxkYXRhLGRmbixlbSxpLGtiZCxtYXJrLHEscnAscnQscnRjLHJ1YnksJyArICdzLHNhbXAsc21hbGwsc3BhbixzdHJvbmcsc3ViLHN1cCx0aW1lLHUsdmFyLHdicixhcmVhLGF1ZGlvLG1hcCx0cmFjayx2aWRlbywnICsgJ2VtYmVkLG9iamVjdCxwYXJhbSxzb3VyY2UsY2FudmFzLHNjcmlwdCxub3NjcmlwdCxkZWwsaW5zLCcgKyAnY2FwdGlvbixjb2wsY29sZ3JvdXAsdGFibGUsdGhlYWQsdGJvZHksdGQsdGgsdHIsJyArICdidXR0b24sZGF0YWxpc3QsZmllbGRzZXQsZm9ybSxpbnB1dCxsYWJlbCxsZWdlbmQsbWV0ZXIsb3B0Z3JvdXAsb3B0aW9uLCcgKyAnb3V0cHV0LHByb2dyZXNzLHNlbGVjdCx0ZXh0YXJlYSwnICsgJ2RldGFpbHMsZGlhbG9nLG1lbnUsbWVudWl0ZW0sc3VtbWFyeSwnICsgJ2NvbnRlbnQsZWxlbWVudCxzaGFkb3csdGVtcGxhdGUsYmxvY2txdW90ZSxpZnJhbWUsdGZvb3QnKTsKLy8gdGhpcyBtYXAgaXMgaW50ZW50aW9uYWxseSBzZWxlY3RpdmUsIG9ubHkgY292ZXJpbmcgU1ZHIGVsZW1lbnRzIHRoYXQgbWF5Ci8vIGNvbnRhaW4gY2hpbGQgZWxlbWVudHMuCnZhciBpc1NWRyA9IG1ha2VNYXAoJ3N2ZyxhbmltYXRlLGNpcmNsZSxjbGlwcGF0aCxjdXJzb3IsZGVmcyxkZXNjLGVsbGlwc2UsZmlsdGVyLGZvbnQtZmFjZSwnICsgJ2ZvcmVpZ25vYmplY3QsZyxnbHlwaCxpbWFnZSxsaW5lLG1hcmtlcixtYXNrLG1pc3NpbmctZ2x5cGgscGF0aCxwYXR0ZXJuLCcgKyAncG9seWdvbixwb2x5bGluZSxyZWN0LHN3aXRjaCxzeW1ib2wsdGV4dCx0ZXh0cGF0aCx0c3Bhbix1c2UsdmlldycsIHRydWUpOwp2YXIgaXNSZXNlcnZlZFRhZyA9IGZ1bmN0aW9uICh0YWcpIHsKICByZXR1cm4gaXNIVE1MVGFnKHRhZykgfHwgaXNTVkcodGFnKTsKfTsKZnVuY3Rpb24gZ2V0VGFnTmFtZXNwYWNlKHRhZykgewogIGlmIChpc1NWRyh0YWcpKSB7CiAgICByZXR1cm4gJ3N2Zyc7CiAgfQogIC8vIGJhc2ljIHN1cHBvcnQgZm9yIE1hdGhNTAogIC8vIG5vdGUgaXQgZG9lc24ndCBzdXBwb3J0IG90aGVyIE1hdGhNTCBlbGVtZW50cyBiZWluZyBjb21wb25lbnQgcm9vdHMKICBpZiAodGFnID09PSAnbWF0aCcpIHsKICAgIHJldHVybiAnbWF0aCc7CiAgfQp9CnZhciB1bmtub3duRWxlbWVudENhY2hlID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKZnVuY3Rpb24gaXNVbmtub3duRWxlbWVudCh0YWcpIHsKICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICBpZiAoIWluQnJvd3NlcikgewogICAgcmV0dXJuIHRydWU7CiAgfQogIGlmIChpc1Jlc2VydmVkVGFnKHRhZykpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgdGFnID0gdGFnLnRvTG93ZXJDYXNlKCk7CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKHVua25vd25FbGVtZW50Q2FjaGVbdGFnXSAhPSBudWxsKSB7CiAgICByZXR1cm4gdW5rbm93bkVsZW1lbnRDYWNoZVt0YWddOwogIH0KICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZyk7CiAgaWYgKHRhZy5pbmRleE9mKCctJykgPiAtMSkgewogICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzI4MjEwMzY0LzEwNzAyNDQKICAgIHJldHVybiB1bmtub3duRWxlbWVudENhY2hlW3RhZ10gPSBlbC5jb25zdHJ1Y3RvciA9PT0gd2luZG93LkhUTUxVbmtub3duRWxlbWVudCB8fCBlbC5jb25zdHJ1Y3RvciA9PT0gd2luZG93LkhUTUxFbGVtZW50OwogIH0gZWxzZSB7CiAgICByZXR1cm4gdW5rbm93bkVsZW1lbnRDYWNoZVt0YWddID0gL0hUTUxVbmtub3duRWxlbWVudC8udGVzdChlbC50b1N0cmluZygpKTsKICB9Cn0KdmFyIGlzVGV4dElucHV0VHlwZSA9IG1ha2VNYXAoJ3RleHQsbnVtYmVyLHBhc3N3b3JkLHNlYXJjaCxlbWFpbCx0ZWwsdXJsJyk7CgovKioKICogUXVlcnkgYW4gZWxlbWVudCBzZWxlY3RvciBpZiBpdCdzIG5vdCBhbiBlbGVtZW50IGFscmVhZHkuCiAqLwpmdW5jdGlvbiBxdWVyeShlbCkgewogIGlmICh0eXBlb2YgZWwgPT09ICdzdHJpbmcnKSB7CiAgICB2YXIgc2VsZWN0ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsKTsKICAgIGlmICghc2VsZWN0ZWQpIHsKICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiB3YXJuKCdDYW5ub3QgZmluZCBlbGVtZW50OiAnICsgZWwpOwogICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICB9CiAgICByZXR1cm4gc2VsZWN0ZWQ7CiAgfSBlbHNlIHsKICAgIHJldHVybiBlbDsKICB9Cn0KZnVuY3Rpb24gY3JlYXRlRWxlbWVudCh0YWdOYW1lLCB2bm9kZSkgewogIHZhciBlbG0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZ05hbWUpOwogIGlmICh0YWdOYW1lICE9PSAnc2VsZWN0JykgewogICAgcmV0dXJuIGVsbTsKICB9CiAgLy8gZmFsc2Ugb3IgbnVsbCB3aWxsIHJlbW92ZSB0aGUgYXR0cmlidXRlIGJ1dCB1bmRlZmluZWQgd2lsbCBub3QKICBpZiAodm5vZGUuZGF0YSAmJiB2bm9kZS5kYXRhLmF0dHJzICYmIHZub2RlLmRhdGEuYXR0cnMubXVsdGlwbGUgIT09IHVuZGVmaW5lZCkgewogICAgZWxtLnNldEF0dHJpYnV0ZSgnbXVsdGlwbGUnLCAnbXVsdGlwbGUnKTsKICB9CiAgcmV0dXJuIGVsbTsKfQpmdW5jdGlvbiBjcmVhdGVFbGVtZW50TlMobmFtZXNwYWNlLCB0YWdOYW1lKSB7CiAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhuYW1lc3BhY2VNYXBbbmFtZXNwYWNlXSwgdGFnTmFtZSk7Cn0KZnVuY3Rpb24gY3JlYXRlVGV4dE5vZGUodGV4dCkgewogIHJldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0ZXh0KTsKfQpmdW5jdGlvbiBjcmVhdGVDb21tZW50KHRleHQpIHsKICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlQ29tbWVudCh0ZXh0KTsKfQpmdW5jdGlvbiBpbnNlcnRCZWZvcmUocGFyZW50Tm9kZSwgbmV3Tm9kZSwgcmVmZXJlbmNlTm9kZSkgewogIHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5ld05vZGUsIHJlZmVyZW5jZU5vZGUpOwp9CmZ1bmN0aW9uIHJlbW92ZUNoaWxkKG5vZGUsIGNoaWxkKSB7CiAgbm9kZS5yZW1vdmVDaGlsZChjaGlsZCk7Cn0KZnVuY3Rpb24gYXBwZW5kQ2hpbGQobm9kZSwgY2hpbGQpIHsKICBub2RlLmFwcGVuZENoaWxkKGNoaWxkKTsKfQpmdW5jdGlvbiBwYXJlbnROb2RlKG5vZGUpIHsKICByZXR1cm4gbm9kZS5wYXJlbnROb2RlOwp9CmZ1bmN0aW9uIG5leHRTaWJsaW5nKG5vZGUpIHsKICByZXR1cm4gbm9kZS5uZXh0U2libGluZzsKfQpmdW5jdGlvbiB0YWdOYW1lKG5vZGUpIHsKICByZXR1cm4gbm9kZS50YWdOYW1lOwp9CmZ1bmN0aW9uIHNldFRleHRDb250ZW50KG5vZGUsIHRleHQpIHsKICBub2RlLnRleHRDb250ZW50ID0gdGV4dDsKfQpmdW5jdGlvbiBzZXRTdHlsZVNjb3BlKG5vZGUsIHNjb3BlSWQpIHsKICBub2RlLnNldEF0dHJpYnV0ZShzY29wZUlkLCAnJyk7Cn0KdmFyIG5vZGVPcHMgPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7CiAgX19wcm90b19fOiBudWxsLAogIGNyZWF0ZUVsZW1lbnQ6IGNyZWF0ZUVsZW1lbnQsCiAgY3JlYXRlRWxlbWVudE5TOiBjcmVhdGVFbGVtZW50TlMsCiAgY3JlYXRlVGV4dE5vZGU6IGNyZWF0ZVRleHROb2RlLAogIGNyZWF0ZUNvbW1lbnQ6IGNyZWF0ZUNvbW1lbnQsCiAgaW5zZXJ0QmVmb3JlOiBpbnNlcnRCZWZvcmUsCiAgcmVtb3ZlQ2hpbGQ6IHJlbW92ZUNoaWxkLAogIGFwcGVuZENoaWxkOiBhcHBlbmRDaGlsZCwKICBwYXJlbnROb2RlOiBwYXJlbnROb2RlLAogIG5leHRTaWJsaW5nOiBuZXh0U2libGluZywKICB0YWdOYW1lOiB0YWdOYW1lLAogIHNldFRleHRDb250ZW50OiBzZXRUZXh0Q29udGVudCwKICBzZXRTdHlsZVNjb3BlOiBzZXRTdHlsZVNjb3BlCn0pOwp2YXIgcmVmID0gewogIGNyZWF0ZTogZnVuY3Rpb24gKF8sIHZub2RlKSB7CiAgICByZWdpc3RlclJlZih2bm9kZSk7CiAgfSwKICB1cGRhdGU6IGZ1bmN0aW9uIChvbGRWbm9kZSwgdm5vZGUpIHsKICAgIGlmIChvbGRWbm9kZS5kYXRhLnJlZiAhPT0gdm5vZGUuZGF0YS5yZWYpIHsKICAgICAgcmVnaXN0ZXJSZWYob2xkVm5vZGUsIHRydWUpOwogICAgICByZWdpc3RlclJlZih2bm9kZSk7CiAgICB9CiAgfSwKICBkZXN0cm95OiBmdW5jdGlvbiAodm5vZGUpIHsKICAgIHJlZ2lzdGVyUmVmKHZub2RlLCB0cnVlKTsKICB9Cn07CmZ1bmN0aW9uIHJlZ2lzdGVyUmVmKHZub2RlLCBpc1JlbW92YWwpIHsKICB2YXIgcmVmID0gdm5vZGUuZGF0YS5yZWY7CiAgaWYgKCFpc0RlZihyZWYpKSByZXR1cm47CiAgdmFyIHZtID0gdm5vZGUuY29udGV4dDsKICB2YXIgcmVmVmFsdWUgPSB2bm9kZS5jb21wb25lbnRJbnN0YW5jZSB8fCB2bm9kZS5lbG07CiAgdmFyIHZhbHVlID0gaXNSZW1vdmFsID8gbnVsbCA6IHJlZlZhbHVlOwogIHZhciAkcmVmc1ZhbHVlID0gaXNSZW1vdmFsID8gdW5kZWZpbmVkIDogcmVmVmFsdWU7CiAgaWYgKGlzRnVuY3Rpb24ocmVmKSkgewogICAgaW52b2tlV2l0aEVycm9ySGFuZGxpbmcocmVmLCB2bSwgW3ZhbHVlXSwgdm0sICJ0ZW1wbGF0ZSByZWYgZnVuY3Rpb24iKTsKICAgIHJldHVybjsKICB9CiAgdmFyIGlzRm9yID0gdm5vZGUuZGF0YS5yZWZJbkZvcjsKICB2YXIgX2lzU3RyaW5nID0gdHlwZW9mIHJlZiA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIHJlZiA9PT0gJ251bWJlcic7CiAgdmFyIF9pc1JlZiA9IGlzUmVmKHJlZik7CiAgdmFyIHJlZnMgPSB2bS4kcmVmczsKICBpZiAoX2lzU3RyaW5nIHx8IF9pc1JlZikgewogICAgaWYgKGlzRm9yKSB7CiAgICAgIHZhciBleGlzdGluZyA9IF9pc1N0cmluZyA/IHJlZnNbcmVmXSA6IHJlZi52YWx1ZTsKICAgICAgaWYgKGlzUmVtb3ZhbCkgewogICAgICAgIGlzQXJyYXkoZXhpc3RpbmcpICYmIHJlbW92ZSQyKGV4aXN0aW5nLCByZWZWYWx1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKCFpc0FycmF5KGV4aXN0aW5nKSkgewogICAgICAgICAgaWYgKF9pc1N0cmluZykgewogICAgICAgICAgICByZWZzW3JlZl0gPSBbcmVmVmFsdWVdOwogICAgICAgICAgICBzZXRTZXR1cFJlZih2bSwgcmVmLCByZWZzW3JlZl0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVmLnZhbHVlID0gW3JlZlZhbHVlXTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKCFleGlzdGluZy5pbmNsdWRlcyhyZWZWYWx1ZSkpIHsKICAgICAgICAgIGV4aXN0aW5nLnB1c2gocmVmVmFsdWUpOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIGlmIChfaXNTdHJpbmcpIHsKICAgICAgaWYgKGlzUmVtb3ZhbCAmJiByZWZzW3JlZl0gIT09IHJlZlZhbHVlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHJlZnNbcmVmXSA9ICRyZWZzVmFsdWU7CiAgICAgIHNldFNldHVwUmVmKHZtLCByZWYsIHZhbHVlKTsKICAgIH0gZWxzZSBpZiAoX2lzUmVmKSB7CiAgICAgIGlmIChpc1JlbW92YWwgJiYgcmVmLnZhbHVlICE9PSByZWZWYWx1ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICByZWYudmFsdWUgPSB2YWx1ZTsKICAgIH0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICB3YXJuKCJJbnZhbGlkIHRlbXBsYXRlIHJlZiB0eXBlOiAiLmNvbmNhdCh0eXBlb2YgcmVmKSk7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIHNldFNldHVwUmVmKF9hLCBrZXksIHZhbCkgewogIHZhciBfc2V0dXBTdGF0ZSA9IF9hLl9zZXR1cFN0YXRlOwogIGlmIChfc2V0dXBTdGF0ZSAmJiBoYXNPd24oX3NldHVwU3RhdGUsIGtleSkpIHsKICAgIGlmIChpc1JlZihfc2V0dXBTdGF0ZVtrZXldKSkgewogICAgICBfc2V0dXBTdGF0ZVtrZXldLnZhbHVlID0gdmFsOwogICAgfSBlbHNlIHsKICAgICAgX3NldHVwU3RhdGVba2V5XSA9IHZhbDsKICAgIH0KICB9Cn0KCi8qKgogKiBWaXJ0dWFsIERPTSBwYXRjaGluZyBhbGdvcml0aG0gYmFzZWQgb24gU25hYmJkb20gYnkKICogU2ltb24gRnJpaXMgVmluZHVtIChAcGFsZGVwaW5kKQogKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UKICogaHR0cHM6Ly9naXRodWIuY29tL3BhbGRlcGluZC9zbmFiYmRvbS9ibG9iL21hc3Rlci9MSUNFTlNFCiAqCiAqIG1vZGlmaWVkIGJ5IEV2YW4gWW91IChAeXl4OTkwODAzKQogKgogKiBOb3QgdHlwZS1jaGVja2luZyB0aGlzIGJlY2F1c2UgdGhpcyBmaWxlIGlzIHBlcmYtY3JpdGljYWwgYW5kIHRoZSBjb3N0CiAqIG9mIG1ha2luZyBmbG93IHVuZGVyc3RhbmQgaXQgaXMgbm90IHdvcnRoIGl0LgogKi8KdmFyIGVtcHR5Tm9kZSA9IG5ldyBWTm9kZSgnJywge30sIFtdKTsKdmFyIGhvb2tzID0gWydjcmVhdGUnLCAnYWN0aXZhdGUnLCAndXBkYXRlJywgJ3JlbW92ZScsICdkZXN0cm95J107CmZ1bmN0aW9uIHNhbWVWbm9kZShhLCBiKSB7CiAgcmV0dXJuIGEua2V5ID09PSBiLmtleSAmJiBhLmFzeW5jRmFjdG9yeSA9PT0gYi5hc3luY0ZhY3RvcnkgJiYgKGEudGFnID09PSBiLnRhZyAmJiBhLmlzQ29tbWVudCA9PT0gYi5pc0NvbW1lbnQgJiYgaXNEZWYoYS5kYXRhKSA9PT0gaXNEZWYoYi5kYXRhKSAmJiBzYW1lSW5wdXRUeXBlKGEsIGIpIHx8IGlzVHJ1ZShhLmlzQXN5bmNQbGFjZWhvbGRlcikgJiYgaXNVbmRlZihiLmFzeW5jRmFjdG9yeS5lcnJvcikpOwp9CmZ1bmN0aW9uIHNhbWVJbnB1dFR5cGUoYSwgYikgewogIGlmIChhLnRhZyAhPT0gJ2lucHV0JykgcmV0dXJuIHRydWU7CiAgdmFyIGk7CiAgdmFyIHR5cGVBID0gaXNEZWYoaSA9IGEuZGF0YSkgJiYgaXNEZWYoaSA9IGkuYXR0cnMpICYmIGkudHlwZTsKICB2YXIgdHlwZUIgPSBpc0RlZihpID0gYi5kYXRhKSAmJiBpc0RlZihpID0gaS5hdHRycykgJiYgaS50eXBlOwogIHJldHVybiB0eXBlQSA9PT0gdHlwZUIgfHwgaXNUZXh0SW5wdXRUeXBlKHR5cGVBKSAmJiBpc1RleHRJbnB1dFR5cGUodHlwZUIpOwp9CmZ1bmN0aW9uIGNyZWF0ZUtleVRvT2xkSWR4KGNoaWxkcmVuLCBiZWdpbklkeCwgZW5kSWR4KSB7CiAgdmFyIGksIGtleTsKICB2YXIgbWFwID0ge307CiAgZm9yIChpID0gYmVnaW5JZHg7IGkgPD0gZW5kSWR4OyArK2kpIHsKICAgIGtleSA9IGNoaWxkcmVuW2ldLmtleTsKICAgIGlmIChpc0RlZihrZXkpKSBtYXBba2V5XSA9IGk7CiAgfQogIHJldHVybiBtYXA7Cn0KZnVuY3Rpb24gY3JlYXRlUGF0Y2hGdW5jdGlvbihiYWNrZW5kKSB7CiAgdmFyIGksIGo7CiAgdmFyIGNicyA9IHt9OwogIHZhciBtb2R1bGVzID0gYmFja2VuZC5tb2R1bGVzLAogICAgbm9kZU9wcyA9IGJhY2tlbmQubm9kZU9wczsKICBmb3IgKGkgPSAwOyBpIDwgaG9va3MubGVuZ3RoOyArK2kpIHsKICAgIGNic1tob29rc1tpXV0gPSBbXTsKICAgIGZvciAoaiA9IDA7IGogPCBtb2R1bGVzLmxlbmd0aDsgKytqKSB7CiAgICAgIGlmIChpc0RlZihtb2R1bGVzW2pdW2hvb2tzW2ldXSkpIHsKICAgICAgICBjYnNbaG9va3NbaV1dLnB1c2gobW9kdWxlc1tqXVtob29rc1tpXV0pOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGVtcHR5Tm9kZUF0KGVsbSkgewogICAgcmV0dXJuIG5ldyBWTm9kZShub2RlT3BzLnRhZ05hbWUoZWxtKS50b0xvd2VyQ2FzZSgpLCB7fSwgW10sIHVuZGVmaW5lZCwgZWxtKTsKICB9CiAgZnVuY3Rpb24gY3JlYXRlUm1DYihjaGlsZEVsbSwgbGlzdGVuZXJzKSB7CiAgICBmdW5jdGlvbiByZW1vdmUoKSB7CiAgICAgIGlmICgtLXJlbW92ZS5saXN0ZW5lcnMgPT09IDApIHsKICAgICAgICByZW1vdmVOb2RlKGNoaWxkRWxtKTsKICAgICAgfQogICAgfQogICAgcmVtb3ZlLmxpc3RlbmVycyA9IGxpc3RlbmVyczsKICAgIHJldHVybiByZW1vdmU7CiAgfQogIGZ1bmN0aW9uIHJlbW92ZU5vZGUoZWwpIHsKICAgIHZhciBwYXJlbnQgPSBub2RlT3BzLnBhcmVudE5vZGUoZWwpOwogICAgLy8gZWxlbWVudCBtYXkgaGF2ZSBhbHJlYWR5IGJlZW4gcmVtb3ZlZCBkdWUgdG8gdi1odG1sIC8gdi10ZXh0CiAgICBpZiAoaXNEZWYocGFyZW50KSkgewogICAgICBub2RlT3BzLnJlbW92ZUNoaWxkKHBhcmVudCwgZWwpOwogICAgfQogIH0KICBmdW5jdGlvbiBpc1Vua25vd25FbGVtZW50KHZub2RlLCBpblZQcmUpIHsKICAgIHJldHVybiAhaW5WUHJlICYmICF2bm9kZS5ucyAmJiAhKGNvbmZpZy5pZ25vcmVkRWxlbWVudHMubGVuZ3RoICYmIGNvbmZpZy5pZ25vcmVkRWxlbWVudHMuc29tZShmdW5jdGlvbiAoaWdub3JlKSB7CiAgICAgIHJldHVybiBpc1JlZ0V4cChpZ25vcmUpID8gaWdub3JlLnRlc3Qodm5vZGUudGFnKSA6IGlnbm9yZSA9PT0gdm5vZGUudGFnOwogICAgfSkpICYmIGNvbmZpZy5pc1Vua25vd25FbGVtZW50KHZub2RlLnRhZyk7CiAgfQogIHZhciBjcmVhdGluZ0VsbUluVlByZSA9IDA7CiAgZnVuY3Rpb24gY3JlYXRlRWxtKHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUsIHBhcmVudEVsbSwgcmVmRWxtLCBuZXN0ZWQsIG93bmVyQXJyYXksIGluZGV4KSB7CiAgICBpZiAoaXNEZWYodm5vZGUuZWxtKSAmJiBpc0RlZihvd25lckFycmF5KSkgewogICAgICAvLyBUaGlzIHZub2RlIHdhcyB1c2VkIGluIGEgcHJldmlvdXMgcmVuZGVyIQogICAgICAvLyBub3cgaXQncyB1c2VkIGFzIGEgbmV3IG5vZGUsIG92ZXJ3cml0aW5nIGl0cyBlbG0gd291bGQgY2F1c2UKICAgICAgLy8gcG90ZW50aWFsIHBhdGNoIGVycm9ycyBkb3duIHRoZSByb2FkIHdoZW4gaXQncyB1c2VkIGFzIGFuIGluc2VydGlvbgogICAgICAvLyByZWZlcmVuY2Ugbm9kZS4gSW5zdGVhZCwgd2UgY2xvbmUgdGhlIG5vZGUgb24tZGVtYW5kIGJlZm9yZSBjcmVhdGluZwogICAgICAvLyBhc3NvY2lhdGVkIERPTSBlbGVtZW50IGZvciBpdC4KICAgICAgdm5vZGUgPSBvd25lckFycmF5W2luZGV4XSA9IGNsb25lVk5vZGUodm5vZGUpOwogICAgfQogICAgdm5vZGUuaXNSb290SW5zZXJ0ID0gIW5lc3RlZDsgLy8gZm9yIHRyYW5zaXRpb24gZW50ZXIgY2hlY2sKICAgIGlmIChjcmVhdGVDb21wb25lbnQodm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSwgcGFyZW50RWxtLCByZWZFbG0pKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHZhciBkYXRhID0gdm5vZGUuZGF0YTsKICAgIHZhciBjaGlsZHJlbiA9IHZub2RlLmNoaWxkcmVuOwogICAgdmFyIHRhZyA9IHZub2RlLnRhZzsKICAgIGlmIChpc0RlZih0YWcpKSB7CiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5wcmUpIHsKICAgICAgICAgIGNyZWF0aW5nRWxtSW5WUHJlKys7CiAgICAgICAgfQogICAgICAgIGlmIChpc1Vua25vd25FbGVtZW50KHZub2RlLCBjcmVhdGluZ0VsbUluVlByZSkpIHsKICAgICAgICAgIHdhcm4oJ1Vua25vd24gY3VzdG9tIGVsZW1lbnQ6IDwnICsgdGFnICsgJz4gLSBkaWQgeW91ICcgKyAncmVnaXN0ZXIgdGhlIGNvbXBvbmVudCBjb3JyZWN0bHk/IEZvciByZWN1cnNpdmUgY29tcG9uZW50cywgJyArICdtYWtlIHN1cmUgdG8gcHJvdmlkZSB0aGUgIm5hbWUiIG9wdGlvbi4nLCB2bm9kZS5jb250ZXh0KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdm5vZGUuZWxtID0gdm5vZGUubnMgPyBub2RlT3BzLmNyZWF0ZUVsZW1lbnROUyh2bm9kZS5ucywgdGFnKSA6IG5vZGVPcHMuY3JlYXRlRWxlbWVudCh0YWcsIHZub2RlKTsKICAgICAgc2V0U2NvcGUodm5vZGUpOwogICAgICBjcmVhdGVDaGlsZHJlbih2bm9kZSwgY2hpbGRyZW4sIGluc2VydGVkVm5vZGVRdWV1ZSk7CiAgICAgIGlmIChpc0RlZihkYXRhKSkgewogICAgICAgIGludm9rZUNyZWF0ZUhvb2tzKHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpOwogICAgICB9CiAgICAgIGluc2VydChwYXJlbnRFbG0sIHZub2RlLmVsbSwgcmVmRWxtKTsKICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgZGF0YSAmJiBkYXRhLnByZSkgewogICAgICAgIGNyZWF0aW5nRWxtSW5WUHJlLS07CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoaXNUcnVlKHZub2RlLmlzQ29tbWVudCkpIHsKICAgICAgdm5vZGUuZWxtID0gbm9kZU9wcy5jcmVhdGVDb21tZW50KHZub2RlLnRleHQpOwogICAgICBpbnNlcnQocGFyZW50RWxtLCB2bm9kZS5lbG0sIHJlZkVsbSk7CiAgICB9IGVsc2UgewogICAgICB2bm9kZS5lbG0gPSBub2RlT3BzLmNyZWF0ZVRleHROb2RlKHZub2RlLnRleHQpOwogICAgICBpbnNlcnQocGFyZW50RWxtLCB2bm9kZS5lbG0sIHJlZkVsbSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUNvbXBvbmVudCh2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlLCBwYXJlbnRFbG0sIHJlZkVsbSkgewogICAgdmFyIGkgPSB2bm9kZS5kYXRhOwogICAgaWYgKGlzRGVmKGkpKSB7CiAgICAgIHZhciBpc1JlYWN0aXZhdGVkID0gaXNEZWYodm5vZGUuY29tcG9uZW50SW5zdGFuY2UpICYmIGkua2VlcEFsaXZlOwogICAgICBpZiAoaXNEZWYoaSA9IGkuaG9vaykgJiYgaXNEZWYoaSA9IGkuaW5pdCkpIHsKICAgICAgICBpKHZub2RlLCBmYWxzZSAvKiBoeWRyYXRpbmcgKi8pOwogICAgICB9CiAgICAgIC8vIGFmdGVyIGNhbGxpbmcgdGhlIGluaXQgaG9vaywgaWYgdGhlIHZub2RlIGlzIGEgY2hpbGQgY29tcG9uZW50CiAgICAgIC8vIGl0IHNob3VsZCd2ZSBjcmVhdGVkIGEgY2hpbGQgaW5zdGFuY2UgYW5kIG1vdW50ZWQgaXQuIHRoZSBjaGlsZAogICAgICAvLyBjb21wb25lbnQgYWxzbyBoYXMgc2V0IHRoZSBwbGFjZWhvbGRlciB2bm9kZSdzIGVsbS4KICAgICAgLy8gaW4gdGhhdCBjYXNlIHdlIGNhbiBqdXN0IHJldHVybiB0aGUgZWxlbWVudCBhbmQgYmUgZG9uZS4KICAgICAgaWYgKGlzRGVmKHZub2RlLmNvbXBvbmVudEluc3RhbmNlKSkgewogICAgICAgIGluaXRDb21wb25lbnQodm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7CiAgICAgICAgaW5zZXJ0KHBhcmVudEVsbSwgdm5vZGUuZWxtLCByZWZFbG0pOwogICAgICAgIGlmIChpc1RydWUoaXNSZWFjdGl2YXRlZCkpIHsKICAgICAgICAgIHJlYWN0aXZhdGVDb21wb25lbnQodm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSwgcGFyZW50RWxtLCByZWZFbG0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBpbml0Q29tcG9uZW50KHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpIHsKICAgIGlmIChpc0RlZih2bm9kZS5kYXRhLnBlbmRpbmdJbnNlcnQpKSB7CiAgICAgIGluc2VydGVkVm5vZGVRdWV1ZS5wdXNoLmFwcGx5KGluc2VydGVkVm5vZGVRdWV1ZSwgdm5vZGUuZGF0YS5wZW5kaW5nSW5zZXJ0KTsKICAgICAgdm5vZGUuZGF0YS5wZW5kaW5nSW5zZXJ0ID0gbnVsbDsKICAgIH0KICAgIHZub2RlLmVsbSA9IHZub2RlLmNvbXBvbmVudEluc3RhbmNlLiRlbDsKICAgIGlmIChpc1BhdGNoYWJsZSh2bm9kZSkpIHsKICAgICAgaW52b2tlQ3JlYXRlSG9va3Modm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7CiAgICAgIHNldFNjb3BlKHZub2RlKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIGVtcHR5IGNvbXBvbmVudCByb290LgogICAgICAvLyBza2lwIGFsbCBlbGVtZW50LXJlbGF0ZWQgbW9kdWxlcyBleGNlcHQgZm9yIHJlZiAoIzM0NTUpCiAgICAgIHJlZ2lzdGVyUmVmKHZub2RlKTsKICAgICAgLy8gbWFrZSBzdXJlIHRvIGludm9rZSB0aGUgaW5zZXJ0IGhvb2sKICAgICAgaW5zZXJ0ZWRWbm9kZVF1ZXVlLnB1c2godm5vZGUpOwogICAgfQogIH0KICBmdW5jdGlvbiByZWFjdGl2YXRlQ29tcG9uZW50KHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUsIHBhcmVudEVsbSwgcmVmRWxtKSB7CiAgICB2YXIgaTsKICAgIC8vIGhhY2sgZm9yICM0MzM5OiBhIHJlYWN0aXZhdGVkIGNvbXBvbmVudCB3aXRoIGlubmVyIHRyYW5zaXRpb24KICAgIC8vIGRvZXMgbm90IHRyaWdnZXIgYmVjYXVzZSB0aGUgaW5uZXIgbm9kZSdzIGNyZWF0ZWQgaG9va3MgYXJlIG5vdCBjYWxsZWQKICAgIC8vIGFnYWluLiBJdCdzIG5vdCBpZGVhbCB0byBpbnZvbHZlIG1vZHVsZS1zcGVjaWZpYyBsb2dpYyBpbiBoZXJlIGJ1dAogICAgLy8gdGhlcmUgZG9lc24ndCBzZWVtIHRvIGJlIGEgYmV0dGVyIHdheSB0byBkbyBpdC4KICAgIHZhciBpbm5lck5vZGUgPSB2bm9kZTsKICAgIHdoaWxlIChpbm5lck5vZGUuY29tcG9uZW50SW5zdGFuY2UpIHsKICAgICAgaW5uZXJOb2RlID0gaW5uZXJOb2RlLmNvbXBvbmVudEluc3RhbmNlLl92bm9kZTsKICAgICAgaWYgKGlzRGVmKGkgPSBpbm5lck5vZGUuZGF0YSkgJiYgaXNEZWYoaSA9IGkudHJhbnNpdGlvbikpIHsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY2JzLmFjdGl2YXRlLmxlbmd0aDsgKytpKSB7CiAgICAgICAgICBjYnMuYWN0aXZhdGVbaV0oZW1wdHlOb2RlLCBpbm5lck5vZGUpOwogICAgICAgIH0KICAgICAgICBpbnNlcnRlZFZub2RlUXVldWUucHVzaChpbm5lck5vZGUpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgICAvLyB1bmxpa2UgYSBuZXdseSBjcmVhdGVkIGNvbXBvbmVudCwKICAgIC8vIGEgcmVhY3RpdmF0ZWQga2VlcC1hbGl2ZSBjb21wb25lbnQgZG9lc24ndCBpbnNlcnQgaXRzZWxmCiAgICBpbnNlcnQocGFyZW50RWxtLCB2bm9kZS5lbG0sIHJlZkVsbSk7CiAgfQogIGZ1bmN0aW9uIGluc2VydChwYXJlbnQsIGVsbSwgcmVmKSB7CiAgICBpZiAoaXNEZWYocGFyZW50KSkgewogICAgICBpZiAoaXNEZWYocmVmKSkgewogICAgICAgIGlmIChub2RlT3BzLnBhcmVudE5vZGUocmVmKSA9PT0gcGFyZW50KSB7CiAgICAgICAgICBub2RlT3BzLmluc2VydEJlZm9yZShwYXJlbnQsIGVsbSwgcmVmKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbm9kZU9wcy5hcHBlbmRDaGlsZChwYXJlbnQsIGVsbSk7CiAgICAgIH0KICAgIH0KICB9CiAgZnVuY3Rpb24gY3JlYXRlQ2hpbGRyZW4odm5vZGUsIGNoaWxkcmVuLCBpbnNlcnRlZFZub2RlUXVldWUpIHsKICAgIGlmIChpc0FycmF5KGNoaWxkcmVuKSkgewogICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICAgIGNoZWNrRHVwbGljYXRlS2V5cyhjaGlsZHJlbik7CiAgICAgIH0KICAgICAgZm9yICh2YXIgaV8xID0gMDsgaV8xIDwgY2hpbGRyZW4ubGVuZ3RoOyArK2lfMSkgewogICAgICAgIGNyZWF0ZUVsbShjaGlsZHJlbltpXzFdLCBpbnNlcnRlZFZub2RlUXVldWUsIHZub2RlLmVsbSwgbnVsbCwgdHJ1ZSwgY2hpbGRyZW4sIGlfMSk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoaXNQcmltaXRpdmUodm5vZGUudGV4dCkpIHsKICAgICAgbm9kZU9wcy5hcHBlbmRDaGlsZCh2bm9kZS5lbG0sIG5vZGVPcHMuY3JlYXRlVGV4dE5vZGUoU3RyaW5nKHZub2RlLnRleHQpKSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGlzUGF0Y2hhYmxlKHZub2RlKSB7CiAgICB3aGlsZSAodm5vZGUuY29tcG9uZW50SW5zdGFuY2UpIHsKICAgICAgdm5vZGUgPSB2bm9kZS5jb21wb25lbnRJbnN0YW5jZS5fdm5vZGU7CiAgICB9CiAgICByZXR1cm4gaXNEZWYodm5vZGUudGFnKTsKICB9CiAgZnVuY3Rpb24gaW52b2tlQ3JlYXRlSG9va3Modm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSkgewogICAgZm9yICh2YXIgaV8yID0gMDsgaV8yIDwgY2JzLmNyZWF0ZS5sZW5ndGg7ICsraV8yKSB7CiAgICAgIGNicy5jcmVhdGVbaV8yXShlbXB0eU5vZGUsIHZub2RlKTsKICAgIH0KICAgIGkgPSB2bm9kZS5kYXRhLmhvb2s7IC8vIFJldXNlIHZhcmlhYmxlCiAgICBpZiAoaXNEZWYoaSkpIHsKICAgICAgaWYgKGlzRGVmKGkuY3JlYXRlKSkgaS5jcmVhdGUoZW1wdHlOb2RlLCB2bm9kZSk7CiAgICAgIGlmIChpc0RlZihpLmluc2VydCkpIGluc2VydGVkVm5vZGVRdWV1ZS5wdXNoKHZub2RlKTsKICAgIH0KICB9CiAgLy8gc2V0IHNjb3BlIGlkIGF0dHJpYnV0ZSBmb3Igc2NvcGVkIENTUy4KICAvLyB0aGlzIGlzIGltcGxlbWVudGVkIGFzIGEgc3BlY2lhbCBjYXNlIHRvIGF2b2lkIHRoZSBvdmVyaGVhZAogIC8vIG9mIGdvaW5nIHRocm91Z2ggdGhlIG5vcm1hbCBhdHRyaWJ1dGUgcGF0Y2hpbmcgcHJvY2Vzcy4KICBmdW5jdGlvbiBzZXRTY29wZSh2bm9kZSkgewogICAgdmFyIGk7CiAgICBpZiAoaXNEZWYoaSA9IHZub2RlLmZuU2NvcGVJZCkpIHsKICAgICAgbm9kZU9wcy5zZXRTdHlsZVNjb3BlKHZub2RlLmVsbSwgaSk7CiAgICB9IGVsc2UgewogICAgICB2YXIgYW5jZXN0b3IgPSB2bm9kZTsKICAgICAgd2hpbGUgKGFuY2VzdG9yKSB7CiAgICAgICAgaWYgKGlzRGVmKGkgPSBhbmNlc3Rvci5jb250ZXh0KSAmJiBpc0RlZihpID0gaS4kb3B0aW9ucy5fc2NvcGVJZCkpIHsKICAgICAgICAgIG5vZGVPcHMuc2V0U3R5bGVTY29wZSh2bm9kZS5lbG0sIGkpOwogICAgICAgIH0KICAgICAgICBhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudDsKICAgICAgfQogICAgfQogICAgLy8gZm9yIHNsb3QgY29udGVudCB0aGV5IHNob3VsZCBhbHNvIGdldCB0aGUgc2NvcGVJZCBmcm9tIHRoZSBob3N0IGluc3RhbmNlLgogICAgaWYgKGlzRGVmKGkgPSBhY3RpdmVJbnN0YW5jZSkgJiYgaSAhPT0gdm5vZGUuY29udGV4dCAmJiBpICE9PSB2bm9kZS5mbkNvbnRleHQgJiYgaXNEZWYoaSA9IGkuJG9wdGlvbnMuX3Njb3BlSWQpKSB7CiAgICAgIG5vZGVPcHMuc2V0U3R5bGVTY29wZSh2bm9kZS5lbG0sIGkpOwogICAgfQogIH0KICBmdW5jdGlvbiBhZGRWbm9kZXMocGFyZW50RWxtLCByZWZFbG0sIHZub2Rlcywgc3RhcnRJZHgsIGVuZElkeCwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKSB7CiAgICBmb3IgKDsgc3RhcnRJZHggPD0gZW5kSWR4OyArK3N0YXJ0SWR4KSB7CiAgICAgIGNyZWF0ZUVsbSh2bm9kZXNbc3RhcnRJZHhdLCBpbnNlcnRlZFZub2RlUXVldWUsIHBhcmVudEVsbSwgcmVmRWxtLCBmYWxzZSwgdm5vZGVzLCBzdGFydElkeCk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGludm9rZURlc3Ryb3lIb29rKHZub2RlKSB7CiAgICB2YXIgaSwgajsKICAgIHZhciBkYXRhID0gdm5vZGUuZGF0YTsKICAgIGlmIChpc0RlZihkYXRhKSkgewogICAgICBpZiAoaXNEZWYoaSA9IGRhdGEuaG9vaykgJiYgaXNEZWYoaSA9IGkuZGVzdHJveSkpIGkodm5vZGUpOwogICAgICBmb3IgKGkgPSAwOyBpIDwgY2JzLmRlc3Ryb3kubGVuZ3RoOyArK2kpIGNicy5kZXN0cm95W2ldKHZub2RlKTsKICAgIH0KICAgIGlmIChpc0RlZihpID0gdm5vZGUuY2hpbGRyZW4pKSB7CiAgICAgIGZvciAoaiA9IDA7IGogPCB2bm9kZS5jaGlsZHJlbi5sZW5ndGg7ICsraikgewogICAgICAgIGludm9rZURlc3Ryb3lIb29rKHZub2RlLmNoaWxkcmVuW2pdKTsKICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiByZW1vdmVWbm9kZXModm5vZGVzLCBzdGFydElkeCwgZW5kSWR4KSB7CiAgICBmb3IgKDsgc3RhcnRJZHggPD0gZW5kSWR4OyArK3N0YXJ0SWR4KSB7CiAgICAgIHZhciBjaCA9IHZub2Rlc1tzdGFydElkeF07CiAgICAgIGlmIChpc0RlZihjaCkpIHsKICAgICAgICBpZiAoaXNEZWYoY2gudGFnKSkgewogICAgICAgICAgcmVtb3ZlQW5kSW52b2tlUmVtb3ZlSG9vayhjaCk7CiAgICAgICAgICBpbnZva2VEZXN0cm95SG9vayhjaCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIFRleHQgbm9kZQogICAgICAgICAgcmVtb3ZlTm9kZShjaC5lbG0pOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiByZW1vdmVBbmRJbnZva2VSZW1vdmVIb29rKHZub2RlLCBybSkgewogICAgaWYgKGlzRGVmKHJtKSB8fCBpc0RlZih2bm9kZS5kYXRhKSkgewogICAgICB2YXIgaV8zOwogICAgICB2YXIgbGlzdGVuZXJzID0gY2JzLnJlbW92ZS5sZW5ndGggKyAxOwogICAgICBpZiAoaXNEZWYocm0pKSB7CiAgICAgICAgLy8gd2UgaGF2ZSBhIHJlY3Vyc2l2ZWx5IHBhc3NlZCBkb3duIHJtIGNhbGxiYWNrCiAgICAgICAgLy8gaW5jcmVhc2UgdGhlIGxpc3RlbmVycyBjb3VudAogICAgICAgIHJtLmxpc3RlbmVycyArPSBsaXN0ZW5lcnM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gZGlyZWN0bHkgcmVtb3ZpbmcKICAgICAgICBybSA9IGNyZWF0ZVJtQ2Iodm5vZGUuZWxtLCBsaXN0ZW5lcnMpOwogICAgICB9CiAgICAgIC8vIHJlY3Vyc2l2ZWx5IGludm9rZSBob29rcyBvbiBjaGlsZCBjb21wb25lbnQgcm9vdCBub2RlCiAgICAgIGlmIChpc0RlZihpXzMgPSB2bm9kZS5jb21wb25lbnRJbnN0YW5jZSkgJiYgaXNEZWYoaV8zID0gaV8zLl92bm9kZSkgJiYgaXNEZWYoaV8zLmRhdGEpKSB7CiAgICAgICAgcmVtb3ZlQW5kSW52b2tlUmVtb3ZlSG9vayhpXzMsIHJtKTsKICAgICAgfQogICAgICBmb3IgKGlfMyA9IDA7IGlfMyA8IGNicy5yZW1vdmUubGVuZ3RoOyArK2lfMykgewogICAgICAgIGNicy5yZW1vdmVbaV8zXSh2bm9kZSwgcm0pOwogICAgICB9CiAgICAgIGlmIChpc0RlZihpXzMgPSB2bm9kZS5kYXRhLmhvb2spICYmIGlzRGVmKGlfMyA9IGlfMy5yZW1vdmUpKSB7CiAgICAgICAgaV8zKHZub2RlLCBybSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcm0oKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmVtb3ZlTm9kZSh2bm9kZS5lbG0pOwogICAgfQogIH0KICBmdW5jdGlvbiB1cGRhdGVDaGlsZHJlbihwYXJlbnRFbG0sIG9sZENoLCBuZXdDaCwgaW5zZXJ0ZWRWbm9kZVF1ZXVlLCByZW1vdmVPbmx5KSB7CiAgICB2YXIgb2xkU3RhcnRJZHggPSAwOwogICAgdmFyIG5ld1N0YXJ0SWR4ID0gMDsKICAgIHZhciBvbGRFbmRJZHggPSBvbGRDaC5sZW5ndGggLSAxOwogICAgdmFyIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFswXTsKICAgIHZhciBvbGRFbmRWbm9kZSA9IG9sZENoW29sZEVuZElkeF07CiAgICB2YXIgbmV3RW5kSWR4ID0gbmV3Q2gubGVuZ3RoIC0gMTsKICAgIHZhciBuZXdTdGFydFZub2RlID0gbmV3Q2hbMF07CiAgICB2YXIgbmV3RW5kVm5vZGUgPSBuZXdDaFtuZXdFbmRJZHhdOwogICAgdmFyIG9sZEtleVRvSWR4LCBpZHhJbk9sZCwgdm5vZGVUb01vdmUsIHJlZkVsbTsKICAgIC8vIHJlbW92ZU9ubHkgaXMgYSBzcGVjaWFsIGZsYWcgdXNlZCBvbmx5IGJ5IDx0cmFuc2l0aW9uLWdyb3VwPgogICAgLy8gdG8gZW5zdXJlIHJlbW92ZWQgZWxlbWVudHMgc3RheSBpbiBjb3JyZWN0IHJlbGF0aXZlIHBvc2l0aW9ucwogICAgLy8gZHVyaW5nIGxlYXZpbmcgdHJhbnNpdGlvbnMKICAgIHZhciBjYW5Nb3ZlID0gIXJlbW92ZU9ubHk7CiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICBjaGVja0R1cGxpY2F0ZUtleXMobmV3Q2gpOwogICAgfQogICAgd2hpbGUgKG9sZFN0YXJ0SWR4IDw9IG9sZEVuZElkeCAmJiBuZXdTdGFydElkeCA8PSBuZXdFbmRJZHgpIHsKICAgICAgaWYgKGlzVW5kZWYob2xkU3RhcnRWbm9kZSkpIHsKICAgICAgICBvbGRTdGFydFZub2RlID0gb2xkQ2hbKytvbGRTdGFydElkeF07IC8vIFZub2RlIGhhcyBiZWVuIG1vdmVkIGxlZnQKICAgICAgfSBlbHNlIGlmIChpc1VuZGVmKG9sZEVuZFZub2RlKSkgewogICAgICAgIG9sZEVuZFZub2RlID0gb2xkQ2hbLS1vbGRFbmRJZHhdOwogICAgICB9IGVsc2UgaWYgKHNhbWVWbm9kZShvbGRTdGFydFZub2RlLCBuZXdTdGFydFZub2RlKSkgewogICAgICAgIHBhdGNoVm5vZGUob2xkU3RhcnRWbm9kZSwgbmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlLCBuZXdDaCwgbmV3U3RhcnRJZHgpOwogICAgICAgIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFsrK29sZFN0YXJ0SWR4XTsKICAgICAgICBuZXdTdGFydFZub2RlID0gbmV3Q2hbKytuZXdTdGFydElkeF07CiAgICAgIH0gZWxzZSBpZiAoc2FtZVZub2RlKG9sZEVuZFZub2RlLCBuZXdFbmRWbm9kZSkpIHsKICAgICAgICBwYXRjaFZub2RlKG9sZEVuZFZub2RlLCBuZXdFbmRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlLCBuZXdDaCwgbmV3RW5kSWR4KTsKICAgICAgICBvbGRFbmRWbm9kZSA9IG9sZENoWy0tb2xkRW5kSWR4XTsKICAgICAgICBuZXdFbmRWbm9kZSA9IG5ld0NoWy0tbmV3RW5kSWR4XTsKICAgICAgfSBlbHNlIGlmIChzYW1lVm5vZGUob2xkU3RhcnRWbm9kZSwgbmV3RW5kVm5vZGUpKSB7CiAgICAgICAgLy8gVm5vZGUgbW92ZWQgcmlnaHQKICAgICAgICBwYXRjaFZub2RlKG9sZFN0YXJ0Vm5vZGUsIG5ld0VuZFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUsIG5ld0NoLCBuZXdFbmRJZHgpOwogICAgICAgIGNhbk1vdmUgJiYgbm9kZU9wcy5pbnNlcnRCZWZvcmUocGFyZW50RWxtLCBvbGRTdGFydFZub2RlLmVsbSwgbm9kZU9wcy5uZXh0U2libGluZyhvbGRFbmRWbm9kZS5lbG0pKTsKICAgICAgICBvbGRTdGFydFZub2RlID0gb2xkQ2hbKytvbGRTdGFydElkeF07CiAgICAgICAgbmV3RW5kVm5vZGUgPSBuZXdDaFstLW5ld0VuZElkeF07CiAgICAgIH0gZWxzZSBpZiAoc2FtZVZub2RlKG9sZEVuZFZub2RlLCBuZXdTdGFydFZub2RlKSkgewogICAgICAgIC8vIFZub2RlIG1vdmVkIGxlZnQKICAgICAgICBwYXRjaFZub2RlKG9sZEVuZFZub2RlLCBuZXdTdGFydFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUsIG5ld0NoLCBuZXdTdGFydElkeCk7CiAgICAgICAgY2FuTW92ZSAmJiBub2RlT3BzLmluc2VydEJlZm9yZShwYXJlbnRFbG0sIG9sZEVuZFZub2RlLmVsbSwgb2xkU3RhcnRWbm9kZS5lbG0pOwogICAgICAgIG9sZEVuZFZub2RlID0gb2xkQ2hbLS1vbGRFbmRJZHhdOwogICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoaXNVbmRlZihvbGRLZXlUb0lkeCkpIG9sZEtleVRvSWR4ID0gY3JlYXRlS2V5VG9PbGRJZHgob2xkQ2gsIG9sZFN0YXJ0SWR4LCBvbGRFbmRJZHgpOwogICAgICAgIGlkeEluT2xkID0gaXNEZWYobmV3U3RhcnRWbm9kZS5rZXkpID8gb2xkS2V5VG9JZHhbbmV3U3RhcnRWbm9kZS5rZXldIDogZmluZElkeEluT2xkKG5ld1N0YXJ0Vm5vZGUsIG9sZENoLCBvbGRTdGFydElkeCwgb2xkRW5kSWR4KTsKICAgICAgICBpZiAoaXNVbmRlZihpZHhJbk9sZCkpIHsKICAgICAgICAgIC8vIE5ldyBlbGVtZW50CiAgICAgICAgICBjcmVhdGVFbG0obmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlLCBwYXJlbnRFbG0sIG9sZFN0YXJ0Vm5vZGUuZWxtLCBmYWxzZSwgbmV3Q2gsIG5ld1N0YXJ0SWR4KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdm5vZGVUb01vdmUgPSBvbGRDaFtpZHhJbk9sZF07CiAgICAgICAgICBpZiAoc2FtZVZub2RlKHZub2RlVG9Nb3ZlLCBuZXdTdGFydFZub2RlKSkgewogICAgICAgICAgICBwYXRjaFZub2RlKHZub2RlVG9Nb3ZlLCBuZXdTdGFydFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUsIG5ld0NoLCBuZXdTdGFydElkeCk7CiAgICAgICAgICAgIG9sZENoW2lkeEluT2xkXSA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgY2FuTW92ZSAmJiBub2RlT3BzLmluc2VydEJlZm9yZShwYXJlbnRFbG0sIHZub2RlVG9Nb3ZlLmVsbSwgb2xkU3RhcnRWbm9kZS5lbG0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gc2FtZSBrZXkgYnV0IGRpZmZlcmVudCBlbGVtZW50LiB0cmVhdCBhcyBuZXcgZWxlbWVudAogICAgICAgICAgICBjcmVhdGVFbG0obmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlLCBwYXJlbnRFbG0sIG9sZFN0YXJ0Vm5vZGUuZWxtLCBmYWxzZSwgbmV3Q2gsIG5ld1N0YXJ0SWR4KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgbmV3U3RhcnRWbm9kZSA9IG5ld0NoWysrbmV3U3RhcnRJZHhdOwogICAgICB9CiAgICB9CiAgICBpZiAob2xkU3RhcnRJZHggPiBvbGRFbmRJZHgpIHsKICAgICAgcmVmRWxtID0gaXNVbmRlZihuZXdDaFtuZXdFbmRJZHggKyAxXSkgPyBudWxsIDogbmV3Q2hbbmV3RW5kSWR4ICsgMV0uZWxtOwogICAgICBhZGRWbm9kZXMocGFyZW50RWxtLCByZWZFbG0sIG5ld0NoLCBuZXdTdGFydElkeCwgbmV3RW5kSWR4LCBpbnNlcnRlZFZub2RlUXVldWUpOwogICAgfSBlbHNlIGlmIChuZXdTdGFydElkeCA+IG5ld0VuZElkeCkgewogICAgICByZW1vdmVWbm9kZXMob2xkQ2gsIG9sZFN0YXJ0SWR4LCBvbGRFbmRJZHgpOwogICAgfQogIH0KICBmdW5jdGlvbiBjaGVja0R1cGxpY2F0ZUtleXMoY2hpbGRyZW4pIHsKICAgIHZhciBzZWVuS2V5cyA9IHt9OwogICAgZm9yICh2YXIgaV80ID0gMDsgaV80IDwgY2hpbGRyZW4ubGVuZ3RoOyBpXzQrKykgewogICAgICB2YXIgdm5vZGUgPSBjaGlsZHJlbltpXzRdOwogICAgICB2YXIga2V5ID0gdm5vZGUua2V5OwogICAgICBpZiAoaXNEZWYoa2V5KSkgewogICAgICAgIGlmIChzZWVuS2V5c1trZXldKSB7CiAgICAgICAgICB3YXJuKCJEdXBsaWNhdGUga2V5cyBkZXRlY3RlZDogJyIuY29uY2F0KGtleSwgIicuIFRoaXMgbWF5IGNhdXNlIGFuIHVwZGF0ZSBlcnJvci4iKSwgdm5vZGUuY29udGV4dCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNlZW5LZXlzW2tleV0gPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBmaW5kSWR4SW5PbGQobm9kZSwgb2xkQ2gsIHN0YXJ0LCBlbmQpIHsKICAgIGZvciAodmFyIGlfNSA9IHN0YXJ0OyBpXzUgPCBlbmQ7IGlfNSsrKSB7CiAgICAgIHZhciBjID0gb2xkQ2hbaV81XTsKICAgICAgaWYgKGlzRGVmKGMpICYmIHNhbWVWbm9kZShub2RlLCBjKSkgcmV0dXJuIGlfNTsKICAgIH0KICB9CiAgZnVuY3Rpb24gcGF0Y2hWbm9kZShvbGRWbm9kZSwgdm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSwgb3duZXJBcnJheSwgaW5kZXgsIHJlbW92ZU9ubHkpIHsKICAgIGlmIChvbGRWbm9kZSA9PT0gdm5vZGUpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgaWYgKGlzRGVmKHZub2RlLmVsbSkgJiYgaXNEZWYob3duZXJBcnJheSkpIHsKICAgICAgLy8gY2xvbmUgcmV1c2VkIHZub2RlCiAgICAgIHZub2RlID0gb3duZXJBcnJheVtpbmRleF0gPSBjbG9uZVZOb2RlKHZub2RlKTsKICAgIH0KICAgIHZhciBlbG0gPSB2bm9kZS5lbG0gPSBvbGRWbm9kZS5lbG07CiAgICBpZiAoaXNUcnVlKG9sZFZub2RlLmlzQXN5bmNQbGFjZWhvbGRlcikpIHsKICAgICAgaWYgKGlzRGVmKHZub2RlLmFzeW5jRmFjdG9yeS5yZXNvbHZlZCkpIHsKICAgICAgICBoeWRyYXRlKG9sZFZub2RlLmVsbSwgdm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdm5vZGUuaXNBc3luY1BsYWNlaG9sZGVyID0gdHJ1ZTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CiAgICAvLyByZXVzZSBlbGVtZW50IGZvciBzdGF0aWMgdHJlZXMuCiAgICAvLyBub3RlIHdlIG9ubHkgZG8gdGhpcyBpZiB0aGUgdm5vZGUgaXMgY2xvbmVkIC0KICAgIC8vIGlmIHRoZSBuZXcgbm9kZSBpcyBub3QgY2xvbmVkIGl0IG1lYW5zIHRoZSByZW5kZXIgZnVuY3Rpb25zIGhhdmUgYmVlbgogICAgLy8gcmVzZXQgYnkgdGhlIGhvdC1yZWxvYWQtYXBpIGFuZCB3ZSBuZWVkIHRvIGRvIGEgcHJvcGVyIHJlLXJlbmRlci4KICAgIGlmIChpc1RydWUodm5vZGUuaXNTdGF0aWMpICYmIGlzVHJ1ZShvbGRWbm9kZS5pc1N0YXRpYykgJiYgdm5vZGUua2V5ID09PSBvbGRWbm9kZS5rZXkgJiYgKGlzVHJ1ZSh2bm9kZS5pc0Nsb25lZCkgfHwgaXNUcnVlKHZub2RlLmlzT25jZSkpKSB7CiAgICAgIHZub2RlLmNvbXBvbmVudEluc3RhbmNlID0gb2xkVm5vZGUuY29tcG9uZW50SW5zdGFuY2U7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHZhciBpOwogICAgdmFyIGRhdGEgPSB2bm9kZS5kYXRhOwogICAgaWYgKGlzRGVmKGRhdGEpICYmIGlzRGVmKGkgPSBkYXRhLmhvb2spICYmIGlzRGVmKGkgPSBpLnByZXBhdGNoKSkgewogICAgICBpKG9sZFZub2RlLCB2bm9kZSk7CiAgICB9CiAgICB2YXIgb2xkQ2ggPSBvbGRWbm9kZS5jaGlsZHJlbjsKICAgIHZhciBjaCA9IHZub2RlLmNoaWxkcmVuOwogICAgaWYgKGlzRGVmKGRhdGEpICYmIGlzUGF0Y2hhYmxlKHZub2RlKSkgewogICAgICBmb3IgKGkgPSAwOyBpIDwgY2JzLnVwZGF0ZS5sZW5ndGg7ICsraSkgY2JzLnVwZGF0ZVtpXShvbGRWbm9kZSwgdm5vZGUpOwogICAgICBpZiAoaXNEZWYoaSA9IGRhdGEuaG9vaykgJiYgaXNEZWYoaSA9IGkudXBkYXRlKSkgaShvbGRWbm9kZSwgdm5vZGUpOwogICAgfQogICAgaWYgKGlzVW5kZWYodm5vZGUudGV4dCkpIHsKICAgICAgaWYgKGlzRGVmKG9sZENoKSAmJiBpc0RlZihjaCkpIHsKICAgICAgICBpZiAob2xkQ2ggIT09IGNoKSB1cGRhdGVDaGlsZHJlbihlbG0sIG9sZENoLCBjaCwgaW5zZXJ0ZWRWbm9kZVF1ZXVlLCByZW1vdmVPbmx5KTsKICAgICAgfSBlbHNlIGlmIChpc0RlZihjaCkpIHsKICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICAgICAgY2hlY2tEdXBsaWNhdGVLZXlzKGNoKTsKICAgICAgICB9CiAgICAgICAgaWYgKGlzRGVmKG9sZFZub2RlLnRleHQpKSBub2RlT3BzLnNldFRleHRDb250ZW50KGVsbSwgJycpOwogICAgICAgIGFkZFZub2RlcyhlbG0sIG51bGwsIGNoLCAwLCBjaC5sZW5ndGggLSAxLCBpbnNlcnRlZFZub2RlUXVldWUpOwogICAgICB9IGVsc2UgaWYgKGlzRGVmKG9sZENoKSkgewogICAgICAgIHJlbW92ZVZub2RlcyhvbGRDaCwgMCwgb2xkQ2gubGVuZ3RoIC0gMSk7CiAgICAgIH0gZWxzZSBpZiAoaXNEZWYob2xkVm5vZGUudGV4dCkpIHsKICAgICAgICBub2RlT3BzLnNldFRleHRDb250ZW50KGVsbSwgJycpOwogICAgICB9CiAgICB9IGVsc2UgaWYgKG9sZFZub2RlLnRleHQgIT09IHZub2RlLnRleHQpIHsKICAgICAgbm9kZU9wcy5zZXRUZXh0Q29udGVudChlbG0sIHZub2RlLnRleHQpOwogICAgfQogICAgaWYgKGlzRGVmKGRhdGEpKSB7CiAgICAgIGlmIChpc0RlZihpID0gZGF0YS5ob29rKSAmJiBpc0RlZihpID0gaS5wb3N0cGF0Y2gpKSBpKG9sZFZub2RlLCB2bm9kZSk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIGludm9rZUluc2VydEhvb2sodm5vZGUsIHF1ZXVlLCBpbml0aWFsKSB7CiAgICAvLyBkZWxheSBpbnNlcnQgaG9va3MgZm9yIGNvbXBvbmVudCByb290IG5vZGVzLCBpbnZva2UgdGhlbSBhZnRlciB0aGUKICAgIC8vIGVsZW1lbnQgaXMgcmVhbGx5IGluc2VydGVkCiAgICBpZiAoaXNUcnVlKGluaXRpYWwpICYmIGlzRGVmKHZub2RlLnBhcmVudCkpIHsKICAgICAgdm5vZGUucGFyZW50LmRhdGEucGVuZGluZ0luc2VydCA9IHF1ZXVlOwogICAgfSBlbHNlIHsKICAgICAgZm9yICh2YXIgaV82ID0gMDsgaV82IDwgcXVldWUubGVuZ3RoOyArK2lfNikgewogICAgICAgIHF1ZXVlW2lfNl0uZGF0YS5ob29rLmluc2VydChxdWV1ZVtpXzZdKTsKICAgICAgfQogICAgfQogIH0KICB2YXIgaHlkcmF0aW9uQmFpbGVkID0gZmFsc2U7CiAgLy8gbGlzdCBvZiBtb2R1bGVzIHRoYXQgY2FuIHNraXAgY3JlYXRlIGhvb2sgZHVyaW5nIGh5ZHJhdGlvbiBiZWNhdXNlIHRoZXkKICAvLyBhcmUgYWxyZWFkeSByZW5kZXJlZCBvbiB0aGUgY2xpZW50IG9yIGhhcyBubyBuZWVkIGZvciBpbml0aWFsaXphdGlvbgogIC8vIE5vdGU6IHN0eWxlIGlzIGV4Y2x1ZGVkIGJlY2F1c2UgaXQgcmVsaWVzIG9uIGluaXRpYWwgY2xvbmUgZm9yIGZ1dHVyZQogIC8vIGRlZXAgdXBkYXRlcyAoIzcwNjMpLgogIHZhciBpc1JlbmRlcmVkTW9kdWxlID0gbWFrZU1hcCgnYXR0cnMsY2xhc3Msc3RhdGljQ2xhc3Msc3RhdGljU3R5bGUsa2V5Jyk7CiAgLy8gTm90ZTogdGhpcyBpcyBhIGJyb3dzZXItb25seSBmdW5jdGlvbiBzbyB3ZSBjYW4gYXNzdW1lIGVsbXMgYXJlIERPTSBub2Rlcy4KICBmdW5jdGlvbiBoeWRyYXRlKGVsbSwgdm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSwgaW5WUHJlKSB7CiAgICB2YXIgaTsKICAgIHZhciB0YWcgPSB2bm9kZS50YWcsCiAgICAgIGRhdGEgPSB2bm9kZS5kYXRhLAogICAgICBjaGlsZHJlbiA9IHZub2RlLmNoaWxkcmVuOwogICAgaW5WUHJlID0gaW5WUHJlIHx8IGRhdGEgJiYgZGF0YS5wcmU7CiAgICB2bm9kZS5lbG0gPSBlbG07CiAgICBpZiAoaXNUcnVlKHZub2RlLmlzQ29tbWVudCkgJiYgaXNEZWYodm5vZGUuYXN5bmNGYWN0b3J5KSkgewogICAgICB2bm9kZS5pc0FzeW5jUGxhY2Vob2xkZXIgPSB0cnVlOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8vIGFzc2VydCBub2RlIG1hdGNoCiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgewogICAgICBpZiAoIWFzc2VydE5vZGVNYXRjaChlbG0sIHZub2RlLCBpblZQcmUpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgICBpZiAoaXNEZWYoZGF0YSkpIHsKICAgICAgaWYgKGlzRGVmKGkgPSBkYXRhLmhvb2spICYmIGlzRGVmKGkgPSBpLmluaXQpKSBpKHZub2RlLCB0cnVlIC8qIGh5ZHJhdGluZyAqLyk7CiAgICAgIGlmIChpc0RlZihpID0gdm5vZGUuY29tcG9uZW50SW5zdGFuY2UpKSB7CiAgICAgICAgLy8gY2hpbGQgY29tcG9uZW50LiBpdCBzaG91bGQgaGF2ZSBoeWRyYXRlZCBpdHMgb3duIHRyZWUuCiAgICAgICAgaW5pdENvbXBvbmVudCh2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQogICAgaWYgKGlzRGVmKHRhZykpIHsKICAgICAgaWYgKGlzRGVmKGNoaWxkcmVuKSkgewogICAgICAgIC8vIGVtcHR5IGVsZW1lbnQsIGFsbG93IGNsaWVudCB0byBwaWNrIHVwIGFuZCBwb3B1bGF0ZSBjaGlsZHJlbgogICAgICAgIGlmICghZWxtLmhhc0NoaWxkTm9kZXMoKSkgewogICAgICAgICAgY3JlYXRlQ2hpbGRyZW4odm5vZGUsIGNoaWxkcmVuLCBpbnNlcnRlZFZub2RlUXVldWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyB2LWh0bWwgYW5kIGRvbVByb3BzOiBpbm5lckhUTUwKICAgICAgICAgIGlmIChpc0RlZihpID0gZGF0YSkgJiYgaXNEZWYoaSA9IGkuZG9tUHJvcHMpICYmIGlzRGVmKGkgPSBpLmlubmVySFRNTCkpIHsKICAgICAgICAgICAgaWYgKGkgIT09IGVsbS5pbm5lckhUTUwpIHsKICAgICAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICAgICAgICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiB0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcgJiYgIWh5ZHJhdGlvbkJhaWxlZCkgewogICAgICAgICAgICAgICAgaHlkcmF0aW9uQmFpbGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignUGFyZW50OiAnLCBlbG0pOwogICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdzZXJ2ZXIgaW5uZXJIVE1MOiAnLCBpKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignY2xpZW50IGlubmVySFRNTDogJywgZWxtLmlubmVySFRNTCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gaXRlcmF0ZSBhbmQgY29tcGFyZSBjaGlsZHJlbiBsaXN0cwogICAgICAgICAgICB2YXIgY2hpbGRyZW5NYXRjaCA9IHRydWU7CiAgICAgICAgICAgIHZhciBjaGlsZE5vZGUgPSBlbG0uZmlyc3RDaGlsZDsKICAgICAgICAgICAgZm9yICh2YXIgaV83ID0gMDsgaV83IDwgY2hpbGRyZW4ubGVuZ3RoOyBpXzcrKykgewogICAgICAgICAgICAgIGlmICghY2hpbGROb2RlIHx8ICFoeWRyYXRlKGNoaWxkTm9kZSwgY2hpbGRyZW5baV83XSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlLCBpblZQcmUpKSB7CiAgICAgICAgICAgICAgICBjaGlsZHJlbk1hdGNoID0gZmFsc2U7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY2hpbGROb2RlID0gY2hpbGROb2RlLm5leHRTaWJsaW5nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIGlmIGNoaWxkTm9kZSBpcyBub3QgbnVsbCwgaXQgbWVhbnMgdGhlIGFjdHVhbCBjaGlsZE5vZGVzIGxpc3QgaXMKICAgICAgICAgICAgLy8gbG9uZ2VyIHRoYW4gdGhlIHZpcnR1YWwgY2hpbGRyZW4gbGlzdC4KICAgICAgICAgICAgaWYgKCFjaGlsZHJlbk1hdGNoIHx8IGNoaWxkTm9kZSkgewogICAgICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgICAgICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiAhaHlkcmF0aW9uQmFpbGVkKSB7CiAgICAgICAgICAgICAgICBoeWRyYXRpb25CYWlsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdQYXJlbnQ6ICcsIGVsbSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ01pc21hdGNoaW5nIGNoaWxkTm9kZXMgdnMuIFZOb2RlczogJywgZWxtLmNoaWxkTm9kZXMsIGNoaWxkcmVuKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChpc0RlZihkYXRhKSkgewogICAgICAgIHZhciBmdWxsSW52b2tlID0gZmFsc2U7CiAgICAgICAgZm9yICh2YXIga2V5IGluIGRhdGEpIHsKICAgICAgICAgIGlmICghaXNSZW5kZXJlZE1vZHVsZShrZXkpKSB7CiAgICAgICAgICAgIGZ1bGxJbnZva2UgPSB0cnVlOwogICAgICAgICAgICBpbnZva2VDcmVhdGVIb29rcyh2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghZnVsbEludm9rZSAmJiBkYXRhWydjbGFzcyddKSB7CiAgICAgICAgICAvLyBlbnN1cmUgY29sbGVjdGluZyBkZXBzIGZvciBkZWVwIGNsYXNzIGJpbmRpbmdzIGZvciBmdXR1cmUgdXBkYXRlcwogICAgICAgICAgdHJhdmVyc2UoZGF0YVsnY2xhc3MnXSk7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKGVsbS5kYXRhICE9PSB2bm9kZS50ZXh0KSB7CiAgICAgIGVsbS5kYXRhID0gdm5vZGUudGV4dDsKICAgIH0KICAgIHJldHVybiB0cnVlOwogIH0KICBmdW5jdGlvbiBhc3NlcnROb2RlTWF0Y2gobm9kZSwgdm5vZGUsIGluVlByZSkgewogICAgaWYgKGlzRGVmKHZub2RlLnRhZykpIHsKICAgICAgcmV0dXJuIHZub2RlLnRhZy5pbmRleE9mKCd2dWUtY29tcG9uZW50JykgPT09IDAgfHwgIWlzVW5rbm93bkVsZW1lbnQodm5vZGUsIGluVlByZSkgJiYgdm5vZGUudGFnLnRvTG93ZXJDYXNlKCkgPT09IChub2RlLnRhZ05hbWUgJiYgbm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCkpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09ICh2bm9kZS5pc0NvbW1lbnQgPyA4IDogMyk7CiAgICB9CiAgfQogIHJldHVybiBmdW5jdGlvbiBwYXRjaChvbGRWbm9kZSwgdm5vZGUsIGh5ZHJhdGluZywgcmVtb3ZlT25seSkgewogICAgaWYgKGlzVW5kZWYodm5vZGUpKSB7CiAgICAgIGlmIChpc0RlZihvbGRWbm9kZSkpIGludm9rZURlc3Ryb3lIb29rKG9sZFZub2RlKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgdmFyIGlzSW5pdGlhbFBhdGNoID0gZmFsc2U7CiAgICB2YXIgaW5zZXJ0ZWRWbm9kZVF1ZXVlID0gW107CiAgICBpZiAoaXNVbmRlZihvbGRWbm9kZSkpIHsKICAgICAgLy8gZW1wdHkgbW91bnQgKGxpa2VseSBhcyBjb21wb25lbnQpLCBjcmVhdGUgbmV3IHJvb3QgZWxlbWVudAogICAgICBpc0luaXRpYWxQYXRjaCA9IHRydWU7CiAgICAgIGNyZWF0ZUVsbSh2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTsKICAgIH0gZWxzZSB7CiAgICAgIHZhciBpc1JlYWxFbGVtZW50ID0gaXNEZWYob2xkVm5vZGUubm9kZVR5cGUpOwogICAgICBpZiAoIWlzUmVhbEVsZW1lbnQgJiYgc2FtZVZub2RlKG9sZFZub2RlLCB2bm9kZSkpIHsKICAgICAgICAvLyBwYXRjaCBleGlzdGluZyByb290IG5vZGUKICAgICAgICBwYXRjaFZub2RlKG9sZFZub2RlLCB2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlLCBudWxsLCBudWxsLCByZW1vdmVPbmx5KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoaXNSZWFsRWxlbWVudCkgewogICAgICAgICAgLy8gbW91bnRpbmcgdG8gYSByZWFsIGVsZW1lbnQKICAgICAgICAgIC8vIGNoZWNrIGlmIHRoaXMgaXMgc2VydmVyLXJlbmRlcmVkIGNvbnRlbnQgYW5kIGlmIHdlIGNhbiBwZXJmb3JtCiAgICAgICAgICAvLyBhIHN1Y2Nlc3NmdWwgaHlkcmF0aW9uLgogICAgICAgICAgaWYgKG9sZFZub2RlLm5vZGVUeXBlID09PSAxICYmIG9sZFZub2RlLmhhc0F0dHJpYnV0ZShTU1JfQVRUUikpIHsKICAgICAgICAgICAgb2xkVm5vZGUucmVtb3ZlQXR0cmlidXRlKFNTUl9BVFRSKTsKICAgICAgICAgICAgaHlkcmF0aW5nID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChpc1RydWUoaHlkcmF0aW5nKSkgewogICAgICAgICAgICBpZiAoaHlkcmF0ZShvbGRWbm9kZSwgdm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSkpIHsKICAgICAgICAgICAgICBpbnZva2VJbnNlcnRIb29rKHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUsIHRydWUpOwogICAgICAgICAgICAgIHJldHVybiBvbGRWbm9kZTsKICAgICAgICAgICAgfSBlbHNlIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7CiAgICAgICAgICAgICAgd2FybignVGhlIGNsaWVudC1zaWRlIHJlbmRlcmVkIHZpcnR1YWwgRE9NIHRyZWUgaXMgbm90IG1hdGNoaW5nICcgKyAnc2VydmVyLXJlbmRlcmVkIGNvbnRlbnQuIFRoaXMgaXMgbGlrZWx5IGNhdXNlZCBieSBpbmNvcnJlY3QgJyArICdIVE1MIG1hcmt1cCwgZm9yIGV4YW1wbGUgbmVzdGluZyBibG9jay1sZXZlbCBlbGVtZW50cyBpbnNpZGUgJyArICc8cD4sIG9yIG1pc3NpbmcgPHRib2R5Pi4gQmFpbGluZyBoeWRyYXRpb24gYW5kIHBlcmZvcm1pbmcgJyArICdmdWxsIGNsaWVudC1zaWRlIHJlbmRlci4nKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgLy8gZWl0aGVyIG5vdCBzZXJ2ZXItcmVuZGVyZWQsIG9yIGh5ZHJhdGlvbiBmYWlsZWQuCiAgICAgICAgICAvLyBjcmVhdGUgYW4gZW1wdHkgbm9kZSBhbmQgcmVwbGFjZSBpdAogICAgICAgICAgb2xkVm5vZGUgPSBlbXB0eU5vZGVBdChvbGRWbm9kZSk7CiAgICAgICAgfQogICAgICAgIC8vIHJlcGxhY2luZyBleGlzdGluZyBlbGVtZW50CiAgICAgICAgdmFyIG9sZEVsbSA9IG9sZFZub2RlLmVsbTsKICAgICAgICB2YXIgcGFyZW50RWxtID0gbm9kZU9wcy5wYXJlbnROb2RlKG9sZEVsbSk7CiAgICAgICAgLy8gY3JlYXRlIG5ldyBub2RlCiAgICAgICAgY3JlYXRlRWxtKHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUsCiAgICAgICAgLy8gZXh0cmVtZWx5IHJhcmUgZWRnZSBjYXNlOiBkbyBub3QgaW5zZXJ0IGlmIG9sZCBlbGVtZW50IGlzIGluIGEKICAgICAgICAvLyBsZWF2aW5nIHRyYW5zaXRpb24uIE9ubHkgaGFwcGVucyB3aGVuIGNvbWJpbmluZyB0cmFuc2l0aW9uICsKICAgICAgICAvLyBrZWVwLWFsaXZlICsgSE9Dcy4gKCM0NTkwKQogICAgICAgIG9sZEVsbS5fbGVhdmVDYiA/IG51bGwgOiBwYXJlbnRFbG0sIG5vZGVPcHMubmV4dFNpYmxpbmcob2xkRWxtKSk7CiAgICAgICAgLy8gdXBkYXRlIHBhcmVudCBwbGFjZWhvbGRlciBub2RlIGVsZW1lbnQsIHJlY3Vyc2l2ZWx5CiAgICAgICAgaWYgKGlzRGVmKHZub2RlLnBhcmVudCkpIHsKICAgICAgICAgIHZhciBhbmNlc3RvciA9IHZub2RlLnBhcmVudDsKICAgICAgICAgIHZhciBwYXRjaGFibGUgPSBpc1BhdGNoYWJsZSh2bm9kZSk7CiAgICAgICAgICB3aGlsZSAoYW5jZXN0b3IpIHsKICAgICAgICAgICAgZm9yICh2YXIgaV84ID0gMDsgaV84IDwgY2JzLmRlc3Ryb3kubGVuZ3RoOyArK2lfOCkgewogICAgICAgICAgICAgIGNicy5kZXN0cm95W2lfOF0oYW5jZXN0b3IpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGFuY2VzdG9yLmVsbSA9IHZub2RlLmVsbTsKICAgICAgICAgICAgaWYgKHBhdGNoYWJsZSkgewogICAgICAgICAgICAgIGZvciAodmFyIGlfOSA9IDA7IGlfOSA8IGNicy5jcmVhdGUubGVuZ3RoOyArK2lfOSkgewogICAgICAgICAgICAgICAgY2JzLmNyZWF0ZVtpXzldKGVtcHR5Tm9kZSwgYW5jZXN0b3IpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyAjNjUxMwogICAgICAgICAgICAgIC8vIGludm9rZSBpbnNlcnQgaG9va3MgdGhhdCBtYXkgaGF2ZSBiZWVuIG1lcmdlZCBieSBjcmVhdGUgaG9va3MuCiAgICAgICAgICAgICAgLy8gZS5nLiBmb3IgZGlyZWN0aXZlcyB0aGF0IHVzZXMgdGhlICJpbnNlcnRlZCIgaG9vay4KICAgICAgICAgICAgICB2YXIgaW5zZXJ0XzEgPSBhbmNlc3Rvci5kYXRhLmhvb2suaW5zZXJ0OwogICAgICAgICAgICAgIGlmIChpbnNlcnRfMS5tZXJnZWQpIHsKICAgICAgICAgICAgICAgIC8vIHN0YXJ0IGF0IGluZGV4IDEgdG8gYXZvaWQgcmUtaW52b2tpbmcgY29tcG9uZW50IG1vdW50ZWQgaG9vawogICAgICAgICAgICAgICAgLy8gY2xvbmUgaW5zZXJ0IGhvb2tzIHRvIGF2b2lkIGJlaW5nIG11dGF0ZWQgZHVyaW5nIGl0ZXJhdGlvbi4KICAgICAgICAgICAgICAgIC8vIGUuZy4gZm9yIGN1c3RvbWVkIGRpcmVjdGl2ZXMgdW5kZXIgdHJhbnNpdGlvbiBncm91cC4KICAgICAgICAgICAgICAgIHZhciBjbG9uZWQgPSBpbnNlcnRfMS5mbnMuc2xpY2UoMSk7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpXzEwID0gMDsgaV8xMCA8IGNsb25lZC5sZW5ndGg7IGlfMTArKykgewogICAgICAgICAgICAgICAgICBjbG9uZWRbaV8xMF0oKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmVnaXN0ZXJSZWYoYW5jZXN0b3IpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGFuY2VzdG9yID0gYW5jZXN0b3IucGFyZW50OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvLyBkZXN0cm95IG9sZCBub2RlCiAgICAgICAgaWYgKGlzRGVmKHBhcmVudEVsbSkpIHsKICAgICAgICAgIHJlbW92ZVZub2Rlcyhbb2xkVm5vZGVdLCAwLCAwKTsKICAgICAgICB9IGVsc2UgaWYgKGlzRGVmKG9sZFZub2RlLnRhZykpIHsKICAgICAgICAgIGludm9rZURlc3Ryb3lIb29rKG9sZFZub2RlKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGludm9rZUluc2VydEhvb2sodm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSwgaXNJbml0aWFsUGF0Y2gpOwogICAgcmV0dXJuIHZub2RlLmVsbTsKICB9Owp9CnZhciBkaXJlY3RpdmVzID0gewogIGNyZWF0ZTogdXBkYXRlRGlyZWN0aXZlcywKICB1cGRhdGU6IHVwZGF0ZURpcmVjdGl2ZXMsCiAgZGVzdHJveTogZnVuY3Rpb24gdW5iaW5kRGlyZWN0aXZlcyh2bm9kZSkgewogICAgLy8gQHRzLWV4cGVjdC1lcnJvciBlbXB0eU5vZGUgaXMgbm90IFZOb2RlV2l0aERhdGEKICAgIHVwZGF0ZURpcmVjdGl2ZXModm5vZGUsIGVtcHR5Tm9kZSk7CiAgfQp9OwpmdW5jdGlvbiB1cGRhdGVEaXJlY3RpdmVzKG9sZFZub2RlLCB2bm9kZSkgewogIGlmIChvbGRWbm9kZS5kYXRhLmRpcmVjdGl2ZXMgfHwgdm5vZGUuZGF0YS5kaXJlY3RpdmVzKSB7CiAgICBfdXBkYXRlKG9sZFZub2RlLCB2bm9kZSk7CiAgfQp9CmZ1bmN0aW9uIF91cGRhdGUob2xkVm5vZGUsIHZub2RlKSB7CiAgdmFyIGlzQ3JlYXRlID0gb2xkVm5vZGUgPT09IGVtcHR5Tm9kZTsKICB2YXIgaXNEZXN0cm95ID0gdm5vZGUgPT09IGVtcHR5Tm9kZTsKICB2YXIgb2xkRGlycyA9IG5vcm1hbGl6ZURpcmVjdGl2ZXMob2xkVm5vZGUuZGF0YS5kaXJlY3RpdmVzLCBvbGRWbm9kZS5jb250ZXh0KTsKICB2YXIgbmV3RGlycyA9IG5vcm1hbGl6ZURpcmVjdGl2ZXModm5vZGUuZGF0YS5kaXJlY3RpdmVzLCB2bm9kZS5jb250ZXh0KTsKICB2YXIgZGlyc1dpdGhJbnNlcnQgPSBbXTsKICB2YXIgZGlyc1dpdGhQb3N0cGF0Y2ggPSBbXTsKICB2YXIga2V5LCBvbGREaXIsIGRpcjsKICBmb3IgKGtleSBpbiBuZXdEaXJzKSB7CiAgICBvbGREaXIgPSBvbGREaXJzW2tleV07CiAgICBkaXIgPSBuZXdEaXJzW2tleV07CiAgICBpZiAoIW9sZERpcikgewogICAgICAvLyBuZXcgZGlyZWN0aXZlLCBiaW5kCiAgICAgIGNhbGxIb29rKGRpciwgJ2JpbmQnLCB2bm9kZSwgb2xkVm5vZGUpOwogICAgICBpZiAoZGlyLmRlZiAmJiBkaXIuZGVmLmluc2VydGVkKSB7CiAgICAgICAgZGlyc1dpdGhJbnNlcnQucHVzaChkaXIpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICAvLyBleGlzdGluZyBkaXJlY3RpdmUsIHVwZGF0ZQogICAgICBkaXIub2xkVmFsdWUgPSBvbGREaXIudmFsdWU7CiAgICAgIGRpci5vbGRBcmcgPSBvbGREaXIuYXJnOwogICAgICBjYWxsSG9vayhkaXIsICd1cGRhdGUnLCB2bm9kZSwgb2xkVm5vZGUpOwogICAgICBpZiAoZGlyLmRlZiAmJiBkaXIuZGVmLmNvbXBvbmVudFVwZGF0ZWQpIHsKICAgICAgICBkaXJzV2l0aFBvc3RwYXRjaC5wdXNoKGRpcik7CiAgICAgIH0KICAgIH0KICB9CiAgaWYgKGRpcnNXaXRoSW5zZXJ0Lmxlbmd0aCkgewogICAgdmFyIGNhbGxJbnNlcnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGlyc1dpdGhJbnNlcnQubGVuZ3RoOyBpKyspIHsKICAgICAgICBjYWxsSG9vayhkaXJzV2l0aEluc2VydFtpXSwgJ2luc2VydGVkJywgdm5vZGUsIG9sZFZub2RlKTsKICAgICAgfQogICAgfTsKICAgIGlmIChpc0NyZWF0ZSkgewogICAgICBtZXJnZVZOb2RlSG9vayh2bm9kZSwgJ2luc2VydCcsIGNhbGxJbnNlcnQpOwogICAgfSBlbHNlIHsKICAgICAgY2FsbEluc2VydCgpOwogICAgfQogIH0KICBpZiAoZGlyc1dpdGhQb3N0cGF0Y2gubGVuZ3RoKSB7CiAgICBtZXJnZVZOb2RlSG9vayh2bm9kZSwgJ3Bvc3RwYXRjaCcsIGZ1bmN0aW9uICgpIHsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkaXJzV2l0aFBvc3RwYXRjaC5sZW5ndGg7IGkrKykgewogICAgICAgIGNhbGxIb29rKGRpcnNXaXRoUG9zdHBhdGNoW2ldLCAnY29tcG9uZW50VXBkYXRlZCcsIHZub2RlLCBvbGRWbm9kZSk7CiAgICAgIH0KICAgIH0pOwogIH0KICBpZiAoIWlzQ3JlYXRlKSB7CiAgICBmb3IgKGtleSBpbiBvbGREaXJzKSB7CiAgICAgIGlmICghbmV3RGlyc1trZXldKSB7CiAgICAgICAgLy8gbm8gbG9uZ2VyIHByZXNlbnQsIHVuYmluZAogICAgICAgIGNhbGxIb29rKG9sZERpcnNba2V5XSwgJ3VuYmluZCcsIG9sZFZub2RlLCBvbGRWbm9kZSwgaXNEZXN0cm95KTsKICAgICAgfQogICAgfQogIH0KfQp2YXIgZW1wdHlNb2RpZmllcnMgPSBPYmplY3QuY3JlYXRlKG51bGwpOwpmdW5jdGlvbiBub3JtYWxpemVEaXJlY3RpdmVzKGRpcnMsIHZtKSB7CiAgdmFyIHJlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7CiAgaWYgKCFkaXJzKSB7CiAgICAvLyAkZmxvdy1kaXNhYmxlLWxpbmUKICAgIHJldHVybiByZXM7CiAgfQogIHZhciBpLCBkaXI7CiAgZm9yIChpID0gMDsgaSA8IGRpcnMubGVuZ3RoOyBpKyspIHsKICAgIGRpciA9IGRpcnNbaV07CiAgICBpZiAoIWRpci5tb2RpZmllcnMpIHsKICAgICAgLy8gJGZsb3ctZGlzYWJsZS1saW5lCiAgICAgIGRpci5tb2RpZmllcnMgPSBlbXB0eU1vZGlmaWVyczsKICAgIH0KICAgIHJlc1tnZXRSYXdEaXJOYW1lKGRpcildID0gZGlyOwogICAgaWYgKHZtLl9zZXR1cFN0YXRlICYmIHZtLl9zZXR1cFN0YXRlLl9fc2ZjKSB7CiAgICAgIHZhciBzZXR1cERlZiA9IGRpci5kZWYgfHwgcmVzb2x2ZUFzc2V0KHZtLCAnX3NldHVwU3RhdGUnLCAndi0nICsgZGlyLm5hbWUpOwogICAgICBpZiAodHlwZW9mIHNldHVwRGVmID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgZGlyLmRlZiA9IHsKICAgICAgICAgIGJpbmQ6IHNldHVwRGVmLAogICAgICAgICAgdXBkYXRlOiBzZXR1cERlZgogICAgICAgIH07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGlyLmRlZiA9IHNldHVwRGVmOwogICAgICB9CiAgICB9CiAgICBkaXIuZGVmID0gZGlyLmRlZiB8fCByZXNvbHZlQXNzZXQodm0uJG9wdGlvbnMsICdkaXJlY3RpdmVzJywgZGlyLm5hbWUsIHRydWUpOwogIH0KICAvLyAkZmxvdy1kaXNhYmxlLWxpbmUKICByZXR1cm4gcmVzOwp9CmZ1bmN0aW9uIGdldFJhd0Rpck5hbWUoZGlyKSB7CiAgcmV0dXJuIGRpci5yYXdOYW1lIHx8ICIiLmNvbmNhdChkaXIubmFtZSwgIi4iKS5jb25jYXQoT2JqZWN0LmtleXMoZGlyLm1vZGlmaWVycyB8fCB7fSkuam9pbignLicpKTsKfQpmdW5jdGlvbiBjYWxsSG9vayhkaXIsIGhvb2ssIHZub2RlLCBvbGRWbm9kZSwgaXNEZXN0cm95KSB7CiAgdmFyIGZuID0gZGlyLmRlZiAmJiBkaXIuZGVmW2hvb2tdOwogIGlmIChmbikgewogICAgdHJ5IHsKICAgICAgZm4odm5vZGUuZWxtLCBkaXIsIHZub2RlLCBvbGRWbm9kZSwgaXNEZXN0cm95KTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgaGFuZGxlRXJyb3IoZSwgdm5vZGUuY29udGV4dCwgImRpcmVjdGl2ZSAiLmNvbmNhdChkaXIubmFtZSwgIiAiKS5jb25jYXQoaG9vaywgIiBob29rIikpOwogICAgfQogIH0KfQp2YXIgYmFzZU1vZHVsZXMgPSBbcmVmLCBkaXJlY3RpdmVzXTsKZnVuY3Rpb24gdXBkYXRlQXR0cnMob2xkVm5vZGUsIHZub2RlKSB7CiAgdmFyIG9wdHMgPSB2bm9kZS5jb21wb25lbnRPcHRpb25zOwogIGlmIChpc0RlZihvcHRzKSAmJiBvcHRzLkN0b3Iub3B0aW9ucy5pbmhlcml0QXR0cnMgPT09IGZhbHNlKSB7CiAgICByZXR1cm47CiAgfQogIGlmIChpc1VuZGVmKG9sZFZub2RlLmRhdGEuYXR0cnMpICYmIGlzVW5kZWYodm5vZGUuZGF0YS5hdHRycykpIHsKICAgIHJldHVybjsKICB9CiAgdmFyIGtleSwgY3VyLCBvbGQ7CiAgdmFyIGVsbSA9IHZub2RlLmVsbTsKICB2YXIgb2xkQXR0cnMgPSBvbGRWbm9kZS5kYXRhLmF0dHJzIHx8IHt9OwogIHZhciBhdHRycyA9IHZub2RlLmRhdGEuYXR0cnMgfHwge307CiAgLy8gY2xvbmUgb2JzZXJ2ZWQgb2JqZWN0cywgYXMgdGhlIHVzZXIgcHJvYmFibHkgd2FudHMgdG8gbXV0YXRlIGl0CiAgaWYgKGlzRGVmKGF0dHJzLl9fb2JfXykgfHwgaXNUcnVlKGF0dHJzLl92X2F0dHJfcHJveHkpKSB7CiAgICBhdHRycyA9IHZub2RlLmRhdGEuYXR0cnMgPSBleHRlbmQoe30sIGF0dHJzKTsKICB9CiAgZm9yIChrZXkgaW4gYXR0cnMpIHsKICAgIGN1ciA9IGF0dHJzW2tleV07CiAgICBvbGQgPSBvbGRBdHRyc1trZXldOwogICAgaWYgKG9sZCAhPT0gY3VyKSB7CiAgICAgIHNldEF0dHIoZWxtLCBrZXksIGN1ciwgdm5vZGUuZGF0YS5wcmUpOwogICAgfQogIH0KICAvLyAjNDM5MTogaW4gSUU5LCBzZXR0aW5nIHR5cGUgY2FuIHJlc2V0IHZhbHVlIGZvciBpbnB1dFt0eXBlPXJhZGlvXQogIC8vICM2NjY2OiBJRS9FZGdlIGZvcmNlcyBwcm9ncmVzcyB2YWx1ZSBkb3duIHRvIDEgYmVmb3JlIHNldHRpbmcgYSBtYXgKICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICBpZiAoKGlzSUUgfHwgaXNFZGdlKSAmJiBhdHRycy52YWx1ZSAhPT0gb2xkQXR0cnMudmFsdWUpIHsKICAgIHNldEF0dHIoZWxtLCAndmFsdWUnLCBhdHRycy52YWx1ZSk7CiAgfQogIGZvciAoa2V5IGluIG9sZEF0dHJzKSB7CiAgICBpZiAoaXNVbmRlZihhdHRyc1trZXldKSkgewogICAgICBpZiAoaXNYbGluayhrZXkpKSB7CiAgICAgICAgZWxtLnJlbW92ZUF0dHJpYnV0ZU5TKHhsaW5rTlMsIGdldFhsaW5rUHJvcChrZXkpKTsKICAgICAgfSBlbHNlIGlmICghaXNFbnVtZXJhdGVkQXR0cihrZXkpKSB7CiAgICAgICAgZWxtLnJlbW92ZUF0dHJpYnV0ZShrZXkpOwogICAgICB9CiAgICB9CiAgfQp9CmZ1bmN0aW9uIHNldEF0dHIoZWwsIGtleSwgdmFsdWUsIGlzSW5QcmUpIHsKICBpZiAoaXNJblByZSB8fCBlbC50YWdOYW1lLmluZGV4T2YoJy0nKSA+IC0xKSB7CiAgICBiYXNlU2V0QXR0cihlbCwga2V5LCB2YWx1ZSk7CiAgfSBlbHNlIGlmIChpc0Jvb2xlYW5BdHRyKGtleSkpIHsKICAgIC8vIHNldCBhdHRyaWJ1dGUgZm9yIGJsYW5rIHZhbHVlCiAgICAvLyBlLmcuIDxvcHRpb24gZGlzYWJsZWQ+U2VsZWN0IG9uZTwvb3B0aW9uPgogICAgaWYgKGlzRmFsc3lBdHRyVmFsdWUodmFsdWUpKSB7CiAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZShrZXkpOwogICAgfSBlbHNlIHsKICAgICAgLy8gdGVjaG5pY2FsbHkgYWxsb3dmdWxsc2NyZWVuIGlzIGEgYm9vbGVhbiBhdHRyaWJ1dGUgZm9yIDxpZnJhbWU+LAogICAgICAvLyBidXQgRmxhc2ggZXhwZWN0cyBhIHZhbHVlIG9mICJ0cnVlIiB3aGVuIHVzZWQgb24gPGVtYmVkPiB0YWcKICAgICAgdmFsdWUgPSBrZXkgPT09ICdhbGxvd2Z1bGxzY3JlZW4nICYmIGVsLnRhZ05hbWUgPT09ICdFTUJFRCcgPyAndHJ1ZScgOiBrZXk7CiAgICAgIGVsLnNldEF0dHJpYnV0ZShrZXksIHZhbHVlKTsKICAgIH0KICB9IGVsc2UgaWYgKGlzRW51bWVyYXRlZEF0dHIoa2V5KSkgewogICAgZWwuc2V0QXR0cmlidXRlKGtleSwgY29udmVydEVudW1lcmF0ZWRWYWx1ZShrZXksIHZhbHVlKSk7CiAgfSBlbHNlIGlmIChpc1hsaW5rKGtleSkpIHsKICAgIGlmIChpc0ZhbHN5QXR0clZhbHVlKHZhbHVlKSkgewogICAgICBlbC5yZW1vdmVBdHRyaWJ1dGVOUyh4bGlua05TLCBnZXRYbGlua1Byb3Aoa2V5KSk7CiAgICB9IGVsc2UgewogICAgICBlbC5zZXRBdHRyaWJ1dGVOUyh4bGlua05TLCBrZXksIHZhbHVlKTsKICAgIH0KICB9IGVsc2UgewogICAgYmFzZVNldEF0dHIoZWwsIGtleSwgdmFsdWUpOwogIH0KfQpmdW5jdGlvbiBiYXNlU2V0QXR0cihlbCwga2V5LCB2YWx1ZSkgewogIGlmIChpc0ZhbHN5QXR0clZhbHVlKHZhbHVlKSkgewogICAgZWwucmVtb3ZlQXR0cmlidXRlKGtleSk7CiAgfSBlbHNlIHsKICAgIC8vICM3MTM4OiBJRTEwICYgMTEgZmlyZXMgaW5wdXQgZXZlbnQgd2hlbiBzZXR0aW5nIHBsYWNlaG9sZGVyIG9uCiAgICAvLyA8dGV4dGFyZWE+Li4uIGJsb2NrIHRoZSBmaXJzdCBpbnB1dCBldmVudCBhbmQgcmVtb3ZlIHRoZSBibG9ja2VyCiAgICAvLyBpbW1lZGlhdGVseS4KICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgaWYgKGlzSUUgJiYgIWlzSUU5ICYmIGVsLnRhZ05hbWUgPT09ICdURVhUQVJFQScgJiYga2V5ID09PSAncGxhY2Vob2xkZXInICYmIHZhbHVlICE9PSAnJyAmJiAhZWwuX19pZXBoKSB7CiAgICAgIHZhciBibG9ja2VyXzEgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7CiAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBibG9ja2VyXzEpOwogICAgICB9OwogICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGJsb2NrZXJfMSk7CiAgICAgIC8vICRmbG93LWRpc2FibGUtbGluZQogICAgICBlbC5fX2llcGggPSB0cnVlOyAvKiBJRSBwbGFjZWhvbGRlciBwYXRjaGVkICovCiAgICB9CiAgICBlbC5zZXRBdHRyaWJ1dGUoa2V5LCB2YWx1ZSk7CiAgfQp9CnZhciBhdHRycyA9IHsKICBjcmVhdGU6IHVwZGF0ZUF0dHJzLAogIHVwZGF0ZTogdXBkYXRlQXR0cnMKfTsKZnVuY3Rpb24gdXBkYXRlQ2xhc3Mob2xkVm5vZGUsIHZub2RlKSB7CiAgdmFyIGVsID0gdm5vZGUuZWxtOwogIHZhciBkYXRhID0gdm5vZGUuZGF0YTsKICB2YXIgb2xkRGF0YSA9IG9sZFZub2RlLmRhdGE7CiAgaWYgKGlzVW5kZWYoZGF0YS5zdGF0aWNDbGFzcykgJiYgaXNVbmRlZihkYXRhLmNsYXNzKSAmJiAoaXNVbmRlZihvbGREYXRhKSB8fCBpc1VuZGVmKG9sZERhdGEuc3RhdGljQ2xhc3MpICYmIGlzVW5kZWYob2xkRGF0YS5jbGFzcykpKSB7CiAgICByZXR1cm47CiAgfQogIHZhciBjbHMgPSBnZW5DbGFzc0ZvclZub2RlKHZub2RlKTsKICAvLyBoYW5kbGUgdHJhbnNpdGlvbiBjbGFzc2VzCiAgdmFyIHRyYW5zaXRpb25DbGFzcyA9IGVsLl90cmFuc2l0aW9uQ2xhc3NlczsKICBpZiAoaXNEZWYodHJhbnNpdGlvbkNsYXNzKSkgewogICAgY2xzID0gY29uY2F0KGNscywgc3RyaW5naWZ5Q2xhc3ModHJhbnNpdGlvbkNsYXNzKSk7CiAgfQogIC8vIHNldCB0aGUgY2xhc3MKICBpZiAoY2xzICE9PSBlbC5fcHJldkNsYXNzKSB7CiAgICBlbC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgY2xzKTsKICAgIGVsLl9wcmV2Q2xhc3MgPSBjbHM7CiAgfQp9CnZhciBrbGFzcyA9IHsKICBjcmVhdGU6IHVwZGF0ZUNsYXNzLAogIHVwZGF0ZTogdXBkYXRlQ2xhc3MKfTsKCi8vIGluIHNvbWUgY2FzZXMsIHRoZSBldmVudCB1c2VkIGhhcyB0byBiZSBkZXRlcm1pbmVkIGF0IHJ1bnRpbWUKLy8gc28gd2UgdXNlZCBzb21lIHJlc2VydmVkIHRva2VucyBkdXJpbmcgY29tcGlsZS4KdmFyIFJBTkdFX1RPS0VOID0gJ19fcic7CnZhciBDSEVDS0JPWF9SQURJT19UT0tFTiA9ICdfX2MnOwoKLy8gbm9ybWFsaXplIHYtbW9kZWwgZXZlbnQgdG9rZW5zIHRoYXQgY2FuIG9ubHkgYmUgZGV0ZXJtaW5lZCBhdCBydW50aW1lLgovLyBpdCdzIGltcG9ydGFudCB0byBwbGFjZSB0aGUgZXZlbnQgYXMgdGhlIGZpcnN0IGluIHRoZSBhcnJheSBiZWNhdXNlCi8vIHRoZSB3aG9sZSBwb2ludCBpcyBlbnN1cmluZyB0aGUgdi1tb2RlbCBjYWxsYmFjayBnZXRzIGNhbGxlZCBiZWZvcmUKLy8gdXNlci1hdHRhY2hlZCBoYW5kbGVycy4KZnVuY3Rpb24gbm9ybWFsaXplRXZlbnRzKG9uKSB7CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKGlzRGVmKG9uW1JBTkdFX1RPS0VOXSkpIHsKICAgIC8vIElFIGlucHV0W3R5cGU9cmFuZ2VdIG9ubHkgc3VwcG9ydHMgYGNoYW5nZWAgZXZlbnQKICAgIHZhciBldmVudF8xID0gaXNJRSA/ICdjaGFuZ2UnIDogJ2lucHV0JzsKICAgIG9uW2V2ZW50XzFdID0gW10uY29uY2F0KG9uW1JBTkdFX1RPS0VOXSwgb25bZXZlbnRfMV0gfHwgW10pOwogICAgZGVsZXRlIG9uW1JBTkdFX1RPS0VOXTsKICB9CiAgLy8gVGhpcyB3YXMgb3JpZ2luYWxseSBpbnRlbmRlZCB0byBmaXggIzQ1MjEgYnV0IG5vIGxvbmdlciBuZWNlc3NhcnkKICAvLyBhZnRlciAyLjUuIEtlZXBpbmcgaXQgZm9yIGJhY2t3YXJkcyBjb21wYXQgd2l0aCBnZW5lcmF0ZWQgY29kZSBmcm9tIDwgMi40CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKGlzRGVmKG9uW0NIRUNLQk9YX1JBRElPX1RPS0VOXSkpIHsKICAgIG9uLmNoYW5nZSA9IFtdLmNvbmNhdChvbltDSEVDS0JPWF9SQURJT19UT0tFTl0sIG9uLmNoYW5nZSB8fCBbXSk7CiAgICBkZWxldGUgb25bQ0hFQ0tCT1hfUkFESU9fVE9LRU5dOwogIH0KfQp2YXIgdGFyZ2V0OwpmdW5jdGlvbiBjcmVhdGVPbmNlSGFuZGxlcihldmVudCwgaGFuZGxlciwgY2FwdHVyZSkgewogIHZhciBfdGFyZ2V0ID0gdGFyZ2V0OyAvLyBzYXZlIGN1cnJlbnQgdGFyZ2V0IGVsZW1lbnQgaW4gY2xvc3VyZQogIHJldHVybiBmdW5jdGlvbiBvbmNlSGFuZGxlcigpIHsKICAgIHZhciByZXMgPSBoYW5kbGVyLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7CiAgICBpZiAocmVzICE9PSBudWxsKSB7CiAgICAgIHJlbW92ZShldmVudCwgb25jZUhhbmRsZXIsIGNhcHR1cmUsIF90YXJnZXQpOwogICAgfQogIH07Cn0KLy8gIzk0NDY6IEZpcmVmb3ggPD0gNTMgKGluIHBhcnRpY3VsYXIsIEVTUiA1MikgaGFzIGluY29ycmVjdCBFdmVudC50aW1lU3RhbXAKLy8gaW1wbGVtZW50YXRpb24gYW5kIGRvZXMgbm90IGZpcmUgbWljcm90YXNrcyBpbiBiZXR3ZWVuIGV2ZW50IHByb3BhZ2F0aW9uLCBzbwovLyBzYWZlIHRvIGV4Y2x1ZGUuCnZhciB1c2VNaWNyb3Rhc2tGaXggPSBpc1VzaW5nTWljcm9UYXNrICYmICEoaXNGRiAmJiBOdW1iZXIoaXNGRlsxXSkgPD0gNTMpOwpmdW5jdGlvbiBhZGQobmFtZSwgaGFuZGxlciwgY2FwdHVyZSwgcGFzc2l2ZSkgewogIC8vIGFzeW5jIGVkZ2UgY2FzZSAjNjU2NjogaW5uZXIgY2xpY2sgZXZlbnQgdHJpZ2dlcnMgcGF0Y2gsIGV2ZW50IGhhbmRsZXIKICAvLyBhdHRhY2hlZCB0byBvdXRlciBlbGVtZW50IGR1cmluZyBwYXRjaCwgYW5kIHRyaWdnZXJlZCBhZ2Fpbi4gVGhpcwogIC8vIGhhcHBlbnMgYmVjYXVzZSBicm93c2VycyBmaXJlIG1pY3JvdGFzayB0aWNrcyBiZXR3ZWVuIGV2ZW50IHByb3BhZ2F0aW9uLgogIC8vIHRoZSBzb2x1dGlvbiBpcyBzaW1wbGU6IHdlIHNhdmUgdGhlIHRpbWVzdGFtcCB3aGVuIGEgaGFuZGxlciBpcyBhdHRhY2hlZCwKICAvLyBhbmQgdGhlIGhhbmRsZXIgd291bGQgb25seSBmaXJlIGlmIHRoZSBldmVudCBwYXNzZWQgdG8gaXQgd2FzIGZpcmVkCiAgLy8gQUZURVIgaXQgd2FzIGF0dGFjaGVkLgogIGlmICh1c2VNaWNyb3Rhc2tGaXgpIHsKICAgIHZhciBhdHRhY2hlZFRpbWVzdGFtcF8xID0gY3VycmVudEZsdXNoVGltZXN0YW1wOwogICAgdmFyIG9yaWdpbmFsXzEgPSBoYW5kbGVyOwogICAgLy9AdHMtZXhwZWN0LWVycm9yCiAgICBoYW5kbGVyID0gb3JpZ2luYWxfMS5fd3JhcHBlciA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmICgKICAgICAgLy8gbm8gYnViYmxpbmcsIHNob3VsZCBhbHdheXMgZmlyZS4KICAgICAgLy8gdGhpcyBpcyBqdXN0IGEgc2FmZXR5IG5ldCBpbiBjYXNlIGV2ZW50LnRpbWVTdGFtcCBpcyB1bnJlbGlhYmxlIGluCiAgICAgIC8vIGNlcnRhaW4gd2VpcmQgZW52aXJvbm1lbnRzLi4uCiAgICAgIGUudGFyZ2V0ID09PSBlLmN1cnJlbnRUYXJnZXQgfHwKICAgICAgLy8gZXZlbnQgaXMgZmlyZWQgYWZ0ZXIgaGFuZGxlciBhdHRhY2htZW50CiAgICAgIGUudGltZVN0YW1wID49IGF0dGFjaGVkVGltZXN0YW1wXzEgfHwKICAgICAgLy8gYmFpbCBmb3IgZW52aXJvbm1lbnRzIHRoYXQgaGF2ZSBidWdneSBldmVudC50aW1lU3RhbXAgaW1wbGVtZW50YXRpb25zCiAgICAgIC8vICM5NDYyIGlPUyA5IGJ1ZzogZXZlbnQudGltZVN0YW1wIGlzIDAgYWZ0ZXIgaGlzdG9yeS5wdXNoU3RhdGUKICAgICAgLy8gIzk2ODEgUXRXZWJFbmdpbmUgZXZlbnQudGltZVN0YW1wIGlzIG5lZ2F0aXZlIHZhbHVlCiAgICAgIGUudGltZVN0YW1wIDw9IDAgfHwKICAgICAgLy8gIzk0NDggYmFpbCBpZiBldmVudCBpcyBmaXJlZCBpbiBhbm90aGVyIGRvY3VtZW50IGluIGEgbXVsdGktcGFnZQogICAgICAvLyBlbGVjdHJvbi9udy5qcyBhcHAsIHNpbmNlIGV2ZW50LnRpbWVTdGFtcCB3aWxsIGJlIHVzaW5nIGEgZGlmZmVyZW50CiAgICAgIC8vIHN0YXJ0aW5nIHJlZmVyZW5jZQogICAgICBlLnRhcmdldC5vd25lckRvY3VtZW50ICE9PSBkb2N1bWVudCkgewogICAgICAgIHJldHVybiBvcmlnaW5hbF8xLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KICAgIH07CiAgfQogIHRhcmdldC5hZGRFdmVudExpc3RlbmVyKG5hbWUsIGhhbmRsZXIsIHN1cHBvcnRzUGFzc2l2ZSA/IHsKICAgIGNhcHR1cmU6IGNhcHR1cmUsCiAgICBwYXNzaXZlOiBwYXNzaXZlCiAgfSA6IGNhcHR1cmUpOwp9CmZ1bmN0aW9uIHJlbW92ZShuYW1lLCBoYW5kbGVyLCBjYXB0dXJlLCBfdGFyZ2V0KSB7CiAgKF90YXJnZXQgfHwgdGFyZ2V0KS5yZW1vdmVFdmVudExpc3RlbmVyKG5hbWUsCiAgLy9AdHMtZXhwZWN0LWVycm9yCiAgaGFuZGxlci5fd3JhcHBlciB8fCBoYW5kbGVyLCBjYXB0dXJlKTsKfQpmdW5jdGlvbiB1cGRhdGVET01MaXN0ZW5lcnMob2xkVm5vZGUsIHZub2RlKSB7CiAgaWYgKGlzVW5kZWYob2xkVm5vZGUuZGF0YS5vbikgJiYgaXNVbmRlZih2bm9kZS5kYXRhLm9uKSkgewogICAgcmV0dXJuOwogIH0KICB2YXIgb24gPSB2bm9kZS5kYXRhLm9uIHx8IHt9OwogIHZhciBvbGRPbiA9IG9sZFZub2RlLmRhdGEub24gfHwge307CiAgLy8gdm5vZGUgaXMgZW1wdHkgd2hlbiByZW1vdmluZyBhbGwgbGlzdGVuZXJzLAogIC8vIGFuZCB1c2Ugb2xkIHZub2RlIGRvbSBlbGVtZW50CiAgdGFyZ2V0ID0gdm5vZGUuZWxtIHx8IG9sZFZub2RlLmVsbTsKICBub3JtYWxpemVFdmVudHMob24pOwogIHVwZGF0ZUxpc3RlbmVycyhvbiwgb2xkT24sIGFkZCwgcmVtb3ZlLCBjcmVhdGVPbmNlSGFuZGxlciwgdm5vZGUuY29udGV4dCk7CiAgdGFyZ2V0ID0gdW5kZWZpbmVkOwp9CnZhciBldmVudHMgPSB7CiAgY3JlYXRlOiB1cGRhdGVET01MaXN0ZW5lcnMsCiAgdXBkYXRlOiB1cGRhdGVET01MaXN0ZW5lcnMsCiAgLy8gQHRzLWV4cGVjdC1lcnJvciBlbXB0eU5vZGUgaGFzIGFjdHVhbGx5IGRhdGEKICBkZXN0cm95OiBmdW5jdGlvbiAodm5vZGUpIHsKICAgIHJldHVybiB1cGRhdGVET01MaXN0ZW5lcnModm5vZGUsIGVtcHR5Tm9kZSk7CiAgfQp9Owp2YXIgc3ZnQ29udGFpbmVyOwpmdW5jdGlvbiB1cGRhdGVET01Qcm9wcyhvbGRWbm9kZSwgdm5vZGUpIHsKICBpZiAoaXNVbmRlZihvbGRWbm9kZS5kYXRhLmRvbVByb3BzKSAmJiBpc1VuZGVmKHZub2RlLmRhdGEuZG9tUHJvcHMpKSB7CiAgICByZXR1cm47CiAgfQogIHZhciBrZXksIGN1cjsKICB2YXIgZWxtID0gdm5vZGUuZWxtOwogIHZhciBvbGRQcm9wcyA9IG9sZFZub2RlLmRhdGEuZG9tUHJvcHMgfHwge307CiAgdmFyIHByb3BzID0gdm5vZGUuZGF0YS5kb21Qcm9wcyB8fCB7fTsKICAvLyBjbG9uZSBvYnNlcnZlZCBvYmplY3RzLCBhcyB0aGUgdXNlciBwcm9iYWJseSB3YW50cyB0byBtdXRhdGUgaXQKICBpZiAoaXNEZWYocHJvcHMuX19vYl9fKSB8fCBpc1RydWUocHJvcHMuX3ZfYXR0cl9wcm94eSkpIHsKICAgIHByb3BzID0gdm5vZGUuZGF0YS5kb21Qcm9wcyA9IGV4dGVuZCh7fSwgcHJvcHMpOwogIH0KICBmb3IgKGtleSBpbiBvbGRQcm9wcykgewogICAgaWYgKCEoa2V5IGluIHByb3BzKSkgewogICAgICBlbG1ba2V5XSA9ICcnOwogICAgfQogIH0KICBmb3IgKGtleSBpbiBwcm9wcykgewogICAgY3VyID0gcHJvcHNba2V5XTsKICAgIC8vIGlnbm9yZSBjaGlsZHJlbiBpZiB0aGUgbm9kZSBoYXMgdGV4dENvbnRlbnQgb3IgaW5uZXJIVE1MLAogICAgLy8gYXMgdGhlc2Ugd2lsbCB0aHJvdyBhd2F5IGV4aXN0aW5nIERPTSBub2RlcyBhbmQgY2F1c2UgcmVtb3ZhbCBlcnJvcnMKICAgIC8vIG9uIHN1YnNlcXVlbnQgcGF0Y2hlcyAoIzMzNjApCiAgICBpZiAoa2V5ID09PSAndGV4dENvbnRlbnQnIHx8IGtleSA9PT0gJ2lubmVySFRNTCcpIHsKICAgICAgaWYgKHZub2RlLmNoaWxkcmVuKSB2bm9kZS5jaGlsZHJlbi5sZW5ndGggPSAwOwogICAgICBpZiAoY3VyID09PSBvbGRQcm9wc1trZXldKSBjb250aW51ZTsKICAgICAgLy8gIzY2MDEgd29yayBhcm91bmQgQ2hyb21lIHZlcnNpb24gPD0gNTUgYnVnIHdoZXJlIHNpbmdsZSB0ZXh0Tm9kZQogICAgICAvLyByZXBsYWNlZCBieSBpbm5lckhUTUwvdGV4dENvbnRlbnQgcmV0YWlucyBpdHMgcGFyZW50Tm9kZSBwcm9wZXJ0eQogICAgICBpZiAoZWxtLmNoaWxkTm9kZXMubGVuZ3RoID09PSAxKSB7CiAgICAgICAgZWxtLnJlbW92ZUNoaWxkKGVsbS5jaGlsZE5vZGVzWzBdKTsKICAgICAgfQogICAgfQogICAgaWYgKGtleSA9PT0gJ3ZhbHVlJyAmJiBlbG0udGFnTmFtZSAhPT0gJ1BST0dSRVNTJykgewogICAgICAvLyBzdG9yZSB2YWx1ZSBhcyBfdmFsdWUgYXMgd2VsbCBzaW5jZQogICAgICAvLyBub24tc3RyaW5nIHZhbHVlcyB3aWxsIGJlIHN0cmluZ2lmaWVkCiAgICAgIGVsbS5fdmFsdWUgPSBjdXI7CiAgICAgIC8vIGF2b2lkIHJlc2V0dGluZyBjdXJzb3IgcG9zaXRpb24gd2hlbiB2YWx1ZSBpcyB0aGUgc2FtZQogICAgICB2YXIgc3RyQ3VyID0gaXNVbmRlZihjdXIpID8gJycgOiBTdHJpbmcoY3VyKTsKICAgICAgaWYgKHNob3VsZFVwZGF0ZVZhbHVlKGVsbSwgc3RyQ3VyKSkgewogICAgICAgIGVsbS52YWx1ZSA9IHN0ckN1cjsKICAgICAgfQogICAgfSBlbHNlIGlmIChrZXkgPT09ICdpbm5lckhUTUwnICYmIGlzU1ZHKGVsbS50YWdOYW1lKSAmJiBpc1VuZGVmKGVsbS5pbm5lckhUTUwpKSB7CiAgICAgIC8vIElFIGRvZXNuJ3Qgc3VwcG9ydCBpbm5lckhUTUwgZm9yIFNWRyBlbGVtZW50cwogICAgICBzdmdDb250YWluZXIgPSBzdmdDb250YWluZXIgfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgIHN2Z0NvbnRhaW5lci5pbm5lckhUTUwgPSAiPHN2Zz4iLmNvbmNhdChjdXIsICI8L3N2Zz4iKTsKICAgICAgdmFyIHN2ZyA9IHN2Z0NvbnRhaW5lci5maXJzdENoaWxkOwogICAgICB3aGlsZSAoZWxtLmZpcnN0Q2hpbGQpIHsKICAgICAgICBlbG0ucmVtb3ZlQ2hpbGQoZWxtLmZpcnN0Q2hpbGQpOwogICAgICB9CiAgICAgIHdoaWxlIChzdmcuZmlyc3RDaGlsZCkgewogICAgICAgIGVsbS5hcHBlbmRDaGlsZChzdmcuZmlyc3RDaGlsZCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoCiAgICAvLyBza2lwIHRoZSB1cGRhdGUgaWYgb2xkIGFuZCBuZXcgVkRPTSBzdGF0ZSBpcyB0aGUgc2FtZS4KICAgIC8vIGB2YWx1ZWAgaXMgaGFuZGxlZCBzZXBhcmF0ZWx5IGJlY2F1c2UgdGhlIERPTSB2YWx1ZSBtYXkgYmUgdGVtcG9yYXJpbHkKICAgIC8vIG91dCBvZiBzeW5jIHdpdGggVkRPTSBzdGF0ZSBkdWUgdG8gZm9jdXMsIGNvbXBvc2l0aW9uIGFuZCBtb2RpZmllcnMuCiAgICAvLyBUaGlzICAjNDUyMSBieSBza2lwcGluZyB0aGUgdW5uZWNlc3NhcnkgYGNoZWNrZWRgIHVwZGF0ZS4KICAgIGN1ciAhPT0gb2xkUHJvcHNba2V5XSkgewogICAgICAvLyBzb21lIHByb3BlcnR5IHVwZGF0ZXMgY2FuIHRocm93CiAgICAgIC8vIGUuZy4gYHZhbHVlYCBvbiA8cHJvZ3Jlc3M+IHcvIG5vbi1maW5pdGUgdmFsdWUKICAgICAgdHJ5IHsKICAgICAgICBlbG1ba2V5XSA9IGN1cjsKICAgICAgfSBjYXRjaCAoZSkge30KICAgIH0KICB9Cn0KZnVuY3Rpb24gc2hvdWxkVXBkYXRlVmFsdWUoZWxtLCBjaGVja1ZhbCkgewogIHJldHVybiAoCiAgICAvL0B0cy1leHBlY3QtZXJyb3IKICAgICFlbG0uY29tcG9zaW5nICYmIChlbG0udGFnTmFtZSA9PT0gJ09QVElPTicgfHwgaXNOb3RJbkZvY3VzQW5kRGlydHkoZWxtLCBjaGVja1ZhbCkgfHwgaXNEaXJ0eVdpdGhNb2RpZmllcnMoZWxtLCBjaGVja1ZhbCkpCiAgKTsKfQpmdW5jdGlvbiBpc05vdEluRm9jdXNBbmREaXJ0eShlbG0sIGNoZWNrVmFsKSB7CiAgLy8gcmV0dXJuIHRydWUgd2hlbiB0ZXh0Ym94ICgubnVtYmVyIGFuZCAudHJpbSkgbG9zZXMgZm9jdXMgYW5kIGl0cyB2YWx1ZSBpcwogIC8vIG5vdCBlcXVhbCB0byB0aGUgdXBkYXRlZCB2YWx1ZQogIHZhciBub3RJbkZvY3VzID0gdHJ1ZTsKICAvLyAjNjE1NwogIC8vIHdvcmsgYXJvdW5kIElFIGJ1ZyB3aGVuIGFjY2Vzc2luZyBkb2N1bWVudC5hY3RpdmVFbGVtZW50IGluIGFuIGlmcmFtZQogIHRyeSB7CiAgICBub3RJbkZvY3VzID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAhPT0gZWxtOwogIH0gY2F0Y2ggKGUpIHt9CiAgcmV0dXJuIG5vdEluRm9jdXMgJiYgZWxtLnZhbHVlICE9PSBjaGVja1ZhbDsKfQpmdW5jdGlvbiBpc0RpcnR5V2l0aE1vZGlmaWVycyhlbG0sIG5ld1ZhbCkgewogIHZhciB2YWx1ZSA9IGVsbS52YWx1ZTsKICB2YXIgbW9kaWZpZXJzID0gZWxtLl92TW9kaWZpZXJzOyAvLyBpbmplY3RlZCBieSB2LW1vZGVsIHJ1bnRpbWUKICBpZiAoaXNEZWYobW9kaWZpZXJzKSkgewogICAgaWYgKG1vZGlmaWVycy5udW1iZXIpIHsKICAgICAgcmV0dXJuIHRvTnVtYmVyKHZhbHVlKSAhPT0gdG9OdW1iZXIobmV3VmFsKTsKICAgIH0KICAgIGlmIChtb2RpZmllcnMudHJpbSkgewogICAgICByZXR1cm4gdmFsdWUudHJpbSgpICE9PSBuZXdWYWwudHJpbSgpOwogICAgfQogIH0KICByZXR1cm4gdmFsdWUgIT09IG5ld1ZhbDsKfQp2YXIgZG9tUHJvcHMgPSB7CiAgY3JlYXRlOiB1cGRhdGVET01Qcm9wcywKICB1cGRhdGU6IHVwZGF0ZURPTVByb3BzCn07CnZhciBwYXJzZVN0eWxlVGV4dCA9IGNhY2hlZChmdW5jdGlvbiAoY3NzVGV4dCkgewogIHZhciByZXMgPSB7fTsKICB2YXIgbGlzdERlbGltaXRlciA9IC87KD8hW14oXSpcKSkvZzsKICB2YXIgcHJvcGVydHlEZWxpbWl0ZXIgPSAvOiguKykvOwogIGNzc1RleHQuc3BsaXQobGlzdERlbGltaXRlcikuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgaWYgKGl0ZW0pIHsKICAgICAgdmFyIHRtcCA9IGl0ZW0uc3BsaXQocHJvcGVydHlEZWxpbWl0ZXIpOwogICAgICB0bXAubGVuZ3RoID4gMSAmJiAocmVzW3RtcFswXS50cmltKCldID0gdG1wWzFdLnRyaW0oKSk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIHJlczsKfSk7Ci8vIG1lcmdlIHN0YXRpYyBhbmQgZHluYW1pYyBzdHlsZSBkYXRhIG9uIHRoZSBzYW1lIHZub2RlCmZ1bmN0aW9uIG5vcm1hbGl6ZVN0eWxlRGF0YShkYXRhKSB7CiAgdmFyIHN0eWxlID0gbm9ybWFsaXplU3R5bGVCaW5kaW5nKGRhdGEuc3R5bGUpOwogIC8vIHN0YXRpYyBzdHlsZSBpcyBwcmUtcHJvY2Vzc2VkIGludG8gYW4gb2JqZWN0IGR1cmluZyBjb21waWxhdGlvbgogIC8vIGFuZCBpcyBhbHdheXMgYSBmcmVzaCBvYmplY3QsIHNvIGl0J3Mgc2FmZSB0byBtZXJnZSBpbnRvIGl0CiAgcmV0dXJuIGRhdGEuc3RhdGljU3R5bGUgPyBleHRlbmQoZGF0YS5zdGF0aWNTdHlsZSwgc3R5bGUpIDogc3R5bGU7Cn0KLy8gbm9ybWFsaXplIHBvc3NpYmxlIGFycmF5IC8gc3RyaW5nIHZhbHVlcyBpbnRvIE9iamVjdApmdW5jdGlvbiBub3JtYWxpemVTdHlsZUJpbmRpbmcoYmluZGluZ1N0eWxlKSB7CiAgaWYgKEFycmF5LmlzQXJyYXkoYmluZGluZ1N0eWxlKSkgewogICAgcmV0dXJuIHRvT2JqZWN0KGJpbmRpbmdTdHlsZSk7CiAgfQogIGlmICh0eXBlb2YgYmluZGluZ1N0eWxlID09PSAnc3RyaW5nJykgewogICAgcmV0dXJuIHBhcnNlU3R5bGVUZXh0KGJpbmRpbmdTdHlsZSk7CiAgfQogIHJldHVybiBiaW5kaW5nU3R5bGU7Cn0KLyoqCiAqIHBhcmVudCBjb21wb25lbnQgc3R5bGUgc2hvdWxkIGJlIGFmdGVyIGNoaWxkJ3MKICogc28gdGhhdCBwYXJlbnQgY29tcG9uZW50J3Mgc3R5bGUgY291bGQgb3ZlcnJpZGUgaXQKICovCmZ1bmN0aW9uIGdldFN0eWxlKHZub2RlLCBjaGVja0NoaWxkKSB7CiAgdmFyIHJlcyA9IHt9OwogIHZhciBzdHlsZURhdGE7CiAgaWYgKGNoZWNrQ2hpbGQpIHsKICAgIHZhciBjaGlsZE5vZGUgPSB2bm9kZTsKICAgIHdoaWxlIChjaGlsZE5vZGUuY29tcG9uZW50SW5zdGFuY2UpIHsKICAgICAgY2hpbGROb2RlID0gY2hpbGROb2RlLmNvbXBvbmVudEluc3RhbmNlLl92bm9kZTsKICAgICAgaWYgKGNoaWxkTm9kZSAmJiBjaGlsZE5vZGUuZGF0YSAmJiAoc3R5bGVEYXRhID0gbm9ybWFsaXplU3R5bGVEYXRhKGNoaWxkTm9kZS5kYXRhKSkpIHsKICAgICAgICBleHRlbmQocmVzLCBzdHlsZURhdGEpOwogICAgICB9CiAgICB9CiAgfQogIGlmIChzdHlsZURhdGEgPSBub3JtYWxpemVTdHlsZURhdGEodm5vZGUuZGF0YSkpIHsKICAgIGV4dGVuZChyZXMsIHN0eWxlRGF0YSk7CiAgfQogIHZhciBwYXJlbnROb2RlID0gdm5vZGU7CiAgLy8gQHRzLWV4cGVjdC1lcnJvciBwYXJlbnROb2RlLnBhcmVudCBub3QgVk5vZGVXaXRoRGF0YQogIHdoaWxlIChwYXJlbnROb2RlID0gcGFyZW50Tm9kZS5wYXJlbnQpIHsKICAgIGlmIChwYXJlbnROb2RlLmRhdGEgJiYgKHN0eWxlRGF0YSA9IG5vcm1hbGl6ZVN0eWxlRGF0YShwYXJlbnROb2RlLmRhdGEpKSkgewogICAgICBleHRlbmQocmVzLCBzdHlsZURhdGEpOwogICAgfQogIH0KICByZXR1cm4gcmVzOwp9CnZhciBjc3NWYXJSRSA9IC9eLS0vOwp2YXIgaW1wb3J0YW50UkUgPSAvXHMqIWltcG9ydGFudCQvOwp2YXIgc2V0UHJvcCA9IGZ1bmN0aW9uIChlbCwgbmFtZSwgdmFsKSB7CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKGNzc1ZhclJFLnRlc3QobmFtZSkpIHsKICAgIGVsLnN0eWxlLnNldFByb3BlcnR5KG5hbWUsIHZhbCk7CiAgfSBlbHNlIGlmIChpbXBvcnRhbnRSRS50ZXN0KHZhbCkpIHsKICAgIGVsLnN0eWxlLnNldFByb3BlcnR5KGh5cGhlbmF0ZShuYW1lKSwgdmFsLnJlcGxhY2UoaW1wb3J0YW50UkUsICcnKSwgJ2ltcG9ydGFudCcpOwogIH0gZWxzZSB7CiAgICB2YXIgbm9ybWFsaXplZE5hbWUgPSBub3JtYWxpemUobmFtZSk7CiAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWwpKSB7CiAgICAgIC8vIFN1cHBvcnQgdmFsdWVzIGFycmF5IGNyZWF0ZWQgYnkgYXV0b3ByZWZpeGVyLCBlLmcuCiAgICAgIC8vIHtkaXNwbGF5OiBbIi13ZWJraXQtYm94IiwgIi1tcy1mbGV4Ym94IiwgImZsZXgiXX0KICAgICAgLy8gU2V0IHRoZW0gb25lIGJ5IG9uZSwgYW5kIHRoZSBicm93c2VyIHdpbGwgb25seSBzZXQgdGhvc2UgaXQgY2FuIHJlY29nbml6ZQogICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdmFsLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgZWwuc3R5bGVbbm9ybWFsaXplZE5hbWVdID0gdmFsW2ldOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBlbC5zdHlsZVtub3JtYWxpemVkTmFtZV0gPSB2YWw7CiAgICB9CiAgfQp9Owp2YXIgdmVuZG9yTmFtZXMgPSBbJ1dlYmtpdCcsICdNb3onLCAnbXMnXTsKdmFyIGVtcHR5U3R5bGU7CnZhciBub3JtYWxpemUgPSBjYWNoZWQoZnVuY3Rpb24gKHByb3ApIHsKICBlbXB0eVN0eWxlID0gZW1wdHlTdHlsZSB8fCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKS5zdHlsZTsKICBwcm9wID0gY2FtZWxpemUocHJvcCk7CiAgaWYgKHByb3AgIT09ICdmaWx0ZXInICYmIHByb3AgaW4gZW1wdHlTdHlsZSkgewogICAgcmV0dXJuIHByb3A7CiAgfQogIHZhciBjYXBOYW1lID0gcHJvcC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHByb3Auc2xpY2UoMSk7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCB2ZW5kb3JOYW1lcy5sZW5ndGg7IGkrKykgewogICAgdmFyIG5hbWVfMSA9IHZlbmRvck5hbWVzW2ldICsgY2FwTmFtZTsKICAgIGlmIChuYW1lXzEgaW4gZW1wdHlTdHlsZSkgewogICAgICByZXR1cm4gbmFtZV8xOwogICAgfQogIH0KfSk7CmZ1bmN0aW9uIHVwZGF0ZVN0eWxlKG9sZFZub2RlLCB2bm9kZSkgewogIHZhciBkYXRhID0gdm5vZGUuZGF0YTsKICB2YXIgb2xkRGF0YSA9IG9sZFZub2RlLmRhdGE7CiAgaWYgKGlzVW5kZWYoZGF0YS5zdGF0aWNTdHlsZSkgJiYgaXNVbmRlZihkYXRhLnN0eWxlKSAmJiBpc1VuZGVmKG9sZERhdGEuc3RhdGljU3R5bGUpICYmIGlzVW5kZWYob2xkRGF0YS5zdHlsZSkpIHsKICAgIHJldHVybjsKICB9CiAgdmFyIGN1ciwgbmFtZTsKICB2YXIgZWwgPSB2bm9kZS5lbG07CiAgdmFyIG9sZFN0YXRpY1N0eWxlID0gb2xkRGF0YS5zdGF0aWNTdHlsZTsKICB2YXIgb2xkU3R5bGVCaW5kaW5nID0gb2xkRGF0YS5ub3JtYWxpemVkU3R5bGUgfHwgb2xkRGF0YS5zdHlsZSB8fCB7fTsKICAvLyBpZiBzdGF0aWMgc3R5bGUgZXhpc3RzLCBzdHlsZWJpbmRpbmcgYWxyZWFkeSBtZXJnZWQgaW50byBpdCB3aGVuIGRvaW5nIG5vcm1hbGl6ZVN0eWxlRGF0YQogIHZhciBvbGRTdHlsZSA9IG9sZFN0YXRpY1N0eWxlIHx8IG9sZFN0eWxlQmluZGluZzsKICB2YXIgc3R5bGUgPSBub3JtYWxpemVTdHlsZUJpbmRpbmcodm5vZGUuZGF0YS5zdHlsZSkgfHwge307CiAgLy8gc3RvcmUgbm9ybWFsaXplZCBzdHlsZSB1bmRlciBhIGRpZmZlcmVudCBrZXkgZm9yIG5leHQgZGlmZgogIC8vIG1ha2Ugc3VyZSB0byBjbG9uZSBpdCBpZiBpdCdzIHJlYWN0aXZlLCBzaW5jZSB0aGUgdXNlciBsaWtlbHkgd2FudHMKICAvLyB0byBtdXRhdGUgaXQuCiAgdm5vZGUuZGF0YS5ub3JtYWxpemVkU3R5bGUgPSBpc0RlZihzdHlsZS5fX29iX18pID8gZXh0ZW5kKHt9LCBzdHlsZSkgOiBzdHlsZTsKICB2YXIgbmV3U3R5bGUgPSBnZXRTdHlsZSh2bm9kZSwgdHJ1ZSk7CiAgZm9yIChuYW1lIGluIG9sZFN0eWxlKSB7CiAgICBpZiAoaXNVbmRlZihuZXdTdHlsZVtuYW1lXSkpIHsKICAgICAgc2V0UHJvcChlbCwgbmFtZSwgJycpOwogICAgfQogIH0KICBmb3IgKG5hbWUgaW4gbmV3U3R5bGUpIHsKICAgIGN1ciA9IG5ld1N0eWxlW25hbWVdOwogICAgLy8gaWU5IHNldHRpbmcgdG8gbnVsbCBoYXMgbm8gZWZmZWN0LCBtdXN0IHVzZSBlbXB0eSBzdHJpbmcKICAgIHNldFByb3AoZWwsIG5hbWUsIGN1ciA9PSBudWxsID8gJycgOiBjdXIpOwogIH0KfQp2YXIgc3R5bGUgPSB7CiAgY3JlYXRlOiB1cGRhdGVTdHlsZSwKICB1cGRhdGU6IHVwZGF0ZVN0eWxlCn07CnZhciB3aGl0ZXNwYWNlUkUgPSAvXHMrLzsKLyoqCiAqIEFkZCBjbGFzcyB3aXRoIGNvbXBhdGliaWxpdHkgZm9yIFNWRyBzaW5jZSBjbGFzc0xpc3QgaXMgbm90IHN1cHBvcnRlZCBvbgogKiBTVkcgZWxlbWVudHMgaW4gSUUKICovCmZ1bmN0aW9uIGFkZENsYXNzKGVsLCBjbHMpIHsKICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICBpZiAoIWNscyB8fCAhKGNscyA9IGNscy50cmltKCkpKSB7CiAgICByZXR1cm47CiAgfQogIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovCiAgaWYgKGVsLmNsYXNzTGlzdCkgewogICAgaWYgKGNscy5pbmRleE9mKCcgJykgPiAtMSkgewogICAgICBjbHMuc3BsaXQod2hpdGVzcGFjZVJFKS5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgcmV0dXJuIGVsLmNsYXNzTGlzdC5hZGQoYyk7CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgZWwuY2xhc3NMaXN0LmFkZChjbHMpOwogICAgfQogIH0gZWxzZSB7CiAgICB2YXIgY3VyID0gIiAiLmNvbmNhdChlbC5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykgfHwgJycsICIgIik7CiAgICBpZiAoY3VyLmluZGV4T2YoJyAnICsgY2xzICsgJyAnKSA8IDApIHsKICAgICAgZWwuc2V0QXR0cmlidXRlKCdjbGFzcycsIChjdXIgKyBjbHMpLnRyaW0oKSk7CiAgICB9CiAgfQp9Ci8qKgogKiBSZW1vdmUgY2xhc3Mgd2l0aCBjb21wYXRpYmlsaXR5IGZvciBTVkcgc2luY2UgY2xhc3NMaXN0IGlzIG5vdCBzdXBwb3J0ZWQgb24KICogU1ZHIGVsZW1lbnRzIGluIElFCiAqLwpmdW5jdGlvbiByZW1vdmVDbGFzcyhlbCwgY2xzKSB7CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKCFjbHMgfHwgIShjbHMgPSBjbHMudHJpbSgpKSkgewogICAgcmV0dXJuOwogIH0KICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqLwogIGlmIChlbC5jbGFzc0xpc3QpIHsKICAgIGlmIChjbHMuaW5kZXhPZignICcpID4gLTEpIHsKICAgICAgY2xzLnNwbGl0KHdoaXRlc3BhY2VSRSkuZm9yRWFjaChmdW5jdGlvbiAoYykgewogICAgICAgIHJldHVybiBlbC5jbGFzc0xpc3QucmVtb3ZlKGMpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoY2xzKTsKICAgIH0KICAgIGlmICghZWwuY2xhc3NMaXN0Lmxlbmd0aCkgewogICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoJ2NsYXNzJyk7CiAgICB9CiAgfSBlbHNlIHsKICAgIHZhciBjdXIgPSAiICIuY29uY2F0KGVsLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSB8fCAnJywgIiAiKTsKICAgIHZhciB0YXIgPSAnICcgKyBjbHMgKyAnICc7CiAgICB3aGlsZSAoY3VyLmluZGV4T2YodGFyKSA+PSAwKSB7CiAgICAgIGN1ciA9IGN1ci5yZXBsYWNlKHRhciwgJyAnKTsKICAgIH0KICAgIGN1ciA9IGN1ci50cmltKCk7CiAgICBpZiAoY3VyKSB7CiAgICAgIGVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBjdXIpOwogICAgfSBlbHNlIHsKICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKCdjbGFzcycpOwogICAgfQogIH0KfQpmdW5jdGlvbiByZXNvbHZlVHJhbnNpdGlvbihkZWYpIHsKICBpZiAoIWRlZikgewogICAgcmV0dXJuOwogIH0KICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqLwogIGlmICh0eXBlb2YgZGVmID09PSAnb2JqZWN0JykgewogICAgdmFyIHJlcyA9IHt9OwogICAgaWYgKGRlZi5jc3MgIT09IGZhbHNlKSB7CiAgICAgIGV4dGVuZChyZXMsIGF1dG9Dc3NUcmFuc2l0aW9uKGRlZi5uYW1lIHx8ICd2JykpOwogICAgfQogICAgZXh0ZW5kKHJlcywgZGVmKTsKICAgIHJldHVybiByZXM7CiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmID09PSAnc3RyaW5nJykgewogICAgcmV0dXJuIGF1dG9Dc3NUcmFuc2l0aW9uKGRlZik7CiAgfQp9CnZhciBhdXRvQ3NzVHJhbnNpdGlvbiA9IGNhY2hlZChmdW5jdGlvbiAobmFtZSkgewogIHJldHVybiB7CiAgICBlbnRlckNsYXNzOiAiIi5jb25jYXQobmFtZSwgIi1lbnRlciIpLAogICAgZW50ZXJUb0NsYXNzOiAiIi5jb25jYXQobmFtZSwgIi1lbnRlci10byIpLAogICAgZW50ZXJBY3RpdmVDbGFzczogIiIuY29uY2F0KG5hbWUsICItZW50ZXItYWN0aXZlIiksCiAgICBsZWF2ZUNsYXNzOiAiIi5jb25jYXQobmFtZSwgIi1sZWF2ZSIpLAogICAgbGVhdmVUb0NsYXNzOiAiIi5jb25jYXQobmFtZSwgIi1sZWF2ZS10byIpLAogICAgbGVhdmVBY3RpdmVDbGFzczogIiIuY29uY2F0KG5hbWUsICItbGVhdmUtYWN0aXZlIikKICB9Owp9KTsKdmFyIGhhc1RyYW5zaXRpb24gPSBpbkJyb3dzZXIgJiYgIWlzSUU5Owp2YXIgVFJBTlNJVElPTiA9ICd0cmFuc2l0aW9uJzsKdmFyIEFOSU1BVElPTiA9ICdhbmltYXRpb24nOwovLyBUcmFuc2l0aW9uIHByb3BlcnR5L2V2ZW50IHNuaWZmaW5nCnZhciB0cmFuc2l0aW9uUHJvcCA9ICd0cmFuc2l0aW9uJzsKdmFyIHRyYW5zaXRpb25FbmRFdmVudCA9ICd0cmFuc2l0aW9uZW5kJzsKdmFyIGFuaW1hdGlvblByb3AgPSAnYW5pbWF0aW9uJzsKdmFyIGFuaW1hdGlvbkVuZEV2ZW50ID0gJ2FuaW1hdGlvbmVuZCc7CmlmIChoYXNUcmFuc2l0aW9uKSB7CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKHdpbmRvdy5vbnRyYW5zaXRpb25lbmQgPT09IHVuZGVmaW5lZCAmJiB3aW5kb3cub253ZWJraXR0cmFuc2l0aW9uZW5kICE9PSB1bmRlZmluZWQpIHsKICAgIHRyYW5zaXRpb25Qcm9wID0gJ1dlYmtpdFRyYW5zaXRpb24nOwogICAgdHJhbnNpdGlvbkVuZEV2ZW50ID0gJ3dlYmtpdFRyYW5zaXRpb25FbmQnOwogIH0KICBpZiAod2luZG93Lm9uYW5pbWF0aW9uZW5kID09PSB1bmRlZmluZWQgJiYgd2luZG93Lm9ud2Via2l0YW5pbWF0aW9uZW5kICE9PSB1bmRlZmluZWQpIHsKICAgIGFuaW1hdGlvblByb3AgPSAnV2Via2l0QW5pbWF0aW9uJzsKICAgIGFuaW1hdGlvbkVuZEV2ZW50ID0gJ3dlYmtpdEFuaW1hdGlvbkVuZCc7CiAgfQp9Ci8vIGJpbmRpbmcgdG8gd2luZG93IGlzIG5lY2Vzc2FyeSB0byBtYWtlIGhvdCByZWxvYWQgd29yayBpbiBJRSBpbiBzdHJpY3QgbW9kZQp2YXIgcmFmID0gaW5Ccm93c2VyID8gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSA/IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUuYmluZCh3aW5kb3cpIDogc2V0VGltZW91dCA6IC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovZnVuY3Rpb24gKC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovZm4pIHsKICByZXR1cm4gZm4oKTsKfTsKZnVuY3Rpb24gbmV4dEZyYW1lKGZuKSB7CiAgcmFmKGZ1bmN0aW9uICgpIHsKICAgIC8vIEB0cy1leHBlY3QtZXJyb3IKICAgIHJhZihmbik7CiAgfSk7Cn0KZnVuY3Rpb24gYWRkVHJhbnNpdGlvbkNsYXNzKGVsLCBjbHMpIHsKICB2YXIgdHJhbnNpdGlvbkNsYXNzZXMgPSBlbC5fdHJhbnNpdGlvbkNsYXNzZXMgfHwgKGVsLl90cmFuc2l0aW9uQ2xhc3NlcyA9IFtdKTsKICBpZiAodHJhbnNpdGlvbkNsYXNzZXMuaW5kZXhPZihjbHMpIDwgMCkgewogICAgdHJhbnNpdGlvbkNsYXNzZXMucHVzaChjbHMpOwogICAgYWRkQ2xhc3MoZWwsIGNscyk7CiAgfQp9CmZ1bmN0aW9uIHJlbW92ZVRyYW5zaXRpb25DbGFzcyhlbCwgY2xzKSB7CiAgaWYgKGVsLl90cmFuc2l0aW9uQ2xhc3NlcykgewogICAgcmVtb3ZlJDIoZWwuX3RyYW5zaXRpb25DbGFzc2VzLCBjbHMpOwogIH0KICByZW1vdmVDbGFzcyhlbCwgY2xzKTsKfQpmdW5jdGlvbiB3aGVuVHJhbnNpdGlvbkVuZHMoZWwsIGV4cGVjdGVkVHlwZSwgY2IpIHsKICB2YXIgX2EgPSBnZXRUcmFuc2l0aW9uSW5mbyhlbCwgZXhwZWN0ZWRUeXBlKSwKICAgIHR5cGUgPSBfYS50eXBlLAogICAgdGltZW91dCA9IF9hLnRpbWVvdXQsCiAgICBwcm9wQ291bnQgPSBfYS5wcm9wQ291bnQ7CiAgaWYgKCF0eXBlKSByZXR1cm4gY2IoKTsKICB2YXIgZXZlbnQgPSB0eXBlID09PSBUUkFOU0lUSU9OID8gdHJhbnNpdGlvbkVuZEV2ZW50IDogYW5pbWF0aW9uRW5kRXZlbnQ7CiAgdmFyIGVuZGVkID0gMDsKICB2YXIgZW5kID0gZnVuY3Rpb24gKCkgewogICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgb25FbmQpOwogICAgY2IoKTsKICB9OwogIHZhciBvbkVuZCA9IGZ1bmN0aW9uIChlKSB7CiAgICBpZiAoZS50YXJnZXQgPT09IGVsKSB7CiAgICAgIGlmICgrK2VuZGVkID49IHByb3BDb3VudCkgewogICAgICAgIGVuZCgpOwogICAgICB9CiAgICB9CiAgfTsKICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgIGlmIChlbmRlZCA8IHByb3BDb3VudCkgewogICAgICBlbmQoKTsKICAgIH0KICB9LCB0aW1lb3V0ICsgMSk7CiAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgb25FbmQpOwp9CnZhciB0cmFuc2Zvcm1SRSA9IC9cYih0cmFuc2Zvcm18YWxsKSgsfCQpLzsKZnVuY3Rpb24gZ2V0VHJhbnNpdGlvbkluZm8oZWwsIGV4cGVjdGVkVHlwZSkgewogIHZhciBzdHlsZXMgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbCk7CiAgLy8gSlNET00gbWF5IHJldHVybiB1bmRlZmluZWQgZm9yIHRyYW5zaXRpb24gcHJvcGVydGllcwogIHZhciB0cmFuc2l0aW9uRGVsYXlzID0gKHN0eWxlc1t0cmFuc2l0aW9uUHJvcCArICdEZWxheSddIHx8ICcnKS5zcGxpdCgnLCAnKTsKICB2YXIgdHJhbnNpdGlvbkR1cmF0aW9ucyA9IChzdHlsZXNbdHJhbnNpdGlvblByb3AgKyAnRHVyYXRpb24nXSB8fCAnJykuc3BsaXQoJywgJyk7CiAgdmFyIHRyYW5zaXRpb25UaW1lb3V0ID0gZ2V0VGltZW91dCh0cmFuc2l0aW9uRGVsYXlzLCB0cmFuc2l0aW9uRHVyYXRpb25zKTsKICB2YXIgYW5pbWF0aW9uRGVsYXlzID0gKHN0eWxlc1thbmltYXRpb25Qcm9wICsgJ0RlbGF5J10gfHwgJycpLnNwbGl0KCcsICcpOwogIHZhciBhbmltYXRpb25EdXJhdGlvbnMgPSAoc3R5bGVzW2FuaW1hdGlvblByb3AgKyAnRHVyYXRpb24nXSB8fCAnJykuc3BsaXQoJywgJyk7CiAgdmFyIGFuaW1hdGlvblRpbWVvdXQgPSBnZXRUaW1lb3V0KGFuaW1hdGlvbkRlbGF5cywgYW5pbWF0aW9uRHVyYXRpb25zKTsKICB2YXIgdHlwZTsKICB2YXIgdGltZW91dCA9IDA7CiAgdmFyIHByb3BDb3VudCA9IDA7CiAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgaWYgKGV4cGVjdGVkVHlwZSA9PT0gVFJBTlNJVElPTikgewogICAgaWYgKHRyYW5zaXRpb25UaW1lb3V0ID4gMCkgewogICAgICB0eXBlID0gVFJBTlNJVElPTjsKICAgICAgdGltZW91dCA9IHRyYW5zaXRpb25UaW1lb3V0OwogICAgICBwcm9wQ291bnQgPSB0cmFuc2l0aW9uRHVyYXRpb25zLmxlbmd0aDsKICAgIH0KICB9IGVsc2UgaWYgKGV4cGVjdGVkVHlwZSA9PT0gQU5JTUFUSU9OKSB7CiAgICBpZiAoYW5pbWF0aW9uVGltZW91dCA+IDApIHsKICAgICAgdHlwZSA9IEFOSU1BVElPTjsKICAgICAgdGltZW91dCA9IGFuaW1hdGlvblRpbWVvdXQ7CiAgICAgIHByb3BDb3VudCA9IGFuaW1hdGlvbkR1cmF0aW9ucy5sZW5ndGg7CiAgICB9CiAgfSBlbHNlIHsKICAgIHRpbWVvdXQgPSBNYXRoLm1heCh0cmFuc2l0aW9uVGltZW91dCwgYW5pbWF0aW9uVGltZW91dCk7CiAgICB0eXBlID0gdGltZW91dCA+IDAgPyB0cmFuc2l0aW9uVGltZW91dCA+IGFuaW1hdGlvblRpbWVvdXQgPyBUUkFOU0lUSU9OIDogQU5JTUFUSU9OIDogbnVsbDsKICAgIHByb3BDb3VudCA9IHR5cGUgPyB0eXBlID09PSBUUkFOU0lUSU9OID8gdHJhbnNpdGlvbkR1cmF0aW9ucy5sZW5ndGggOiBhbmltYXRpb25EdXJhdGlvbnMubGVuZ3RoIDogMDsKICB9CiAgdmFyIGhhc1RyYW5zZm9ybSA9IHR5cGUgPT09IFRSQU5TSVRJT04gJiYgdHJhbnNmb3JtUkUudGVzdChzdHlsZXNbdHJhbnNpdGlvblByb3AgKyAnUHJvcGVydHknXSk7CiAgcmV0dXJuIHsKICAgIHR5cGU6IHR5cGUsCiAgICB0aW1lb3V0OiB0aW1lb3V0LAogICAgcHJvcENvdW50OiBwcm9wQ291bnQsCiAgICBoYXNUcmFuc2Zvcm06IGhhc1RyYW5zZm9ybQogIH07Cn0KZnVuY3Rpb24gZ2V0VGltZW91dChkZWxheXMsIGR1cmF0aW9ucykgewogIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgd2hpbGUgKGRlbGF5cy5sZW5ndGggPCBkdXJhdGlvbnMubGVuZ3RoKSB7CiAgICBkZWxheXMgPSBkZWxheXMuY29uY2F0KGRlbGF5cyk7CiAgfQogIHJldHVybiBNYXRoLm1heC5hcHBseShudWxsLCBkdXJhdGlvbnMubWFwKGZ1bmN0aW9uIChkLCBpKSB7CiAgICByZXR1cm4gdG9NcyhkKSArIHRvTXMoZGVsYXlzW2ldKTsKICB9KSk7Cn0KLy8gT2xkIHZlcnNpb25zIG9mIENocm9taXVtIChiZWxvdyA2MS4wLjMxNjMuMTAwKSBmb3JtYXRzIGZsb2F0aW5nIHBvaW50ZXIgbnVtYmVycwovLyBpbiBhIGxvY2FsZS1kZXBlbmRlbnQgd2F5LCB1c2luZyBhIGNvbW1hIGluc3RlYWQgb2YgYSBkb3QuCi8vIElmIGNvbW1hIGlzIG5vdCByZXBsYWNlZCB3aXRoIGEgZG90LCB0aGUgaW5wdXQgd2lsbCBiZSByb3VuZGVkIGRvd24gKGkuZS4gYWN0aW5nCi8vIGFzIGEgZmxvb3IgZnVuY3Rpb24pIGNhdXNpbmcgdW5leHBlY3RlZCBiZWhhdmlvcnMKZnVuY3Rpb24gdG9NcyhzKSB7CiAgcmV0dXJuIE51bWJlcihzLnNsaWNlKDAsIC0xKS5yZXBsYWNlKCcsJywgJy4nKSkgKiAxMDAwOwp9CmZ1bmN0aW9uIGVudGVyKHZub2RlLCB0b2dnbGVEaXNwbGF5KSB7CiAgdmFyIGVsID0gdm5vZGUuZWxtOwogIC8vIGNhbGwgbGVhdmUgY2FsbGJhY2sgbm93CiAgaWYgKGlzRGVmKGVsLl9sZWF2ZUNiKSkgewogICAgZWwuX2xlYXZlQ2IuY2FuY2VsbGVkID0gdHJ1ZTsKICAgIGVsLl9sZWF2ZUNiKCk7CiAgfQogIHZhciBkYXRhID0gcmVzb2x2ZVRyYW5zaXRpb24odm5vZGUuZGF0YS50cmFuc2l0aW9uKTsKICBpZiAoaXNVbmRlZihkYXRhKSkgewogICAgcmV0dXJuOwogIH0KICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICBpZiAoaXNEZWYoZWwuX2VudGVyQ2IpIHx8IGVsLm5vZGVUeXBlICE9PSAxKSB7CiAgICByZXR1cm47CiAgfQogIHZhciBjc3MgPSBkYXRhLmNzcywKICAgIHR5cGUgPSBkYXRhLnR5cGUsCiAgICBlbnRlckNsYXNzID0gZGF0YS5lbnRlckNsYXNzLAogICAgZW50ZXJUb0NsYXNzID0gZGF0YS5lbnRlclRvQ2xhc3MsCiAgICBlbnRlckFjdGl2ZUNsYXNzID0gZGF0YS5lbnRlckFjdGl2ZUNsYXNzLAogICAgYXBwZWFyQ2xhc3MgPSBkYXRhLmFwcGVhckNsYXNzLAogICAgYXBwZWFyVG9DbGFzcyA9IGRhdGEuYXBwZWFyVG9DbGFzcywKICAgIGFwcGVhckFjdGl2ZUNsYXNzID0gZGF0YS5hcHBlYXJBY3RpdmVDbGFzcywKICAgIGJlZm9yZUVudGVyID0gZGF0YS5iZWZvcmVFbnRlciwKICAgIGVudGVyID0gZGF0YS5lbnRlciwKICAgIGFmdGVyRW50ZXIgPSBkYXRhLmFmdGVyRW50ZXIsCiAgICBlbnRlckNhbmNlbGxlZCA9IGRhdGEuZW50ZXJDYW5jZWxsZWQsCiAgICBiZWZvcmVBcHBlYXIgPSBkYXRhLmJlZm9yZUFwcGVhciwKICAgIGFwcGVhciA9IGRhdGEuYXBwZWFyLAogICAgYWZ0ZXJBcHBlYXIgPSBkYXRhLmFmdGVyQXBwZWFyLAogICAgYXBwZWFyQ2FuY2VsbGVkID0gZGF0YS5hcHBlYXJDYW5jZWxsZWQsCiAgICBkdXJhdGlvbiA9IGRhdGEuZHVyYXRpb247CiAgLy8gYWN0aXZlSW5zdGFuY2Ugd2lsbCBhbHdheXMgYmUgdGhlIDx0cmFuc2l0aW9uPiBjb21wb25lbnQgbWFuYWdpbmcgdGhpcwogIC8vIHRyYW5zaXRpb24uIE9uZSBlZGdlIGNhc2UgdG8gY2hlY2sgaXMgd2hlbiB0aGUgPHRyYW5zaXRpb24+IGlzIHBsYWNlZAogIC8vIGFzIHRoZSByb290IG5vZGUgb2YgYSBjaGlsZCBjb21wb25lbnQuIEluIHRoYXQgY2FzZSB3ZSBuZWVkIHRvIGNoZWNrCiAgLy8gPHRyYW5zaXRpb24+J3MgcGFyZW50IGZvciBhcHBlYXIgY2hlY2suCiAgdmFyIGNvbnRleHQgPSBhY3RpdmVJbnN0YW5jZTsKICB2YXIgdHJhbnNpdGlvbk5vZGUgPSBhY3RpdmVJbnN0YW5jZS4kdm5vZGU7CiAgd2hpbGUgKHRyYW5zaXRpb25Ob2RlICYmIHRyYW5zaXRpb25Ob2RlLnBhcmVudCkgewogICAgY29udGV4dCA9IHRyYW5zaXRpb25Ob2RlLmNvbnRleHQ7CiAgICB0cmFuc2l0aW9uTm9kZSA9IHRyYW5zaXRpb25Ob2RlLnBhcmVudDsKICB9CiAgdmFyIGlzQXBwZWFyID0gIWNvbnRleHQuX2lzTW91bnRlZCB8fCAhdm5vZGUuaXNSb290SW5zZXJ0OwogIGlmIChpc0FwcGVhciAmJiAhYXBwZWFyICYmIGFwcGVhciAhPT0gJycpIHsKICAgIHJldHVybjsKICB9CiAgdmFyIHN0YXJ0Q2xhc3MgPSBpc0FwcGVhciAmJiBhcHBlYXJDbGFzcyA/IGFwcGVhckNsYXNzIDogZW50ZXJDbGFzczsKICB2YXIgYWN0aXZlQ2xhc3MgPSBpc0FwcGVhciAmJiBhcHBlYXJBY3RpdmVDbGFzcyA/IGFwcGVhckFjdGl2ZUNsYXNzIDogZW50ZXJBY3RpdmVDbGFzczsKICB2YXIgdG9DbGFzcyA9IGlzQXBwZWFyICYmIGFwcGVhclRvQ2xhc3MgPyBhcHBlYXJUb0NsYXNzIDogZW50ZXJUb0NsYXNzOwogIHZhciBiZWZvcmVFbnRlckhvb2sgPSBpc0FwcGVhciA/IGJlZm9yZUFwcGVhciB8fCBiZWZvcmVFbnRlciA6IGJlZm9yZUVudGVyOwogIHZhciBlbnRlckhvb2sgPSBpc0FwcGVhciA/IGlzRnVuY3Rpb24oYXBwZWFyKSA/IGFwcGVhciA6IGVudGVyIDogZW50ZXI7CiAgdmFyIGFmdGVyRW50ZXJIb29rID0gaXNBcHBlYXIgPyBhZnRlckFwcGVhciB8fCBhZnRlckVudGVyIDogYWZ0ZXJFbnRlcjsKICB2YXIgZW50ZXJDYW5jZWxsZWRIb29rID0gaXNBcHBlYXIgPyBhcHBlYXJDYW5jZWxsZWQgfHwgZW50ZXJDYW5jZWxsZWQgOiBlbnRlckNhbmNlbGxlZDsKICB2YXIgZXhwbGljaXRFbnRlckR1cmF0aW9uID0gdG9OdW1iZXIoaXNPYmplY3QoZHVyYXRpb24pID8gZHVyYXRpb24uZW50ZXIgOiBkdXJhdGlvbik7CiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgZXhwbGljaXRFbnRlckR1cmF0aW9uICE9IG51bGwpIHsKICAgIGNoZWNrRHVyYXRpb24oZXhwbGljaXRFbnRlckR1cmF0aW9uLCAnZW50ZXInLCB2bm9kZSk7CiAgfQogIHZhciBleHBlY3RzQ1NTID0gY3NzICE9PSBmYWxzZSAmJiAhaXNJRTk7CiAgdmFyIHVzZXJXYW50c0NvbnRyb2wgPSBnZXRIb29rQXJndW1lbnRzTGVuZ3RoKGVudGVySG9vayk7CiAgdmFyIGNiID0gZWwuX2VudGVyQ2IgPSBvbmNlKGZ1bmN0aW9uICgpIHsKICAgIGlmIChleHBlY3RzQ1NTKSB7CiAgICAgIHJlbW92ZVRyYW5zaXRpb25DbGFzcyhlbCwgdG9DbGFzcyk7CiAgICAgIHJlbW92ZVRyYW5zaXRpb25DbGFzcyhlbCwgYWN0aXZlQ2xhc3MpOwogICAgfQogICAgLy8gQHRzLWV4cGVjdC1lcnJvcgogICAgaWYgKGNiLmNhbmNlbGxlZCkgewogICAgICBpZiAoZXhwZWN0c0NTUykgewogICAgICAgIHJlbW92ZVRyYW5zaXRpb25DbGFzcyhlbCwgc3RhcnRDbGFzcyk7CiAgICAgIH0KICAgICAgZW50ZXJDYW5jZWxsZWRIb29rICYmIGVudGVyQ2FuY2VsbGVkSG9vayhlbCk7CiAgICB9IGVsc2UgewogICAgICBhZnRlckVudGVySG9vayAmJiBhZnRlckVudGVySG9vayhlbCk7CiAgICB9CiAgICBlbC5fZW50ZXJDYiA9IG51bGw7CiAgfSk7CiAgaWYgKCF2bm9kZS5kYXRhLnNob3cpIHsKICAgIC8vIHJlbW92ZSBwZW5kaW5nIGxlYXZlIGVsZW1lbnQgb24gZW50ZXIgYnkgaW5qZWN0aW5nIGFuIGluc2VydCBob29rCiAgICBtZXJnZVZOb2RlSG9vayh2bm9kZSwgJ2luc2VydCcsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHBhcmVudCA9IGVsLnBhcmVudE5vZGU7CiAgICAgIHZhciBwZW5kaW5nTm9kZSA9IHBhcmVudCAmJiBwYXJlbnQuX3BlbmRpbmcgJiYgcGFyZW50Ll9wZW5kaW5nW3Zub2RlLmtleV07CiAgICAgIGlmIChwZW5kaW5nTm9kZSAmJiBwZW5kaW5nTm9kZS50YWcgPT09IHZub2RlLnRhZyAmJiBwZW5kaW5nTm9kZS5lbG0uX2xlYXZlQ2IpIHsKICAgICAgICBwZW5kaW5nTm9kZS5lbG0uX2xlYXZlQ2IoKTsKICAgICAgfQogICAgICBlbnRlckhvb2sgJiYgZW50ZXJIb29rKGVsLCBjYik7CiAgICB9KTsKICB9CiAgLy8gc3RhcnQgZW50ZXIgdHJhbnNpdGlvbgogIGJlZm9yZUVudGVySG9vayAmJiBiZWZvcmVFbnRlckhvb2soZWwpOwogIGlmIChleHBlY3RzQ1NTKSB7CiAgICBhZGRUcmFuc2l0aW9uQ2xhc3MoZWwsIHN0YXJ0Q2xhc3MpOwogICAgYWRkVHJhbnNpdGlvbkNsYXNzKGVsLCBhY3RpdmVDbGFzcyk7CiAgICBuZXh0RnJhbWUoZnVuY3Rpb24gKCkgewogICAgICByZW1vdmVUcmFuc2l0aW9uQ2xhc3MoZWwsIHN0YXJ0Q2xhc3MpOwogICAgICAvLyBAdHMtZXhwZWN0LWVycm9yCiAgICAgIGlmICghY2IuY2FuY2VsbGVkKSB7CiAgICAgICAgYWRkVHJhbnNpdGlvbkNsYXNzKGVsLCB0b0NsYXNzKTsKICAgICAgICBpZiAoIXVzZXJXYW50c0NvbnRyb2wpIHsKICAgICAgICAgIGlmIChpc1ZhbGlkRHVyYXRpb24oZXhwbGljaXRFbnRlckR1cmF0aW9uKSkgewogICAgICAgICAgICBzZXRUaW1lb3V0KGNiLCBleHBsaWNpdEVudGVyRHVyYXRpb24pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgd2hlblRyYW5zaXRpb25FbmRzKGVsLCB0eXBlLCBjYik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9CiAgaWYgKHZub2RlLmRhdGEuc2hvdykgewogICAgdG9nZ2xlRGlzcGxheSAmJiB0b2dnbGVEaXNwbGF5KCk7CiAgICBlbnRlckhvb2sgJiYgZW50ZXJIb29rKGVsLCBjYik7CiAgfQogIGlmICghZXhwZWN0c0NTUyAmJiAhdXNlcldhbnRzQ29udHJvbCkgewogICAgY2IoKTsKICB9Cn0KZnVuY3Rpb24gbGVhdmUodm5vZGUsIHJtKSB7CiAgdmFyIGVsID0gdm5vZGUuZWxtOwogIC8vIGNhbGwgZW50ZXIgY2FsbGJhY2sgbm93CiAgaWYgKGlzRGVmKGVsLl9lbnRlckNiKSkgewogICAgZWwuX2VudGVyQ2IuY2FuY2VsbGVkID0gdHJ1ZTsKICAgIGVsLl9lbnRlckNiKCk7CiAgfQogIHZhciBkYXRhID0gcmVzb2x2ZVRyYW5zaXRpb24odm5vZGUuZGF0YS50cmFuc2l0aW9uKTsKICBpZiAoaXNVbmRlZihkYXRhKSB8fCBlbC5ub2RlVHlwZSAhPT0gMSkgewogICAgcmV0dXJuIHJtKCk7CiAgfQogIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogIGlmIChpc0RlZihlbC5fbGVhdmVDYikpIHsKICAgIHJldHVybjsKICB9CiAgdmFyIGNzcyA9IGRhdGEuY3NzLAogICAgdHlwZSA9IGRhdGEudHlwZSwKICAgIGxlYXZlQ2xhc3MgPSBkYXRhLmxlYXZlQ2xhc3MsCiAgICBsZWF2ZVRvQ2xhc3MgPSBkYXRhLmxlYXZlVG9DbGFzcywKICAgIGxlYXZlQWN0aXZlQ2xhc3MgPSBkYXRhLmxlYXZlQWN0aXZlQ2xhc3MsCiAgICBiZWZvcmVMZWF2ZSA9IGRhdGEuYmVmb3JlTGVhdmUsCiAgICBsZWF2ZSA9IGRhdGEubGVhdmUsCiAgICBhZnRlckxlYXZlID0gZGF0YS5hZnRlckxlYXZlLAogICAgbGVhdmVDYW5jZWxsZWQgPSBkYXRhLmxlYXZlQ2FuY2VsbGVkLAogICAgZGVsYXlMZWF2ZSA9IGRhdGEuZGVsYXlMZWF2ZSwKICAgIGR1cmF0aW9uID0gZGF0YS5kdXJhdGlvbjsKICB2YXIgZXhwZWN0c0NTUyA9IGNzcyAhPT0gZmFsc2UgJiYgIWlzSUU5OwogIHZhciB1c2VyV2FudHNDb250cm9sID0gZ2V0SG9va0FyZ3VtZW50c0xlbmd0aChsZWF2ZSk7CiAgdmFyIGV4cGxpY2l0TGVhdmVEdXJhdGlvbiA9IHRvTnVtYmVyKGlzT2JqZWN0KGR1cmF0aW9uKSA/IGR1cmF0aW9uLmxlYXZlIDogZHVyYXRpb24pOwogIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIGlzRGVmKGV4cGxpY2l0TGVhdmVEdXJhdGlvbikpIHsKICAgIGNoZWNrRHVyYXRpb24oZXhwbGljaXRMZWF2ZUR1cmF0aW9uLCAnbGVhdmUnLCB2bm9kZSk7CiAgfQogIHZhciBjYiA9IGVsLl9sZWF2ZUNiID0gb25jZShmdW5jdGlvbiAoKSB7CiAgICBpZiAoZWwucGFyZW50Tm9kZSAmJiBlbC5wYXJlbnROb2RlLl9wZW5kaW5nKSB7CiAgICAgIGVsLnBhcmVudE5vZGUuX3BlbmRpbmdbdm5vZGUua2V5XSA9IG51bGw7CiAgICB9CiAgICBpZiAoZXhwZWN0c0NTUykgewogICAgICByZW1vdmVUcmFuc2l0aW9uQ2xhc3MoZWwsIGxlYXZlVG9DbGFzcyk7CiAgICAgIHJlbW92ZVRyYW5zaXRpb25DbGFzcyhlbCwgbGVhdmVBY3RpdmVDbGFzcyk7CiAgICB9CiAgICAvLyBAdHMtZXhwZWN0LWVycm9yCiAgICBpZiAoY2IuY2FuY2VsbGVkKSB7CiAgICAgIGlmIChleHBlY3RzQ1NTKSB7CiAgICAgICAgcmVtb3ZlVHJhbnNpdGlvbkNsYXNzKGVsLCBsZWF2ZUNsYXNzKTsKICAgICAgfQogICAgICBsZWF2ZUNhbmNlbGxlZCAmJiBsZWF2ZUNhbmNlbGxlZChlbCk7CiAgICB9IGVsc2UgewogICAgICBybSgpOwogICAgICBhZnRlckxlYXZlICYmIGFmdGVyTGVhdmUoZWwpOwogICAgfQogICAgZWwuX2xlYXZlQ2IgPSBudWxsOwogIH0pOwogIGlmIChkZWxheUxlYXZlKSB7CiAgICBkZWxheUxlYXZlKHBlcmZvcm1MZWF2ZSk7CiAgfSBlbHNlIHsKICAgIHBlcmZvcm1MZWF2ZSgpOwogIH0KICBmdW5jdGlvbiBwZXJmb3JtTGVhdmUoKSB7CiAgICAvLyB0aGUgZGVsYXllZCBsZWF2ZSBtYXkgaGF2ZSBhbHJlYWR5IGJlZW4gY2FuY2VsbGVkCiAgICAvLyBAdHMtZXhwZWN0LWVycm9yCiAgICBpZiAoY2IuY2FuY2VsbGVkKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIC8vIHJlY29yZCBsZWF2aW5nIGVsZW1lbnQKICAgIGlmICghdm5vZGUuZGF0YS5zaG93ICYmIGVsLnBhcmVudE5vZGUpIHsKICAgICAgKGVsLnBhcmVudE5vZGUuX3BlbmRpbmcgfHwgKGVsLnBhcmVudE5vZGUuX3BlbmRpbmcgPSB7fSkpW3Zub2RlLmtleV0gPSB2bm9kZTsKICAgIH0KICAgIGJlZm9yZUxlYXZlICYmIGJlZm9yZUxlYXZlKGVsKTsKICAgIGlmIChleHBlY3RzQ1NTKSB7CiAgICAgIGFkZFRyYW5zaXRpb25DbGFzcyhlbCwgbGVhdmVDbGFzcyk7CiAgICAgIGFkZFRyYW5zaXRpb25DbGFzcyhlbCwgbGVhdmVBY3RpdmVDbGFzcyk7CiAgICAgIG5leHRGcmFtZShmdW5jdGlvbiAoKSB7CiAgICAgICAgcmVtb3ZlVHJhbnNpdGlvbkNsYXNzKGVsLCBsZWF2ZUNsYXNzKTsKICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yCiAgICAgICAgaWYgKCFjYi5jYW5jZWxsZWQpIHsKICAgICAgICAgIGFkZFRyYW5zaXRpb25DbGFzcyhlbCwgbGVhdmVUb0NsYXNzKTsKICAgICAgICAgIGlmICghdXNlcldhbnRzQ29udHJvbCkgewogICAgICAgICAgICBpZiAoaXNWYWxpZER1cmF0aW9uKGV4cGxpY2l0TGVhdmVEdXJhdGlvbikpIHsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KGNiLCBleHBsaWNpdExlYXZlRHVyYXRpb24pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHdoZW5UcmFuc2l0aW9uRW5kcyhlbCwgdHlwZSwgY2IpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIGxlYXZlICYmIGxlYXZlKGVsLCBjYik7CiAgICBpZiAoIWV4cGVjdHNDU1MgJiYgIXVzZXJXYW50c0NvbnRyb2wpIHsKICAgICAgY2IoKTsKICAgIH0KICB9Cn0KLy8gb25seSB1c2VkIGluIGRldiBtb2RlCmZ1bmN0aW9uIGNoZWNrRHVyYXRpb24odmFsLCBuYW1lLCB2bm9kZSkgewogIGlmICh0eXBlb2YgdmFsICE9PSAnbnVtYmVyJykgewogICAgd2FybigiPHRyYW5zaXRpb24+IGV4cGxpY2l0ICIuY29uY2F0KG5hbWUsICIgZHVyYXRpb24gaXMgbm90IGEgdmFsaWQgbnVtYmVyIC0gIikgKyAiZ290ICIuY29uY2F0KEpTT04uc3RyaW5naWZ5KHZhbCksICIuIiksIHZub2RlLmNvbnRleHQpOwogIH0gZWxzZSBpZiAoaXNOYU4odmFsKSkgewogICAgd2FybigiPHRyYW5zaXRpb24+IGV4cGxpY2l0ICIuY29uY2F0KG5hbWUsICIgZHVyYXRpb24gaXMgTmFOIC0gIikgKyAndGhlIGR1cmF0aW9uIGV4cHJlc3Npb24gbWlnaHQgYmUgaW5jb3JyZWN0LicsIHZub2RlLmNvbnRleHQpOwogIH0KfQpmdW5jdGlvbiBpc1ZhbGlkRHVyYXRpb24odmFsKSB7CiAgcmV0dXJuIHR5cGVvZiB2YWwgPT09ICdudW1iZXInICYmICFpc05hTih2YWwpOwp9Ci8qKgogKiBOb3JtYWxpemUgYSB0cmFuc2l0aW9uIGhvb2sncyBhcmd1bWVudCBsZW5ndGguIFRoZSBob29rIG1heSBiZToKICogLSBhIG1lcmdlZCBob29rIChpbnZva2VyKSB3aXRoIHRoZSBvcmlnaW5hbCBpbiAuZm5zCiAqIC0gYSB3cmFwcGVkIGNvbXBvbmVudCBtZXRob2QgKGNoZWNrIC5fbGVuZ3RoKQogKiAtIGEgcGxhaW4gZnVuY3Rpb24gKC5sZW5ndGgpCiAqLwpmdW5jdGlvbiBnZXRIb29rQXJndW1lbnRzTGVuZ3RoKGZuKSB7CiAgaWYgKGlzVW5kZWYoZm4pKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQogIC8vIEB0cy1leHBlY3QtZXJyb3IKICB2YXIgaW52b2tlckZucyA9IGZuLmZuczsKICBpZiAoaXNEZWYoaW52b2tlckZucykpIHsKICAgIC8vIGludm9rZXIKICAgIHJldHVybiBnZXRIb29rQXJndW1lbnRzTGVuZ3RoKEFycmF5LmlzQXJyYXkoaW52b2tlckZucykgPyBpbnZva2VyRm5zWzBdIDogaW52b2tlckZucyk7CiAgfSBlbHNlIHsKICAgIC8vIEB0cy1leHBlY3QtZXJyb3IKICAgIHJldHVybiAoZm4uX2xlbmd0aCB8fCBmbi5sZW5ndGgpID4gMTsKICB9Cn0KZnVuY3Rpb24gX2VudGVyKF8sIHZub2RlKSB7CiAgaWYgKHZub2RlLmRhdGEuc2hvdyAhPT0gdHJ1ZSkgewogICAgZW50ZXIodm5vZGUpOwogIH0KfQp2YXIgdHJhbnNpdGlvbiA9IGluQnJvd3NlciA/IHsKICBjcmVhdGU6IF9lbnRlciwKICBhY3RpdmF0ZTogX2VudGVyLAogIHJlbW92ZTogZnVuY3Rpb24gKHZub2RlLCBybSkgewogICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi8KICAgIGlmICh2bm9kZS5kYXRhLnNob3cgIT09IHRydWUpIHsKICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvcgogICAgICBsZWF2ZSh2bm9kZSwgcm0pOwogICAgfSBlbHNlIHsKICAgICAgcm0oKTsKICAgIH0KICB9Cn0gOiB7fTsKdmFyIHBsYXRmb3JtTW9kdWxlcyA9IFthdHRycywga2xhc3MsIGV2ZW50cywgZG9tUHJvcHMsIHN0eWxlLCB0cmFuc2l0aW9uXTsKCi8vIHRoZSBkaXJlY3RpdmUgbW9kdWxlIHNob3VsZCBiZSBhcHBsaWVkIGxhc3QsIGFmdGVyIGFsbAovLyBidWlsdC1pbiBtb2R1bGVzIGhhdmUgYmVlbiBhcHBsaWVkLgp2YXIgbW9kdWxlcyA9IHBsYXRmb3JtTW9kdWxlcy5jb25jYXQoYmFzZU1vZHVsZXMpOwp2YXIgcGF0Y2ggPSBjcmVhdGVQYXRjaEZ1bmN0aW9uKHsKICBub2RlT3BzOiBub2RlT3BzLAogIG1vZHVsZXM6IG1vZHVsZXMKfSk7CgovKioKICogTm90IHR5cGUgY2hlY2tpbmcgdGhpcyBmaWxlIGJlY2F1c2UgZmxvdyBkb2Vzbid0IGxpa2UgYXR0YWNoaW5nCiAqIHByb3BlcnRpZXMgdG8gRWxlbWVudHMuCiAqLwovKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KaWYgKGlzSUU5KSB7CiAgLy8gaHR0cDovL3d3dy5tYXR0czQxMS5jb20vcG9zdC9pbnRlcm5ldC1leHBsb3Jlci05LW9uaW5wdXQvCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc2VsZWN0aW9uY2hhbmdlJywgZnVuY3Rpb24gKCkgewogICAgdmFyIGVsID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDsKICAgIC8vIEB0cy1leHBlY3QtZXJyb3IKICAgIGlmIChlbCAmJiBlbC52bW9kZWwpIHsKICAgICAgdHJpZ2dlcihlbCwgJ2lucHV0Jyk7CiAgICB9CiAgfSk7Cn0KdmFyIGRpcmVjdGl2ZSA9IHsKICBpbnNlcnRlZDogZnVuY3Rpb24gKGVsLCBiaW5kaW5nLCB2bm9kZSwgb2xkVm5vZGUpIHsKICAgIGlmICh2bm9kZS50YWcgPT09ICdzZWxlY3QnKSB7CiAgICAgIC8vICM2OTAzCiAgICAgIGlmIChvbGRWbm9kZS5lbG0gJiYgIW9sZFZub2RlLmVsbS5fdk9wdGlvbnMpIHsKICAgICAgICBtZXJnZVZOb2RlSG9vayh2bm9kZSwgJ3Bvc3RwYXRjaCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGRpcmVjdGl2ZS5jb21wb25lbnRVcGRhdGVkKGVsLCBiaW5kaW5nLCB2bm9kZSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2V0U2VsZWN0ZWQoZWwsIGJpbmRpbmcsIHZub2RlLmNvbnRleHQpOwogICAgICB9CiAgICAgIGVsLl92T3B0aW9ucyA9IFtdLm1hcC5jYWxsKGVsLm9wdGlvbnMsIGdldFZhbHVlKTsKICAgIH0gZWxzZSBpZiAodm5vZGUudGFnID09PSAndGV4dGFyZWEnIHx8IGlzVGV4dElucHV0VHlwZShlbC50eXBlKSkgewogICAgICBlbC5fdk1vZGlmaWVycyA9IGJpbmRpbmcubW9kaWZpZXJzOwogICAgICBpZiAoIWJpbmRpbmcubW9kaWZpZXJzLmxhenkpIHsKICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjb21wb3NpdGlvbnN0YXJ0Jywgb25Db21wb3NpdGlvblN0YXJ0KTsKICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjb21wb3NpdGlvbmVuZCcsIG9uQ29tcG9zaXRpb25FbmQpOwogICAgICAgIC8vIFNhZmFyaSA8IDEwLjIgJiBVSVdlYlZpZXcgZG9lc24ndCBmaXJlIGNvbXBvc2l0aW9uZW5kIHdoZW4KICAgICAgICAvLyBzd2l0Y2hpbmcgZm9jdXMgYmVmb3JlIGNvbmZpcm1pbmcgY29tcG9zaXRpb24gY2hvaWNlCiAgICAgICAgLy8gdGhpcyBhbHNvIGZpeGVzIHRoZSBpc3N1ZSB3aGVyZSBzb21lIGJyb3dzZXJzIGUuZy4gaU9TIENocm9tZQogICAgICAgIC8vIGZpcmVzICJjaGFuZ2UiIGluc3RlYWQgb2YgImlucHV0IiBvbiBhdXRvY29tcGxldGUuCiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25Db21wb3NpdGlvbkVuZCk7CiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgICAgICAgaWYgKGlzSUU5KSB7CiAgICAgICAgICBlbC52bW9kZWwgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sCiAgY29tcG9uZW50VXBkYXRlZDogZnVuY3Rpb24gKGVsLCBiaW5kaW5nLCB2bm9kZSkgewogICAgaWYgKHZub2RlLnRhZyA9PT0gJ3NlbGVjdCcpIHsKICAgICAgc2V0U2VsZWN0ZWQoZWwsIGJpbmRpbmcsIHZub2RlLmNvbnRleHQpOwogICAgICAvLyBpbiBjYXNlIHRoZSBvcHRpb25zIHJlbmRlcmVkIGJ5IHYtZm9yIGhhdmUgY2hhbmdlZCwKICAgICAgLy8gaXQncyBwb3NzaWJsZSB0aGF0IHRoZSB2YWx1ZSBpcyBvdXQtb2Ytc3luYyB3aXRoIHRoZSByZW5kZXJlZCBvcHRpb25zLgogICAgICAvLyBkZXRlY3Qgc3VjaCBjYXNlcyBhbmQgZmlsdGVyIG91dCB2YWx1ZXMgdGhhdCBubyBsb25nZXIgaGFzIGEgbWF0Y2hpbmcKICAgICAgLy8gb3B0aW9uIGluIHRoZSBET00uCiAgICAgIHZhciBwcmV2T3B0aW9uc18xID0gZWwuX3ZPcHRpb25zOwogICAgICB2YXIgY3VyT3B0aW9uc18xID0gZWwuX3ZPcHRpb25zID0gW10ubWFwLmNhbGwoZWwub3B0aW9ucywgZ2V0VmFsdWUpOwogICAgICBpZiAoY3VyT3B0aW9uc18xLnNvbWUoZnVuY3Rpb24gKG8sIGkpIHsKICAgICAgICByZXR1cm4gIWxvb3NlRXF1YWwobywgcHJldk9wdGlvbnNfMVtpXSk7CiAgICAgIH0pKSB7CiAgICAgICAgLy8gdHJpZ2dlciBjaGFuZ2UgZXZlbnQgaWYKICAgICAgICAvLyBubyBtYXRjaGluZyBvcHRpb24gZm91bmQgZm9yIGF0IGxlYXN0IG9uZSB2YWx1ZQogICAgICAgIHZhciBuZWVkUmVzZXQgPSBlbC5tdWx0aXBsZSA/IGJpbmRpbmcudmFsdWUuc29tZShmdW5jdGlvbiAodikgewogICAgICAgICAgcmV0dXJuIGhhc05vTWF0Y2hpbmdPcHRpb24odiwgY3VyT3B0aW9uc18xKTsKICAgICAgICB9KSA6IGJpbmRpbmcudmFsdWUgIT09IGJpbmRpbmcub2xkVmFsdWUgJiYgaGFzTm9NYXRjaGluZ09wdGlvbihiaW5kaW5nLnZhbHVlLCBjdXJPcHRpb25zXzEpOwogICAgICAgIGlmIChuZWVkUmVzZXQpIHsKICAgICAgICAgIHRyaWdnZXIoZWwsICdjaGFuZ2UnKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn07CmZ1bmN0aW9uIHNldFNlbGVjdGVkKGVsLCBiaW5kaW5nLCB2bSkgewogIGFjdHVhbGx5U2V0U2VsZWN0ZWQoZWwsIGJpbmRpbmcsIHZtKTsKICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICBpZiAoaXNJRSB8fCBpc0VkZ2UpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICBhY3R1YWxseVNldFNlbGVjdGVkKGVsLCBiaW5kaW5nLCB2bSk7CiAgICB9LCAwKTsKICB9Cn0KZnVuY3Rpb24gYWN0dWFsbHlTZXRTZWxlY3RlZChlbCwgYmluZGluZywgdm0pIHsKICB2YXIgdmFsdWUgPSBiaW5kaW5nLnZhbHVlOwogIHZhciBpc011bHRpcGxlID0gZWwubXVsdGlwbGU7CiAgaWYgKGlzTXVsdGlwbGUgJiYgIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nICYmIHdhcm4oIjxzZWxlY3QgbXVsdGlwbGUgdi1tb2RlbD1cIiIuY29uY2F0KGJpbmRpbmcuZXhwcmVzc2lvbiwgIlwiPiAiKSArICJleHBlY3RzIGFuIEFycmF5IHZhbHVlIGZvciBpdHMgYmluZGluZywgYnV0IGdvdCAiLmNvbmNhdChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsdWUpLnNsaWNlKDgsIC0xKSksIHZtKTsKICAgIHJldHVybjsKICB9CiAgdmFyIHNlbGVjdGVkLCBvcHRpb247CiAgZm9yICh2YXIgaSA9IDAsIGwgPSBlbC5vcHRpb25zLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgb3B0aW9uID0gZWwub3B0aW9uc1tpXTsKICAgIGlmIChpc011bHRpcGxlKSB7CiAgICAgIHNlbGVjdGVkID0gbG9vc2VJbmRleE9mKHZhbHVlLCBnZXRWYWx1ZShvcHRpb24pKSA+IC0xOwogICAgICBpZiAob3B0aW9uLnNlbGVjdGVkICE9PSBzZWxlY3RlZCkgewogICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IHNlbGVjdGVkOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAobG9vc2VFcXVhbChnZXRWYWx1ZShvcHRpb24pLCB2YWx1ZSkpIHsKICAgICAgICBpZiAoZWwuc2VsZWN0ZWRJbmRleCAhPT0gaSkgewogICAgICAgICAgZWwuc2VsZWN0ZWRJbmRleCA9IGk7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQogIH0KICBpZiAoIWlzTXVsdGlwbGUpIHsKICAgIGVsLnNlbGVjdGVkSW5kZXggPSAtMTsKICB9Cn0KZnVuY3Rpb24gaGFzTm9NYXRjaGluZ09wdGlvbih2YWx1ZSwgb3B0aW9ucykgewogIHJldHVybiBvcHRpb25zLmV2ZXJ5KGZ1bmN0aW9uIChvKSB7CiAgICByZXR1cm4gIWxvb3NlRXF1YWwobywgdmFsdWUpOwogIH0pOwp9CmZ1bmN0aW9uIGdldFZhbHVlKG9wdGlvbikgewogIHJldHVybiAnX3ZhbHVlJyBpbiBvcHRpb24gPyBvcHRpb24uX3ZhbHVlIDogb3B0aW9uLnZhbHVlOwp9CmZ1bmN0aW9uIG9uQ29tcG9zaXRpb25TdGFydChlKSB7CiAgZS50YXJnZXQuY29tcG9zaW5nID0gdHJ1ZTsKfQpmdW5jdGlvbiBvbkNvbXBvc2l0aW9uRW5kKGUpIHsKICAvLyBwcmV2ZW50IHRyaWdnZXJpbmcgYW4gaW5wdXQgZXZlbnQgZm9yIG5vIHJlYXNvbgogIGlmICghZS50YXJnZXQuY29tcG9zaW5nKSByZXR1cm47CiAgZS50YXJnZXQuY29tcG9zaW5nID0gZmFsc2U7CiAgdHJpZ2dlcihlLnRhcmdldCwgJ2lucHV0Jyk7Cn0KZnVuY3Rpb24gdHJpZ2dlcihlbCwgdHlwZSkgewogIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0hUTUxFdmVudHMnKTsKICBlLmluaXRFdmVudCh0eXBlLCB0cnVlLCB0cnVlKTsKICBlbC5kaXNwYXRjaEV2ZW50KGUpOwp9CgovLyByZWN1cnNpdmVseSBzZWFyY2ggZm9yIHBvc3NpYmxlIHRyYW5zaXRpb24gZGVmaW5lZCBpbnNpZGUgdGhlIGNvbXBvbmVudCByb290CmZ1bmN0aW9uIGxvY2F0ZU5vZGUodm5vZGUpIHsKICAvLyBAdHMtZXhwZWN0LWVycm9yCiAgcmV0dXJuIHZub2RlLmNvbXBvbmVudEluc3RhbmNlICYmICghdm5vZGUuZGF0YSB8fCAhdm5vZGUuZGF0YS50cmFuc2l0aW9uKSA/IGxvY2F0ZU5vZGUodm5vZGUuY29tcG9uZW50SW5zdGFuY2UuX3Zub2RlKSA6IHZub2RlOwp9CnZhciBzaG93ID0gewogIGJpbmQ6IGZ1bmN0aW9uIChlbCwgX2EsIHZub2RlKSB7CiAgICB2YXIgdmFsdWUgPSBfYS52YWx1ZTsKICAgIHZub2RlID0gbG9jYXRlTm9kZSh2bm9kZSk7CiAgICB2YXIgdHJhbnNpdGlvbiA9IHZub2RlLmRhdGEgJiYgdm5vZGUuZGF0YS50cmFuc2l0aW9uOwogICAgdmFyIG9yaWdpbmFsRGlzcGxheSA9IGVsLl9fdk9yaWdpbmFsRGlzcGxheSA9IGVsLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJyA/ICcnIDogZWwuc3R5bGUuZGlzcGxheTsKICAgIGlmICh2YWx1ZSAmJiB0cmFuc2l0aW9uKSB7CiAgICAgIHZub2RlLmRhdGEuc2hvdyA9IHRydWU7CiAgICAgIGVudGVyKHZub2RlLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgZWwuc3R5bGUuZGlzcGxheSA9IG9yaWdpbmFsRGlzcGxheTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gdmFsdWUgPyBvcmlnaW5hbERpc3BsYXkgOiAnbm9uZSc7CiAgICB9CiAgfSwKICB1cGRhdGU6IGZ1bmN0aW9uIChlbCwgX2EsIHZub2RlKSB7CiAgICB2YXIgdmFsdWUgPSBfYS52YWx1ZSwKICAgICAgb2xkVmFsdWUgPSBfYS5vbGRWYWx1ZTsKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgaWYgKCF2YWx1ZSA9PT0gIW9sZFZhbHVlKSByZXR1cm47CiAgICB2bm9kZSA9IGxvY2F0ZU5vZGUodm5vZGUpOwogICAgdmFyIHRyYW5zaXRpb24gPSB2bm9kZS5kYXRhICYmIHZub2RlLmRhdGEudHJhbnNpdGlvbjsKICAgIGlmICh0cmFuc2l0aW9uKSB7CiAgICAgIHZub2RlLmRhdGEuc2hvdyA9IHRydWU7CiAgICAgIGlmICh2YWx1ZSkgewogICAgICAgIGVudGVyKHZub2RlLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gZWwuX192T3JpZ2luYWxEaXNwbGF5OwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGxlYXZlKHZub2RlLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIH0pOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gdmFsdWUgPyBlbC5fX3ZPcmlnaW5hbERpc3BsYXkgOiAnbm9uZSc7CiAgICB9CiAgfSwKICB1bmJpbmQ6IGZ1bmN0aW9uIChlbCwgYmluZGluZywgdm5vZGUsIG9sZFZub2RlLCBpc0Rlc3Ryb3kpIHsKICAgIGlmICghaXNEZXN0cm95KSB7CiAgICAgIGVsLnN0eWxlLmRpc3BsYXkgPSBlbC5fX3ZPcmlnaW5hbERpc3BsYXk7CiAgICB9CiAgfQp9Owp2YXIgcGxhdGZvcm1EaXJlY3RpdmVzID0gewogIG1vZGVsOiBkaXJlY3RpdmUsCiAgc2hvdzogc2hvdwp9OwoKLy8gUHJvdmlkZXMgdHJhbnNpdGlvbiBzdXBwb3J0IGZvciBhIHNpbmdsZSBlbGVtZW50L2NvbXBvbmVudC4KdmFyIHRyYW5zaXRpb25Qcm9wcyA9IHsKICBuYW1lOiBTdHJpbmcsCiAgYXBwZWFyOiBCb29sZWFuLAogIGNzczogQm9vbGVhbiwKICBtb2RlOiBTdHJpbmcsCiAgdHlwZTogU3RyaW5nLAogIGVudGVyQ2xhc3M6IFN0cmluZywKICBsZWF2ZUNsYXNzOiBTdHJpbmcsCiAgZW50ZXJUb0NsYXNzOiBTdHJpbmcsCiAgbGVhdmVUb0NsYXNzOiBTdHJpbmcsCiAgZW50ZXJBY3RpdmVDbGFzczogU3RyaW5nLAogIGxlYXZlQWN0aXZlQ2xhc3M6IFN0cmluZywKICBhcHBlYXJDbGFzczogU3RyaW5nLAogIGFwcGVhckFjdGl2ZUNsYXNzOiBTdHJpbmcsCiAgYXBwZWFyVG9DbGFzczogU3RyaW5nLAogIGR1cmF0aW9uOiBbTnVtYmVyLCBTdHJpbmcsIE9iamVjdF0KfTsKLy8gaW4gY2FzZSB0aGUgY2hpbGQgaXMgYWxzbyBhbiBhYnN0cmFjdCBjb21wb25lbnQsIGUuZy4gPGtlZXAtYWxpdmU+Ci8vIHdlIHdhbnQgdG8gcmVjdXJzaXZlbHkgcmV0cmlldmUgdGhlIHJlYWwgY29tcG9uZW50IHRvIGJlIHJlbmRlcmVkCmZ1bmN0aW9uIGdldFJlYWxDaGlsZCh2bm9kZSkgewogIHZhciBjb21wT3B0aW9ucyA9IHZub2RlICYmIHZub2RlLmNvbXBvbmVudE9wdGlvbnM7CiAgaWYgKGNvbXBPcHRpb25zICYmIGNvbXBPcHRpb25zLkN0b3Iub3B0aW9ucy5hYnN0cmFjdCkgewogICAgcmV0dXJuIGdldFJlYWxDaGlsZChnZXRGaXJzdENvbXBvbmVudENoaWxkKGNvbXBPcHRpb25zLmNoaWxkcmVuKSk7CiAgfSBlbHNlIHsKICAgIHJldHVybiB2bm9kZTsKICB9Cn0KZnVuY3Rpb24gZXh0cmFjdFRyYW5zaXRpb25EYXRhKGNvbXApIHsKICB2YXIgZGF0YSA9IHt9OwogIHZhciBvcHRpb25zID0gY29tcC4kb3B0aW9uczsKICAvLyBwcm9wcwogIGZvciAodmFyIGtleSBpbiBvcHRpb25zLnByb3BzRGF0YSkgewogICAgZGF0YVtrZXldID0gY29tcFtrZXldOwogIH0KICAvLyBldmVudHMuCiAgLy8gZXh0cmFjdCBsaXN0ZW5lcnMgYW5kIHBhc3MgdGhlbSBkaXJlY3RseSB0byB0aGUgdHJhbnNpdGlvbiBtZXRob2RzCiAgdmFyIGxpc3RlbmVycyA9IG9wdGlvbnMuX3BhcmVudExpc3RlbmVyczsKICBmb3IgKHZhciBrZXkgaW4gbGlzdGVuZXJzKSB7CiAgICBkYXRhW2NhbWVsaXplKGtleSldID0gbGlzdGVuZXJzW2tleV07CiAgfQogIHJldHVybiBkYXRhOwp9CmZ1bmN0aW9uIHBsYWNlaG9sZGVyKGgsIHJhd0NoaWxkKSB7CiAgLy8gQHRzLWV4cGVjdC1lcnJvcgogIGlmICgvXGQta2VlcC1hbGl2ZSQvLnRlc3QocmF3Q2hpbGQudGFnKSkgewogICAgcmV0dXJuIGgoJ2tlZXAtYWxpdmUnLCB7CiAgICAgIHByb3BzOiByYXdDaGlsZC5jb21wb25lbnRPcHRpb25zLnByb3BzRGF0YQogICAgfSk7CiAgfQp9CmZ1bmN0aW9uIGhhc1BhcmVudFRyYW5zaXRpb24odm5vZGUpIHsKICB3aGlsZSAodm5vZGUgPSB2bm9kZS5wYXJlbnQpIHsKICAgIGlmICh2bm9kZS5kYXRhLnRyYW5zaXRpb24pIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfQp9CmZ1bmN0aW9uIGlzU2FtZUNoaWxkKGNoaWxkLCBvbGRDaGlsZCkgewogIHJldHVybiBvbGRDaGlsZC5rZXkgPT09IGNoaWxkLmtleSAmJiBvbGRDaGlsZC50YWcgPT09IGNoaWxkLnRhZzsKfQp2YXIgaXNOb3RUZXh0Tm9kZSA9IGZ1bmN0aW9uIChjKSB7CiAgcmV0dXJuIGMudGFnIHx8IGlzQXN5bmNQbGFjZWhvbGRlcihjKTsKfTsKdmFyIGlzVlNob3dEaXJlY3RpdmUgPSBmdW5jdGlvbiAoZCkgewogIHJldHVybiBkLm5hbWUgPT09ICdzaG93JzsKfTsKdmFyIFRyYW5zaXRpb24gPSB7CiAgbmFtZTogJ3RyYW5zaXRpb24nLAogIHByb3BzOiB0cmFuc2l0aW9uUHJvcHMsCiAgYWJzdHJhY3Q6IHRydWUsCiAgcmVuZGVyOiBmdW5jdGlvbiAoaCkgewogICAgdmFyIF90aGlzID0gdGhpczsKICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuJHNsb3RzLmRlZmF1bHQ7CiAgICBpZiAoIWNoaWxkcmVuKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIC8vIGZpbHRlciBvdXQgdGV4dCBub2RlcyAocG9zc2libGUgd2hpdGVzcGFjZXMpCiAgICBjaGlsZHJlbiA9IGNoaWxkcmVuLmZpbHRlcihpc05vdFRleHROb2RlKTsKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgaWYgKCFjaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgLy8gd2FybiBtdWx0aXBsZSBlbGVtZW50cwogICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicgJiYgY2hpbGRyZW4ubGVuZ3RoID4gMSkgewogICAgICB3YXJuKCc8dHJhbnNpdGlvbj4gY2FuIG9ubHkgYmUgdXNlZCBvbiBhIHNpbmdsZSBlbGVtZW50LiBVc2UgJyArICc8dHJhbnNpdGlvbi1ncm91cD4gZm9yIGxpc3RzLicsIHRoaXMuJHBhcmVudCk7CiAgICB9CiAgICB2YXIgbW9kZSA9IHRoaXMubW9kZTsKICAgIC8vIHdhcm4gaW52YWxpZCBtb2RlCiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiBtb2RlICYmIG1vZGUgIT09ICdpbi1vdXQnICYmIG1vZGUgIT09ICdvdXQtaW4nKSB7CiAgICAgIHdhcm4oJ2ludmFsaWQgPHRyYW5zaXRpb24+IG1vZGU6ICcgKyBtb2RlLCB0aGlzLiRwYXJlbnQpOwogICAgfQogICAgdmFyIHJhd0NoaWxkID0gY2hpbGRyZW5bMF07CiAgICAvLyBpZiB0aGlzIGlzIGEgY29tcG9uZW50IHJvb3Qgbm9kZSBhbmQgdGhlIGNvbXBvbmVudCdzCiAgICAvLyBwYXJlbnQgY29udGFpbmVyIG5vZGUgYWxzbyBoYXMgdHJhbnNpdGlvbiwgc2tpcC4KICAgIGlmIChoYXNQYXJlbnRUcmFuc2l0aW9uKHRoaXMuJHZub2RlKSkgewogICAgICByZXR1cm4gcmF3Q2hpbGQ7CiAgICB9CiAgICAvLyBhcHBseSB0cmFuc2l0aW9uIGRhdGEgdG8gY2hpbGQKICAgIC8vIHVzZSBnZXRSZWFsQ2hpbGQoKSB0byBpZ25vcmUgYWJzdHJhY3QgY29tcG9uZW50cyBlLmcuIGtlZXAtYWxpdmUKICAgIHZhciBjaGlsZCA9IGdldFJlYWxDaGlsZChyYXdDaGlsZCk7CiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICAgIGlmICghY2hpbGQpIHsKICAgICAgcmV0dXJuIHJhd0NoaWxkOwogICAgfQogICAgaWYgKHRoaXMuX2xlYXZpbmcpIHsKICAgICAgcmV0dXJuIHBsYWNlaG9sZGVyKGgsIHJhd0NoaWxkKTsKICAgIH0KICAgIC8vIGVuc3VyZSBhIGtleSB0aGF0IGlzIHVuaXF1ZSB0byB0aGUgdm5vZGUgdHlwZSBhbmQgdG8gdGhpcyB0cmFuc2l0aW9uCiAgICAvLyBjb21wb25lbnQgaW5zdGFuY2UuIFRoaXMga2V5IHdpbGwgYmUgdXNlZCB0byByZW1vdmUgcGVuZGluZyBsZWF2aW5nIG5vZGVzCiAgICAvLyBkdXJpbmcgZW50ZXJpbmcuCiAgICB2YXIgaWQgPSAiX190cmFuc2l0aW9uLSIuY29uY2F0KHRoaXMuX3VpZCwgIi0iKTsKICAgIGNoaWxkLmtleSA9IGNoaWxkLmtleSA9PSBudWxsID8gY2hpbGQuaXNDb21tZW50ID8gaWQgKyAnY29tbWVudCcgOiBpZCArIGNoaWxkLnRhZyA6IGlzUHJpbWl0aXZlKGNoaWxkLmtleSkgPyBTdHJpbmcoY2hpbGQua2V5KS5pbmRleE9mKGlkKSA9PT0gMCA/IGNoaWxkLmtleSA6IGlkICsgY2hpbGQua2V5IDogY2hpbGQua2V5OwogICAgdmFyIGRhdGEgPSAoY2hpbGQuZGF0YSB8fCAoY2hpbGQuZGF0YSA9IHt9KSkudHJhbnNpdGlvbiA9IGV4dHJhY3RUcmFuc2l0aW9uRGF0YSh0aGlzKTsKICAgIHZhciBvbGRSYXdDaGlsZCA9IHRoaXMuX3Zub2RlOwogICAgdmFyIG9sZENoaWxkID0gZ2V0UmVhbENoaWxkKG9sZFJhd0NoaWxkKTsKICAgIC8vIG1hcmsgdi1zaG93CiAgICAvLyBzbyB0aGF0IHRoZSB0cmFuc2l0aW9uIG1vZHVsZSBjYW4gaGFuZCBvdmVyIHRoZSBjb250cm9sIHRvIHRoZSBkaXJlY3RpdmUKICAgIGlmIChjaGlsZC5kYXRhLmRpcmVjdGl2ZXMgJiYgY2hpbGQuZGF0YS5kaXJlY3RpdmVzLnNvbWUoaXNWU2hvd0RpcmVjdGl2ZSkpIHsKICAgICAgY2hpbGQuZGF0YS5zaG93ID0gdHJ1ZTsKICAgIH0KICAgIGlmIChvbGRDaGlsZCAmJiBvbGRDaGlsZC5kYXRhICYmICFpc1NhbWVDaGlsZChjaGlsZCwgb2xkQ2hpbGQpICYmICFpc0FzeW5jUGxhY2Vob2xkZXIob2xkQ2hpbGQpICYmCiAgICAvLyAjNjY4NyBjb21wb25lbnQgcm9vdCBpcyBhIGNvbW1lbnQgbm9kZQogICAgIShvbGRDaGlsZC5jb21wb25lbnRJbnN0YW5jZSAmJiBvbGRDaGlsZC5jb21wb25lbnRJbnN0YW5jZS5fdm5vZGUuaXNDb21tZW50KSkgewogICAgICAvLyByZXBsYWNlIG9sZCBjaGlsZCB0cmFuc2l0aW9uIGRhdGEgd2l0aCBmcmVzaCBvbmUKICAgICAgLy8gaW1wb3J0YW50IGZvciBkeW5hbWljIHRyYW5zaXRpb25zIQogICAgICB2YXIgb2xkRGF0YSA9IG9sZENoaWxkLmRhdGEudHJhbnNpdGlvbiA9IGV4dGVuZCh7fSwgZGF0YSk7CiAgICAgIC8vIGhhbmRsZSB0cmFuc2l0aW9uIG1vZGUKICAgICAgaWYgKG1vZGUgPT09ICdvdXQtaW4nKSB7CiAgICAgICAgLy8gcmV0dXJuIHBsYWNlaG9sZGVyIG5vZGUgYW5kIHF1ZXVlIHVwZGF0ZSB3aGVuIGxlYXZlIGZpbmlzaGVzCiAgICAgICAgdGhpcy5fbGVhdmluZyA9IHRydWU7CiAgICAgICAgbWVyZ2VWTm9kZUhvb2sob2xkRGF0YSwgJ2FmdGVyTGVhdmUnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5fbGVhdmluZyA9IGZhbHNlOwogICAgICAgICAgX3RoaXMuJGZvcmNlVXBkYXRlKCk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHBsYWNlaG9sZGVyKGgsIHJhd0NoaWxkKTsKICAgICAgfSBlbHNlIGlmIChtb2RlID09PSAnaW4tb3V0JykgewogICAgICAgIGlmIChpc0FzeW5jUGxhY2Vob2xkZXIoY2hpbGQpKSB7CiAgICAgICAgICByZXR1cm4gb2xkUmF3Q2hpbGQ7CiAgICAgICAgfQogICAgICAgIHZhciBkZWxheWVkTGVhdmVfMTsKICAgICAgICB2YXIgcGVyZm9ybUxlYXZlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgZGVsYXllZExlYXZlXzEoKTsKICAgICAgICB9OwogICAgICAgIG1lcmdlVk5vZGVIb29rKGRhdGEsICdhZnRlckVudGVyJywgcGVyZm9ybUxlYXZlKTsKICAgICAgICBtZXJnZVZOb2RlSG9vayhkYXRhLCAnZW50ZXJDYW5jZWxsZWQnLCBwZXJmb3JtTGVhdmUpOwogICAgICAgIG1lcmdlVk5vZGVIb29rKG9sZERhdGEsICdkZWxheUxlYXZlJywgZnVuY3Rpb24gKGxlYXZlKSB7CiAgICAgICAgICBkZWxheWVkTGVhdmVfMSA9IGxlYXZlOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gcmF3Q2hpbGQ7CiAgfQp9OwoKLy8gUHJvdmlkZXMgdHJhbnNpdGlvbiBzdXBwb3J0IGZvciBsaXN0IGl0ZW1zLgp2YXIgcHJvcHMgPSBleHRlbmQoewogIHRhZzogU3RyaW5nLAogIG1vdmVDbGFzczogU3RyaW5nCn0sIHRyYW5zaXRpb25Qcm9wcyk7CmRlbGV0ZSBwcm9wcy5tb2RlOwp2YXIgVHJhbnNpdGlvbkdyb3VwID0gewogIHByb3BzOiBwcm9wcywKICBiZWZvcmVNb3VudDogZnVuY3Rpb24gKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKICAgIHZhciB1cGRhdGUgPSB0aGlzLl91cGRhdGU7CiAgICB0aGlzLl91cGRhdGUgPSBmdW5jdGlvbiAodm5vZGUsIGh5ZHJhdGluZykgewogICAgICB2YXIgcmVzdG9yZUFjdGl2ZUluc3RhbmNlID0gc2V0QWN0aXZlSW5zdGFuY2UoX3RoaXMpOwogICAgICAvLyBmb3JjZSByZW1vdmluZyBwYXNzCiAgICAgIF90aGlzLl9fcGF0Y2hfXyhfdGhpcy5fdm5vZGUsIF90aGlzLmtlcHQsIGZhbHNlLAogICAgICAvLyBoeWRyYXRpbmcKICAgICAgdHJ1ZSAvLyByZW1vdmVPbmx5ICghaW1wb3J0YW50LCBhdm9pZHMgdW5uZWNlc3NhcnkgbW92ZXMpCiAgICAgICk7CiAgICAgIF90aGlzLl92bm9kZSA9IF90aGlzLmtlcHQ7CiAgICAgIHJlc3RvcmVBY3RpdmVJbnN0YW5jZSgpOwogICAgICB1cGRhdGUuY2FsbChfdGhpcywgdm5vZGUsIGh5ZHJhdGluZyk7CiAgICB9OwogIH0sCiAgcmVuZGVyOiBmdW5jdGlvbiAoaCkgewogICAgdmFyIHRhZyA9IHRoaXMudGFnIHx8IHRoaXMuJHZub2RlLmRhdGEudGFnIHx8ICdzcGFuJzsKICAgIHZhciBtYXAgPSBPYmplY3QuY3JlYXRlKG51bGwpOwogICAgdmFyIHByZXZDaGlsZHJlbiA9IHRoaXMucHJldkNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjsKICAgIHZhciByYXdDaGlsZHJlbiA9IHRoaXMuJHNsb3RzLmRlZmF1bHQgfHwgW107CiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuID0gW107CiAgICB2YXIgdHJhbnNpdGlvbkRhdGEgPSBleHRyYWN0VHJhbnNpdGlvbkRhdGEodGhpcyk7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJhd0NoaWxkcmVuLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBjID0gcmF3Q2hpbGRyZW5baV07CiAgICAgIGlmIChjLnRhZykgewogICAgICAgIGlmIChjLmtleSAhPSBudWxsICYmIFN0cmluZyhjLmtleSkuaW5kZXhPZignX192bGlzdCcpICE9PSAwKSB7CiAgICAgICAgICBjaGlsZHJlbi5wdXNoKGMpOwogICAgICAgICAgbWFwW2Mua2V5XSA9IGM7CiAgICAgICAgICAoYy5kYXRhIHx8IChjLmRhdGEgPSB7fSkpLnRyYW5zaXRpb24gPSB0cmFuc2l0aW9uRGF0YTsKICAgICAgICB9IGVsc2UgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHsKICAgICAgICAgIHZhciBvcHRzID0gYy5jb21wb25lbnRPcHRpb25zOwogICAgICAgICAgdmFyIG5hbWVfMSA9IG9wdHMgPyBnZXRDb21wb25lbnROYW1lKG9wdHMuQ3Rvci5vcHRpb25zKSB8fCBvcHRzLnRhZyB8fCAnJyA6IGMudGFnOwogICAgICAgICAgd2FybigiPHRyYW5zaXRpb24tZ3JvdXA+IGNoaWxkcmVuIG11c3QgYmUga2V5ZWQ6IDwiLmNvbmNhdChuYW1lXzEsICI+IikpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgaWYgKHByZXZDaGlsZHJlbikgewogICAgICB2YXIga2VwdCA9IFtdOwogICAgICB2YXIgcmVtb3ZlZCA9IFtdOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByZXZDaGlsZHJlbi5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBjID0gcHJldkNoaWxkcmVuW2ldOwogICAgICAgIGMuZGF0YS50cmFuc2l0aW9uID0gdHJhbnNpdGlvbkRhdGE7CiAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciAuZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGlzIG5vdCB0eXBlZCBpbiBOb2RlCiAgICAgICAgYy5kYXRhLnBvcyA9IGMuZWxtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIGlmIChtYXBbYy5rZXldKSB7CiAgICAgICAgICBrZXB0LnB1c2goYyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlbW92ZWQucHVzaChjKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5rZXB0ID0gaCh0YWcsIG51bGwsIGtlcHQpOwogICAgICB0aGlzLnJlbW92ZWQgPSByZW1vdmVkOwogICAgfQogICAgcmV0dXJuIGgodGFnLCBudWxsLCBjaGlsZHJlbik7CiAgfSwKICB1cGRhdGVkOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLnByZXZDaGlsZHJlbjsKICAgIHZhciBtb3ZlQ2xhc3MgPSB0aGlzLm1vdmVDbGFzcyB8fCAodGhpcy5uYW1lIHx8ICd2JykgKyAnLW1vdmUnOwogICAgaWYgKCFjaGlsZHJlbi5sZW5ndGggfHwgIXRoaXMuaGFzTW92ZShjaGlsZHJlblswXS5lbG0sIG1vdmVDbGFzcykpIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgLy8gd2UgZGl2aWRlIHRoZSB3b3JrIGludG8gdGhyZWUgbG9vcHMgdG8gYXZvaWQgbWl4aW5nIERPTSByZWFkcyBhbmQgd3JpdGVzCiAgICAvLyBpbiBlYWNoIGl0ZXJhdGlvbiAtIHdoaWNoIGhlbHBzIHByZXZlbnQgbGF5b3V0IHRocmFzaGluZy4KICAgIGNoaWxkcmVuLmZvckVhY2goY2FsbFBlbmRpbmdDYnMpOwogICAgY2hpbGRyZW4uZm9yRWFjaChyZWNvcmRQb3NpdGlvbik7CiAgICBjaGlsZHJlbi5mb3JFYWNoKGFwcGx5VHJhbnNsYXRpb24pOwogICAgLy8gZm9yY2UgcmVmbG93IHRvIHB1dCBldmVyeXRoaW5nIGluIHBvc2l0aW9uCiAgICAvLyBhc3NpZ24gdG8gdGhpcyB0byBhdm9pZCBiZWluZyByZW1vdmVkIGluIHRyZWUtc2hha2luZwogICAgLy8gJGZsb3ctZGlzYWJsZS1saW5lCiAgICB0aGlzLl9yZWZsb3cgPSBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodDsKICAgIGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGMpIHsKICAgICAgaWYgKGMuZGF0YS5tb3ZlZCkgewogICAgICAgIHZhciBlbF8xID0gYy5lbG07CiAgICAgICAgdmFyIHMgPSBlbF8xLnN0eWxlOwogICAgICAgIGFkZFRyYW5zaXRpb25DbGFzcyhlbF8xLCBtb3ZlQ2xhc3MpOwogICAgICAgIHMudHJhbnNmb3JtID0gcy5XZWJraXRUcmFuc2Zvcm0gPSBzLnRyYW5zaXRpb25EdXJhdGlvbiA9ICcnOwogICAgICAgIGVsXzEuYWRkRXZlbnRMaXN0ZW5lcih0cmFuc2l0aW9uRW5kRXZlbnQsIGVsXzEuX21vdmVDYiA9IGZ1bmN0aW9uIGNiKGUpIHsKICAgICAgICAgIGlmIChlICYmIGUudGFyZ2V0ICE9PSBlbF8xKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghZSB8fCAvdHJhbnNmb3JtJC8udGVzdChlLnByb3BlcnR5TmFtZSkpIHsKICAgICAgICAgICAgZWxfMS5yZW1vdmVFdmVudExpc3RlbmVyKHRyYW5zaXRpb25FbmRFdmVudCwgY2IpOwogICAgICAgICAgICBlbF8xLl9tb3ZlQ2IgPSBudWxsOwogICAgICAgICAgICByZW1vdmVUcmFuc2l0aW9uQ2xhc3MoZWxfMSwgbW92ZUNsYXNzKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBoYXNNb3ZlOiBmdW5jdGlvbiAoZWwsIG1vdmVDbGFzcykgewogICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICAgICAgaWYgKCFoYXNUcmFuc2l0aW9uKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogICAgICBpZiAodGhpcy5faGFzTW92ZSkgewogICAgICAgIHJldHVybiB0aGlzLl9oYXNNb3ZlOwogICAgICB9CiAgICAgIC8vIERldGVjdCB3aGV0aGVyIGFuIGVsZW1lbnQgd2l0aCB0aGUgbW92ZSBjbGFzcyBhcHBsaWVkIGhhcwogICAgICAvLyBDU1MgdHJhbnNpdGlvbnMuIFNpbmNlIHRoZSBlbGVtZW50IG1heSBiZSBpbnNpZGUgYW4gZW50ZXJpbmcKICAgICAgLy8gdHJhbnNpdGlvbiBhdCB0aGlzIHZlcnkgbW9tZW50LCB3ZSBtYWtlIGEgY2xvbmUgb2YgaXQgYW5kIHJlbW92ZQogICAgICAvLyBhbGwgb3RoZXIgdHJhbnNpdGlvbiBjbGFzc2VzIGFwcGxpZWQgdG8gZW5zdXJlIG9ubHkgdGhlIG1vdmUgY2xhc3MKICAgICAgLy8gaXMgYXBwbGllZC4KICAgICAgdmFyIGNsb25lID0gZWwuY2xvbmVOb2RlKCk7CiAgICAgIGlmIChlbC5fdHJhbnNpdGlvbkNsYXNzZXMpIHsKICAgICAgICBlbC5fdHJhbnNpdGlvbkNsYXNzZXMuZm9yRWFjaChmdW5jdGlvbiAoY2xzKSB7CiAgICAgICAgICByZW1vdmVDbGFzcyhjbG9uZSwgY2xzKTsKICAgICAgICB9KTsKICAgICAgfQogICAgICBhZGRDbGFzcyhjbG9uZSwgbW92ZUNsYXNzKTsKICAgICAgY2xvbmUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgdGhpcy4kZWwuYXBwZW5kQ2hpbGQoY2xvbmUpOwogICAgICB2YXIgaW5mbyA9IGdldFRyYW5zaXRpb25JbmZvKGNsb25lKTsKICAgICAgdGhpcy4kZWwucmVtb3ZlQ2hpbGQoY2xvbmUpOwogICAgICByZXR1cm4gdGhpcy5faGFzTW92ZSA9IGluZm8uaGFzVHJhbnNmb3JtOwogICAgfQogIH0KfTsKZnVuY3Rpb24gY2FsbFBlbmRpbmdDYnMoYykgewogIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogIGlmIChjLmVsbS5fbW92ZUNiKSB7CiAgICBjLmVsbS5fbW92ZUNiKCk7CiAgfQogIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwogIGlmIChjLmVsbS5fZW50ZXJDYikgewogICAgYy5lbG0uX2VudGVyQ2IoKTsKICB9Cn0KZnVuY3Rpb24gcmVjb3JkUG9zaXRpb24oYykgewogIGMuZGF0YS5uZXdQb3MgPSBjLmVsbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKfQpmdW5jdGlvbiBhcHBseVRyYW5zbGF0aW9uKGMpIHsKICB2YXIgb2xkUG9zID0gYy5kYXRhLnBvczsKICB2YXIgbmV3UG9zID0gYy5kYXRhLm5ld1BvczsKICB2YXIgZHggPSBvbGRQb3MubGVmdCAtIG5ld1Bvcy5sZWZ0OwogIHZhciBkeSA9IG9sZFBvcy50b3AgLSBuZXdQb3MudG9wOwogIGlmIChkeCB8fCBkeSkgewogICAgYy5kYXRhLm1vdmVkID0gdHJ1ZTsKICAgIHZhciBzID0gYy5lbG0uc3R5bGU7CiAgICBzLnRyYW5zZm9ybSA9IHMuV2Via2l0VHJhbnNmb3JtID0gInRyYW5zbGF0ZSgiLmNvbmNhdChkeCwgInB4LCIpLmNvbmNhdChkeSwgInB4KSIpOwogICAgcy50cmFuc2l0aW9uRHVyYXRpb24gPSAnMHMnOwogIH0KfQp2YXIgcGxhdGZvcm1Db21wb25lbnRzID0gewogIFRyYW5zaXRpb246IFRyYW5zaXRpb24sCiAgVHJhbnNpdGlvbkdyb3VwOiBUcmFuc2l0aW9uR3JvdXAKfTsKCi8vIGluc3RhbGwgcGxhdGZvcm0gc3BlY2lmaWMgdXRpbHMKVnVlLmNvbmZpZy5tdXN0VXNlUHJvcCA9IG11c3RVc2VQcm9wOwpWdWUuY29uZmlnLmlzUmVzZXJ2ZWRUYWcgPSBpc1Jlc2VydmVkVGFnOwpWdWUuY29uZmlnLmlzUmVzZXJ2ZWRBdHRyID0gaXNSZXNlcnZlZEF0dHI7ClZ1ZS5jb25maWcuZ2V0VGFnTmFtZXNwYWNlID0gZ2V0VGFnTmFtZXNwYWNlOwpWdWUuY29uZmlnLmlzVW5rbm93bkVsZW1lbnQgPSBpc1Vua25vd25FbGVtZW50OwovLyBpbnN0YWxsIHBsYXRmb3JtIHJ1bnRpbWUgZGlyZWN0aXZlcyAmIGNvbXBvbmVudHMKZXh0ZW5kKFZ1ZS5vcHRpb25zLmRpcmVjdGl2ZXMsIHBsYXRmb3JtRGlyZWN0aXZlcyk7CmV4dGVuZChWdWUub3B0aW9ucy5jb21wb25lbnRzLCBwbGF0Zm9ybUNvbXBvbmVudHMpOwovLyBpbnN0YWxsIHBsYXRmb3JtIHBhdGNoIGZ1bmN0aW9uClZ1ZS5wcm90b3R5cGUuX19wYXRjaF9fID0gaW5Ccm93c2VyID8gcGF0Y2ggOiBub29wOwovLyBwdWJsaWMgbW91bnQgbWV0aG9kClZ1ZS5wcm90b3R5cGUuJG1vdW50ID0gZnVuY3Rpb24gKGVsLCBoeWRyYXRpbmcpIHsKICBlbCA9IGVsICYmIGluQnJvd3NlciA/IHF1ZXJ5KGVsKSA6IHVuZGVmaW5lZDsKICByZXR1cm4gbW91bnRDb21wb25lbnQodGhpcywgZWwsIGh5ZHJhdGluZyk7Cn07Ci8vIGRldnRvb2xzIGdsb2JhbCBob29rCi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCmlmIChpbkJyb3dzZXIpIHsKICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgIGlmIChjb25maWcuZGV2dG9vbHMpIHsKICAgICAgaWYgKGRldnRvb2xzKSB7CiAgICAgICAgZGV2dG9vbHMuZW1pdCgnaW5pdCcsIFZ1ZSk7CiAgICAgIH0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Rlc3QnKSB7CiAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvcgogICAgICAgIGNvbnNvbGVbY29uc29sZS5pbmZvID8gJ2luZm8nIDogJ2xvZyddKCdEb3dubG9hZCB0aGUgVnVlIERldnRvb2xzIGV4dGVuc2lvbiBmb3IgYSBiZXR0ZXIgZGV2ZWxvcG1lbnQgZXhwZXJpZW5jZTpcbicgKyAnaHR0cHM6Ly9naXRodWIuY29tL3Z1ZWpzL3Z1ZS1kZXZ0b29scycpOwogICAgICB9CiAgICB9CiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJyAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Rlc3QnICYmIGNvbmZpZy5wcm9kdWN0aW9uVGlwICE9PSBmYWxzZSAmJiB0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvcgogICAgICBjb25zb2xlW2NvbnNvbGUuaW5mbyA/ICdpbmZvJyA6ICdsb2cnXSgiWW91IGFyZSBydW5uaW5nIFZ1ZSBpbiBkZXZlbG9wbWVudCBtb2RlLlxuIiArICJNYWtlIHN1cmUgdG8gdHVybiBvbiBwcm9kdWN0aW9uIG1vZGUgd2hlbiBkZXBsb3lpbmcgZm9yIHByb2R1Y3Rpb24uXG4iICsgIlNlZSBtb3JlIHRpcHMgYXQgaHR0cHM6Ly92dWVqcy5vcmcvZ3VpZGUvZGVwbG95bWVudC5odG1sIik7CiAgICB9CiAgfSwgMCk7Cn0KZXhwb3J0IHsgRWZmZWN0U2NvcGUsIGNvbXB1dGVkLCBjdXN0b21SZWYsIFZ1ZSBhcyBkZWZhdWx0LCBkZWZpbmVBc3luY0NvbXBvbmVudCwgZGVmaW5lQ29tcG9uZW50LCBkZWwsIGVmZmVjdFNjb3BlLCBnZXRDdXJyZW50SW5zdGFuY2UsIGdldEN1cnJlbnRTY29wZSwgaCwgaW5qZWN0LCBpc1Byb3h5LCBpc1JlYWN0aXZlLCBpc1JlYWRvbmx5LCBpc1JlZiwgaXNTaGFsbG93LCBtYXJrUmF3LCBtZXJnZURlZmF1bHRzLCBuZXh0VGljaywgb25BY3RpdmF0ZWQsIG9uQmVmb3JlTW91bnQsIG9uQmVmb3JlVW5tb3VudCwgb25CZWZvcmVVcGRhdGUsIG9uRGVhY3RpdmF0ZWQsIG9uRXJyb3JDYXB0dXJlZCwgb25Nb3VudGVkLCBvblJlbmRlclRyYWNrZWQsIG9uUmVuZGVyVHJpZ2dlcmVkLCBvblNjb3BlRGlzcG9zZSwgb25TZXJ2ZXJQcmVmZXRjaCwgb25Vbm1vdW50ZWQsIG9uVXBkYXRlZCwgcHJvdmlkZSwgcHJveHlSZWZzLCByZWFjdGl2ZSwgcmVhZG9ubHksIHJlZiQxIGFzIHJlZiwgc2V0LCBzaGFsbG93UmVhY3RpdmUsIHNoYWxsb3dSZWFkb25seSwgc2hhbGxvd1JlZiwgdG9SYXcsIHRvUmVmLCB0b1JlZnMsIHRyaWdnZXJSZWYsIHVucmVmLCB1c2VBdHRycywgdXNlQ3NzTW9kdWxlLCB1c2VDc3NWYXJzLCB1c2VMaXN0ZW5lcnMsIHVzZVNsb3RzLCB2ZXJzaW9uLCB3YXRjaCwgd2F0Y2hFZmZlY3QsIHdhdGNoUG9zdEVmZmVjdCwgd2F0Y2hTeW5jRWZmZWN0IH07"},{"version":3,"names":["emptyObject","Object","freeze","isArray","Array","isUndef","v","undefined","isDef","isTrue","isFalse","isPrimitive","value","isFunction","isObject","obj","_toString","prototype","toString","toRawType","call","slice","isPlainObject","isRegExp","isValidArrayIndex","val","n","parseFloat","String","Math","floor","isFinite","isPromise","then","catch","JSON","stringify","replacer","_key","__v_isRef","toNumber","isNaN","makeMap","str","expectsLowerCase","map","create","list","split","i","length","toLowerCase","isBuiltInTag","isReservedAttribute","remove$2","arr","item","len","index","indexOf","splice","hasOwnProperty","hasOwn","key","cached","fn","cache","cachedFn","hit","camelizeRE","camelize","replace","_","c","toUpperCase","capitalize","charAt","hyphenateRE","hyphenate","polyfillBind","ctx","boundFn","a","l","arguments","apply","_length","nativeBind","bind","Function","toArray","start","ret","extend","to","_from","toObject","res","noop","b","no","identity","looseEqual","isObjectA","isObjectB","isArrayA","isArrayB","every","e","Date","getTime","keysA","keys","keysB","looseIndexOf","once","called","hasChanged","x","y","SSR_ATTR","ASSET_TYPES","LIFECYCLE_HOOKS","config","optionMergeStrategies","silent","productionTip","process","env","NODE_ENV","devtools","performance","errorHandler","warnHandler","ignoredElements","keyCodes","isReservedTag","isReservedAttr","isUnknownElement","getTagNamespace","parsePlatformTagName","mustUseProp","async","_lifecycleHooks","unicodeRegExp","isReserved","charCodeAt","def","enumerable","defineProperty","writable","configurable","bailRE","RegExp","concat","source","parsePath","path","test","segments","hasProto","inBrowser","window","UA","navigator","userAgent","isIE","isIE9","isEdge","isIOS","isFF","match","nativeWatch","watch","supportsPassive","opts","get","addEventListener","_isServer","isServerRendering","global","VUE_ENV","__VUE_DEVTOOLS_GLOBAL_HOOK__","isNative","Ctor","hasSymbol","Symbol","Reflect","ownKeys","_Set","Set","set","has","add","clear","currentInstance","getCurrentInstance","proxy","setCurrentInstance","vm","_scope","off","on","VNode","tag","data","children","text","elm","context","componentOptions","asyncFactory","ns","fnContext","fnOptions","fnScopeId","componentInstance","parent","raw","isStatic","isRootInsert","isComment","isCloned","isOnce","asyncMeta","isAsyncPlaceholder","createEmptyVNode","node","createTextVNode","cloneVNode","vnode","cloned","__assign","assign","t","s","p","SuppressedError","error","suppressed","message","Error","name","uid$2","pendingCleanupDeps","cleanupDeps","dep","subs","filter","_pending","Dep","id","addSub","sub","push","removeSub","depend","info","target","addDep","onTrack","effect","notify","sort","onTrigger","update","targetStack","pushTarget","popTarget","pop","arrayProto","arrayMethods","methodsToPatch","forEach","method","original","mutator","args","_i","result","ob","__ob__","inserted","observeArray","type","arrayKeys","getOwnPropertyNames","NO_INITIAL_VALUE","shouldObserve","toggleObserving","mockDep","Observer","shallow","mock","vmCount","__proto__","defineReactive","observe","ssrMockReactivity","isExtensible","__v_skip","isRef","customSetter","observeEvenIfShallow","property","getOwnPropertyDescriptor","getter","setter","childOb","reactiveGetter","dependArray","reactiveSetter","newVal","newValue","oldValue","warn","isReadonly","max","_isVue","del","reactive","makeReactive","shallowReactive","existingOb","isCollectionType","isReactive","isShallow","__v_isShallow","__v_isReadonly","isProxy","toRaw","observed","markRaw","RefFlag","r","ref$1","createRef","shallowRef","rawValue","ref","triggerRef","unref","proxyRefs","objectWithRefs","proxyWithRefUnwrap","customRef","factory","_a","toRefs","object","toRef","defaultValue","rawToReadonlyFlag","rawToShallowReadonlyFlag","readonly","createReadonly","existingFlag","existingProxy","getPrototypeOf","defineReadonlyProperty","shallowReadonly","computed","getterOrOptions","debugOptions","onlyGetter","watcher","Watcher","lazy","dirty","evaluate","WATCHER","WATCHER_CB","WATCHER_GETTER","WATCHER_CLEANUP","watchEffect","options","doWatch","watchPostEffect","flush","watchSyncEffect","INITIAL_WATCHER_VALUE","cb","_b","immediate","deep","_c","warnInvalidSource","instance","invokeWithErrorHandling","forceTrigger","isMultiSource","some","traverse","_isDestroyed","cleanup","onCleanup","baseGetter_1","onStop","noRecurse","run","active","post","queueWatcher","_isMounted","buffer","_preWatchers","$once","teardown","activeEffectScope","EffectScope","detached","effects","cleanups","scopes","currentEffectScope","stop","fromParent","last","effectScope","recordEffectScope","scope","getCurrentScope","onScopeDispose","provide","resolveProvided","existing","_provided","parentProvides","$parent","inject","treatDefaultAsFactory","provides","normalizeEvent","passive","capture","createFnInvoker","fns","invoker","updateListeners","oldOn","remove","createOnceHandler","cur","old","event","params","mergeVNodeHook","hookKey","hook","oldHook","wrappedHook","merged","extractPropsFromVNodeData","propOptions","props","attrs","altKey","keyInLowerCase","tip","formatComponentName","checkProp","hash","preserve","simpleNormalizeChildren","normalizeChildren","normalizeArrayChildren","isTextNode","nestedIndex","lastIndex","shift","_isVList","renderList","render","iterator","next","done","renderSlot","fallbackRender","bindObject","scopedSlotFn","$scopedSlots","nodes","$slots","slot","$createElement","resolveFilter","resolveAsset","$options","isKeyNotMatch","expect","actual","checkKeyCodes","eventKeyCode","builtInKeyCode","eventKeyName","builtInKeyName","mappedKeyCode","bindObjectProps","asProp","isSync","_loop_1","domProps","camelizedKey","hyphenatedKey","$event","renderStatic","isInFor","_staticTrees","tree","staticRenderFns","_renderProxy","markStatic","markOnce","markStaticNode","bindObjectListeners","ours","resolveScopedSlots","hasDynamicKeys","contentHashKey","$stable","$key","bindDynamicKeys","baseObj","values","prependModifier","symbol","installRenderHelpers","_o","_n","_s","_l","_t","_q","_m","_f","_k","_v","_e","_u","_g","_d","_p","resolveSlots","slots","child","name_1","default","name_2","isWhitespace","normalizeScopedSlots","ownerVm","scopedSlots","normalSlots","prevScopedSlots","hasNormalSlots","isStable","_normalized","$hasNormal","key_1","normalizeScopedSlot","key_2","proxyNormalSlot","normalized","initSetup","setup","_setupContext","createSetupContext","setupResult","_props","_setupState","__sfc","_setupProxy","exposeCalled","_attrsProxy","syncSetupProxy","$attrs","listeners","_listenersProxy","$listeners","initSlotsProxy","emit","$emit","expose","exposed","from","prev","changed","defineProxyAttr","_slotsProxy","syncSetupSlots","useSlots","getContext","useAttrs","useListeners","mergeDefaults","defaults","reduce","opt","initRender","_vnode","parentVnode","$vnode","_parentVnode","renderContext","_renderChildren","d","createElement$1","parentData","isUpdatingChildComponent","_parentListeners","currentRenderingInstance","renderMixin","Vue","$nextTick","nextTick","_render","prevInst","prevRenderInst","handleError","renderError","ensureCtor","comp","base","__esModule","toStringTag","createAsyncPlaceholder","resolveAsyncComponent","baseCtor","errorComp","resolved","owner","owners","loading","loadingComp","owners_1","sync_1","timerLoading_1","timerTimeout_1","$on","forceRender_1","renderCompleted","$forceUpdate","clearTimeout","resolve","reject_1","reason","res_1","component","delay","setTimeout","timeout","getFirstComponentChild","SIMPLE_NORMALIZE","ALWAYS_NORMALIZE","normalizationType","alwaysNormalize","_createElement","is","nativeOn","pre","createComponent","applyNS","registerDeepBindings","force","style","class","h","err","hooks","errorCaptured","globalHandleError","handler","_handled","logError","console","isUsingMicroTask","callbacks","pending","flushCallbacks","copies","timerFunc","Promise","p_1","MutationObserver","counter_1","observer","textNode_1","document","createTextNode","characterData","setImmediate","_resolve","useCssModule","mod","useCssVars","el","$el","vars","nodeType","setProperty","defineAsyncComponent","loader","loadingComponent","errorComponent","suspensible","userOnError","onError","pendingRequest","retries","retry","load","thisRequest","reject","userRetry","userFail","createLifeCycle","hookName","formatName","injectHook","mergeLifecycleHook","onBeforeMount","onMounted","onBeforeUpdate","onUpdated","onBeforeUnmount","onUnmounted","onActivated","onDeactivated","onServerPrefetch","onRenderTracked","onRenderTriggered","injectErrorCapturedHook","onErrorCaptured","version","defineComponent","seenObjects","_traverse","seen","isA","isFrozen","depId","uid$1","expOrFn","isRenderWatcher","_vm","_watcher","user","sync","before","deps","newDeps","depIds","newDepIds","expression","tmp","_isBeingDestroyed","mark","measure","perf_1","clearMarks","clearMeasures","startTag","endTag","initEvents","_events","_hasHookEvent","updateComponentListeners","target$1","add$1","remove$1","$off","createOnceHandler$1","_target","onceHandler","oldListeners","eventsMixin","hookRE","i_1","cbs","lowerCaseEvent","activeInstance","setActiveInstance","prevActiveInstance","initLifecycle","abstract","$children","$root","$refs","_inactive","_directInactive","lifecycleMixin","_update","hydrating","prevEl","prevVnode","restoreActiveInstance","__patch__","__vue__","wrapper","$destroy","callHook$1","_data","mountComponent","template","updateComponent","_name","_uid","watcherOptions","preWatchers","updateChildComponent","propsData","renderChildren","newScopedSlots","oldScopedSlots","hasDynamicScopedSlot","needsForceUpdate","prevVNode","prevListeners","propKeys","_propKeys","validateProp","isInInactiveTree","activateChildComponent","direct","deactivateChildComponent","setContext","prevScope","handlers","j","MAX_UPDATE_COUNT","queue","activatedChildren","circular","waiting","flushing","resetSchedulerState","currentFlushTimestamp","getNow","now","performance_1","createEvent","timeStamp","sortCompareFn","flushSchedulerQueue","activatedQueue","updatedQueue","callActivatedHooks","callUpdatedHooks","queueActivatedComponent","initProvide","provideOption","provided","initInjections","resolveInject","provideKey","provideDefault","FunctionalRenderContext","_this","contextVm","_original","isCompiled","_compiled","needNormalization","injections","_scopeId","createFunctionalComponent","mergeProps","cloneAndMarkFunctionalResult","vnodes","clone","devtoolsMeta","getComponentName","__name","_componentTag","componentVNodeHooks","init","keepAlive","mountedNode","prepatch","createComponentInstanceForVnode","$mount","oldVnode","insert","destroy","hooksToMerge","_base","cid","resolveConstructorOptions","model","transformModel","functional","installComponentHooks","_isComponent","inlineTemplate","toMerge","_merged","mergeHook","f1","f2","prop","callback","generateComponentTrace","hasConsole_1","classifyRE_1","classify_1","msg","trace","includeFile","constructor","file","__file","repeat_1","currentRecursiveSequence","join","strats","defaultStrat","mergeData","recursive","toVal","fromVal","mergeDataOrFn","parentVal","childVal","mergedDataFn","mergedInstanceDataFn","instanceData","defaultData","dedupeHooks","mergeAssets","assertObjectType","parent_1","methods","checkComponents","components","validateComponentName","normalizeProps","normalizeInject","normalizeDirectives$1","dirs","directives","mergeOptions","extends","mixins","mergeField","strat","warnMissing","assets","camelizedId","PascalCaseId","absent","booleanIndex","getTypeIndex","Boolean","stringIndex","getPropDefaultValue","prevShouldObserve","assertProp","getType","required","valid","expectedTypes","assertedType","assertType","expectedType","haveExpectedTypes","getInvalidTypeMessage","validator","simpleCheckRE","functionTypeCheckRE","isSameType","receivedType","isExplicable","isBoolean","styleValue","Number","EXPLICABLE_TYPES","elem","initProxy","allowedGlobals_1","warnNonPresent_1","warnReservedPrefix_1","hasProxy_1","Proxy","isBuiltInModifier_1","hasHandler_1","isAllowed","$data","getHandler_1","_withStripped","sharedPropertyDefinition","sourceKey","proxyGetter","proxySetter","initState","initProps$1","initMethods","initData","initComputed$1","initWatch","propsOptions","isRoot","getData","computedWatcherOptions","watchers","_computedWatchers","isSSR","userDef","defineComputed","shouldCache","createComputedGetter","createGetterInvoker","computedGetter","createWatcher","$watch","stateMixin","dataDef","propsDef","$set","$delete","unwatchFn","uid","initMixin$1","_init","initInternalComponent","_self","vnodeComponentOptions","super","superOptions","cachedSuperOptions","modifiedOptions","resolveModifiedOptions","extendOptions","modified","latest","sealed","sealedOptions","initUse","use","plugin","installedPlugins","_installedPlugins","unshift","install","initMixin","mixin","initExtend","Super","SuperId","cachedCtors","_Ctor","Sub","VueComponent","initProps","initComputed","Comp","initAssetRegisters","definition","_getComponentName","matches","pattern","pruneCache","keepAliveInstance","entry","pruneCacheEntry","current","patternTypes","KeepAlive","include","exclude","cacheVNode","vnodeToCache","keyToCache","parseInt","created","destroyed","mounted","updated","builtInComponents","initGlobalAPI","configDef","util","delete","observable","ssrContext","acceptValue","attr","isEnumeratedAttr","isValidContentEditableValue","convertEnumeratedValue","isFalsyAttrValue","isBooleanAttr","xlinkNS","isXlink","getXlinkProp","genClassForVnode","parentNode","childNode","mergeClassData","renderClass","staticClass","dynamicClass","stringifyClass","stringifyArray","stringifyObject","stringified","namespaceMap","svg","math","isHTMLTag","isSVG","unknownElementCache","createElement","HTMLUnknownElement","HTMLElement","isTextInputType","query","selected","querySelector","tagName","multiple","setAttribute","createElementNS","namespace","createComment","insertBefore","newNode","referenceNode","removeChild","appendChild","nextSibling","setTextContent","textContent","setStyleScope","scopeId","nodeOps","registerRef","isRemoval","refValue","$refsValue","isFor","refInFor","_isString","_isRef","refs","setSetupRef","includes","emptyNode","sameVnode","sameInputType","typeA","typeB","createKeyToOldIdx","beginIdx","endIdx","createPatchFunction","backend","modules","emptyNodeAt","createRmCb","childElm","removeNode","inVPre","ignore","creatingElmInVPre","createElm","insertedVnodeQueue","parentElm","refElm","nested","ownerArray","setScope","createChildren","invokeCreateHooks","isReactivated","initComponent","reactivateComponent","pendingInsert","isPatchable","innerNode","transition","activate","checkDuplicateKeys","i_2","ancestor","addVnodes","startIdx","invokeDestroyHook","removeVnodes","ch","removeAndInvokeRemoveHook","rm","i_3","updateChildren","oldCh","newCh","removeOnly","oldStartIdx","newStartIdx","oldEndIdx","oldStartVnode","oldEndVnode","newEndIdx","newStartVnode","newEndVnode","oldKeyToIdx","idxInOld","vnodeToMove","canMove","patchVnode","findIdxInOld","seenKeys","i_4","end","i_5","hydrate","postpatch","invokeInsertHook","initial","i_6","hydrationBailed","isRenderedModule","assertNodeMatch","hasChildNodes","innerHTML","childrenMatch","firstChild","i_7","childNodes","fullInvoke","patch","isInitialPatch","isRealElement","hasAttribute","removeAttribute","oldElm","_leaveCb","patchable","i_8","i_9","insert_1","i_10","updateDirectives","unbindDirectives","isCreate","isDestroy","oldDirs","normalizeDirectives","newDirs","dirsWithInsert","dirsWithPostpatch","oldDir","dir","callHook","oldArg","arg","componentUpdated","callInsert","emptyModifiers","modifiers","getRawDirName","setupDef","rawName","baseModules","updateAttrs","inheritAttrs","oldAttrs","_v_attr_proxy","setAttr","removeAttributeNS","isInPre","baseSetAttr","setAttributeNS","__ieph","blocker_1","stopImmediatePropagation","removeEventListener","updateClass","oldData","cls","transitionClass","_transitionClasses","_prevClass","klass","RANGE_TOKEN","CHECKBOX_RADIO_TOKEN","normalizeEvents","event_1","change","useMicrotaskFix","attachedTimestamp_1","original_1","_wrapper","currentTarget","ownerDocument","updateDOMListeners","events","svgContainer","updateDOMProps","oldProps","_value","strCur","shouldUpdateValue","checkVal","composing","isNotInFocusAndDirty","isDirtyWithModifiers","notInFocus","activeElement","_vModifiers","number","trim","parseStyleText","cssText","listDelimiter","propertyDelimiter","normalizeStyleData","normalizeStyleBinding","staticStyle","bindingStyle","getStyle","checkChild","styleData","cssVarRE","importantRE","setProp","normalizedName","normalize","vendorNames","emptyStyle","capName","updateStyle","oldStaticStyle","oldStyleBinding","normalizedStyle","oldStyle","newStyle","whitespaceRE","addClass","classList","getAttribute","removeClass","tar","resolveTransition","css","autoCssTransition","enterClass","enterToClass","enterActiveClass","leaveClass","leaveToClass","leaveActiveClass","hasTransition","TRANSITION","ANIMATION","transitionProp","transitionEndEvent","animationProp","animationEndEvent","ontransitionend","onwebkittransitionend","onanimationend","onwebkitanimationend","raf","requestAnimationFrame","nextFrame","addTransitionClass","transitionClasses","removeTransitionClass","whenTransitionEnds","getTransitionInfo","propCount","ended","onEnd","transformRE","styles","getComputedStyle","transitionDelays","transitionDurations","transitionTimeout","getTimeout","animationDelays","animationDurations","animationTimeout","hasTransform","delays","durations","toMs","enter","toggleDisplay","cancelled","_enterCb","appearClass","appearToClass","appearActiveClass","beforeEnter","afterEnter","enterCancelled","beforeAppear","appear","afterAppear","appearCancelled","duration","transitionNode","isAppear","startClass","activeClass","toClass","beforeEnterHook","enterHook","afterEnterHook","enterCancelledHook","explicitEnterDuration","checkDuration","expectsCSS","userWantsControl","getHookArgumentsLength","show","pendingNode","isValidDuration","leave","beforeLeave","afterLeave","leaveCancelled","delayLeave","explicitLeaveDuration","performLeave","invokerFns","_enter","platformModules","vmodel","trigger","directive","binding","_vOptions","setSelected","getValue","onCompositionStart","onCompositionEnd","prevOptions_1","curOptions_1","o","needReset","hasNoMatchingOption","actuallySetSelected","isMultiple","option","selectedIndex","initEvent","dispatchEvent","locateNode","originalDisplay","__vOriginalDisplay","display","unbind","platformDirectives","transitionProps","mode","getRealChild","compOptions","extractTransitionData","placeholder","rawChild","hasParentTransition","isSameChild","oldChild","isNotTextNode","isVShowDirective","Transition","_leaving","oldRawChild","delayedLeave_1","moveClass","TransitionGroup","beforeMount","kept","prevChildren","rawChildren","transitionData","removed","pos","getBoundingClientRect","hasMove","callPendingCbs","recordPosition","applyTranslation","_reflow","body","offsetHeight","moved","el_1","transform","WebkitTransform","transitionDuration","_moveCb","propertyName","_hasMove","cloneNode","newPos","oldPos","dx","left","dy","top","platformComponents"],"sources":["F:/fortivex/vuepress-tutorial/docs/node_modules/vue/dist/vue.runtime.esm.js"],"sourcesContent":["/*!\n * Vue.js v2.7.16\n * (c) 2014-2023 Evan You\n * Released under the MIT License.\n */\nvar emptyObject = Object.freeze({});\nvar isArray = Array.isArray;\n// These helpers produce better VM code in JS engines due to their\n// explicitness and function inlining.\nfunction isUndef(v) {\n    return v === undefined || v === null;\n}\nfunction isDef(v) {\n    return v !== undefined && v !== null;\n}\nfunction isTrue(v) {\n    return v === true;\n}\nfunction isFalse(v) {\n    return v === false;\n}\n/**\n * Check if value is primitive.\n */\nfunction isPrimitive(value) {\n    return (typeof value === 'string' ||\n        typeof value === 'number' ||\n        // $flow-disable-line\n        typeof value === 'symbol' ||\n        typeof value === 'boolean');\n}\nfunction isFunction(value) {\n    return typeof value === 'function';\n}\n/**\n * Quick object check - this is primarily used to tell\n * objects from primitive values when we know the value\n * is a JSON-compliant type.\n */\nfunction isObject(obj) {\n    return obj !== null && typeof obj === 'object';\n}\n/**\n * Get the raw type string of a value, e.g., [object Object].\n */\nvar _toString = Object.prototype.toString;\nfunction toRawType(value) {\n    return _toString.call(value).slice(8, -1);\n}\n/**\n * Strict object type check. Only returns true\n * for plain JavaScript objects.\n */\nfunction isPlainObject(obj) {\n    return _toString.call(obj) === '[object Object]';\n}\nfunction isRegExp(v) {\n    return _toString.call(v) === '[object RegExp]';\n}\n/**\n * Check if val is a valid array index.\n */\nfunction isValidArrayIndex(val) {\n    var n = parseFloat(String(val));\n    return n >= 0 && Math.floor(n) === n && isFinite(val);\n}\nfunction isPromise(val) {\n    return (isDef(val) &&\n        typeof val.then === 'function' &&\n        typeof val.catch === 'function');\n}\n/**\n * Convert a value to a string that is actually rendered.\n */\nfunction toString(val) {\n    return val == null\n        ? ''\n        : Array.isArray(val) || (isPlainObject(val) && val.toString === _toString)\n            ? JSON.stringify(val, replacer, 2)\n            : String(val);\n}\nfunction replacer(_key, val) {\n    // avoid circular deps from v3\n    if (val && val.__v_isRef) {\n        return val.value;\n    }\n    return val;\n}\n/**\n * Convert an input value to a number for persistence.\n * If the conversion fails, return original string.\n */\nfunction toNumber(val) {\n    var n = parseFloat(val);\n    return isNaN(n) ? val : n;\n}\n/**\n * Make a map and return a function for checking if a key\n * is in that map.\n */\nfunction makeMap(str, expectsLowerCase) {\n    var map = Object.create(null);\n    var list = str.split(',');\n    for (var i = 0; i < list.length; i++) {\n        map[list[i]] = true;\n    }\n    return expectsLowerCase ? function (val) { return map[val.toLowerCase()]; } : function (val) { return map[val]; };\n}\n/**\n * Check if a tag is a built-in tag.\n */\nvar isBuiltInTag = makeMap('slot,component', true);\n/**\n * Check if an attribute is a reserved attribute.\n */\nvar isReservedAttribute = makeMap('key,ref,slot,slot-scope,is');\n/**\n * Remove an item from an array.\n */\nfunction remove$2(arr, item) {\n    var len = arr.length;\n    if (len) {\n        // fast path for the only / last item\n        if (item === arr[len - 1]) {\n            arr.length = len - 1;\n            return;\n        }\n        var index = arr.indexOf(item);\n        if (index > -1) {\n            return arr.splice(index, 1);\n        }\n    }\n}\n/**\n * Check whether an object has the property.\n */\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nfunction hasOwn(obj, key) {\n    return hasOwnProperty.call(obj, key);\n}\n/**\n * Create a cached version of a pure function.\n */\nfunction cached(fn) {\n    var cache = Object.create(null);\n    return function cachedFn(str) {\n        var hit = cache[str];\n        return hit || (cache[str] = fn(str));\n    };\n}\n/**\n * Camelize a hyphen-delimited string.\n */\nvar camelizeRE = /-(\\w)/g;\nvar camelize = cached(function (str) {\n    return str.replace(camelizeRE, function (_, c) { return (c ? c.toUpperCase() : ''); });\n});\n/**\n * Capitalize a string.\n */\nvar capitalize = cached(function (str) {\n    return str.charAt(0).toUpperCase() + str.slice(1);\n});\n/**\n * Hyphenate a camelCase string.\n */\nvar hyphenateRE = /\\B([A-Z])/g;\nvar hyphenate = cached(function (str) {\n    return str.replace(hyphenateRE, '-$1').toLowerCase();\n});\n/**\n * Simple bind polyfill for environments that do not support it,\n * e.g., PhantomJS 1.x. Technically, we don't need this anymore\n * since native bind is now performant enough in most browsers.\n * But removing it would mean breaking code that was able to run in\n * PhantomJS 1.x, so this must be kept for backward compatibility.\n */\n/* istanbul ignore next */\nfunction polyfillBind(fn, ctx) {\n    function boundFn(a) {\n        var l = arguments.length;\n        return l\n            ? l > 1\n                ? fn.apply(ctx, arguments)\n                : fn.call(ctx, a)\n            : fn.call(ctx);\n    }\n    boundFn._length = fn.length;\n    return boundFn;\n}\nfunction nativeBind(fn, ctx) {\n    return fn.bind(ctx);\n}\n// @ts-expect-error bind cannot be `undefined`\nvar bind = Function.prototype.bind ? nativeBind : polyfillBind;\n/**\n * Convert an Array-like object to a real Array.\n */\nfunction toArray(list, start) {\n    start = start || 0;\n    var i = list.length - start;\n    var ret = new Array(i);\n    while (i--) {\n        ret[i] = list[i + start];\n    }\n    return ret;\n}\n/**\n * Mix properties into target object.\n */\nfunction extend(to, _from) {\n    for (var key in _from) {\n        to[key] = _from[key];\n    }\n    return to;\n}\n/**\n * Merge an Array of Objects into a single Object.\n */\nfunction toObject(arr) {\n    var res = {};\n    for (var i = 0; i < arr.length; i++) {\n        if (arr[i]) {\n            extend(res, arr[i]);\n        }\n    }\n    return res;\n}\n/* eslint-disable no-unused-vars */\n/**\n * Perform no operation.\n * Stubbing args to make Flow happy without leaving useless transpiled code\n * with ...rest (https://flow.org/blog/2017/05/07/Strict-Function-Call-Arity/).\n */\nfunction noop(a, b, c) { }\n/**\n * Always return false.\n */\nvar no = function (a, b, c) { return false; };\n/* eslint-enable no-unused-vars */\n/**\n * Return the same value.\n */\nvar identity = function (_) { return _; };\n/**\n * Check if two values are loosely equal - that is,\n * if they are plain objects, do they have the same shape?\n */\nfunction looseEqual(a, b) {\n    if (a === b)\n        return true;\n    var isObjectA = isObject(a);\n    var isObjectB = isObject(b);\n    if (isObjectA && isObjectB) {\n        try {\n            var isArrayA = Array.isArray(a);\n            var isArrayB = Array.isArray(b);\n            if (isArrayA && isArrayB) {\n                return (a.length === b.length &&\n                    a.every(function (e, i) {\n                        return looseEqual(e, b[i]);\n                    }));\n            }\n            else if (a instanceof Date && b instanceof Date) {\n                return a.getTime() === b.getTime();\n            }\n            else if (!isArrayA && !isArrayB) {\n                var keysA = Object.keys(a);\n                var keysB = Object.keys(b);\n                return (keysA.length === keysB.length &&\n                    keysA.every(function (key) {\n                        return looseEqual(a[key], b[key]);\n                    }));\n            }\n            else {\n                /* istanbul ignore next */\n                return false;\n            }\n        }\n        catch (e) {\n            /* istanbul ignore next */\n            return false;\n        }\n    }\n    else if (!isObjectA && !isObjectB) {\n        return String(a) === String(b);\n    }\n    else {\n        return false;\n    }\n}\n/**\n * Return the first index at which a loosely equal value can be\n * found in the array (if value is a plain object, the array must\n * contain an object of the same shape), or -1 if it is not present.\n */\nfunction looseIndexOf(arr, val) {\n    for (var i = 0; i < arr.length; i++) {\n        if (looseEqual(arr[i], val))\n            return i;\n    }\n    return -1;\n}\n/**\n * Ensure a function is called only once.\n */\nfunction once(fn) {\n    var called = false;\n    return function () {\n        if (!called) {\n            called = true;\n            fn.apply(this, arguments);\n        }\n    };\n}\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is#polyfill\nfunction hasChanged(x, y) {\n    if (x === y) {\n        return x === 0 && 1 / x !== 1 / y;\n    }\n    else {\n        return x === x || y === y;\n    }\n}\n\nvar SSR_ATTR = 'data-server-rendered';\nvar ASSET_TYPES = ['component', 'directive', 'filter'];\nvar LIFECYCLE_HOOKS = [\n    'beforeCreate',\n    'created',\n    'beforeMount',\n    'mounted',\n    'beforeUpdate',\n    'updated',\n    'beforeDestroy',\n    'destroyed',\n    'activated',\n    'deactivated',\n    'errorCaptured',\n    'serverPrefetch',\n    'renderTracked',\n    'renderTriggered'\n];\n\nvar config = {\n    /**\n     * Option merge strategies (used in core/util/options)\n     */\n    // $flow-disable-line\n    optionMergeStrategies: Object.create(null),\n    /**\n     * Whether to suppress warnings.\n     */\n    silent: false,\n    /**\n     * Show production mode tip message on boot?\n     */\n    productionTip: process.env.NODE_ENV !== 'production',\n    /**\n     * Whether to enable devtools\n     */\n    devtools: process.env.NODE_ENV !== 'production',\n    /**\n     * Whether to record perf\n     */\n    performance: false,\n    /**\n     * Error handler for watcher errors\n     */\n    errorHandler: null,\n    /**\n     * Warn handler for watcher warns\n     */\n    warnHandler: null,\n    /**\n     * Ignore certain custom elements\n     */\n    ignoredElements: [],\n    /**\n     * Custom user key aliases for v-on\n     */\n    // $flow-disable-line\n    keyCodes: Object.create(null),\n    /**\n     * Check if a tag is reserved so that it cannot be registered as a\n     * component. This is platform-dependent and may be overwritten.\n     */\n    isReservedTag: no,\n    /**\n     * Check if an attribute is reserved so that it cannot be used as a component\n     * prop. This is platform-dependent and may be overwritten.\n     */\n    isReservedAttr: no,\n    /**\n     * Check if a tag is an unknown element.\n     * Platform-dependent.\n     */\n    isUnknownElement: no,\n    /**\n     * Get the namespace of an element\n     */\n    getTagNamespace: noop,\n    /**\n     * Parse the real tag name for the specific platform.\n     */\n    parsePlatformTagName: identity,\n    /**\n     * Check if an attribute must be bound using property, e.g. value\n     * Platform-dependent.\n     */\n    mustUseProp: no,\n    /**\n     * Perform updates asynchronously. Intended to be used by Vue Test Utils\n     * This will significantly reduce performance if set to false.\n     */\n    async: true,\n    /**\n     * Exposed for legacy reasons\n     */\n    _lifecycleHooks: LIFECYCLE_HOOKS\n};\n\n/**\n * unicode letters used for parsing html tags, component names and property paths.\n * using https://www.w3.org/TR/html53/semantics-scripting.html#potentialcustomelementname\n * skipping \\u10000-\\uEFFFF due to it freezing up PhantomJS\n */\nvar unicodeRegExp = /a-zA-Z\\u00B7\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u203F-\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD/;\n/**\n * Check if a string starts with $ or _\n */\nfunction isReserved(str) {\n    var c = (str + '').charCodeAt(0);\n    return c === 0x24 || c === 0x5f;\n}\n/**\n * Define a property.\n */\nfunction def(obj, key, val, enumerable) {\n    Object.defineProperty(obj, key, {\n        value: val,\n        enumerable: !!enumerable,\n        writable: true,\n        configurable: true\n    });\n}\n/**\n * Parse simple path.\n */\nvar bailRE = new RegExp(\"[^\".concat(unicodeRegExp.source, \".$_\\\\d]\"));\nfunction parsePath(path) {\n    if (bailRE.test(path)) {\n        return;\n    }\n    var segments = path.split('.');\n    return function (obj) {\n        for (var i = 0; i < segments.length; i++) {\n            if (!obj)\n                return;\n            obj = obj[segments[i]];\n        }\n        return obj;\n    };\n}\n\n// can we use __proto__?\nvar hasProto = '__proto__' in {};\n// Browser environment sniffing\nvar inBrowser = typeof window !== 'undefined';\nvar UA = inBrowser && window.navigator.userAgent.toLowerCase();\nvar isIE = UA && /msie|trident/.test(UA);\nvar isIE9 = UA && UA.indexOf('msie 9.0') > 0;\nvar isEdge = UA && UA.indexOf('edge/') > 0;\nUA && UA.indexOf('android') > 0;\nvar isIOS = UA && /iphone|ipad|ipod|ios/.test(UA);\nUA && /chrome\\/\\d+/.test(UA) && !isEdge;\nUA && /phantomjs/.test(UA);\nvar isFF = UA && UA.match(/firefox\\/(\\d+)/);\n// Firefox has a \"watch\" function on Object.prototype...\n// @ts-expect-error firebox support\nvar nativeWatch = {}.watch;\nvar supportsPassive = false;\nif (inBrowser) {\n    try {\n        var opts = {};\n        Object.defineProperty(opts, 'passive', {\n            get: function () {\n                /* istanbul ignore next */\n                supportsPassive = true;\n            }\n        }); // https://github.com/facebook/flow/issues/285\n        window.addEventListener('test-passive', null, opts);\n    }\n    catch (e) { }\n}\n// this needs to be lazy-evaled because vue may be required before\n// vue-server-renderer can set VUE_ENV\nvar _isServer;\nvar isServerRendering = function () {\n    if (_isServer === undefined) {\n        /* istanbul ignore if */\n        if (!inBrowser && typeof global !== 'undefined') {\n            // detect presence of vue-server-renderer and avoid\n            // Webpack shimming the process\n            _isServer =\n                global['process'] && global['process'].env.VUE_ENV === 'server';\n        }\n        else {\n            _isServer = false;\n        }\n    }\n    return _isServer;\n};\n// detect devtools\nvar devtools = inBrowser && window.__VUE_DEVTOOLS_GLOBAL_HOOK__;\n/* istanbul ignore next */\nfunction isNative(Ctor) {\n    return typeof Ctor === 'function' && /native code/.test(Ctor.toString());\n}\nvar hasSymbol = typeof Symbol !== 'undefined' &&\n    isNative(Symbol) &&\n    typeof Reflect !== 'undefined' &&\n    isNative(Reflect.ownKeys);\nvar _Set; // $flow-disable-line\n/* istanbul ignore if */ if (typeof Set !== 'undefined' && isNative(Set)) {\n    // use native Set when available.\n    _Set = Set;\n}\nelse {\n    // a non-standard Set polyfill that only works with primitive keys.\n    _Set = /** @class */ (function () {\n        function Set() {\n            this.set = Object.create(null);\n        }\n        Set.prototype.has = function (key) {\n            return this.set[key] === true;\n        };\n        Set.prototype.add = function (key) {\n            this.set[key] = true;\n        };\n        Set.prototype.clear = function () {\n            this.set = Object.create(null);\n        };\n        return Set;\n    }());\n}\n\nvar currentInstance = null;\n/**\n * This is exposed for compatibility with v3 (e.g. some functions in VueUse\n * relies on it). Do not use this internally, just use `currentInstance`.\n *\n * @internal this function needs manual type declaration because it relies\n * on previously manually authored types from Vue 2\n */\nfunction getCurrentInstance() {\n    return currentInstance && { proxy: currentInstance };\n}\n/**\n * @internal\n */\nfunction setCurrentInstance(vm) {\n    if (vm === void 0) { vm = null; }\n    if (!vm)\n        currentInstance && currentInstance._scope.off();\n    currentInstance = vm;\n    vm && vm._scope.on();\n}\n\n/**\n * @internal\n */\nvar VNode = /** @class */ (function () {\n    function VNode(tag, data, children, text, elm, context, componentOptions, asyncFactory) {\n        this.tag = tag;\n        this.data = data;\n        this.children = children;\n        this.text = text;\n        this.elm = elm;\n        this.ns = undefined;\n        this.context = context;\n        this.fnContext = undefined;\n        this.fnOptions = undefined;\n        this.fnScopeId = undefined;\n        this.key = data && data.key;\n        this.componentOptions = componentOptions;\n        this.componentInstance = undefined;\n        this.parent = undefined;\n        this.raw = false;\n        this.isStatic = false;\n        this.isRootInsert = true;\n        this.isComment = false;\n        this.isCloned = false;\n        this.isOnce = false;\n        this.asyncFactory = asyncFactory;\n        this.asyncMeta = undefined;\n        this.isAsyncPlaceholder = false;\n    }\n    Object.defineProperty(VNode.prototype, \"child\", {\n        // DEPRECATED: alias for componentInstance for backwards compat.\n        /* istanbul ignore next */\n        get: function () {\n            return this.componentInstance;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return VNode;\n}());\nvar createEmptyVNode = function (text) {\n    if (text === void 0) { text = ''; }\n    var node = new VNode();\n    node.text = text;\n    node.isComment = true;\n    return node;\n};\nfunction createTextVNode(val) {\n    return new VNode(undefined, undefined, undefined, String(val));\n}\n// optimized shallow clone\n// used for static nodes and slot nodes because they may be reused across\n// multiple renders, cloning them avoids errors when DOM manipulations rely\n// on their elm reference.\nfunction cloneVNode(vnode) {\n    var cloned = new VNode(vnode.tag, vnode.data, \n    // #7975\n    // clone children array to avoid mutating original in case of cloning\n    // a child.\n    vnode.children && vnode.children.slice(), vnode.text, vnode.elm, vnode.context, vnode.componentOptions, vnode.asyncFactory);\n    cloned.ns = vnode.ns;\n    cloned.isStatic = vnode.isStatic;\n    cloned.key = vnode.key;\n    cloned.isComment = vnode.isComment;\n    cloned.fnContext = vnode.fnContext;\n    cloned.fnOptions = vnode.fnOptions;\n    cloned.fnScopeId = vnode.fnScopeId;\n    cloned.asyncMeta = vnode.asyncMeta;\n    cloned.isCloned = true;\n    return cloned;\n}\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\n\nvar uid$2 = 0;\nvar pendingCleanupDeps = [];\nvar cleanupDeps = function () {\n    for (var i = 0; i < pendingCleanupDeps.length; i++) {\n        var dep = pendingCleanupDeps[i];\n        dep.subs = dep.subs.filter(function (s) { return s; });\n        dep._pending = false;\n    }\n    pendingCleanupDeps.length = 0;\n};\n/**\n * A dep is an observable that can have multiple\n * directives subscribing to it.\n * @internal\n */\nvar Dep = /** @class */ (function () {\n    function Dep() {\n        // pending subs cleanup\n        this._pending = false;\n        this.id = uid$2++;\n        this.subs = [];\n    }\n    Dep.prototype.addSub = function (sub) {\n        this.subs.push(sub);\n    };\n    Dep.prototype.removeSub = function (sub) {\n        // #12696 deps with massive amount of subscribers are extremely slow to\n        // clean up in Chromium\n        // to workaround this, we unset the sub for now, and clear them on\n        // next scheduler flush.\n        this.subs[this.subs.indexOf(sub)] = null;\n        if (!this._pending) {\n            this._pending = true;\n            pendingCleanupDeps.push(this);\n        }\n    };\n    Dep.prototype.depend = function (info) {\n        if (Dep.target) {\n            Dep.target.addDep(this);\n            if (process.env.NODE_ENV !== 'production' && info && Dep.target.onTrack) {\n                Dep.target.onTrack(__assign({ effect: Dep.target }, info));\n            }\n        }\n    };\n    Dep.prototype.notify = function (info) {\n        // stabilize the subscriber list first\n        var subs = this.subs.filter(function (s) { return s; });\n        if (process.env.NODE_ENV !== 'production' && !config.async) {\n            // subs aren't sorted in scheduler if not running async\n            // we need to sort them now to make sure they fire in correct\n            // order\n            subs.sort(function (a, b) { return a.id - b.id; });\n        }\n        for (var i = 0, l = subs.length; i < l; i++) {\n            var sub = subs[i];\n            if (process.env.NODE_ENV !== 'production' && info) {\n                sub.onTrigger &&\n                    sub.onTrigger(__assign({ effect: subs[i] }, info));\n            }\n            sub.update();\n        }\n    };\n    return Dep;\n}());\n// The current target watcher being evaluated.\n// This is globally unique because only one watcher\n// can be evaluated at a time.\nDep.target = null;\nvar targetStack = [];\nfunction pushTarget(target) {\n    targetStack.push(target);\n    Dep.target = target;\n}\nfunction popTarget() {\n    targetStack.pop();\n    Dep.target = targetStack[targetStack.length - 1];\n}\n\n/*\n * not type checking this file because flow doesn't play well with\n * dynamically accessing methods on Array prototype\n */\nvar arrayProto = Array.prototype;\nvar arrayMethods = Object.create(arrayProto);\nvar methodsToPatch = [\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'splice',\n    'sort',\n    'reverse'\n];\n/**\n * Intercept mutating methods and emit events\n */\nmethodsToPatch.forEach(function (method) {\n    // cache original method\n    var original = arrayProto[method];\n    def(arrayMethods, method, function mutator() {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var result = original.apply(this, args);\n        var ob = this.__ob__;\n        var inserted;\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                inserted = args;\n                break;\n            case 'splice':\n                inserted = args.slice(2);\n                break;\n        }\n        if (inserted)\n            ob.observeArray(inserted);\n        // notify change\n        if (process.env.NODE_ENV !== 'production') {\n            ob.dep.notify({\n                type: \"array mutation\" /* TriggerOpTypes.ARRAY_MUTATION */,\n                target: this,\n                key: method\n            });\n        }\n        else {\n            ob.dep.notify();\n        }\n        return result;\n    });\n});\n\nvar arrayKeys = Object.getOwnPropertyNames(arrayMethods);\nvar NO_INITIAL_VALUE = {};\n/**\n * In some cases we may want to disable observation inside a component's\n * update computation.\n */\nvar shouldObserve = true;\nfunction toggleObserving(value) {\n    shouldObserve = value;\n}\n// ssr mock dep\nvar mockDep = {\n    notify: noop,\n    depend: noop,\n    addSub: noop,\n    removeSub: noop\n};\n/**\n * Observer class that is attached to each observed\n * object. Once attached, the observer converts the target\n * object's property keys into getter/setters that\n * collect dependencies and dispatch updates.\n */\nvar Observer = /** @class */ (function () {\n    function Observer(value, shallow, mock) {\n        if (shallow === void 0) { shallow = false; }\n        if (mock === void 0) { mock = false; }\n        this.value = value;\n        this.shallow = shallow;\n        this.mock = mock;\n        // this.value = value\n        this.dep = mock ? mockDep : new Dep();\n        this.vmCount = 0;\n        def(value, '__ob__', this);\n        if (isArray(value)) {\n            if (!mock) {\n                if (hasProto) {\n                    value.__proto__ = arrayMethods;\n                    /* eslint-enable no-proto */\n                }\n                else {\n                    for (var i = 0, l = arrayKeys.length; i < l; i++) {\n                        var key = arrayKeys[i];\n                        def(value, key, arrayMethods[key]);\n                    }\n                }\n            }\n            if (!shallow) {\n                this.observeArray(value);\n            }\n        }\n        else {\n            /**\n             * Walk through all properties and convert them into\n             * getter/setters. This method should only be called when\n             * value type is Object.\n             */\n            var keys = Object.keys(value);\n            for (var i = 0; i < keys.length; i++) {\n                var key = keys[i];\n                defineReactive(value, key, NO_INITIAL_VALUE, undefined, shallow, mock);\n            }\n        }\n    }\n    /**\n     * Observe a list of Array items.\n     */\n    Observer.prototype.observeArray = function (value) {\n        for (var i = 0, l = value.length; i < l; i++) {\n            observe(value[i], false, this.mock);\n        }\n    };\n    return Observer;\n}());\n// helpers\n/**\n * Attempt to create an observer instance for a value,\n * returns the new observer if successfully observed,\n * or the existing observer if the value already has one.\n */\nfunction observe(value, shallow, ssrMockReactivity) {\n    if (value && hasOwn(value, '__ob__') && value.__ob__ instanceof Observer) {\n        return value.__ob__;\n    }\n    if (shouldObserve &&\n        (ssrMockReactivity || !isServerRendering()) &&\n        (isArray(value) || isPlainObject(value)) &&\n        Object.isExtensible(value) &&\n        !value.__v_skip /* ReactiveFlags.SKIP */ &&\n        !isRef(value) &&\n        !(value instanceof VNode)) {\n        return new Observer(value, shallow, ssrMockReactivity);\n    }\n}\n/**\n * Define a reactive property on an Object.\n */\nfunction defineReactive(obj, key, val, customSetter, shallow, mock, observeEvenIfShallow) {\n    if (observeEvenIfShallow === void 0) { observeEvenIfShallow = false; }\n    var dep = new Dep();\n    var property = Object.getOwnPropertyDescriptor(obj, key);\n    if (property && property.configurable === false) {\n        return;\n    }\n    // cater for pre-defined getter/setters\n    var getter = property && property.get;\n    var setter = property && property.set;\n    if ((!getter || setter) &&\n        (val === NO_INITIAL_VALUE || arguments.length === 2)) {\n        val = obj[key];\n    }\n    var childOb = shallow ? val && val.__ob__ : observe(val, false, mock);\n    Object.defineProperty(obj, key, {\n        enumerable: true,\n        configurable: true,\n        get: function reactiveGetter() {\n            var value = getter ? getter.call(obj) : val;\n            if (Dep.target) {\n                if (process.env.NODE_ENV !== 'production') {\n                    dep.depend({\n                        target: obj,\n                        type: \"get\" /* TrackOpTypes.GET */,\n                        key: key\n                    });\n                }\n                else {\n                    dep.depend();\n                }\n                if (childOb) {\n                    childOb.dep.depend();\n                    if (isArray(value)) {\n                        dependArray(value);\n                    }\n                }\n            }\n            return isRef(value) && !shallow ? value.value : value;\n        },\n        set: function reactiveSetter(newVal) {\n            var value = getter ? getter.call(obj) : val;\n            if (!hasChanged(value, newVal)) {\n                return;\n            }\n            if (process.env.NODE_ENV !== 'production' && customSetter) {\n                customSetter();\n            }\n            if (setter) {\n                setter.call(obj, newVal);\n            }\n            else if (getter) {\n                // #7981: for accessor properties without setter\n                return;\n            }\n            else if (!shallow && isRef(value) && !isRef(newVal)) {\n                value.value = newVal;\n                return;\n            }\n            else {\n                val = newVal;\n            }\n            childOb = shallow ? newVal && newVal.__ob__ : observe(newVal, false, mock);\n            if (process.env.NODE_ENV !== 'production') {\n                dep.notify({\n                    type: \"set\" /* TriggerOpTypes.SET */,\n                    target: obj,\n                    key: key,\n                    newValue: newVal,\n                    oldValue: value\n                });\n            }\n            else {\n                dep.notify();\n            }\n        }\n    });\n    return dep;\n}\nfunction set(target, key, val) {\n    if (process.env.NODE_ENV !== 'production' && (isUndef(target) || isPrimitive(target))) {\n        warn(\"Cannot set reactive property on undefined, null, or primitive value: \".concat(target));\n    }\n    if (isReadonly(target)) {\n        process.env.NODE_ENV !== 'production' && warn(\"Set operation on key \\\"\".concat(key, \"\\\" failed: target is readonly.\"));\n        return;\n    }\n    var ob = target.__ob__;\n    if (isArray(target) && isValidArrayIndex(key)) {\n        target.length = Math.max(target.length, key);\n        target.splice(key, 1, val);\n        // when mocking for SSR, array methods are not hijacked\n        if (ob && !ob.shallow && ob.mock) {\n            observe(val, false, true);\n        }\n        return val;\n    }\n    if (key in target && !(key in Object.prototype)) {\n        target[key] = val;\n        return val;\n    }\n    if (target._isVue || (ob && ob.vmCount)) {\n        process.env.NODE_ENV !== 'production' &&\n            warn('Avoid adding reactive properties to a Vue instance or its root $data ' +\n                'at runtime - declare it upfront in the data option.');\n        return val;\n    }\n    if (!ob) {\n        target[key] = val;\n        return val;\n    }\n    defineReactive(ob.value, key, val, undefined, ob.shallow, ob.mock);\n    if (process.env.NODE_ENV !== 'production') {\n        ob.dep.notify({\n            type: \"add\" /* TriggerOpTypes.ADD */,\n            target: target,\n            key: key,\n            newValue: val,\n            oldValue: undefined\n        });\n    }\n    else {\n        ob.dep.notify();\n    }\n    return val;\n}\nfunction del(target, key) {\n    if (process.env.NODE_ENV !== 'production' && (isUndef(target) || isPrimitive(target))) {\n        warn(\"Cannot delete reactive property on undefined, null, or primitive value: \".concat(target));\n    }\n    if (isArray(target) && isValidArrayIndex(key)) {\n        target.splice(key, 1);\n        return;\n    }\n    var ob = target.__ob__;\n    if (target._isVue || (ob && ob.vmCount)) {\n        process.env.NODE_ENV !== 'production' &&\n            warn('Avoid deleting properties on a Vue instance or its root $data ' +\n                '- just set it to null.');\n        return;\n    }\n    if (isReadonly(target)) {\n        process.env.NODE_ENV !== 'production' &&\n            warn(\"Delete operation on key \\\"\".concat(key, \"\\\" failed: target is readonly.\"));\n        return;\n    }\n    if (!hasOwn(target, key)) {\n        return;\n    }\n    delete target[key];\n    if (!ob) {\n        return;\n    }\n    if (process.env.NODE_ENV !== 'production') {\n        ob.dep.notify({\n            type: \"delete\" /* TriggerOpTypes.DELETE */,\n            target: target,\n            key: key\n        });\n    }\n    else {\n        ob.dep.notify();\n    }\n}\n/**\n * Collect dependencies on array elements when the array is touched, since\n * we cannot intercept array element access like property getters.\n */\nfunction dependArray(value) {\n    for (var e = void 0, i = 0, l = value.length; i < l; i++) {\n        e = value[i];\n        if (e && e.__ob__) {\n            e.__ob__.dep.depend();\n        }\n        if (isArray(e)) {\n            dependArray(e);\n        }\n    }\n}\n\nfunction reactive(target) {\n    makeReactive(target, false);\n    return target;\n}\n/**\n * Return a shallowly-reactive copy of the original object, where only the root\n * level properties are reactive. It also does not auto-unwrap refs (even at the\n * root level).\n */\nfunction shallowReactive(target) {\n    makeReactive(target, true);\n    def(target, \"__v_isShallow\" /* ReactiveFlags.IS_SHALLOW */, true);\n    return target;\n}\nfunction makeReactive(target, shallow) {\n    // if trying to observe a readonly proxy, return the readonly version.\n    if (!isReadonly(target)) {\n        if (process.env.NODE_ENV !== 'production') {\n            if (isArray(target)) {\n                warn(\"Avoid using Array as root value for \".concat(shallow ? \"shallowReactive()\" : \"reactive()\", \" as it cannot be tracked in watch() or watchEffect(). Use \").concat(shallow ? \"shallowRef()\" : \"ref()\", \" instead. This is a Vue-2-only limitation.\"));\n            }\n            var existingOb = target && target.__ob__;\n            if (existingOb && existingOb.shallow !== shallow) {\n                warn(\"Target is already a \".concat(existingOb.shallow ? \"\" : \"non-\", \"shallow reactive object, and cannot be converted to \").concat(shallow ? \"\" : \"non-\", \"shallow.\"));\n            }\n        }\n        var ob = observe(target, shallow, isServerRendering() /* ssr mock reactivity */);\n        if (process.env.NODE_ENV !== 'production' && !ob) {\n            if (target == null || isPrimitive(target)) {\n                warn(\"value cannot be made reactive: \".concat(String(target)));\n            }\n            if (isCollectionType(target)) {\n                warn(\"Vue 2 does not support reactive collection types such as Map or Set.\");\n            }\n        }\n    }\n}\nfunction isReactive(value) {\n    if (isReadonly(value)) {\n        return isReactive(value[\"__v_raw\" /* ReactiveFlags.RAW */]);\n    }\n    return !!(value && value.__ob__);\n}\nfunction isShallow(value) {\n    return !!(value && value.__v_isShallow);\n}\nfunction isReadonly(value) {\n    return !!(value && value.__v_isReadonly);\n}\nfunction isProxy(value) {\n    return isReactive(value) || isReadonly(value);\n}\nfunction toRaw(observed) {\n    var raw = observed && observed[\"__v_raw\" /* ReactiveFlags.RAW */];\n    return raw ? toRaw(raw) : observed;\n}\nfunction markRaw(value) {\n    // non-extensible objects won't be observed anyway\n    if (Object.isExtensible(value)) {\n        def(value, \"__v_skip\" /* ReactiveFlags.SKIP */, true);\n    }\n    return value;\n}\n/**\n * @internal\n */\nfunction isCollectionType(value) {\n    var type = toRawType(value);\n    return (type === 'Map' || type === 'WeakMap' || type === 'Set' || type === 'WeakSet');\n}\n\n/**\n * @internal\n */\nvar RefFlag = \"__v_isRef\";\nfunction isRef(r) {\n    return !!(r && r.__v_isRef === true);\n}\nfunction ref$1(value) {\n    return createRef(value, false);\n}\nfunction shallowRef(value) {\n    return createRef(value, true);\n}\nfunction createRef(rawValue, shallow) {\n    if (isRef(rawValue)) {\n        return rawValue;\n    }\n    var ref = {};\n    def(ref, RefFlag, true);\n    def(ref, \"__v_isShallow\" /* ReactiveFlags.IS_SHALLOW */, shallow);\n    def(ref, 'dep', defineReactive(ref, 'value', rawValue, null, shallow, isServerRendering()));\n    return ref;\n}\nfunction triggerRef(ref) {\n    if (process.env.NODE_ENV !== 'production' && !ref.dep) {\n        warn(\"received object is not a triggerable ref.\");\n    }\n    if (process.env.NODE_ENV !== 'production') {\n        ref.dep &&\n            ref.dep.notify({\n                type: \"set\" /* TriggerOpTypes.SET */,\n                target: ref,\n                key: 'value'\n            });\n    }\n    else {\n        ref.dep && ref.dep.notify();\n    }\n}\nfunction unref(ref) {\n    return isRef(ref) ? ref.value : ref;\n}\nfunction proxyRefs(objectWithRefs) {\n    if (isReactive(objectWithRefs)) {\n        return objectWithRefs;\n    }\n    var proxy = {};\n    var keys = Object.keys(objectWithRefs);\n    for (var i = 0; i < keys.length; i++) {\n        proxyWithRefUnwrap(proxy, objectWithRefs, keys[i]);\n    }\n    return proxy;\n}\nfunction proxyWithRefUnwrap(target, source, key) {\n    Object.defineProperty(target, key, {\n        enumerable: true,\n        configurable: true,\n        get: function () {\n            var val = source[key];\n            if (isRef(val)) {\n                return val.value;\n            }\n            else {\n                var ob = val && val.__ob__;\n                if (ob)\n                    ob.dep.depend();\n                return val;\n            }\n        },\n        set: function (value) {\n            var oldValue = source[key];\n            if (isRef(oldValue) && !isRef(value)) {\n                oldValue.value = value;\n            }\n            else {\n                source[key] = value;\n            }\n        }\n    });\n}\nfunction customRef(factory) {\n    var dep = new Dep();\n    var _a = factory(function () {\n        if (process.env.NODE_ENV !== 'production') {\n            dep.depend({\n                target: ref,\n                type: \"get\" /* TrackOpTypes.GET */,\n                key: 'value'\n            });\n        }\n        else {\n            dep.depend();\n        }\n    }, function () {\n        if (process.env.NODE_ENV !== 'production') {\n            dep.notify({\n                target: ref,\n                type: \"set\" /* TriggerOpTypes.SET */,\n                key: 'value'\n            });\n        }\n        else {\n            dep.notify();\n        }\n    }), get = _a.get, set = _a.set;\n    var ref = {\n        get value() {\n            return get();\n        },\n        set value(newVal) {\n            set(newVal);\n        }\n    };\n    def(ref, RefFlag, true);\n    return ref;\n}\nfunction toRefs(object) {\n    if (process.env.NODE_ENV !== 'production' && !isReactive(object)) {\n        warn(\"toRefs() expects a reactive object but received a plain one.\");\n    }\n    var ret = isArray(object) ? new Array(object.length) : {};\n    for (var key in object) {\n        ret[key] = toRef(object, key);\n    }\n    return ret;\n}\nfunction toRef(object, key, defaultValue) {\n    var val = object[key];\n    if (isRef(val)) {\n        return val;\n    }\n    var ref = {\n        get value() {\n            var val = object[key];\n            return val === undefined ? defaultValue : val;\n        },\n        set value(newVal) {\n            object[key] = newVal;\n        }\n    };\n    def(ref, RefFlag, true);\n    return ref;\n}\n\nvar rawToReadonlyFlag = \"__v_rawToReadonly\";\nvar rawToShallowReadonlyFlag = \"__v_rawToShallowReadonly\";\nfunction readonly(target) {\n    return createReadonly(target, false);\n}\nfunction createReadonly(target, shallow) {\n    if (!isPlainObject(target)) {\n        if (process.env.NODE_ENV !== 'production') {\n            if (isArray(target)) {\n                warn(\"Vue 2 does not support readonly arrays.\");\n            }\n            else if (isCollectionType(target)) {\n                warn(\"Vue 2 does not support readonly collection types such as Map or Set.\");\n            }\n            else {\n                warn(\"value cannot be made readonly: \".concat(typeof target));\n            }\n        }\n        return target;\n    }\n    if (process.env.NODE_ENV !== 'production' && !Object.isExtensible(target)) {\n        warn(\"Vue 2 does not support creating readonly proxy for non-extensible object.\");\n    }\n    // already a readonly object\n    if (isReadonly(target)) {\n        return target;\n    }\n    // already has a readonly proxy\n    var existingFlag = shallow ? rawToShallowReadonlyFlag : rawToReadonlyFlag;\n    var existingProxy = target[existingFlag];\n    if (existingProxy) {\n        return existingProxy;\n    }\n    var proxy = Object.create(Object.getPrototypeOf(target));\n    def(target, existingFlag, proxy);\n    def(proxy, \"__v_isReadonly\" /* ReactiveFlags.IS_READONLY */, true);\n    def(proxy, \"__v_raw\" /* ReactiveFlags.RAW */, target);\n    if (isRef(target)) {\n        def(proxy, RefFlag, true);\n    }\n    if (shallow || isShallow(target)) {\n        def(proxy, \"__v_isShallow\" /* ReactiveFlags.IS_SHALLOW */, true);\n    }\n    var keys = Object.keys(target);\n    for (var i = 0; i < keys.length; i++) {\n        defineReadonlyProperty(proxy, target, keys[i], shallow);\n    }\n    return proxy;\n}\nfunction defineReadonlyProperty(proxy, target, key, shallow) {\n    Object.defineProperty(proxy, key, {\n        enumerable: true,\n        configurable: true,\n        get: function () {\n            var val = target[key];\n            return shallow || !isPlainObject(val) ? val : readonly(val);\n        },\n        set: function () {\n            process.env.NODE_ENV !== 'production' &&\n                warn(\"Set operation on key \\\"\".concat(key, \"\\\" failed: target is readonly.\"));\n        }\n    });\n}\n/**\n * Returns a reactive-copy of the original object, where only the root level\n * properties are readonly, and does NOT unwrap refs nor recursively convert\n * returned properties.\n * This is used for creating the props proxy object for stateful components.\n */\nfunction shallowReadonly(target) {\n    return createReadonly(target, true);\n}\n\nfunction computed(getterOrOptions, debugOptions) {\n    var getter;\n    var setter;\n    var onlyGetter = isFunction(getterOrOptions);\n    if (onlyGetter) {\n        getter = getterOrOptions;\n        setter = process.env.NODE_ENV !== 'production'\n            ? function () {\n                warn('Write operation failed: computed value is readonly');\n            }\n            : noop;\n    }\n    else {\n        getter = getterOrOptions.get;\n        setter = getterOrOptions.set;\n    }\n    var watcher = isServerRendering()\n        ? null\n        : new Watcher(currentInstance, getter, noop, { lazy: true });\n    if (process.env.NODE_ENV !== 'production' && watcher && debugOptions) {\n        watcher.onTrack = debugOptions.onTrack;\n        watcher.onTrigger = debugOptions.onTrigger;\n    }\n    var ref = {\n        // some libs rely on the presence effect for checking computed refs\n        // from normal refs, but the implementation doesn't matter\n        effect: watcher,\n        get value() {\n            if (watcher) {\n                if (watcher.dirty) {\n                    watcher.evaluate();\n                }\n                if (Dep.target) {\n                    if (process.env.NODE_ENV !== 'production' && Dep.target.onTrack) {\n                        Dep.target.onTrack({\n                            effect: Dep.target,\n                            target: ref,\n                            type: \"get\" /* TrackOpTypes.GET */,\n                            key: 'value'\n                        });\n                    }\n                    watcher.depend();\n                }\n                return watcher.value;\n            }\n            else {\n                return getter();\n            }\n        },\n        set value(newVal) {\n            setter(newVal);\n        }\n    };\n    def(ref, RefFlag, true);\n    def(ref, \"__v_isReadonly\" /* ReactiveFlags.IS_READONLY */, onlyGetter);\n    return ref;\n}\n\nvar WATCHER = \"watcher\";\nvar WATCHER_CB = \"\".concat(WATCHER, \" callback\");\nvar WATCHER_GETTER = \"\".concat(WATCHER, \" getter\");\nvar WATCHER_CLEANUP = \"\".concat(WATCHER, \" cleanup\");\n// Simple effect.\nfunction watchEffect(effect, options) {\n    return doWatch(effect, null, options);\n}\nfunction watchPostEffect(effect, options) {\n    return doWatch(effect, null, (process.env.NODE_ENV !== 'production'\n        ? __assign(__assign({}, options), { flush: 'post' }) : { flush: 'post' }));\n}\nfunction watchSyncEffect(effect, options) {\n    return doWatch(effect, null, (process.env.NODE_ENV !== 'production'\n        ? __assign(__assign({}, options), { flush: 'sync' }) : { flush: 'sync' }));\n}\n// initial value for watchers to trigger on undefined initial values\nvar INITIAL_WATCHER_VALUE = {};\n// implementation\nfunction watch(source, cb, options) {\n    if (process.env.NODE_ENV !== 'production' && typeof cb !== 'function') {\n        warn(\"`watch(fn, options?)` signature has been moved to a separate API. \" +\n            \"Use `watchEffect(fn, options?)` instead. `watch` now only \" +\n            \"supports `watch(source, cb, options?) signature.\");\n    }\n    return doWatch(source, cb, options);\n}\nfunction doWatch(source, cb, _a) {\n    var _b = _a === void 0 ? emptyObject : _a, immediate = _b.immediate, deep = _b.deep, _c = _b.flush, flush = _c === void 0 ? 'pre' : _c, onTrack = _b.onTrack, onTrigger = _b.onTrigger;\n    if (process.env.NODE_ENV !== 'production' && !cb) {\n        if (immediate !== undefined) {\n            warn(\"watch() \\\"immediate\\\" option is only respected when using the \" +\n                \"watch(source, callback, options?) signature.\");\n        }\n        if (deep !== undefined) {\n            warn(\"watch() \\\"deep\\\" option is only respected when using the \" +\n                \"watch(source, callback, options?) signature.\");\n        }\n    }\n    var warnInvalidSource = function (s) {\n        warn(\"Invalid watch source: \".concat(s, \". A watch source can only be a getter/effect \") +\n            \"function, a ref, a reactive object, or an array of these types.\");\n    };\n    var instance = currentInstance;\n    var call = function (fn, type, args) {\n        if (args === void 0) { args = null; }\n        var res = invokeWithErrorHandling(fn, null, args, instance, type);\n        if (deep && res && res.__ob__)\n            res.__ob__.dep.depend();\n        return res;\n    };\n    var getter;\n    var forceTrigger = false;\n    var isMultiSource = false;\n    if (isRef(source)) {\n        getter = function () { return source.value; };\n        forceTrigger = isShallow(source);\n    }\n    else if (isReactive(source)) {\n        getter = function () {\n            source.__ob__.dep.depend();\n            return source;\n        };\n        deep = true;\n    }\n    else if (isArray(source)) {\n        isMultiSource = true;\n        forceTrigger = source.some(function (s) { return isReactive(s) || isShallow(s); });\n        getter = function () {\n            return source.map(function (s) {\n                if (isRef(s)) {\n                    return s.value;\n                }\n                else if (isReactive(s)) {\n                    s.__ob__.dep.depend();\n                    return traverse(s);\n                }\n                else if (isFunction(s)) {\n                    return call(s, WATCHER_GETTER);\n                }\n                else {\n                    process.env.NODE_ENV !== 'production' && warnInvalidSource(s);\n                }\n            });\n        };\n    }\n    else if (isFunction(source)) {\n        if (cb) {\n            // getter with cb\n            getter = function () { return call(source, WATCHER_GETTER); };\n        }\n        else {\n            // no cb -> simple effect\n            getter = function () {\n                if (instance && instance._isDestroyed) {\n                    return;\n                }\n                if (cleanup) {\n                    cleanup();\n                }\n                return call(source, WATCHER, [onCleanup]);\n            };\n        }\n    }\n    else {\n        getter = noop;\n        process.env.NODE_ENV !== 'production' && warnInvalidSource(source);\n    }\n    if (cb && deep) {\n        var baseGetter_1 = getter;\n        getter = function () { return traverse(baseGetter_1()); };\n    }\n    var cleanup;\n    var onCleanup = function (fn) {\n        cleanup = watcher.onStop = function () {\n            call(fn, WATCHER_CLEANUP);\n        };\n    };\n    // in SSR there is no need to setup an actual effect, and it should be noop\n    // unless it's eager\n    if (isServerRendering()) {\n        // we will also not call the invalidate callback (+ runner is not set up)\n        onCleanup = noop;\n        if (!cb) {\n            getter();\n        }\n        else if (immediate) {\n            call(cb, WATCHER_CB, [\n                getter(),\n                isMultiSource ? [] : undefined,\n                onCleanup\n            ]);\n        }\n        return noop;\n    }\n    var watcher = new Watcher(currentInstance, getter, noop, {\n        lazy: true\n    });\n    watcher.noRecurse = !cb;\n    var oldValue = isMultiSource ? [] : INITIAL_WATCHER_VALUE;\n    // overwrite default run\n    watcher.run = function () {\n        if (!watcher.active) {\n            return;\n        }\n        if (cb) {\n            // watch(source, cb)\n            var newValue = watcher.get();\n            if (deep ||\n                forceTrigger ||\n                (isMultiSource\n                    ? newValue.some(function (v, i) {\n                        return hasChanged(v, oldValue[i]);\n                    })\n                    : hasChanged(newValue, oldValue))) {\n                // cleanup before running cb again\n                if (cleanup) {\n                    cleanup();\n                }\n                call(cb, WATCHER_CB, [\n                    newValue,\n                    // pass undefined as the old value when it's changed for the first time\n                    oldValue === INITIAL_WATCHER_VALUE ? undefined : oldValue,\n                    onCleanup\n                ]);\n                oldValue = newValue;\n            }\n        }\n        else {\n            // watchEffect\n            watcher.get();\n        }\n    };\n    if (flush === 'sync') {\n        watcher.update = watcher.run;\n    }\n    else if (flush === 'post') {\n        watcher.post = true;\n        watcher.update = function () { return queueWatcher(watcher); };\n    }\n    else {\n        // pre\n        watcher.update = function () {\n            if (instance && instance === currentInstance && !instance._isMounted) {\n                // pre-watcher triggered before\n                var buffer = instance._preWatchers || (instance._preWatchers = []);\n                if (buffer.indexOf(watcher) < 0)\n                    buffer.push(watcher);\n            }\n            else {\n                queueWatcher(watcher);\n            }\n        };\n    }\n    if (process.env.NODE_ENV !== 'production') {\n        watcher.onTrack = onTrack;\n        watcher.onTrigger = onTrigger;\n    }\n    // initial run\n    if (cb) {\n        if (immediate) {\n            watcher.run();\n        }\n        else {\n            oldValue = watcher.get();\n        }\n    }\n    else if (flush === 'post' && instance) {\n        instance.$once('hook:mounted', function () { return watcher.get(); });\n    }\n    else {\n        watcher.get();\n    }\n    return function () {\n        watcher.teardown();\n    };\n}\n\nvar activeEffectScope;\nvar EffectScope = /** @class */ (function () {\n    function EffectScope(detached) {\n        if (detached === void 0) { detached = false; }\n        this.detached = detached;\n        /**\n         * @internal\n         */\n        this.active = true;\n        /**\n         * @internal\n         */\n        this.effects = [];\n        /**\n         * @internal\n         */\n        this.cleanups = [];\n        this.parent = activeEffectScope;\n        if (!detached && activeEffectScope) {\n            this.index =\n                (activeEffectScope.scopes || (activeEffectScope.scopes = [])).push(this) - 1;\n        }\n    }\n    EffectScope.prototype.run = function (fn) {\n        if (this.active) {\n            var currentEffectScope = activeEffectScope;\n            try {\n                activeEffectScope = this;\n                return fn();\n            }\n            finally {\n                activeEffectScope = currentEffectScope;\n            }\n        }\n        else if (process.env.NODE_ENV !== 'production') {\n            warn(\"cannot run an inactive effect scope.\");\n        }\n    };\n    /**\n     * This should only be called on non-detached scopes\n     * @internal\n     */\n    EffectScope.prototype.on = function () {\n        activeEffectScope = this;\n    };\n    /**\n     * This should only be called on non-detached scopes\n     * @internal\n     */\n    EffectScope.prototype.off = function () {\n        activeEffectScope = this.parent;\n    };\n    EffectScope.prototype.stop = function (fromParent) {\n        if (this.active) {\n            var i = void 0, l = void 0;\n            for (i = 0, l = this.effects.length; i < l; i++) {\n                this.effects[i].teardown();\n            }\n            for (i = 0, l = this.cleanups.length; i < l; i++) {\n                this.cleanups[i]();\n            }\n            if (this.scopes) {\n                for (i = 0, l = this.scopes.length; i < l; i++) {\n                    this.scopes[i].stop(true);\n                }\n            }\n            // nested scope, dereference from parent to avoid memory leaks\n            if (!this.detached && this.parent && !fromParent) {\n                // optimized O(1) removal\n                var last = this.parent.scopes.pop();\n                if (last && last !== this) {\n                    this.parent.scopes[this.index] = last;\n                    last.index = this.index;\n                }\n            }\n            this.parent = undefined;\n            this.active = false;\n        }\n    };\n    return EffectScope;\n}());\nfunction effectScope(detached) {\n    return new EffectScope(detached);\n}\n/**\n * @internal\n */\nfunction recordEffectScope(effect, scope) {\n    if (scope === void 0) { scope = activeEffectScope; }\n    if (scope && scope.active) {\n        scope.effects.push(effect);\n    }\n}\nfunction getCurrentScope() {\n    return activeEffectScope;\n}\nfunction onScopeDispose(fn) {\n    if (activeEffectScope) {\n        activeEffectScope.cleanups.push(fn);\n    }\n    else if (process.env.NODE_ENV !== 'production') {\n        warn(\"onScopeDispose() is called when there is no active effect scope\" +\n            \" to be associated with.\");\n    }\n}\n\nfunction provide(key, value) {\n    if (!currentInstance) {\n        if (process.env.NODE_ENV !== 'production') {\n            warn(\"provide() can only be used inside setup().\");\n        }\n    }\n    else {\n        // TS doesn't allow symbol as index type\n        resolveProvided(currentInstance)[key] = value;\n    }\n}\nfunction resolveProvided(vm) {\n    // by default an instance inherits its parent's provides object\n    // but when it needs to provide values of its own, it creates its\n    // own provides object using parent provides object as prototype.\n    // this way in `inject` we can simply look up injections from direct\n    // parent and let the prototype chain do the work.\n    var existing = vm._provided;\n    var parentProvides = vm.$parent && vm.$parent._provided;\n    if (parentProvides === existing) {\n        return (vm._provided = Object.create(parentProvides));\n    }\n    else {\n        return existing;\n    }\n}\nfunction inject(key, defaultValue, treatDefaultAsFactory) {\n    if (treatDefaultAsFactory === void 0) { treatDefaultAsFactory = false; }\n    // fallback to `currentRenderingInstance` so that this can be called in\n    // a functional component\n    var instance = currentInstance;\n    if (instance) {\n        // #2400\n        // to support `app.use` plugins,\n        // fallback to appContext's `provides` if the instance is at root\n        var provides = instance.$parent && instance.$parent._provided;\n        if (provides && key in provides) {\n            // TS doesn't allow symbol as index type\n            return provides[key];\n        }\n        else if (arguments.length > 1) {\n            return treatDefaultAsFactory && isFunction(defaultValue)\n                ? defaultValue.call(instance)\n                : defaultValue;\n        }\n        else if (process.env.NODE_ENV !== 'production') {\n            warn(\"injection \\\"\".concat(String(key), \"\\\" not found.\"));\n        }\n    }\n    else if (process.env.NODE_ENV !== 'production') {\n        warn(\"inject() can only be used inside setup() or functional components.\");\n    }\n}\n\nvar normalizeEvent = cached(function (name) {\n    var passive = name.charAt(0) === '&';\n    name = passive ? name.slice(1) : name;\n    var once = name.charAt(0) === '~'; // Prefixed last, checked first\n    name = once ? name.slice(1) : name;\n    var capture = name.charAt(0) === '!';\n    name = capture ? name.slice(1) : name;\n    return {\n        name: name,\n        once: once,\n        capture: capture,\n        passive: passive\n    };\n});\nfunction createFnInvoker(fns, vm) {\n    function invoker() {\n        var fns = invoker.fns;\n        if (isArray(fns)) {\n            var cloned = fns.slice();\n            for (var i = 0; i < cloned.length; i++) {\n                invokeWithErrorHandling(cloned[i], null, arguments, vm, \"v-on handler\");\n            }\n        }\n        else {\n            // return handler return value for single handlers\n            return invokeWithErrorHandling(fns, null, arguments, vm, \"v-on handler\");\n        }\n    }\n    invoker.fns = fns;\n    return invoker;\n}\nfunction updateListeners(on, oldOn, add, remove, createOnceHandler, vm) {\n    var name, cur, old, event;\n    for (name in on) {\n        cur = on[name];\n        old = oldOn[name];\n        event = normalizeEvent(name);\n        if (isUndef(cur)) {\n            process.env.NODE_ENV !== 'production' &&\n                warn(\"Invalid handler for event \\\"\".concat(event.name, \"\\\": got \") + String(cur), vm);\n        }\n        else if (isUndef(old)) {\n            if (isUndef(cur.fns)) {\n                cur = on[name] = createFnInvoker(cur, vm);\n            }\n            if (isTrue(event.once)) {\n                cur = on[name] = createOnceHandler(event.name, cur, event.capture);\n            }\n            add(event.name, cur, event.capture, event.passive, event.params);\n        }\n        else if (cur !== old) {\n            old.fns = cur;\n            on[name] = old;\n        }\n    }\n    for (name in oldOn) {\n        if (isUndef(on[name])) {\n            event = normalizeEvent(name);\n            remove(event.name, oldOn[name], event.capture);\n        }\n    }\n}\n\nfunction mergeVNodeHook(def, hookKey, hook) {\n    if (def instanceof VNode) {\n        def = def.data.hook || (def.data.hook = {});\n    }\n    var invoker;\n    var oldHook = def[hookKey];\n    function wrappedHook() {\n        hook.apply(this, arguments);\n        // important: remove merged hook to ensure it's called only once\n        // and prevent memory leak\n        remove$2(invoker.fns, wrappedHook);\n    }\n    if (isUndef(oldHook)) {\n        // no existing hook\n        invoker = createFnInvoker([wrappedHook]);\n    }\n    else {\n        /* istanbul ignore if */\n        if (isDef(oldHook.fns) && isTrue(oldHook.merged)) {\n            // already a merged invoker\n            invoker = oldHook;\n            invoker.fns.push(wrappedHook);\n        }\n        else {\n            // existing plain hook\n            invoker = createFnInvoker([oldHook, wrappedHook]);\n        }\n    }\n    invoker.merged = true;\n    def[hookKey] = invoker;\n}\n\nfunction extractPropsFromVNodeData(data, Ctor, tag) {\n    // we are only extracting raw values here.\n    // validation and default values are handled in the child\n    // component itself.\n    var propOptions = Ctor.options.props;\n    if (isUndef(propOptions)) {\n        return;\n    }\n    var res = {};\n    var attrs = data.attrs, props = data.props;\n    if (isDef(attrs) || isDef(props)) {\n        for (var key in propOptions) {\n            var altKey = hyphenate(key);\n            if (process.env.NODE_ENV !== 'production') {\n                var keyInLowerCase = key.toLowerCase();\n                if (key !== keyInLowerCase && attrs && hasOwn(attrs, keyInLowerCase)) {\n                    tip(\"Prop \\\"\".concat(keyInLowerCase, \"\\\" is passed to component \") +\n                        \"\".concat(formatComponentName(\n                        // @ts-expect-error tag is string\n                        tag || Ctor), \", but the declared prop name is\") +\n                        \" \\\"\".concat(key, \"\\\". \") +\n                        \"Note that HTML attributes are case-insensitive and camelCased \" +\n                        \"props need to use their kebab-case equivalents when using in-DOM \" +\n                        \"templates. You should probably use \\\"\".concat(altKey, \"\\\" instead of \\\"\").concat(key, \"\\\".\"));\n                }\n            }\n            checkProp(res, props, key, altKey, true) ||\n                checkProp(res, attrs, key, altKey, false);\n        }\n    }\n    return res;\n}\nfunction checkProp(res, hash, key, altKey, preserve) {\n    if (isDef(hash)) {\n        if (hasOwn(hash, key)) {\n            res[key] = hash[key];\n            if (!preserve) {\n                delete hash[key];\n            }\n            return true;\n        }\n        else if (hasOwn(hash, altKey)) {\n            res[key] = hash[altKey];\n            if (!preserve) {\n                delete hash[altKey];\n            }\n            return true;\n        }\n    }\n    return false;\n}\n\n// The template compiler attempts to minimize the need for normalization by\n// statically analyzing the template at compile time.\n//\n// For plain HTML markup, normalization can be completely skipped because the\n// generated render function is guaranteed to return Array<VNode>. There are\n// two cases where extra normalization is needed:\n// 1. When the children contains components - because a functional component\n// may return an Array instead of a single root. In this case, just a simple\n// normalization is needed - if any child is an Array, we flatten the whole\n// thing with Array.prototype.concat. It is guaranteed to be only 1-level deep\n// because functional components already normalize their own children.\nfunction simpleNormalizeChildren(children) {\n    for (var i = 0; i < children.length; i++) {\n        if (isArray(children[i])) {\n            return Array.prototype.concat.apply([], children);\n        }\n    }\n    return children;\n}\n// 2. When the children contains constructs that always generated nested Arrays,\n// e.g. <template>, <slot>, v-for, or when the children is provided by user\n// with hand-written render functions / JSX. In such cases a full normalization\n// is needed to cater to all possible types of children values.\nfunction normalizeChildren(children) {\n    return isPrimitive(children)\n        ? [createTextVNode(children)]\n        : isArray(children)\n            ? normalizeArrayChildren(children)\n            : undefined;\n}\nfunction isTextNode(node) {\n    return isDef(node) && isDef(node.text) && isFalse(node.isComment);\n}\nfunction normalizeArrayChildren(children, nestedIndex) {\n    var res = [];\n    var i, c, lastIndex, last;\n    for (i = 0; i < children.length; i++) {\n        c = children[i];\n        if (isUndef(c) || typeof c === 'boolean')\n            continue;\n        lastIndex = res.length - 1;\n        last = res[lastIndex];\n        //  nested\n        if (isArray(c)) {\n            if (c.length > 0) {\n                c = normalizeArrayChildren(c, \"\".concat(nestedIndex || '', \"_\").concat(i));\n                // merge adjacent text nodes\n                if (isTextNode(c[0]) && isTextNode(last)) {\n                    res[lastIndex] = createTextVNode(last.text + c[0].text);\n                    c.shift();\n                }\n                res.push.apply(res, c);\n            }\n        }\n        else if (isPrimitive(c)) {\n            if (isTextNode(last)) {\n                // merge adjacent text nodes\n                // this is necessary for SSR hydration because text nodes are\n                // essentially merged when rendered to HTML strings\n                res[lastIndex] = createTextVNode(last.text + c);\n            }\n            else if (c !== '') {\n                // convert primitive to vnode\n                res.push(createTextVNode(c));\n            }\n        }\n        else {\n            if (isTextNode(c) && isTextNode(last)) {\n                // merge adjacent text nodes\n                res[lastIndex] = createTextVNode(last.text + c.text);\n            }\n            else {\n                // default key for nested array children (likely generated by v-for)\n                if (isTrue(children._isVList) &&\n                    isDef(c.tag) &&\n                    isUndef(c.key) &&\n                    isDef(nestedIndex)) {\n                    c.key = \"__vlist\".concat(nestedIndex, \"_\").concat(i, \"__\");\n                }\n                res.push(c);\n            }\n        }\n    }\n    return res;\n}\n\n/**\n * Runtime helper for rendering v-for lists.\n */\nfunction renderList(val, render) {\n    var ret = null, i, l, keys, key;\n    if (isArray(val) || typeof val === 'string') {\n        ret = new Array(val.length);\n        for (i = 0, l = val.length; i < l; i++) {\n            ret[i] = render(val[i], i);\n        }\n    }\n    else if (typeof val === 'number') {\n        ret = new Array(val);\n        for (i = 0; i < val; i++) {\n            ret[i] = render(i + 1, i);\n        }\n    }\n    else if (isObject(val)) {\n        if (hasSymbol && val[Symbol.iterator]) {\n            ret = [];\n            var iterator = val[Symbol.iterator]();\n            var result = iterator.next();\n            while (!result.done) {\n                ret.push(render(result.value, ret.length));\n                result = iterator.next();\n            }\n        }\n        else {\n            keys = Object.keys(val);\n            ret = new Array(keys.length);\n            for (i = 0, l = keys.length; i < l; i++) {\n                key = keys[i];\n                ret[i] = render(val[key], key, i);\n            }\n        }\n    }\n    if (!isDef(ret)) {\n        ret = [];\n    }\n    ret._isVList = true;\n    return ret;\n}\n\n/**\n * Runtime helper for rendering <slot>\n */\nfunction renderSlot(name, fallbackRender, props, bindObject) {\n    var scopedSlotFn = this.$scopedSlots[name];\n    var nodes;\n    if (scopedSlotFn) {\n        // scoped slot\n        props = props || {};\n        if (bindObject) {\n            if (process.env.NODE_ENV !== 'production' && !isObject(bindObject)) {\n                warn('slot v-bind without argument expects an Object', this);\n            }\n            props = extend(extend({}, bindObject), props);\n        }\n        nodes =\n            scopedSlotFn(props) ||\n                (isFunction(fallbackRender) ? fallbackRender() : fallbackRender);\n    }\n    else {\n        nodes =\n            this.$slots[name] ||\n                (isFunction(fallbackRender) ? fallbackRender() : fallbackRender);\n    }\n    var target = props && props.slot;\n    if (target) {\n        return this.$createElement('template', { slot: target }, nodes);\n    }\n    else {\n        return nodes;\n    }\n}\n\n/**\n * Runtime helper for resolving filters\n */\nfunction resolveFilter(id) {\n    return resolveAsset(this.$options, 'filters', id, true) || identity;\n}\n\nfunction isKeyNotMatch(expect, actual) {\n    if (isArray(expect)) {\n        return expect.indexOf(actual) === -1;\n    }\n    else {\n        return expect !== actual;\n    }\n}\n/**\n * Runtime helper for checking keyCodes from config.\n * exposed as Vue.prototype._k\n * passing in eventKeyName as last argument separately for backwards compat\n */\nfunction checkKeyCodes(eventKeyCode, key, builtInKeyCode, eventKeyName, builtInKeyName) {\n    var mappedKeyCode = config.keyCodes[key] || builtInKeyCode;\n    if (builtInKeyName && eventKeyName && !config.keyCodes[key]) {\n        return isKeyNotMatch(builtInKeyName, eventKeyName);\n    }\n    else if (mappedKeyCode) {\n        return isKeyNotMatch(mappedKeyCode, eventKeyCode);\n    }\n    else if (eventKeyName) {\n        return hyphenate(eventKeyName) !== key;\n    }\n    return eventKeyCode === undefined;\n}\n\n/**\n * Runtime helper for merging v-bind=\"object\" into a VNode's data.\n */\nfunction bindObjectProps(data, tag, value, asProp, isSync) {\n    if (value) {\n        if (!isObject(value)) {\n            process.env.NODE_ENV !== 'production' &&\n                warn('v-bind without argument expects an Object or Array value', this);\n        }\n        else {\n            if (isArray(value)) {\n                value = toObject(value);\n            }\n            var hash = void 0;\n            var _loop_1 = function (key) {\n                if (key === 'class' || key === 'style' || isReservedAttribute(key)) {\n                    hash = data;\n                }\n                else {\n                    var type = data.attrs && data.attrs.type;\n                    hash =\n                        asProp || config.mustUseProp(tag, type, key)\n                            ? data.domProps || (data.domProps = {})\n                            : data.attrs || (data.attrs = {});\n                }\n                var camelizedKey = camelize(key);\n                var hyphenatedKey = hyphenate(key);\n                if (!(camelizedKey in hash) && !(hyphenatedKey in hash)) {\n                    hash[key] = value[key];\n                    if (isSync) {\n                        var on = data.on || (data.on = {});\n                        on[\"update:\".concat(key)] = function ($event) {\n                            value[key] = $event;\n                        };\n                    }\n                }\n            };\n            for (var key in value) {\n                _loop_1(key);\n            }\n        }\n    }\n    return data;\n}\n\n/**\n * Runtime helper for rendering static trees.\n */\nfunction renderStatic(index, isInFor) {\n    var cached = this._staticTrees || (this._staticTrees = []);\n    var tree = cached[index];\n    // if has already-rendered static tree and not inside v-for,\n    // we can reuse the same tree.\n    if (tree && !isInFor) {\n        return tree;\n    }\n    // otherwise, render a fresh tree.\n    tree = cached[index] = this.$options.staticRenderFns[index].call(this._renderProxy, this._c, this // for render fns generated for functional component templates\n    );\n    markStatic(tree, \"__static__\".concat(index), false);\n    return tree;\n}\n/**\n * Runtime helper for v-once.\n * Effectively it means marking the node as static with a unique key.\n */\nfunction markOnce(tree, index, key) {\n    markStatic(tree, \"__once__\".concat(index).concat(key ? \"_\".concat(key) : \"\"), true);\n    return tree;\n}\nfunction markStatic(tree, key, isOnce) {\n    if (isArray(tree)) {\n        for (var i = 0; i < tree.length; i++) {\n            if (tree[i] && typeof tree[i] !== 'string') {\n                markStaticNode(tree[i], \"\".concat(key, \"_\").concat(i), isOnce);\n            }\n        }\n    }\n    else {\n        markStaticNode(tree, key, isOnce);\n    }\n}\nfunction markStaticNode(node, key, isOnce) {\n    node.isStatic = true;\n    node.key = key;\n    node.isOnce = isOnce;\n}\n\nfunction bindObjectListeners(data, value) {\n    if (value) {\n        if (!isPlainObject(value)) {\n            process.env.NODE_ENV !== 'production' && warn('v-on without argument expects an Object value', this);\n        }\n        else {\n            var on = (data.on = data.on ? extend({}, data.on) : {});\n            for (var key in value) {\n                var existing = on[key];\n                var ours = value[key];\n                on[key] = existing ? [].concat(existing, ours) : ours;\n            }\n        }\n    }\n    return data;\n}\n\nfunction resolveScopedSlots(fns, res, \n// the following are added in 2.6\nhasDynamicKeys, contentHashKey) {\n    res = res || { $stable: !hasDynamicKeys };\n    for (var i = 0; i < fns.length; i++) {\n        var slot = fns[i];\n        if (isArray(slot)) {\n            resolveScopedSlots(slot, res, hasDynamicKeys);\n        }\n        else if (slot) {\n            // marker for reverse proxying v-slot without scope on this.$slots\n            // @ts-expect-error\n            if (slot.proxy) {\n                // @ts-expect-error\n                slot.fn.proxy = true;\n            }\n            res[slot.key] = slot.fn;\n        }\n    }\n    if (contentHashKey) {\n        res.$key = contentHashKey;\n    }\n    return res;\n}\n\n// helper to process dynamic keys for dynamic arguments in v-bind and v-on.\nfunction bindDynamicKeys(baseObj, values) {\n    for (var i = 0; i < values.length; i += 2) {\n        var key = values[i];\n        if (typeof key === 'string' && key) {\n            baseObj[values[i]] = values[i + 1];\n        }\n        else if (process.env.NODE_ENV !== 'production' && key !== '' && key !== null) {\n            // null is a special value for explicitly removing a binding\n            warn(\"Invalid value for dynamic directive argument (expected string or null): \".concat(key), this);\n        }\n    }\n    return baseObj;\n}\n// helper to dynamically append modifier runtime markers to event names.\n// ensure only append when value is already string, otherwise it will be cast\n// to string and cause the type check to miss.\nfunction prependModifier(value, symbol) {\n    return typeof value === 'string' ? symbol + value : value;\n}\n\nfunction installRenderHelpers(target) {\n    target._o = markOnce;\n    target._n = toNumber;\n    target._s = toString;\n    target._l = renderList;\n    target._t = renderSlot;\n    target._q = looseEqual;\n    target._i = looseIndexOf;\n    target._m = renderStatic;\n    target._f = resolveFilter;\n    target._k = checkKeyCodes;\n    target._b = bindObjectProps;\n    target._v = createTextVNode;\n    target._e = createEmptyVNode;\n    target._u = resolveScopedSlots;\n    target._g = bindObjectListeners;\n    target._d = bindDynamicKeys;\n    target._p = prependModifier;\n}\n\n/**\n * Runtime helper for resolving raw children VNodes into a slot object.\n */\nfunction resolveSlots(children, context) {\n    if (!children || !children.length) {\n        return {};\n    }\n    var slots = {};\n    for (var i = 0, l = children.length; i < l; i++) {\n        var child = children[i];\n        var data = child.data;\n        // remove slot attribute if the node is resolved as a Vue slot node\n        if (data && data.attrs && data.attrs.slot) {\n            delete data.attrs.slot;\n        }\n        // named slots should only be respected if the vnode was rendered in the\n        // same context.\n        if ((child.context === context || child.fnContext === context) &&\n            data &&\n            data.slot != null) {\n            var name_1 = data.slot;\n            var slot = slots[name_1] || (slots[name_1] = []);\n            if (child.tag === 'template') {\n                slot.push.apply(slot, child.children || []);\n            }\n            else {\n                slot.push(child);\n            }\n        }\n        else {\n            (slots.default || (slots.default = [])).push(child);\n        }\n    }\n    // ignore slots that contains only whitespace\n    for (var name_2 in slots) {\n        if (slots[name_2].every(isWhitespace)) {\n            delete slots[name_2];\n        }\n    }\n    return slots;\n}\nfunction isWhitespace(node) {\n    return (node.isComment && !node.asyncFactory) || node.text === ' ';\n}\n\nfunction isAsyncPlaceholder(node) {\n    // @ts-expect-error not really boolean type\n    return node.isComment && node.asyncFactory;\n}\n\nfunction normalizeScopedSlots(ownerVm, scopedSlots, normalSlots, prevScopedSlots) {\n    var res;\n    var hasNormalSlots = Object.keys(normalSlots).length > 0;\n    var isStable = scopedSlots ? !!scopedSlots.$stable : !hasNormalSlots;\n    var key = scopedSlots && scopedSlots.$key;\n    if (!scopedSlots) {\n        res = {};\n    }\n    else if (scopedSlots._normalized) {\n        // fast path 1: child component re-render only, parent did not change\n        return scopedSlots._normalized;\n    }\n    else if (isStable &&\n        prevScopedSlots &&\n        prevScopedSlots !== emptyObject &&\n        key === prevScopedSlots.$key &&\n        !hasNormalSlots &&\n        !prevScopedSlots.$hasNormal) {\n        // fast path 2: stable scoped slots w/ no normal slots to proxy,\n        // only need to normalize once\n        return prevScopedSlots;\n    }\n    else {\n        res = {};\n        for (var key_1 in scopedSlots) {\n            if (scopedSlots[key_1] && key_1[0] !== '$') {\n                res[key_1] = normalizeScopedSlot(ownerVm, normalSlots, key_1, scopedSlots[key_1]);\n            }\n        }\n    }\n    // expose normal slots on scopedSlots\n    for (var key_2 in normalSlots) {\n        if (!(key_2 in res)) {\n            res[key_2] = proxyNormalSlot(normalSlots, key_2);\n        }\n    }\n    // avoriaz seems to mock a non-extensible $scopedSlots object\n    // and when that is passed down this would cause an error\n    if (scopedSlots && Object.isExtensible(scopedSlots)) {\n        scopedSlots._normalized = res;\n    }\n    def(res, '$stable', isStable);\n    def(res, '$key', key);\n    def(res, '$hasNormal', hasNormalSlots);\n    return res;\n}\nfunction normalizeScopedSlot(vm, normalSlots, key, fn) {\n    var normalized = function () {\n        var cur = currentInstance;\n        setCurrentInstance(vm);\n        var res = arguments.length ? fn.apply(null, arguments) : fn({});\n        res =\n            res && typeof res === 'object' && !isArray(res)\n                ? [res] // single vnode\n                : normalizeChildren(res);\n        var vnode = res && res[0];\n        setCurrentInstance(cur);\n        return res &&\n            (!vnode ||\n                (res.length === 1 && vnode.isComment && !isAsyncPlaceholder(vnode))) // #9658, #10391\n            ? undefined\n            : res;\n    };\n    // this is a slot using the new v-slot syntax without scope. although it is\n    // compiled as a scoped slot, render fn users would expect it to be present\n    // on this.$slots because the usage is semantically a normal slot.\n    if (fn.proxy) {\n        Object.defineProperty(normalSlots, key, {\n            get: normalized,\n            enumerable: true,\n            configurable: true\n        });\n    }\n    return normalized;\n}\nfunction proxyNormalSlot(slots, key) {\n    return function () { return slots[key]; };\n}\n\nfunction initSetup(vm) {\n    var options = vm.$options;\n    var setup = options.setup;\n    if (setup) {\n        var ctx = (vm._setupContext = createSetupContext(vm));\n        setCurrentInstance(vm);\n        pushTarget();\n        var setupResult = invokeWithErrorHandling(setup, null, [vm._props || shallowReactive({}), ctx], vm, \"setup\");\n        popTarget();\n        setCurrentInstance();\n        if (isFunction(setupResult)) {\n            // render function\n            // @ts-ignore\n            options.render = setupResult;\n        }\n        else if (isObject(setupResult)) {\n            // bindings\n            if (process.env.NODE_ENV !== 'production' && setupResult instanceof VNode) {\n                warn(\"setup() should not return VNodes directly - \" +\n                    \"return a render function instead.\");\n            }\n            vm._setupState = setupResult;\n            // __sfc indicates compiled bindings from <script setup>\n            if (!setupResult.__sfc) {\n                for (var key in setupResult) {\n                    if (!isReserved(key)) {\n                        proxyWithRefUnwrap(vm, setupResult, key);\n                    }\n                    else if (process.env.NODE_ENV !== 'production') {\n                        warn(\"Avoid using variables that start with _ or $ in setup().\");\n                    }\n                }\n            }\n            else {\n                // exposed for compiled render fn\n                var proxy = (vm._setupProxy = {});\n                for (var key in setupResult) {\n                    if (key !== '__sfc') {\n                        proxyWithRefUnwrap(proxy, setupResult, key);\n                    }\n                }\n            }\n        }\n        else if (process.env.NODE_ENV !== 'production' && setupResult !== undefined) {\n            warn(\"setup() should return an object. Received: \".concat(setupResult === null ? 'null' : typeof setupResult));\n        }\n    }\n}\nfunction createSetupContext(vm) {\n    var exposeCalled = false;\n    return {\n        get attrs() {\n            if (!vm._attrsProxy) {\n                var proxy = (vm._attrsProxy = {});\n                def(proxy, '_v_attr_proxy', true);\n                syncSetupProxy(proxy, vm.$attrs, emptyObject, vm, '$attrs');\n            }\n            return vm._attrsProxy;\n        },\n        get listeners() {\n            if (!vm._listenersProxy) {\n                var proxy = (vm._listenersProxy = {});\n                syncSetupProxy(proxy, vm.$listeners, emptyObject, vm, '$listeners');\n            }\n            return vm._listenersProxy;\n        },\n        get slots() {\n            return initSlotsProxy(vm);\n        },\n        emit: bind(vm.$emit, vm),\n        expose: function (exposed) {\n            if (process.env.NODE_ENV !== 'production') {\n                if (exposeCalled) {\n                    warn(\"expose() should be called only once per setup().\", vm);\n                }\n                exposeCalled = true;\n            }\n            if (exposed) {\n                Object.keys(exposed).forEach(function (key) {\n                    return proxyWithRefUnwrap(vm, exposed, key);\n                });\n            }\n        }\n    };\n}\nfunction syncSetupProxy(to, from, prev, instance, type) {\n    var changed = false;\n    for (var key in from) {\n        if (!(key in to)) {\n            changed = true;\n            defineProxyAttr(to, key, instance, type);\n        }\n        else if (from[key] !== prev[key]) {\n            changed = true;\n        }\n    }\n    for (var key in to) {\n        if (!(key in from)) {\n            changed = true;\n            delete to[key];\n        }\n    }\n    return changed;\n}\nfunction defineProxyAttr(proxy, key, instance, type) {\n    Object.defineProperty(proxy, key, {\n        enumerable: true,\n        configurable: true,\n        get: function () {\n            return instance[type][key];\n        }\n    });\n}\nfunction initSlotsProxy(vm) {\n    if (!vm._slotsProxy) {\n        syncSetupSlots((vm._slotsProxy = {}), vm.$scopedSlots);\n    }\n    return vm._slotsProxy;\n}\nfunction syncSetupSlots(to, from) {\n    for (var key in from) {\n        to[key] = from[key];\n    }\n    for (var key in to) {\n        if (!(key in from)) {\n            delete to[key];\n        }\n    }\n}\n/**\n * @internal use manual type def because public setup context type relies on\n * legacy VNode types\n */\nfunction useSlots() {\n    return getContext().slots;\n}\n/**\n * @internal use manual type def because public setup context type relies on\n * legacy VNode types\n */\nfunction useAttrs() {\n    return getContext().attrs;\n}\n/**\n * Vue 2 only\n * @internal use manual type def because public setup context type relies on\n * legacy VNode types\n */\nfunction useListeners() {\n    return getContext().listeners;\n}\nfunction getContext() {\n    if (process.env.NODE_ENV !== 'production' && !currentInstance) {\n        warn(\"useContext() called without active instance.\");\n    }\n    var vm = currentInstance;\n    return vm._setupContext || (vm._setupContext = createSetupContext(vm));\n}\n/**\n * Runtime helper for merging default declarations. Imported by compiled code\n * only.\n * @internal\n */\nfunction mergeDefaults(raw, defaults) {\n    var props = isArray(raw)\n        ? raw.reduce(function (normalized, p) { return ((normalized[p] = {}), normalized); }, {})\n        : raw;\n    for (var key in defaults) {\n        var opt = props[key];\n        if (opt) {\n            if (isArray(opt) || isFunction(opt)) {\n                props[key] = { type: opt, default: defaults[key] };\n            }\n            else {\n                opt.default = defaults[key];\n            }\n        }\n        else if (opt === null) {\n            props[key] = { default: defaults[key] };\n        }\n        else if (process.env.NODE_ENV !== 'production') {\n            warn(\"props default key \\\"\".concat(key, \"\\\" has no corresponding declaration.\"));\n        }\n    }\n    return props;\n}\n\nfunction initRender(vm) {\n    vm._vnode = null; // the root of the child tree\n    vm._staticTrees = null; // v-once cached trees\n    var options = vm.$options;\n    var parentVnode = (vm.$vnode = options._parentVnode); // the placeholder node in parent tree\n    var renderContext = parentVnode && parentVnode.context;\n    vm.$slots = resolveSlots(options._renderChildren, renderContext);\n    vm.$scopedSlots = parentVnode\n        ? normalizeScopedSlots(vm.$parent, parentVnode.data.scopedSlots, vm.$slots)\n        : emptyObject;\n    // bind the createElement fn to this instance\n    // so that we get proper render context inside it.\n    // args order: tag, data, children, normalizationType, alwaysNormalize\n    // internal version is used by render functions compiled from templates\n    // @ts-expect-error\n    vm._c = function (a, b, c, d) { return createElement$1(vm, a, b, c, d, false); };\n    // normalization is always applied for the public version, used in\n    // user-written render functions.\n    // @ts-expect-error\n    vm.$createElement = function (a, b, c, d) { return createElement$1(vm, a, b, c, d, true); };\n    // $attrs & $listeners are exposed for easier HOC creation.\n    // they need to be reactive so that HOCs using them are always updated\n    var parentData = parentVnode && parentVnode.data;\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== 'production') {\n        defineReactive(vm, '$attrs', (parentData && parentData.attrs) || emptyObject, function () {\n            !isUpdatingChildComponent && warn(\"$attrs is readonly.\", vm);\n        }, true);\n        defineReactive(vm, '$listeners', options._parentListeners || emptyObject, function () {\n            !isUpdatingChildComponent && warn(\"$listeners is readonly.\", vm);\n        }, true);\n    }\n    else {\n        defineReactive(vm, '$attrs', (parentData && parentData.attrs) || emptyObject, null, true);\n        defineReactive(vm, '$listeners', options._parentListeners || emptyObject, null, true);\n    }\n}\nvar currentRenderingInstance = null;\nfunction renderMixin(Vue) {\n    // install runtime convenience helpers\n    installRenderHelpers(Vue.prototype);\n    Vue.prototype.$nextTick = function (fn) {\n        return nextTick(fn, this);\n    };\n    Vue.prototype._render = function () {\n        var vm = this;\n        var _a = vm.$options, render = _a.render, _parentVnode = _a._parentVnode;\n        if (_parentVnode && vm._isMounted) {\n            vm.$scopedSlots = normalizeScopedSlots(vm.$parent, _parentVnode.data.scopedSlots, vm.$slots, vm.$scopedSlots);\n            if (vm._slotsProxy) {\n                syncSetupSlots(vm._slotsProxy, vm.$scopedSlots);\n            }\n        }\n        // set parent vnode. this allows render functions to have access\n        // to the data on the placeholder node.\n        vm.$vnode = _parentVnode;\n        // render self\n        var prevInst = currentInstance;\n        var prevRenderInst = currentRenderingInstance;\n        var vnode;\n        try {\n            setCurrentInstance(vm);\n            currentRenderingInstance = vm;\n            vnode = render.call(vm._renderProxy, vm.$createElement);\n        }\n        catch (e) {\n            handleError(e, vm, \"render\");\n            // return error render result,\n            // or previous vnode to prevent render error causing blank component\n            /* istanbul ignore else */\n            if (process.env.NODE_ENV !== 'production' && vm.$options.renderError) {\n                try {\n                    vnode = vm.$options.renderError.call(vm._renderProxy, vm.$createElement, e);\n                }\n                catch (e) {\n                    handleError(e, vm, \"renderError\");\n                    vnode = vm._vnode;\n                }\n            }\n            else {\n                vnode = vm._vnode;\n            }\n        }\n        finally {\n            currentRenderingInstance = prevRenderInst;\n            setCurrentInstance(prevInst);\n        }\n        // if the returned array contains only a single node, allow it\n        if (isArray(vnode) && vnode.length === 1) {\n            vnode = vnode[0];\n        }\n        // return empty vnode in case the render function errored out\n        if (!(vnode instanceof VNode)) {\n            if (process.env.NODE_ENV !== 'production' && isArray(vnode)) {\n                warn('Multiple root nodes returned from render function. Render function ' +\n                    'should return a single root node.', vm);\n            }\n            vnode = createEmptyVNode();\n        }\n        // set parent\n        vnode.parent = _parentVnode;\n        return vnode;\n    };\n}\n\nfunction ensureCtor(comp, base) {\n    if (comp.__esModule || (hasSymbol && comp[Symbol.toStringTag] === 'Module')) {\n        comp = comp.default;\n    }\n    return isObject(comp) ? base.extend(comp) : comp;\n}\nfunction createAsyncPlaceholder(factory, data, context, children, tag) {\n    var node = createEmptyVNode();\n    node.asyncFactory = factory;\n    node.asyncMeta = { data: data, context: context, children: children, tag: tag };\n    return node;\n}\nfunction resolveAsyncComponent(factory, baseCtor) {\n    if (isTrue(factory.error) && isDef(factory.errorComp)) {\n        return factory.errorComp;\n    }\n    if (isDef(factory.resolved)) {\n        return factory.resolved;\n    }\n    var owner = currentRenderingInstance;\n    if (owner && isDef(factory.owners) && factory.owners.indexOf(owner) === -1) {\n        // already pending\n        factory.owners.push(owner);\n    }\n    if (isTrue(factory.loading) && isDef(factory.loadingComp)) {\n        return factory.loadingComp;\n    }\n    if (owner && !isDef(factory.owners)) {\n        var owners_1 = (factory.owners = [owner]);\n        var sync_1 = true;\n        var timerLoading_1 = null;\n        var timerTimeout_1 = null;\n        owner.$on('hook:destroyed', function () { return remove$2(owners_1, owner); });\n        var forceRender_1 = function (renderCompleted) {\n            for (var i = 0, l = owners_1.length; i < l; i++) {\n                owners_1[i].$forceUpdate();\n            }\n            if (renderCompleted) {\n                owners_1.length = 0;\n                if (timerLoading_1 !== null) {\n                    clearTimeout(timerLoading_1);\n                    timerLoading_1 = null;\n                }\n                if (timerTimeout_1 !== null) {\n                    clearTimeout(timerTimeout_1);\n                    timerTimeout_1 = null;\n                }\n            }\n        };\n        var resolve = once(function (res) {\n            // cache resolved\n            factory.resolved = ensureCtor(res, baseCtor);\n            // invoke callbacks only if this is not a synchronous resolve\n            // (async resolves are shimmed as synchronous during SSR)\n            if (!sync_1) {\n                forceRender_1(true);\n            }\n            else {\n                owners_1.length = 0;\n            }\n        });\n        var reject_1 = once(function (reason) {\n            process.env.NODE_ENV !== 'production' &&\n                warn(\"Failed to resolve async component: \".concat(String(factory)) +\n                    (reason ? \"\\nReason: \".concat(reason) : ''));\n            if (isDef(factory.errorComp)) {\n                factory.error = true;\n                forceRender_1(true);\n            }\n        });\n        var res_1 = factory(resolve, reject_1);\n        if (isObject(res_1)) {\n            if (isPromise(res_1)) {\n                // () => Promise\n                if (isUndef(factory.resolved)) {\n                    res_1.then(resolve, reject_1);\n                }\n            }\n            else if (isPromise(res_1.component)) {\n                res_1.component.then(resolve, reject_1);\n                if (isDef(res_1.error)) {\n                    factory.errorComp = ensureCtor(res_1.error, baseCtor);\n                }\n                if (isDef(res_1.loading)) {\n                    factory.loadingComp = ensureCtor(res_1.loading, baseCtor);\n                    if (res_1.delay === 0) {\n                        factory.loading = true;\n                    }\n                    else {\n                        // @ts-expect-error NodeJS timeout type\n                        timerLoading_1 = setTimeout(function () {\n                            timerLoading_1 = null;\n                            if (isUndef(factory.resolved) && isUndef(factory.error)) {\n                                factory.loading = true;\n                                forceRender_1(false);\n                            }\n                        }, res_1.delay || 200);\n                    }\n                }\n                if (isDef(res_1.timeout)) {\n                    // @ts-expect-error NodeJS timeout type\n                    timerTimeout_1 = setTimeout(function () {\n                        timerTimeout_1 = null;\n                        if (isUndef(factory.resolved)) {\n                            reject_1(process.env.NODE_ENV !== 'production' ? \"timeout (\".concat(res_1.timeout, \"ms)\") : null);\n                        }\n                    }, res_1.timeout);\n                }\n            }\n        }\n        sync_1 = false;\n        // return in case resolved synchronously\n        return factory.loading ? factory.loadingComp : factory.resolved;\n    }\n}\n\nfunction getFirstComponentChild(children) {\n    if (isArray(children)) {\n        for (var i = 0; i < children.length; i++) {\n            var c = children[i];\n            if (isDef(c) && (isDef(c.componentOptions) || isAsyncPlaceholder(c))) {\n                return c;\n            }\n        }\n    }\n}\n\nvar SIMPLE_NORMALIZE = 1;\nvar ALWAYS_NORMALIZE = 2;\n// wrapper function for providing a more flexible interface\n// without getting yelled at by flow\nfunction createElement$1(context, tag, data, children, normalizationType, alwaysNormalize) {\n    if (isArray(data) || isPrimitive(data)) {\n        normalizationType = children;\n        children = data;\n        data = undefined;\n    }\n    if (isTrue(alwaysNormalize)) {\n        normalizationType = ALWAYS_NORMALIZE;\n    }\n    return _createElement(context, tag, data, children, normalizationType);\n}\nfunction _createElement(context, tag, data, children, normalizationType) {\n    if (isDef(data) && isDef(data.__ob__)) {\n        process.env.NODE_ENV !== 'production' &&\n            warn(\"Avoid using observed data object as vnode data: \".concat(JSON.stringify(data), \"\\n\") + 'Always create fresh vnode data objects in each render!', context);\n        return createEmptyVNode();\n    }\n    // object syntax in v-bind\n    if (isDef(data) && isDef(data.is)) {\n        tag = data.is;\n    }\n    if (!tag) {\n        // in case of component :is set to falsy value\n        return createEmptyVNode();\n    }\n    // warn against non-primitive key\n    if (process.env.NODE_ENV !== 'production' && isDef(data) && isDef(data.key) && !isPrimitive(data.key)) {\n        warn('Avoid using non-primitive value as key, ' +\n            'use string/number value instead.', context);\n    }\n    // support single function children as default scoped slot\n    if (isArray(children) && isFunction(children[0])) {\n        data = data || {};\n        data.scopedSlots = { default: children[0] };\n        children.length = 0;\n    }\n    if (normalizationType === ALWAYS_NORMALIZE) {\n        children = normalizeChildren(children);\n    }\n    else if (normalizationType === SIMPLE_NORMALIZE) {\n        children = simpleNormalizeChildren(children);\n    }\n    var vnode, ns;\n    if (typeof tag === 'string') {\n        var Ctor = void 0;\n        ns = (context.$vnode && context.$vnode.ns) || config.getTagNamespace(tag);\n        if (config.isReservedTag(tag)) {\n            // platform built-in elements\n            if (process.env.NODE_ENV !== 'production' &&\n                isDef(data) &&\n                isDef(data.nativeOn) &&\n                data.tag !== 'component') {\n                warn(\"The .native modifier for v-on is only valid on components but it was used on <\".concat(tag, \">.\"), context);\n            }\n            vnode = new VNode(config.parsePlatformTagName(tag), data, children, undefined, undefined, context);\n        }\n        else if ((!data || !data.pre) &&\n            isDef((Ctor = resolveAsset(context.$options, 'components', tag)))) {\n            // component\n            vnode = createComponent(Ctor, data, context, children, tag);\n        }\n        else {\n            // unknown or unlisted namespaced elements\n            // check at runtime because it may get assigned a namespace when its\n            // parent normalizes children\n            vnode = new VNode(tag, data, children, undefined, undefined, context);\n        }\n    }\n    else {\n        // direct component options / constructor\n        vnode = createComponent(tag, data, context, children);\n    }\n    if (isArray(vnode)) {\n        return vnode;\n    }\n    else if (isDef(vnode)) {\n        if (isDef(ns))\n            applyNS(vnode, ns);\n        if (isDef(data))\n            registerDeepBindings(data);\n        return vnode;\n    }\n    else {\n        return createEmptyVNode();\n    }\n}\nfunction applyNS(vnode, ns, force) {\n    vnode.ns = ns;\n    if (vnode.tag === 'foreignObject') {\n        // use default namespace inside foreignObject\n        ns = undefined;\n        force = true;\n    }\n    if (isDef(vnode.children)) {\n        for (var i = 0, l = vnode.children.length; i < l; i++) {\n            var child = vnode.children[i];\n            if (isDef(child.tag) &&\n                (isUndef(child.ns) || (isTrue(force) && child.tag !== 'svg'))) {\n                applyNS(child, ns, force);\n            }\n        }\n    }\n}\n// ref #5318\n// necessary to ensure parent re-render when deep bindings like :style and\n// :class are used on slot nodes\nfunction registerDeepBindings(data) {\n    if (isObject(data.style)) {\n        traverse(data.style);\n    }\n    if (isObject(data.class)) {\n        traverse(data.class);\n    }\n}\n\n/**\n * @internal this function needs manual public type declaration because it relies\n * on previously manually authored types from Vue 2\n */\nfunction h(type, props, children) {\n    if (!currentInstance) {\n        process.env.NODE_ENV !== 'production' &&\n            warn(\"globally imported h() can only be invoked when there is an active \" +\n                \"component instance, e.g. synchronously in a component's render or setup function.\");\n    }\n    return createElement$1(currentInstance, type, props, children, 2, true);\n}\n\nfunction handleError(err, vm, info) {\n    // Deactivate deps tracking while processing error handler to avoid possible infinite rendering.\n    // See: https://github.com/vuejs/vuex/issues/1505\n    pushTarget();\n    try {\n        if (vm) {\n            var cur = vm;\n            while ((cur = cur.$parent)) {\n                var hooks = cur.$options.errorCaptured;\n                if (hooks) {\n                    for (var i = 0; i < hooks.length; i++) {\n                        try {\n                            var capture = hooks[i].call(cur, err, vm, info) === false;\n                            if (capture)\n                                return;\n                        }\n                        catch (e) {\n                            globalHandleError(e, cur, 'errorCaptured hook');\n                        }\n                    }\n                }\n            }\n        }\n        globalHandleError(err, vm, info);\n    }\n    finally {\n        popTarget();\n    }\n}\nfunction invokeWithErrorHandling(handler, context, args, vm, info) {\n    var res;\n    try {\n        res = args ? handler.apply(context, args) : handler.call(context);\n        if (res && !res._isVue && isPromise(res) && !res._handled) {\n            res.catch(function (e) { return handleError(e, vm, info + \" (Promise/async)\"); });\n            res._handled = true;\n        }\n    }\n    catch (e) {\n        handleError(e, vm, info);\n    }\n    return res;\n}\nfunction globalHandleError(err, vm, info) {\n    if (config.errorHandler) {\n        try {\n            return config.errorHandler.call(null, err, vm, info);\n        }\n        catch (e) {\n            // if the user intentionally throws the original error in the handler,\n            // do not log it twice\n            if (e !== err) {\n                logError(e, null, 'config.errorHandler');\n            }\n        }\n    }\n    logError(err, vm, info);\n}\nfunction logError(err, vm, info) {\n    if (process.env.NODE_ENV !== 'production') {\n        warn(\"Error in \".concat(info, \": \\\"\").concat(err.toString(), \"\\\"\"), vm);\n    }\n    /* istanbul ignore else */\n    if (inBrowser && typeof console !== 'undefined') {\n        console.error(err);\n    }\n    else {\n        throw err;\n    }\n}\n\n/* globals MutationObserver */\nvar isUsingMicroTask = false;\nvar callbacks = [];\nvar pending = false;\nfunction flushCallbacks() {\n    pending = false;\n    var copies = callbacks.slice(0);\n    callbacks.length = 0;\n    for (var i = 0; i < copies.length; i++) {\n        copies[i]();\n    }\n}\n// Here we have async deferring wrappers using microtasks.\n// In 2.5 we used (macro) tasks (in combination with microtasks).\n// However, it has subtle problems when state is changed right before repaint\n// (e.g. #6813, out-in transitions).\n// Also, using (macro) tasks in event handler would cause some weird behaviors\n// that cannot be circumvented (e.g. #7109, #7153, #7546, #7834, #8109).\n// So we now use microtasks everywhere, again.\n// A major drawback of this tradeoff is that there are some scenarios\n// where microtasks have too high a priority and fire in between supposedly\n// sequential events (e.g. #4521, #6690, which have workarounds)\n// or even between bubbling of the same event (#6566).\nvar timerFunc;\n// The nextTick behavior leverages the microtask queue, which can be accessed\n// via either native Promise.then or MutationObserver.\n// MutationObserver has wider support, however it is seriously bugged in\n// UIWebView in iOS >= 9.3.3 when triggered in touch event handlers. It\n// completely stops working after triggering a few times... so, if native\n// Promise is available, we will use it:\n/* istanbul ignore next, $flow-disable-line */\nif (typeof Promise !== 'undefined' && isNative(Promise)) {\n    var p_1 = Promise.resolve();\n    timerFunc = function () {\n        p_1.then(flushCallbacks);\n        // In problematic UIWebViews, Promise.then doesn't completely break, but\n        // it can get stuck in a weird state where callbacks are pushed into the\n        // microtask queue but the queue isn't being flushed, until the browser\n        // needs to do some other work, e.g. handle a timer. Therefore we can\n        // \"force\" the microtask queue to be flushed by adding an empty timer.\n        if (isIOS)\n            setTimeout(noop);\n    };\n    isUsingMicroTask = true;\n}\nelse if (!isIE &&\n    typeof MutationObserver !== 'undefined' &&\n    (isNative(MutationObserver) ||\n        // PhantomJS and iOS 7.x\n        MutationObserver.toString() === '[object MutationObserverConstructor]')) {\n    // Use MutationObserver where native Promise is not available,\n    // e.g. PhantomJS, iOS7, Android 4.4\n    // (#6466 MutationObserver is unreliable in IE11)\n    var counter_1 = 1;\n    var observer = new MutationObserver(flushCallbacks);\n    var textNode_1 = document.createTextNode(String(counter_1));\n    observer.observe(textNode_1, {\n        characterData: true\n    });\n    timerFunc = function () {\n        counter_1 = (counter_1 + 1) % 2;\n        textNode_1.data = String(counter_1);\n    };\n    isUsingMicroTask = true;\n}\nelse if (typeof setImmediate !== 'undefined' && isNative(setImmediate)) {\n    // Fallback to setImmediate.\n    // Technically it leverages the (macro) task queue,\n    // but it is still a better choice than setTimeout.\n    timerFunc = function () {\n        setImmediate(flushCallbacks);\n    };\n}\nelse {\n    // Fallback to setTimeout.\n    timerFunc = function () {\n        setTimeout(flushCallbacks, 0);\n    };\n}\n/**\n * @internal\n */\nfunction nextTick(cb, ctx) {\n    var _resolve;\n    callbacks.push(function () {\n        if (cb) {\n            try {\n                cb.call(ctx);\n            }\n            catch (e) {\n                handleError(e, ctx, 'nextTick');\n            }\n        }\n        else if (_resolve) {\n            _resolve(ctx);\n        }\n    });\n    if (!pending) {\n        pending = true;\n        timerFunc();\n    }\n    // $flow-disable-line\n    if (!cb && typeof Promise !== 'undefined') {\n        return new Promise(function (resolve) {\n            _resolve = resolve;\n        });\n    }\n}\n\nfunction useCssModule(name) {\n    if (name === void 0) { name = '$style'; }\n    /* istanbul ignore else */\n    {\n        if (!currentInstance) {\n            process.env.NODE_ENV !== 'production' && warn(\"useCssModule must be called inside setup()\");\n            return emptyObject;\n        }\n        var mod = currentInstance[name];\n        if (!mod) {\n            process.env.NODE_ENV !== 'production' &&\n                warn(\"Current instance does not have CSS module named \\\"\".concat(name, \"\\\".\"));\n            return emptyObject;\n        }\n        return mod;\n    }\n}\n\n/**\n * Runtime helper for SFC's CSS variable injection feature.\n * @private\n */\nfunction useCssVars(getter) {\n    if (!inBrowser && !false)\n        return;\n    var instance = currentInstance;\n    if (!instance) {\n        process.env.NODE_ENV !== 'production' &&\n            warn(\"useCssVars is called without current active component instance.\");\n        return;\n    }\n    watchPostEffect(function () {\n        var el = instance.$el;\n        var vars = getter(instance, instance._setupProxy);\n        if (el && el.nodeType === 1) {\n            var style = el.style;\n            for (var key in vars) {\n                style.setProperty(\"--\".concat(key), vars[key]);\n            }\n        }\n    });\n}\n\n/**\n * v3-compatible async component API.\n * @internal the type is manually declared in <root>/types/v3-define-async-component.d.ts\n * because it relies on existing manual types\n */\nfunction defineAsyncComponent(source) {\n    if (isFunction(source)) {\n        source = { loader: source };\n    }\n    var loader = source.loader, loadingComponent = source.loadingComponent, errorComponent = source.errorComponent, _a = source.delay, delay = _a === void 0 ? 200 : _a, timeout = source.timeout, // undefined = never times out\n    _b = source.suspensible, // undefined = never times out\n    suspensible = _b === void 0 ? false : _b, // in Vue 3 default is true\n    userOnError = source.onError;\n    if (process.env.NODE_ENV !== 'production' && suspensible) {\n        warn(\"The suspensible option for async components is not supported in Vue2. It is ignored.\");\n    }\n    var pendingRequest = null;\n    var retries = 0;\n    var retry = function () {\n        retries++;\n        pendingRequest = null;\n        return load();\n    };\n    var load = function () {\n        var thisRequest;\n        return (pendingRequest ||\n            (thisRequest = pendingRequest =\n                loader()\n                    .catch(function (err) {\n                    err = err instanceof Error ? err : new Error(String(err));\n                    if (userOnError) {\n                        return new Promise(function (resolve, reject) {\n                            var userRetry = function () { return resolve(retry()); };\n                            var userFail = function () { return reject(err); };\n                            userOnError(err, userRetry, userFail, retries + 1);\n                        });\n                    }\n                    else {\n                        throw err;\n                    }\n                })\n                    .then(function (comp) {\n                    if (thisRequest !== pendingRequest && pendingRequest) {\n                        return pendingRequest;\n                    }\n                    if (process.env.NODE_ENV !== 'production' && !comp) {\n                        warn(\"Async component loader resolved to undefined. \" +\n                            \"If you are using retry(), make sure to return its return value.\");\n                    }\n                    // interop module default\n                    if (comp &&\n                        (comp.__esModule || comp[Symbol.toStringTag] === 'Module')) {\n                        comp = comp.default;\n                    }\n                    if (process.env.NODE_ENV !== 'production' && comp && !isObject(comp) && !isFunction(comp)) {\n                        throw new Error(\"Invalid async component load result: \".concat(comp));\n                    }\n                    return comp;\n                })));\n    };\n    return function () {\n        var component = load();\n        return {\n            component: component,\n            delay: delay,\n            timeout: timeout,\n            error: errorComponent,\n            loading: loadingComponent\n        };\n    };\n}\n\nfunction createLifeCycle(hookName) {\n    return function (fn, target) {\n        if (target === void 0) { target = currentInstance; }\n        if (!target) {\n            process.env.NODE_ENV !== 'production' &&\n                warn(\"\".concat(formatName(hookName), \" is called when there is no active component instance to be \") +\n                    \"associated with. \" +\n                    \"Lifecycle injection APIs can only be used during execution of setup().\");\n            return;\n        }\n        return injectHook(target, hookName, fn);\n    };\n}\nfunction formatName(name) {\n    if (name === 'beforeDestroy') {\n        name = 'beforeUnmount';\n    }\n    else if (name === 'destroyed') {\n        name = 'unmounted';\n    }\n    return \"on\".concat(name[0].toUpperCase() + name.slice(1));\n}\nfunction injectHook(instance, hookName, fn) {\n    var options = instance.$options;\n    options[hookName] = mergeLifecycleHook(options[hookName], fn);\n}\nvar onBeforeMount = createLifeCycle('beforeMount');\nvar onMounted = createLifeCycle('mounted');\nvar onBeforeUpdate = createLifeCycle('beforeUpdate');\nvar onUpdated = createLifeCycle('updated');\nvar onBeforeUnmount = createLifeCycle('beforeDestroy');\nvar onUnmounted = createLifeCycle('destroyed');\nvar onActivated = createLifeCycle('activated');\nvar onDeactivated = createLifeCycle('deactivated');\nvar onServerPrefetch = createLifeCycle('serverPrefetch');\nvar onRenderTracked = createLifeCycle('renderTracked');\nvar onRenderTriggered = createLifeCycle('renderTriggered');\nvar injectErrorCapturedHook = createLifeCycle('errorCaptured');\nfunction onErrorCaptured(hook, target) {\n    if (target === void 0) { target = currentInstance; }\n    injectErrorCapturedHook(hook, target);\n}\n\n/**\n * Note: also update dist/vue.runtime.mjs when adding new exports to this file.\n */\nvar version = '2.7.16';\n/**\n * @internal type is manually declared in <root>/types/v3-define-component.d.ts\n */\nfunction defineComponent(options) {\n    return options;\n}\n\nvar seenObjects = new _Set();\n/**\n * Recursively traverse an object to evoke all converted\n * getters, so that every nested property inside the object\n * is collected as a \"deep\" dependency.\n */\nfunction traverse(val) {\n    _traverse(val, seenObjects);\n    seenObjects.clear();\n    return val;\n}\nfunction _traverse(val, seen) {\n    var i, keys;\n    var isA = isArray(val);\n    if ((!isA && !isObject(val)) ||\n        val.__v_skip /* ReactiveFlags.SKIP */ ||\n        Object.isFrozen(val) ||\n        val instanceof VNode) {\n        return;\n    }\n    if (val.__ob__) {\n        var depId = val.__ob__.dep.id;\n        if (seen.has(depId)) {\n            return;\n        }\n        seen.add(depId);\n    }\n    if (isA) {\n        i = val.length;\n        while (i--)\n            _traverse(val[i], seen);\n    }\n    else if (isRef(val)) {\n        _traverse(val.value, seen);\n    }\n    else {\n        keys = Object.keys(val);\n        i = keys.length;\n        while (i--)\n            _traverse(val[keys[i]], seen);\n    }\n}\n\nvar uid$1 = 0;\n/**\n * A watcher parses an expression, collects dependencies,\n * and fires callback when the expression value changes.\n * This is used for both the $watch() api and directives.\n * @internal\n */\nvar Watcher = /** @class */ (function () {\n    function Watcher(vm, expOrFn, cb, options, isRenderWatcher) {\n        recordEffectScope(this, \n        // if the active effect scope is manually created (not a component scope),\n        // prioritize it\n        activeEffectScope && !activeEffectScope._vm\n            ? activeEffectScope\n            : vm\n                ? vm._scope\n                : undefined);\n        if ((this.vm = vm) && isRenderWatcher) {\n            vm._watcher = this;\n        }\n        // options\n        if (options) {\n            this.deep = !!options.deep;\n            this.user = !!options.user;\n            this.lazy = !!options.lazy;\n            this.sync = !!options.sync;\n            this.before = options.before;\n            if (process.env.NODE_ENV !== 'production') {\n                this.onTrack = options.onTrack;\n                this.onTrigger = options.onTrigger;\n            }\n        }\n        else {\n            this.deep = this.user = this.lazy = this.sync = false;\n        }\n        this.cb = cb;\n        this.id = ++uid$1; // uid for batching\n        this.active = true;\n        this.post = false;\n        this.dirty = this.lazy; // for lazy watchers\n        this.deps = [];\n        this.newDeps = [];\n        this.depIds = new _Set();\n        this.newDepIds = new _Set();\n        this.expression = process.env.NODE_ENV !== 'production' ? expOrFn.toString() : '';\n        // parse expression for getter\n        if (isFunction(expOrFn)) {\n            this.getter = expOrFn;\n        }\n        else {\n            this.getter = parsePath(expOrFn);\n            if (!this.getter) {\n                this.getter = noop;\n                process.env.NODE_ENV !== 'production' &&\n                    warn(\"Failed watching path: \\\"\".concat(expOrFn, \"\\\" \") +\n                        'Watcher only accepts simple dot-delimited paths. ' +\n                        'For full control, use a function instead.', vm);\n            }\n        }\n        this.value = this.lazy ? undefined : this.get();\n    }\n    /**\n     * Evaluate the getter, and re-collect dependencies.\n     */\n    Watcher.prototype.get = function () {\n        pushTarget(this);\n        var value;\n        var vm = this.vm;\n        try {\n            value = this.getter.call(vm, vm);\n        }\n        catch (e) {\n            if (this.user) {\n                handleError(e, vm, \"getter for watcher \\\"\".concat(this.expression, \"\\\"\"));\n            }\n            else {\n                throw e;\n            }\n        }\n        finally {\n            // \"touch\" every property so they are all tracked as\n            // dependencies for deep watching\n            if (this.deep) {\n                traverse(value);\n            }\n            popTarget();\n            this.cleanupDeps();\n        }\n        return value;\n    };\n    /**\n     * Add a dependency to this directive.\n     */\n    Watcher.prototype.addDep = function (dep) {\n        var id = dep.id;\n        if (!this.newDepIds.has(id)) {\n            this.newDepIds.add(id);\n            this.newDeps.push(dep);\n            if (!this.depIds.has(id)) {\n                dep.addSub(this);\n            }\n        }\n    };\n    /**\n     * Clean up for dependency collection.\n     */\n    Watcher.prototype.cleanupDeps = function () {\n        var i = this.deps.length;\n        while (i--) {\n            var dep = this.deps[i];\n            if (!this.newDepIds.has(dep.id)) {\n                dep.removeSub(this);\n            }\n        }\n        var tmp = this.depIds;\n        this.depIds = this.newDepIds;\n        this.newDepIds = tmp;\n        this.newDepIds.clear();\n        tmp = this.deps;\n        this.deps = this.newDeps;\n        this.newDeps = tmp;\n        this.newDeps.length = 0;\n    };\n    /**\n     * Subscriber interface.\n     * Will be called when a dependency changes.\n     */\n    Watcher.prototype.update = function () {\n        /* istanbul ignore else */\n        if (this.lazy) {\n            this.dirty = true;\n        }\n        else if (this.sync) {\n            this.run();\n        }\n        else {\n            queueWatcher(this);\n        }\n    };\n    /**\n     * Scheduler job interface.\n     * Will be called by the scheduler.\n     */\n    Watcher.prototype.run = function () {\n        if (this.active) {\n            var value = this.get();\n            if (value !== this.value ||\n                // Deep watchers and watchers on Object/Arrays should fire even\n                // when the value is the same, because the value may\n                // have mutated.\n                isObject(value) ||\n                this.deep) {\n                // set new value\n                var oldValue = this.value;\n                this.value = value;\n                if (this.user) {\n                    var info = \"callback for watcher \\\"\".concat(this.expression, \"\\\"\");\n                    invokeWithErrorHandling(this.cb, this.vm, [value, oldValue], this.vm, info);\n                }\n                else {\n                    this.cb.call(this.vm, value, oldValue);\n                }\n            }\n        }\n    };\n    /**\n     * Evaluate the value of the watcher.\n     * This only gets called for lazy watchers.\n     */\n    Watcher.prototype.evaluate = function () {\n        this.value = this.get();\n        this.dirty = false;\n    };\n    /**\n     * Depend on all deps collected by this watcher.\n     */\n    Watcher.prototype.depend = function () {\n        var i = this.deps.length;\n        while (i--) {\n            this.deps[i].depend();\n        }\n    };\n    /**\n     * Remove self from all dependencies' subscriber list.\n     */\n    Watcher.prototype.teardown = function () {\n        if (this.vm && !this.vm._isBeingDestroyed) {\n            remove$2(this.vm._scope.effects, this);\n        }\n        if (this.active) {\n            var i = this.deps.length;\n            while (i--) {\n                this.deps[i].removeSub(this);\n            }\n            this.active = false;\n            if (this.onStop) {\n                this.onStop();\n            }\n        }\n    };\n    return Watcher;\n}());\n\nvar mark;\nvar measure;\nif (process.env.NODE_ENV !== 'production') {\n    var perf_1 = inBrowser && window.performance;\n    /* istanbul ignore if */\n    if (perf_1 &&\n        // @ts-ignore\n        perf_1.mark &&\n        // @ts-ignore\n        perf_1.measure &&\n        // @ts-ignore\n        perf_1.clearMarks &&\n        // @ts-ignore\n        perf_1.clearMeasures) {\n        mark = function (tag) { return perf_1.mark(tag); };\n        measure = function (name, startTag, endTag) {\n            perf_1.measure(name, startTag, endTag);\n            perf_1.clearMarks(startTag);\n            perf_1.clearMarks(endTag);\n            // perf.clearMeasures(name)\n        };\n    }\n}\n\nfunction initEvents(vm) {\n    vm._events = Object.create(null);\n    vm._hasHookEvent = false;\n    // init parent attached events\n    var listeners = vm.$options._parentListeners;\n    if (listeners) {\n        updateComponentListeners(vm, listeners);\n    }\n}\nvar target$1;\nfunction add$1(event, fn) {\n    target$1.$on(event, fn);\n}\nfunction remove$1(event, fn) {\n    target$1.$off(event, fn);\n}\nfunction createOnceHandler$1(event, fn) {\n    var _target = target$1;\n    return function onceHandler() {\n        var res = fn.apply(null, arguments);\n        if (res !== null) {\n            _target.$off(event, onceHandler);\n        }\n    };\n}\nfunction updateComponentListeners(vm, listeners, oldListeners) {\n    target$1 = vm;\n    updateListeners(listeners, oldListeners || {}, add$1, remove$1, createOnceHandler$1, vm);\n    target$1 = undefined;\n}\nfunction eventsMixin(Vue) {\n    var hookRE = /^hook:/;\n    Vue.prototype.$on = function (event, fn) {\n        var vm = this;\n        if (isArray(event)) {\n            for (var i = 0, l = event.length; i < l; i++) {\n                vm.$on(event[i], fn);\n            }\n        }\n        else {\n            (vm._events[event] || (vm._events[event] = [])).push(fn);\n            // optimize hook:event cost by using a boolean flag marked at registration\n            // instead of a hash lookup\n            if (hookRE.test(event)) {\n                vm._hasHookEvent = true;\n            }\n        }\n        return vm;\n    };\n    Vue.prototype.$once = function (event, fn) {\n        var vm = this;\n        function on() {\n            vm.$off(event, on);\n            fn.apply(vm, arguments);\n        }\n        on.fn = fn;\n        vm.$on(event, on);\n        return vm;\n    };\n    Vue.prototype.$off = function (event, fn) {\n        var vm = this;\n        // all\n        if (!arguments.length) {\n            vm._events = Object.create(null);\n            return vm;\n        }\n        // array of events\n        if (isArray(event)) {\n            for (var i_1 = 0, l = event.length; i_1 < l; i_1++) {\n                vm.$off(event[i_1], fn);\n            }\n            return vm;\n        }\n        // specific event\n        var cbs = vm._events[event];\n        if (!cbs) {\n            return vm;\n        }\n        if (!fn) {\n            vm._events[event] = null;\n            return vm;\n        }\n        // specific handler\n        var cb;\n        var i = cbs.length;\n        while (i--) {\n            cb = cbs[i];\n            if (cb === fn || cb.fn === fn) {\n                cbs.splice(i, 1);\n                break;\n            }\n        }\n        return vm;\n    };\n    Vue.prototype.$emit = function (event) {\n        var vm = this;\n        if (process.env.NODE_ENV !== 'production') {\n            var lowerCaseEvent = event.toLowerCase();\n            if (lowerCaseEvent !== event && vm._events[lowerCaseEvent]) {\n                tip(\"Event \\\"\".concat(lowerCaseEvent, \"\\\" is emitted in component \") +\n                    \"\".concat(formatComponentName(vm), \" but the handler is registered for \\\"\").concat(event, \"\\\". \") +\n                    \"Note that HTML attributes are case-insensitive and you cannot use \" +\n                    \"v-on to listen to camelCase events when using in-DOM templates. \" +\n                    \"You should probably use \\\"\".concat(hyphenate(event), \"\\\" instead of \\\"\").concat(event, \"\\\".\"));\n            }\n        }\n        var cbs = vm._events[event];\n        if (cbs) {\n            cbs = cbs.length > 1 ? toArray(cbs) : cbs;\n            var args = toArray(arguments, 1);\n            var info = \"event handler for \\\"\".concat(event, \"\\\"\");\n            for (var i = 0, l = cbs.length; i < l; i++) {\n                invokeWithErrorHandling(cbs[i], vm, args, vm, info);\n            }\n        }\n        return vm;\n    };\n}\n\nvar activeInstance = null;\nvar isUpdatingChildComponent = false;\nfunction setActiveInstance(vm) {\n    var prevActiveInstance = activeInstance;\n    activeInstance = vm;\n    return function () {\n        activeInstance = prevActiveInstance;\n    };\n}\nfunction initLifecycle(vm) {\n    var options = vm.$options;\n    // locate first non-abstract parent\n    var parent = options.parent;\n    if (parent && !options.abstract) {\n        while (parent.$options.abstract && parent.$parent) {\n            parent = parent.$parent;\n        }\n        parent.$children.push(vm);\n    }\n    vm.$parent = parent;\n    vm.$root = parent ? parent.$root : vm;\n    vm.$children = [];\n    vm.$refs = {};\n    vm._provided = parent ? parent._provided : Object.create(null);\n    vm._watcher = null;\n    vm._inactive = null;\n    vm._directInactive = false;\n    vm._isMounted = false;\n    vm._isDestroyed = false;\n    vm._isBeingDestroyed = false;\n}\nfunction lifecycleMixin(Vue) {\n    Vue.prototype._update = function (vnode, hydrating) {\n        var vm = this;\n        var prevEl = vm.$el;\n        var prevVnode = vm._vnode;\n        var restoreActiveInstance = setActiveInstance(vm);\n        vm._vnode = vnode;\n        // Vue.prototype.__patch__ is injected in entry points\n        // based on the rendering backend used.\n        if (!prevVnode) {\n            // initial render\n            vm.$el = vm.__patch__(vm.$el, vnode, hydrating, false /* removeOnly */);\n        }\n        else {\n            // updates\n            vm.$el = vm.__patch__(prevVnode, vnode);\n        }\n        restoreActiveInstance();\n        // update __vue__ reference\n        if (prevEl) {\n            prevEl.__vue__ = null;\n        }\n        if (vm.$el) {\n            vm.$el.__vue__ = vm;\n        }\n        // if parent is an HOC, update its $el as well\n        var wrapper = vm;\n        while (wrapper &&\n            wrapper.$vnode &&\n            wrapper.$parent &&\n            wrapper.$vnode === wrapper.$parent._vnode) {\n            wrapper.$parent.$el = wrapper.$el;\n            wrapper = wrapper.$parent;\n        }\n        // updated hook is called by the scheduler to ensure that children are\n        // updated in a parent's updated hook.\n    };\n    Vue.prototype.$forceUpdate = function () {\n        var vm = this;\n        if (vm._watcher) {\n            vm._watcher.update();\n        }\n    };\n    Vue.prototype.$destroy = function () {\n        var vm = this;\n        if (vm._isBeingDestroyed) {\n            return;\n        }\n        callHook$1(vm, 'beforeDestroy');\n        vm._isBeingDestroyed = true;\n        // remove self from parent\n        var parent = vm.$parent;\n        if (parent && !parent._isBeingDestroyed && !vm.$options.abstract) {\n            remove$2(parent.$children, vm);\n        }\n        // teardown scope. this includes both the render watcher and other\n        // watchers created\n        vm._scope.stop();\n        // remove reference from data ob\n        // frozen object may not have observer.\n        if (vm._data.__ob__) {\n            vm._data.__ob__.vmCount--;\n        }\n        // call the last hook...\n        vm._isDestroyed = true;\n        // invoke destroy hooks on current rendered tree\n        vm.__patch__(vm._vnode, null);\n        // fire destroyed hook\n        callHook$1(vm, 'destroyed');\n        // turn off all instance listeners.\n        vm.$off();\n        // remove __vue__ reference\n        if (vm.$el) {\n            vm.$el.__vue__ = null;\n        }\n        // release circular reference (#6759)\n        if (vm.$vnode) {\n            vm.$vnode.parent = null;\n        }\n    };\n}\nfunction mountComponent(vm, el, hydrating) {\n    vm.$el = el;\n    if (!vm.$options.render) {\n        // @ts-expect-error invalid type\n        vm.$options.render = createEmptyVNode;\n        if (process.env.NODE_ENV !== 'production') {\n            /* istanbul ignore if */\n            if ((vm.$options.template && vm.$options.template.charAt(0) !== '#') ||\n                vm.$options.el ||\n                el) {\n                warn('You are using the runtime-only build of Vue where the template ' +\n                    'compiler is not available. Either pre-compile the templates into ' +\n                    'render functions, or use the compiler-included build.', vm);\n            }\n            else {\n                warn('Failed to mount component: template or render function not defined.', vm);\n            }\n        }\n    }\n    callHook$1(vm, 'beforeMount');\n    var updateComponent;\n    /* istanbul ignore if */\n    if (process.env.NODE_ENV !== 'production' && config.performance && mark) {\n        updateComponent = function () {\n            var name = vm._name;\n            var id = vm._uid;\n            var startTag = \"vue-perf-start:\".concat(id);\n            var endTag = \"vue-perf-end:\".concat(id);\n            mark(startTag);\n            var vnode = vm._render();\n            mark(endTag);\n            measure(\"vue \".concat(name, \" render\"), startTag, endTag);\n            mark(startTag);\n            vm._update(vnode, hydrating);\n            mark(endTag);\n            measure(\"vue \".concat(name, \" patch\"), startTag, endTag);\n        };\n    }\n    else {\n        updateComponent = function () {\n            vm._update(vm._render(), hydrating);\n        };\n    }\n    var watcherOptions = {\n        before: function () {\n            if (vm._isMounted && !vm._isDestroyed) {\n                callHook$1(vm, 'beforeUpdate');\n            }\n        }\n    };\n    if (process.env.NODE_ENV !== 'production') {\n        watcherOptions.onTrack = function (e) { return callHook$1(vm, 'renderTracked', [e]); };\n        watcherOptions.onTrigger = function (e) { return callHook$1(vm, 'renderTriggered', [e]); };\n    }\n    // we set this to vm._watcher inside the watcher's constructor\n    // since the watcher's initial patch may call $forceUpdate (e.g. inside child\n    // component's mounted hook), which relies on vm._watcher being already defined\n    new Watcher(vm, updateComponent, noop, watcherOptions, true /* isRenderWatcher */);\n    hydrating = false;\n    // flush buffer for flush: \"pre\" watchers queued in setup()\n    var preWatchers = vm._preWatchers;\n    if (preWatchers) {\n        for (var i = 0; i < preWatchers.length; i++) {\n            preWatchers[i].run();\n        }\n    }\n    // manually mounted instance, call mounted on self\n    // mounted is called for render-created child components in its inserted hook\n    if (vm.$vnode == null) {\n        vm._isMounted = true;\n        callHook$1(vm, 'mounted');\n    }\n    return vm;\n}\nfunction updateChildComponent(vm, propsData, listeners, parentVnode, renderChildren) {\n    if (process.env.NODE_ENV !== 'production') {\n        isUpdatingChildComponent = true;\n    }\n    // determine whether component has slot children\n    // we need to do this before overwriting $options._renderChildren.\n    // check if there are dynamic scopedSlots (hand-written or compiled but with\n    // dynamic slot names). Static scoped slots compiled from template has the\n    // \"$stable\" marker.\n    var newScopedSlots = parentVnode.data.scopedSlots;\n    var oldScopedSlots = vm.$scopedSlots;\n    var hasDynamicScopedSlot = !!((newScopedSlots && !newScopedSlots.$stable) ||\n        (oldScopedSlots !== emptyObject && !oldScopedSlots.$stable) ||\n        (newScopedSlots && vm.$scopedSlots.$key !== newScopedSlots.$key) ||\n        (!newScopedSlots && vm.$scopedSlots.$key));\n    // Any static slot children from the parent may have changed during parent's\n    // update. Dynamic scoped slots may also have changed. In such cases, a forced\n    // update is necessary to ensure correctness.\n    var needsForceUpdate = !!(renderChildren || // has new static slots\n        vm.$options._renderChildren || // has old static slots\n        hasDynamicScopedSlot);\n    var prevVNode = vm.$vnode;\n    vm.$options._parentVnode = parentVnode;\n    vm.$vnode = parentVnode; // update vm's placeholder node without re-render\n    if (vm._vnode) {\n        // update child tree's parent\n        vm._vnode.parent = parentVnode;\n    }\n    vm.$options._renderChildren = renderChildren;\n    // update $attrs and $listeners hash\n    // these are also reactive so they may trigger child update if the child\n    // used them during render\n    var attrs = parentVnode.data.attrs || emptyObject;\n    if (vm._attrsProxy) {\n        // force update if attrs are accessed and has changed since it may be\n        // passed to a child component.\n        if (syncSetupProxy(vm._attrsProxy, attrs, (prevVNode.data && prevVNode.data.attrs) || emptyObject, vm, '$attrs')) {\n            needsForceUpdate = true;\n        }\n    }\n    vm.$attrs = attrs;\n    // update listeners\n    listeners = listeners || emptyObject;\n    var prevListeners = vm.$options._parentListeners;\n    if (vm._listenersProxy) {\n        syncSetupProxy(vm._listenersProxy, listeners, prevListeners || emptyObject, vm, '$listeners');\n    }\n    vm.$listeners = vm.$options._parentListeners = listeners;\n    updateComponentListeners(vm, listeners, prevListeners);\n    // update props\n    if (propsData && vm.$options.props) {\n        toggleObserving(false);\n        var props = vm._props;\n        var propKeys = vm.$options._propKeys || [];\n        for (var i = 0; i < propKeys.length; i++) {\n            var key = propKeys[i];\n            var propOptions = vm.$options.props; // wtf flow?\n            props[key] = validateProp(key, propOptions, propsData, vm);\n        }\n        toggleObserving(true);\n        // keep a copy of raw propsData\n        vm.$options.propsData = propsData;\n    }\n    // resolve slots + force update if has children\n    if (needsForceUpdate) {\n        vm.$slots = resolveSlots(renderChildren, parentVnode.context);\n        vm.$forceUpdate();\n    }\n    if (process.env.NODE_ENV !== 'production') {\n        isUpdatingChildComponent = false;\n    }\n}\nfunction isInInactiveTree(vm) {\n    while (vm && (vm = vm.$parent)) {\n        if (vm._inactive)\n            return true;\n    }\n    return false;\n}\nfunction activateChildComponent(vm, direct) {\n    if (direct) {\n        vm._directInactive = false;\n        if (isInInactiveTree(vm)) {\n            return;\n        }\n    }\n    else if (vm._directInactive) {\n        return;\n    }\n    if (vm._inactive || vm._inactive === null) {\n        vm._inactive = false;\n        for (var i = 0; i < vm.$children.length; i++) {\n            activateChildComponent(vm.$children[i]);\n        }\n        callHook$1(vm, 'activated');\n    }\n}\nfunction deactivateChildComponent(vm, direct) {\n    if (direct) {\n        vm._directInactive = true;\n        if (isInInactiveTree(vm)) {\n            return;\n        }\n    }\n    if (!vm._inactive) {\n        vm._inactive = true;\n        for (var i = 0; i < vm.$children.length; i++) {\n            deactivateChildComponent(vm.$children[i]);\n        }\n        callHook$1(vm, 'deactivated');\n    }\n}\nfunction callHook$1(vm, hook, args, setContext) {\n    if (setContext === void 0) { setContext = true; }\n    // #7573 disable dep collection when invoking lifecycle hooks\n    pushTarget();\n    var prevInst = currentInstance;\n    var prevScope = getCurrentScope();\n    setContext && setCurrentInstance(vm);\n    var handlers = vm.$options[hook];\n    var info = \"\".concat(hook, \" hook\");\n    if (handlers) {\n        for (var i = 0, j = handlers.length; i < j; i++) {\n            invokeWithErrorHandling(handlers[i], vm, args || null, vm, info);\n        }\n    }\n    if (vm._hasHookEvent) {\n        vm.$emit('hook:' + hook);\n    }\n    if (setContext) {\n        setCurrentInstance(prevInst);\n        prevScope && prevScope.on();\n    }\n    popTarget();\n}\n\nvar MAX_UPDATE_COUNT = 100;\nvar queue = [];\nvar activatedChildren = [];\nvar has = {};\nvar circular = {};\nvar waiting = false;\nvar flushing = false;\nvar index = 0;\n/**\n * Reset the scheduler's state.\n */\nfunction resetSchedulerState() {\n    index = queue.length = activatedChildren.length = 0;\n    has = {};\n    if (process.env.NODE_ENV !== 'production') {\n        circular = {};\n    }\n    waiting = flushing = false;\n}\n// Async edge case #6566 requires saving the timestamp when event listeners are\n// attached. However, calling performance.now() has a perf overhead especially\n// if the page has thousands of event listeners. Instead, we take a timestamp\n// every time the scheduler flushes and use that for all event listeners\n// attached during that flush.\nvar currentFlushTimestamp = 0;\n// Async edge case fix requires storing an event listener's attach timestamp.\nvar getNow = Date.now;\n// Determine what event timestamp the browser is using. Annoyingly, the\n// timestamp can either be hi-res (relative to page load) or low-res\n// (relative to UNIX epoch), so in order to compare time we have to use the\n// same timestamp type when saving the flush timestamp.\n// All IE versions use low-res event timestamps, and have problematic clock\n// implementations (#9632)\nif (inBrowser && !isIE) {\n    var performance_1 = window.performance;\n    if (performance_1 &&\n        typeof performance_1.now === 'function' &&\n        getNow() > document.createEvent('Event').timeStamp) {\n        // if the event timestamp, although evaluated AFTER the Date.now(), is\n        // smaller than it, it means the event is using a hi-res timestamp,\n        // and we need to use the hi-res version for event listener timestamps as\n        // well.\n        getNow = function () { return performance_1.now(); };\n    }\n}\nvar sortCompareFn = function (a, b) {\n    if (a.post) {\n        if (!b.post)\n            return 1;\n    }\n    else if (b.post) {\n        return -1;\n    }\n    return a.id - b.id;\n};\n/**\n * Flush both queues and run the watchers.\n */\nfunction flushSchedulerQueue() {\n    currentFlushTimestamp = getNow();\n    flushing = true;\n    var watcher, id;\n    // Sort queue before flush.\n    // This ensures that:\n    // 1. Components are updated from parent to child. (because parent is always\n    //    created before the child)\n    // 2. A component's user watchers are run before its render watcher (because\n    //    user watchers are created before the render watcher)\n    // 3. If a component is destroyed during a parent component's watcher run,\n    //    its watchers can be skipped.\n    queue.sort(sortCompareFn);\n    // do not cache length because more watchers might be pushed\n    // as we run existing watchers\n    for (index = 0; index < queue.length; index++) {\n        watcher = queue[index];\n        if (watcher.before) {\n            watcher.before();\n        }\n        id = watcher.id;\n        has[id] = null;\n        watcher.run();\n        // in dev build, check and stop circular updates.\n        if (process.env.NODE_ENV !== 'production' && has[id] != null) {\n            circular[id] = (circular[id] || 0) + 1;\n            if (circular[id] > MAX_UPDATE_COUNT) {\n                warn('You may have an infinite update loop ' +\n                    (watcher.user\n                        ? \"in watcher with expression \\\"\".concat(watcher.expression, \"\\\"\")\n                        : \"in a component render function.\"), watcher.vm);\n                break;\n            }\n        }\n    }\n    // keep copies of post queues before resetting state\n    var activatedQueue = activatedChildren.slice();\n    var updatedQueue = queue.slice();\n    resetSchedulerState();\n    // call component updated and activated hooks\n    callActivatedHooks(activatedQueue);\n    callUpdatedHooks(updatedQueue);\n    cleanupDeps();\n    // devtool hook\n    /* istanbul ignore if */\n    if (devtools && config.devtools) {\n        devtools.emit('flush');\n    }\n}\nfunction callUpdatedHooks(queue) {\n    var i = queue.length;\n    while (i--) {\n        var watcher = queue[i];\n        var vm = watcher.vm;\n        if (vm && vm._watcher === watcher && vm._isMounted && !vm._isDestroyed) {\n            callHook$1(vm, 'updated');\n        }\n    }\n}\n/**\n * Queue a kept-alive component that was activated during patch.\n * The queue will be processed after the entire tree has been patched.\n */\nfunction queueActivatedComponent(vm) {\n    // setting _inactive to false here so that a render function can\n    // rely on checking whether it's in an inactive tree (e.g. router-view)\n    vm._inactive = false;\n    activatedChildren.push(vm);\n}\nfunction callActivatedHooks(queue) {\n    for (var i = 0; i < queue.length; i++) {\n        queue[i]._inactive = true;\n        activateChildComponent(queue[i], true /* true */);\n    }\n}\n/**\n * Push a watcher into the watcher queue.\n * Jobs with duplicate IDs will be skipped unless it's\n * pushed when the queue is being flushed.\n */\nfunction queueWatcher(watcher) {\n    var id = watcher.id;\n    if (has[id] != null) {\n        return;\n    }\n    if (watcher === Dep.target && watcher.noRecurse) {\n        return;\n    }\n    has[id] = true;\n    if (!flushing) {\n        queue.push(watcher);\n    }\n    else {\n        // if already flushing, splice the watcher based on its id\n        // if already past its id, it will be run next immediately.\n        var i = queue.length - 1;\n        while (i > index && queue[i].id > watcher.id) {\n            i--;\n        }\n        queue.splice(i + 1, 0, watcher);\n    }\n    // queue the flush\n    if (!waiting) {\n        waiting = true;\n        if (process.env.NODE_ENV !== 'production' && !config.async) {\n            flushSchedulerQueue();\n            return;\n        }\n        nextTick(flushSchedulerQueue);\n    }\n}\n\nfunction initProvide(vm) {\n    var provideOption = vm.$options.provide;\n    if (provideOption) {\n        var provided = isFunction(provideOption)\n            ? provideOption.call(vm)\n            : provideOption;\n        if (!isObject(provided)) {\n            return;\n        }\n        var source = resolveProvided(vm);\n        // IE9 doesn't support Object.getOwnPropertyDescriptors so we have to\n        // iterate the keys ourselves.\n        var keys = hasSymbol ? Reflect.ownKeys(provided) : Object.keys(provided);\n        for (var i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            Object.defineProperty(source, key, Object.getOwnPropertyDescriptor(provided, key));\n        }\n    }\n}\nfunction initInjections(vm) {\n    var result = resolveInject(vm.$options.inject, vm);\n    if (result) {\n        toggleObserving(false);\n        Object.keys(result).forEach(function (key) {\n            /* istanbul ignore else */\n            if (process.env.NODE_ENV !== 'production') {\n                defineReactive(vm, key, result[key], function () {\n                    warn(\"Avoid mutating an injected value directly since the changes will be \" +\n                        \"overwritten whenever the provided component re-renders. \" +\n                        \"injection being mutated: \\\"\".concat(key, \"\\\"\"), vm);\n                });\n            }\n            else {\n                defineReactive(vm, key, result[key]);\n            }\n        });\n        toggleObserving(true);\n    }\n}\nfunction resolveInject(inject, vm) {\n    if (inject) {\n        // inject is :any because flow is not smart enough to figure out cached\n        var result = Object.create(null);\n        var keys = hasSymbol ? Reflect.ownKeys(inject) : Object.keys(inject);\n        for (var i = 0; i < keys.length; i++) {\n            var key = keys[i];\n            // #6574 in case the inject object is observed...\n            if (key === '__ob__')\n                continue;\n            var provideKey = inject[key].from;\n            if (provideKey in vm._provided) {\n                result[key] = vm._provided[provideKey];\n            }\n            else if ('default' in inject[key]) {\n                var provideDefault = inject[key].default;\n                result[key] = isFunction(provideDefault)\n                    ? provideDefault.call(vm)\n                    : provideDefault;\n            }\n            else if (process.env.NODE_ENV !== 'production') {\n                warn(\"Injection \\\"\".concat(key, \"\\\" not found\"), vm);\n            }\n        }\n        return result;\n    }\n}\n\nfunction FunctionalRenderContext(data, props, children, parent, Ctor) {\n    var _this = this;\n    var options = Ctor.options;\n    // ensure the createElement function in functional components\n    // gets a unique context - this is necessary for correct named slot check\n    var contextVm;\n    if (hasOwn(parent, '_uid')) {\n        contextVm = Object.create(parent);\n        contextVm._original = parent;\n    }\n    else {\n        // the context vm passed in is a functional context as well.\n        // in this case we want to make sure we are able to get a hold to the\n        // real context instance.\n        contextVm = parent;\n        // @ts-ignore\n        parent = parent._original;\n    }\n    var isCompiled = isTrue(options._compiled);\n    var needNormalization = !isCompiled;\n    this.data = data;\n    this.props = props;\n    this.children = children;\n    this.parent = parent;\n    this.listeners = data.on || emptyObject;\n    this.injections = resolveInject(options.inject, parent);\n    this.slots = function () {\n        if (!_this.$slots) {\n            normalizeScopedSlots(parent, data.scopedSlots, (_this.$slots = resolveSlots(children, parent)));\n        }\n        return _this.$slots;\n    };\n    Object.defineProperty(this, 'scopedSlots', {\n        enumerable: true,\n        get: function () {\n            return normalizeScopedSlots(parent, data.scopedSlots, this.slots());\n        }\n    });\n    // support for compiled functional template\n    if (isCompiled) {\n        // exposing $options for renderStatic()\n        this.$options = options;\n        // pre-resolve slots for renderSlot()\n        this.$slots = this.slots();\n        this.$scopedSlots = normalizeScopedSlots(parent, data.scopedSlots, this.$slots);\n    }\n    if (options._scopeId) {\n        this._c = function (a, b, c, d) {\n            var vnode = createElement$1(contextVm, a, b, c, d, needNormalization);\n            if (vnode && !isArray(vnode)) {\n                vnode.fnScopeId = options._scopeId;\n                vnode.fnContext = parent;\n            }\n            return vnode;\n        };\n    }\n    else {\n        this._c = function (a, b, c, d) {\n            return createElement$1(contextVm, a, b, c, d, needNormalization);\n        };\n    }\n}\ninstallRenderHelpers(FunctionalRenderContext.prototype);\nfunction createFunctionalComponent(Ctor, propsData, data, contextVm, children) {\n    var options = Ctor.options;\n    var props = {};\n    var propOptions = options.props;\n    if (isDef(propOptions)) {\n        for (var key in propOptions) {\n            props[key] = validateProp(key, propOptions, propsData || emptyObject);\n        }\n    }\n    else {\n        if (isDef(data.attrs))\n            mergeProps(props, data.attrs);\n        if (isDef(data.props))\n            mergeProps(props, data.props);\n    }\n    var renderContext = new FunctionalRenderContext(data, props, children, contextVm, Ctor);\n    var vnode = options.render.call(null, renderContext._c, renderContext);\n    if (vnode instanceof VNode) {\n        return cloneAndMarkFunctionalResult(vnode, data, renderContext.parent, options, renderContext);\n    }\n    else if (isArray(vnode)) {\n        var vnodes = normalizeChildren(vnode) || [];\n        var res = new Array(vnodes.length);\n        for (var i = 0; i < vnodes.length; i++) {\n            res[i] = cloneAndMarkFunctionalResult(vnodes[i], data, renderContext.parent, options, renderContext);\n        }\n        return res;\n    }\n}\nfunction cloneAndMarkFunctionalResult(vnode, data, contextVm, options, renderContext) {\n    // #7817 clone node before setting fnContext, otherwise if the node is reused\n    // (e.g. it was from a cached normal slot) the fnContext causes named slots\n    // that should not be matched to match.\n    var clone = cloneVNode(vnode);\n    clone.fnContext = contextVm;\n    clone.fnOptions = options;\n    if (process.env.NODE_ENV !== 'production') {\n        (clone.devtoolsMeta = clone.devtoolsMeta || {}).renderContext =\n            renderContext;\n    }\n    if (data.slot) {\n        (clone.data || (clone.data = {})).slot = data.slot;\n    }\n    return clone;\n}\nfunction mergeProps(to, from) {\n    for (var key in from) {\n        to[camelize(key)] = from[key];\n    }\n}\n\nfunction getComponentName(options) {\n    return options.name || options.__name || options._componentTag;\n}\n// inline hooks to be invoked on component VNodes during patch\nvar componentVNodeHooks = {\n    init: function (vnode, hydrating) {\n        if (vnode.componentInstance &&\n            !vnode.componentInstance._isDestroyed &&\n            vnode.data.keepAlive) {\n            // kept-alive components, treat as a patch\n            var mountedNode = vnode; // work around flow\n            componentVNodeHooks.prepatch(mountedNode, mountedNode);\n        }\n        else {\n            var child = (vnode.componentInstance = createComponentInstanceForVnode(vnode, activeInstance));\n            child.$mount(hydrating ? vnode.elm : undefined, hydrating);\n        }\n    },\n    prepatch: function (oldVnode, vnode) {\n        var options = vnode.componentOptions;\n        var child = (vnode.componentInstance = oldVnode.componentInstance);\n        updateChildComponent(child, options.propsData, // updated props\n        options.listeners, // updated listeners\n        vnode, // new parent vnode\n        options.children // new children\n        );\n    },\n    insert: function (vnode) {\n        var context = vnode.context, componentInstance = vnode.componentInstance;\n        if (!componentInstance._isMounted) {\n            componentInstance._isMounted = true;\n            callHook$1(componentInstance, 'mounted');\n        }\n        if (vnode.data.keepAlive) {\n            if (context._isMounted) {\n                // vue-router#1212\n                // During updates, a kept-alive component's child components may\n                // change, so directly walking the tree here may call activated hooks\n                // on incorrect children. Instead we push them into a queue which will\n                // be processed after the whole patch process ended.\n                queueActivatedComponent(componentInstance);\n            }\n            else {\n                activateChildComponent(componentInstance, true /* direct */);\n            }\n        }\n    },\n    destroy: function (vnode) {\n        var componentInstance = vnode.componentInstance;\n        if (!componentInstance._isDestroyed) {\n            if (!vnode.data.keepAlive) {\n                componentInstance.$destroy();\n            }\n            else {\n                deactivateChildComponent(componentInstance, true /* direct */);\n            }\n        }\n    }\n};\nvar hooksToMerge = Object.keys(componentVNodeHooks);\nfunction createComponent(Ctor, data, context, children, tag) {\n    if (isUndef(Ctor)) {\n        return;\n    }\n    var baseCtor = context.$options._base;\n    // plain options object: turn it into a constructor\n    if (isObject(Ctor)) {\n        Ctor = baseCtor.extend(Ctor);\n    }\n    // if at this stage it's not a constructor or an async component factory,\n    // reject.\n    if (typeof Ctor !== 'function') {\n        if (process.env.NODE_ENV !== 'production') {\n            warn(\"Invalid Component definition: \".concat(String(Ctor)), context);\n        }\n        return;\n    }\n    // async component\n    var asyncFactory;\n    // @ts-expect-error\n    if (isUndef(Ctor.cid)) {\n        asyncFactory = Ctor;\n        Ctor = resolveAsyncComponent(asyncFactory, baseCtor);\n        if (Ctor === undefined) {\n            // return a placeholder node for async component, which is rendered\n            // as a comment node but preserves all the raw information for the node.\n            // the information will be used for async server-rendering and hydration.\n            return createAsyncPlaceholder(asyncFactory, data, context, children, tag);\n        }\n    }\n    data = data || {};\n    // resolve constructor options in case global mixins are applied after\n    // component constructor creation\n    resolveConstructorOptions(Ctor);\n    // transform component v-model data into props & events\n    if (isDef(data.model)) {\n        // @ts-expect-error\n        transformModel(Ctor.options, data);\n    }\n    // extract props\n    // @ts-expect-error\n    var propsData = extractPropsFromVNodeData(data, Ctor, tag);\n    // functional component\n    // @ts-expect-error\n    if (isTrue(Ctor.options.functional)) {\n        return createFunctionalComponent(Ctor, propsData, data, context, children);\n    }\n    // extract listeners, since these needs to be treated as\n    // child component listeners instead of DOM listeners\n    var listeners = data.on;\n    // replace with listeners with .native modifier\n    // so it gets processed during parent component patch.\n    data.on = data.nativeOn;\n    // @ts-expect-error\n    if (isTrue(Ctor.options.abstract)) {\n        // abstract components do not keep anything\n        // other than props & listeners & slot\n        // work around flow\n        var slot = data.slot;\n        data = {};\n        if (slot) {\n            data.slot = slot;\n        }\n    }\n    // install component management hooks onto the placeholder node\n    installComponentHooks(data);\n    // return a placeholder vnode\n    // @ts-expect-error\n    var name = getComponentName(Ctor.options) || tag;\n    var vnode = new VNode(\n    // @ts-expect-error\n    \"vue-component-\".concat(Ctor.cid).concat(name ? \"-\".concat(name) : ''), data, undefined, undefined, undefined, context, \n    // @ts-expect-error\n    { Ctor: Ctor, propsData: propsData, listeners: listeners, tag: tag, children: children }, asyncFactory);\n    return vnode;\n}\nfunction createComponentInstanceForVnode(\n// we know it's MountedComponentVNode but flow doesn't\nvnode, \n// activeInstance in lifecycle state\nparent) {\n    var options = {\n        _isComponent: true,\n        _parentVnode: vnode,\n        parent: parent\n    };\n    // check inline-template render functions\n    var inlineTemplate = vnode.data.inlineTemplate;\n    if (isDef(inlineTemplate)) {\n        options.render = inlineTemplate.render;\n        options.staticRenderFns = inlineTemplate.staticRenderFns;\n    }\n    return new vnode.componentOptions.Ctor(options);\n}\nfunction installComponentHooks(data) {\n    var hooks = data.hook || (data.hook = {});\n    for (var i = 0; i < hooksToMerge.length; i++) {\n        var key = hooksToMerge[i];\n        var existing = hooks[key];\n        var toMerge = componentVNodeHooks[key];\n        // @ts-expect-error\n        if (existing !== toMerge && !(existing && existing._merged)) {\n            hooks[key] = existing ? mergeHook(toMerge, existing) : toMerge;\n        }\n    }\n}\nfunction mergeHook(f1, f2) {\n    var merged = function (a, b) {\n        // flow complains about extra args which is why we use any\n        f1(a, b);\n        f2(a, b);\n    };\n    merged._merged = true;\n    return merged;\n}\n// transform component v-model info (value and callback) into\n// prop and event handler respectively.\nfunction transformModel(options, data) {\n    var prop = (options.model && options.model.prop) || 'value';\n    var event = (options.model && options.model.event) || 'input';\n    (data.attrs || (data.attrs = {}))[prop] = data.model.value;\n    var on = data.on || (data.on = {});\n    var existing = on[event];\n    var callback = data.model.callback;\n    if (isDef(existing)) {\n        if (isArray(existing)\n            ? existing.indexOf(callback) === -1\n            : existing !== callback) {\n            on[event] = [callback].concat(existing);\n        }\n    }\n    else {\n        on[event] = callback;\n    }\n}\n\nvar warn = noop;\nvar tip = noop;\nvar generateComponentTrace; // work around flow check\nvar formatComponentName;\nif (process.env.NODE_ENV !== 'production') {\n    var hasConsole_1 = typeof console !== 'undefined';\n    var classifyRE_1 = /(?:^|[-_])(\\w)/g;\n    var classify_1 = function (str) {\n        return str.replace(classifyRE_1, function (c) { return c.toUpperCase(); }).replace(/[-_]/g, '');\n    };\n    warn = function (msg, vm) {\n        if (vm === void 0) { vm = currentInstance; }\n        var trace = vm ? generateComponentTrace(vm) : '';\n        if (config.warnHandler) {\n            config.warnHandler.call(null, msg, vm, trace);\n        }\n        else if (hasConsole_1 && !config.silent) {\n            console.error(\"[Vue warn]: \".concat(msg).concat(trace));\n        }\n    };\n    tip = function (msg, vm) {\n        if (hasConsole_1 && !config.silent) {\n            console.warn(\"[Vue tip]: \".concat(msg) + (vm ? generateComponentTrace(vm) : ''));\n        }\n    };\n    formatComponentName = function (vm, includeFile) {\n        if (vm.$root === vm) {\n            return '<Root>';\n        }\n        var options = isFunction(vm) && vm.cid != null\n            ? vm.options\n            : vm._isVue\n                ? vm.$options || vm.constructor.options\n                : vm;\n        var name = getComponentName(options);\n        var file = options.__file;\n        if (!name && file) {\n            var match = file.match(/([^/\\\\]+)\\.vue$/);\n            name = match && match[1];\n        }\n        return ((name ? \"<\".concat(classify_1(name), \">\") : \"<Anonymous>\") +\n            (file && includeFile !== false ? \" at \".concat(file) : ''));\n    };\n    var repeat_1 = function (str, n) {\n        var res = '';\n        while (n) {\n            if (n % 2 === 1)\n                res += str;\n            if (n > 1)\n                str += str;\n            n >>= 1;\n        }\n        return res;\n    };\n    generateComponentTrace = function (vm) {\n        if (vm._isVue && vm.$parent) {\n            var tree = [];\n            var currentRecursiveSequence = 0;\n            while (vm) {\n                if (tree.length > 0) {\n                    var last = tree[tree.length - 1];\n                    if (last.constructor === vm.constructor) {\n                        currentRecursiveSequence++;\n                        vm = vm.$parent;\n                        continue;\n                    }\n                    else if (currentRecursiveSequence > 0) {\n                        tree[tree.length - 1] = [last, currentRecursiveSequence];\n                        currentRecursiveSequence = 0;\n                    }\n                }\n                tree.push(vm);\n                vm = vm.$parent;\n            }\n            return ('\\n\\nfound in\\n\\n' +\n                tree\n                    .map(function (vm, i) {\n                    return \"\".concat(i === 0 ? '---> ' : repeat_1(' ', 5 + i * 2)).concat(isArray(vm)\n                        ? \"\".concat(formatComponentName(vm[0]), \"... (\").concat(vm[1], \" recursive calls)\")\n                        : formatComponentName(vm));\n                })\n                    .join('\\n'));\n        }\n        else {\n            return \"\\n\\n(found in \".concat(formatComponentName(vm), \")\");\n        }\n    };\n}\n\n/**\n * Option overwriting strategies are functions that handle\n * how to merge a parent option value and a child option\n * value into the final value.\n */\nvar strats = config.optionMergeStrategies;\n/**\n * Options with restrictions\n */\nif (process.env.NODE_ENV !== 'production') {\n    strats.el = strats.propsData = function (parent, child, vm, key) {\n        if (!vm) {\n            warn(\"option \\\"\".concat(key, \"\\\" can only be used during instance \") +\n                'creation with the `new` keyword.');\n        }\n        return defaultStrat(parent, child);\n    };\n}\n/**\n * Helper that recursively merges two data objects together.\n */\nfunction mergeData(to, from, recursive) {\n    if (recursive === void 0) { recursive = true; }\n    if (!from)\n        return to;\n    var key, toVal, fromVal;\n    var keys = hasSymbol\n        ? Reflect.ownKeys(from)\n        : Object.keys(from);\n    for (var i = 0; i < keys.length; i++) {\n        key = keys[i];\n        // in case the object is already observed...\n        if (key === '__ob__')\n            continue;\n        toVal = to[key];\n        fromVal = from[key];\n        if (!recursive || !hasOwn(to, key)) {\n            set(to, key, fromVal);\n        }\n        else if (toVal !== fromVal &&\n            isPlainObject(toVal) &&\n            isPlainObject(fromVal)) {\n            mergeData(toVal, fromVal);\n        }\n    }\n    return to;\n}\n/**\n * Data\n */\nfunction mergeDataOrFn(parentVal, childVal, vm) {\n    if (!vm) {\n        // in a Vue.extend merge, both should be functions\n        if (!childVal) {\n            return parentVal;\n        }\n        if (!parentVal) {\n            return childVal;\n        }\n        // when parentVal & childVal are both present,\n        // we need to return a function that returns the\n        // merged result of both functions... no need to\n        // check if parentVal is a function here because\n        // it has to be a function to pass previous merges.\n        return function mergedDataFn() {\n            return mergeData(isFunction(childVal) ? childVal.call(this, this) : childVal, isFunction(parentVal) ? parentVal.call(this, this) : parentVal);\n        };\n    }\n    else {\n        return function mergedInstanceDataFn() {\n            // instance merge\n            var instanceData = isFunction(childVal)\n                ? childVal.call(vm, vm)\n                : childVal;\n            var defaultData = isFunction(parentVal)\n                ? parentVal.call(vm, vm)\n                : parentVal;\n            if (instanceData) {\n                return mergeData(instanceData, defaultData);\n            }\n            else {\n                return defaultData;\n            }\n        };\n    }\n}\nstrats.data = function (parentVal, childVal, vm) {\n    if (!vm) {\n        if (childVal && typeof childVal !== 'function') {\n            process.env.NODE_ENV !== 'production' &&\n                warn('The \"data\" option should be a function ' +\n                    'that returns a per-instance value in component ' +\n                    'definitions.', vm);\n            return parentVal;\n        }\n        return mergeDataOrFn(parentVal, childVal);\n    }\n    return mergeDataOrFn(parentVal, childVal, vm);\n};\n/**\n * Hooks and props are merged as arrays.\n */\nfunction mergeLifecycleHook(parentVal, childVal) {\n    var res = childVal\n        ? parentVal\n            ? parentVal.concat(childVal)\n            : isArray(childVal)\n                ? childVal\n                : [childVal]\n        : parentVal;\n    return res ? dedupeHooks(res) : res;\n}\nfunction dedupeHooks(hooks) {\n    var res = [];\n    for (var i = 0; i < hooks.length; i++) {\n        if (res.indexOf(hooks[i]) === -1) {\n            res.push(hooks[i]);\n        }\n    }\n    return res;\n}\nLIFECYCLE_HOOKS.forEach(function (hook) {\n    strats[hook] = mergeLifecycleHook;\n});\n/**\n * Assets\n *\n * When a vm is present (instance creation), we need to do\n * a three-way merge between constructor options, instance\n * options and parent options.\n */\nfunction mergeAssets(parentVal, childVal, vm, key) {\n    var res = Object.create(parentVal || null);\n    if (childVal) {\n        process.env.NODE_ENV !== 'production' && assertObjectType(key, childVal, vm);\n        return extend(res, childVal);\n    }\n    else {\n        return res;\n    }\n}\nASSET_TYPES.forEach(function (type) {\n    strats[type + 's'] = mergeAssets;\n});\n/**\n * Watchers.\n *\n * Watchers hashes should not overwrite one\n * another, so we merge them as arrays.\n */\nstrats.watch = function (parentVal, childVal, vm, key) {\n    // work around Firefox's Object.prototype.watch...\n    //@ts-expect-error work around\n    if (parentVal === nativeWatch)\n        parentVal = undefined;\n    //@ts-expect-error work around\n    if (childVal === nativeWatch)\n        childVal = undefined;\n    /* istanbul ignore if */\n    if (!childVal)\n        return Object.create(parentVal || null);\n    if (process.env.NODE_ENV !== 'production') {\n        assertObjectType(key, childVal, vm);\n    }\n    if (!parentVal)\n        return childVal;\n    var ret = {};\n    extend(ret, parentVal);\n    for (var key_1 in childVal) {\n        var parent_1 = ret[key_1];\n        var child = childVal[key_1];\n        if (parent_1 && !isArray(parent_1)) {\n            parent_1 = [parent_1];\n        }\n        ret[key_1] = parent_1 ? parent_1.concat(child) : isArray(child) ? child : [child];\n    }\n    return ret;\n};\n/**\n * Other object hashes.\n */\nstrats.props =\n    strats.methods =\n        strats.inject =\n            strats.computed =\n                function (parentVal, childVal, vm, key) {\n                    if (childVal && process.env.NODE_ENV !== 'production') {\n                        assertObjectType(key, childVal, vm);\n                    }\n                    if (!parentVal)\n                        return childVal;\n                    var ret = Object.create(null);\n                    extend(ret, parentVal);\n                    if (childVal)\n                        extend(ret, childVal);\n                    return ret;\n                };\nstrats.provide = function (parentVal, childVal) {\n    if (!parentVal)\n        return childVal;\n    return function () {\n        var ret = Object.create(null);\n        mergeData(ret, isFunction(parentVal) ? parentVal.call(this) : parentVal);\n        if (childVal) {\n            mergeData(ret, isFunction(childVal) ? childVal.call(this) : childVal, false // non-recursive\n            );\n        }\n        return ret;\n    };\n};\n/**\n * Default strategy.\n */\nvar defaultStrat = function (parentVal, childVal) {\n    return childVal === undefined ? parentVal : childVal;\n};\n/**\n * Validate component names\n */\nfunction checkComponents(options) {\n    for (var key in options.components) {\n        validateComponentName(key);\n    }\n}\nfunction validateComponentName(name) {\n    if (!new RegExp(\"^[a-zA-Z][\\\\-\\\\.0-9_\".concat(unicodeRegExp.source, \"]*$\")).test(name)) {\n        warn('Invalid component name: \"' +\n            name +\n            '\". Component names ' +\n            'should conform to valid custom element name in html5 specification.');\n    }\n    if (isBuiltInTag(name) || config.isReservedTag(name)) {\n        warn('Do not use built-in or reserved HTML elements as component ' +\n            'id: ' +\n            name);\n    }\n}\n/**\n * Ensure all props option syntax are normalized into the\n * Object-based format.\n */\nfunction normalizeProps(options, vm) {\n    var props = options.props;\n    if (!props)\n        return;\n    var res = {};\n    var i, val, name;\n    if (isArray(props)) {\n        i = props.length;\n        while (i--) {\n            val = props[i];\n            if (typeof val === 'string') {\n                name = camelize(val);\n                res[name] = { type: null };\n            }\n            else if (process.env.NODE_ENV !== 'production') {\n                warn('props must be strings when using array syntax.');\n            }\n        }\n    }\n    else if (isPlainObject(props)) {\n        for (var key in props) {\n            val = props[key];\n            name = camelize(key);\n            res[name] = isPlainObject(val) ? val : { type: val };\n        }\n    }\n    else if (process.env.NODE_ENV !== 'production') {\n        warn(\"Invalid value for option \\\"props\\\": expected an Array or an Object, \" +\n            \"but got \".concat(toRawType(props), \".\"), vm);\n    }\n    options.props = res;\n}\n/**\n * Normalize all injections into Object-based format\n */\nfunction normalizeInject(options, vm) {\n    var inject = options.inject;\n    if (!inject)\n        return;\n    var normalized = (options.inject = {});\n    if (isArray(inject)) {\n        for (var i = 0; i < inject.length; i++) {\n            normalized[inject[i]] = { from: inject[i] };\n        }\n    }\n    else if (isPlainObject(inject)) {\n        for (var key in inject) {\n            var val = inject[key];\n            normalized[key] = isPlainObject(val)\n                ? extend({ from: key }, val)\n                : { from: val };\n        }\n    }\n    else if (process.env.NODE_ENV !== 'production') {\n        warn(\"Invalid value for option \\\"inject\\\": expected an Array or an Object, \" +\n            \"but got \".concat(toRawType(inject), \".\"), vm);\n    }\n}\n/**\n * Normalize raw function directives into object format.\n */\nfunction normalizeDirectives$1(options) {\n    var dirs = options.directives;\n    if (dirs) {\n        for (var key in dirs) {\n            var def = dirs[key];\n            if (isFunction(def)) {\n                dirs[key] = { bind: def, update: def };\n            }\n        }\n    }\n}\nfunction assertObjectType(name, value, vm) {\n    if (!isPlainObject(value)) {\n        warn(\"Invalid value for option \\\"\".concat(name, \"\\\": expected an Object, \") +\n            \"but got \".concat(toRawType(value), \".\"), vm);\n    }\n}\n/**\n * Merge two option objects into a new one.\n * Core utility used in both instantiation and inheritance.\n */\nfunction mergeOptions(parent, child, vm) {\n    if (process.env.NODE_ENV !== 'production') {\n        checkComponents(child);\n    }\n    if (isFunction(child)) {\n        // @ts-expect-error\n        child = child.options;\n    }\n    normalizeProps(child, vm);\n    normalizeInject(child, vm);\n    normalizeDirectives$1(child);\n    // Apply extends and mixins on the child options,\n    // but only if it is a raw options object that isn't\n    // the result of another mergeOptions call.\n    // Only merged options has the _base property.\n    if (!child._base) {\n        if (child.extends) {\n            parent = mergeOptions(parent, child.extends, vm);\n        }\n        if (child.mixins) {\n            for (var i = 0, l = child.mixins.length; i < l; i++) {\n                parent = mergeOptions(parent, child.mixins[i], vm);\n            }\n        }\n    }\n    var options = {};\n    var key;\n    for (key in parent) {\n        mergeField(key);\n    }\n    for (key in child) {\n        if (!hasOwn(parent, key)) {\n            mergeField(key);\n        }\n    }\n    function mergeField(key) {\n        var strat = strats[key] || defaultStrat;\n        options[key] = strat(parent[key], child[key], vm, key);\n    }\n    return options;\n}\n/**\n * Resolve an asset.\n * This function is used because child instances need access\n * to assets defined in its ancestor chain.\n */\nfunction resolveAsset(options, type, id, warnMissing) {\n    /* istanbul ignore if */\n    if (typeof id !== 'string') {\n        return;\n    }\n    var assets = options[type];\n    // check local registration variations first\n    if (hasOwn(assets, id))\n        return assets[id];\n    var camelizedId = camelize(id);\n    if (hasOwn(assets, camelizedId))\n        return assets[camelizedId];\n    var PascalCaseId = capitalize(camelizedId);\n    if (hasOwn(assets, PascalCaseId))\n        return assets[PascalCaseId];\n    // fallback to prototype chain\n    var res = assets[id] || assets[camelizedId] || assets[PascalCaseId];\n    if (process.env.NODE_ENV !== 'production' && warnMissing && !res) {\n        warn('Failed to resolve ' + type.slice(0, -1) + ': ' + id);\n    }\n    return res;\n}\n\nfunction validateProp(key, propOptions, propsData, vm) {\n    var prop = propOptions[key];\n    var absent = !hasOwn(propsData, key);\n    var value = propsData[key];\n    // boolean casting\n    var booleanIndex = getTypeIndex(Boolean, prop.type);\n    if (booleanIndex > -1) {\n        if (absent && !hasOwn(prop, 'default')) {\n            value = false;\n        }\n        else if (value === '' || value === hyphenate(key)) {\n            // only cast empty string / same name to boolean if\n            // boolean has higher priority\n            var stringIndex = getTypeIndex(String, prop.type);\n            if (stringIndex < 0 || booleanIndex < stringIndex) {\n                value = true;\n            }\n        }\n    }\n    // check default value\n    if (value === undefined) {\n        value = getPropDefaultValue(vm, prop, key);\n        // since the default value is a fresh copy,\n        // make sure to observe it.\n        var prevShouldObserve = shouldObserve;\n        toggleObserving(true);\n        observe(value);\n        toggleObserving(prevShouldObserve);\n    }\n    if (process.env.NODE_ENV !== 'production') {\n        assertProp(prop, key, value, vm, absent);\n    }\n    return value;\n}\n/**\n * Get the default value of a prop.\n */\nfunction getPropDefaultValue(vm, prop, key) {\n    // no default, return undefined\n    if (!hasOwn(prop, 'default')) {\n        return undefined;\n    }\n    var def = prop.default;\n    // warn against non-factory defaults for Object & Array\n    if (process.env.NODE_ENV !== 'production' && isObject(def)) {\n        warn('Invalid default value for prop \"' +\n            key +\n            '\": ' +\n            'Props with type Object/Array must use a factory function ' +\n            'to return the default value.', vm);\n    }\n    // the raw prop value was also undefined from previous render,\n    // return previous default value to avoid unnecessary watcher trigger\n    if (vm &&\n        vm.$options.propsData &&\n        vm.$options.propsData[key] === undefined &&\n        vm._props[key] !== undefined) {\n        return vm._props[key];\n    }\n    // call factory function for non-Function types\n    // a value is Function if its prototype is function even across different execution context\n    return isFunction(def) && getType(prop.type) !== 'Function'\n        ? def.call(vm)\n        : def;\n}\n/**\n * Assert whether a prop is valid.\n */\nfunction assertProp(prop, name, value, vm, absent) {\n    if (prop.required && absent) {\n        warn('Missing required prop: \"' + name + '\"', vm);\n        return;\n    }\n    if (value == null && !prop.required) {\n        return;\n    }\n    var type = prop.type;\n    var valid = !type || type === true;\n    var expectedTypes = [];\n    if (type) {\n        if (!isArray(type)) {\n            type = [type];\n        }\n        for (var i = 0; i < type.length && !valid; i++) {\n            var assertedType = assertType(value, type[i], vm);\n            expectedTypes.push(assertedType.expectedType || '');\n            valid = assertedType.valid;\n        }\n    }\n    var haveExpectedTypes = expectedTypes.some(function (t) { return t; });\n    if (!valid && haveExpectedTypes) {\n        warn(getInvalidTypeMessage(name, value, expectedTypes), vm);\n        return;\n    }\n    var validator = prop.validator;\n    if (validator) {\n        if (!validator(value)) {\n            warn('Invalid prop: custom validator check failed for prop \"' + name + '\".', vm);\n        }\n    }\n}\nvar simpleCheckRE = /^(String|Number|Boolean|Function|Symbol|BigInt)$/;\nfunction assertType(value, type, vm) {\n    var valid;\n    var expectedType = getType(type);\n    if (simpleCheckRE.test(expectedType)) {\n        var t = typeof value;\n        valid = t === expectedType.toLowerCase();\n        // for primitive wrapper objects\n        if (!valid && t === 'object') {\n            valid = value instanceof type;\n        }\n    }\n    else if (expectedType === 'Object') {\n        valid = isPlainObject(value);\n    }\n    else if (expectedType === 'Array') {\n        valid = isArray(value);\n    }\n    else {\n        try {\n            valid = value instanceof type;\n        }\n        catch (e) {\n            warn('Invalid prop type: \"' + String(type) + '\" is not a constructor', vm);\n            valid = false;\n        }\n    }\n    return {\n        valid: valid,\n        expectedType: expectedType\n    };\n}\nvar functionTypeCheckRE = /^\\s*function (\\w+)/;\n/**\n * Use function string name to check built-in types,\n * because a simple equality check will fail when running\n * across different vms / iframes.\n */\nfunction getType(fn) {\n    var match = fn && fn.toString().match(functionTypeCheckRE);\n    return match ? match[1] : '';\n}\nfunction isSameType(a, b) {\n    return getType(a) === getType(b);\n}\nfunction getTypeIndex(type, expectedTypes) {\n    if (!isArray(expectedTypes)) {\n        return isSameType(expectedTypes, type) ? 0 : -1;\n    }\n    for (var i = 0, len = expectedTypes.length; i < len; i++) {\n        if (isSameType(expectedTypes[i], type)) {\n            return i;\n        }\n    }\n    return -1;\n}\nfunction getInvalidTypeMessage(name, value, expectedTypes) {\n    var message = \"Invalid prop: type check failed for prop \\\"\".concat(name, \"\\\".\") +\n        \" Expected \".concat(expectedTypes.map(capitalize).join(', '));\n    var expectedType = expectedTypes[0];\n    var receivedType = toRawType(value);\n    // check if we need to specify expected value\n    if (expectedTypes.length === 1 &&\n        isExplicable(expectedType) &&\n        isExplicable(typeof value) &&\n        !isBoolean(expectedType, receivedType)) {\n        message += \" with value \".concat(styleValue(value, expectedType));\n    }\n    message += \", got \".concat(receivedType, \" \");\n    // check if we need to specify received value\n    if (isExplicable(receivedType)) {\n        message += \"with value \".concat(styleValue(value, receivedType), \".\");\n    }\n    return message;\n}\nfunction styleValue(value, type) {\n    if (type === 'String') {\n        return \"\\\"\".concat(value, \"\\\"\");\n    }\n    else if (type === 'Number') {\n        return \"\".concat(Number(value));\n    }\n    else {\n        return \"\".concat(value);\n    }\n}\nvar EXPLICABLE_TYPES = ['string', 'number', 'boolean'];\nfunction isExplicable(value) {\n    return EXPLICABLE_TYPES.some(function (elem) { return value.toLowerCase() === elem; });\n}\nfunction isBoolean() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return args.some(function (elem) { return elem.toLowerCase() === 'boolean'; });\n}\n\n/* not type checking this file because flow doesn't play well with Proxy */\nvar initProxy;\nif (process.env.NODE_ENV !== 'production') {\n    var allowedGlobals_1 = makeMap('Infinity,undefined,NaN,isFinite,isNaN,' +\n        'parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,' +\n        'Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,' +\n        'require' // for Webpack/Browserify\n    );\n    var warnNonPresent_1 = function (target, key) {\n        warn(\"Property or method \\\"\".concat(key, \"\\\" is not defined on the instance but \") +\n            'referenced during render. Make sure that this property is reactive, ' +\n            'either in the data option, or for class-based components, by ' +\n            'initializing the property. ' +\n            'See: https://v2.vuejs.org/v2/guide/reactivity.html#Declaring-Reactive-Properties.', target);\n    };\n    var warnReservedPrefix_1 = function (target, key) {\n        warn(\"Property \\\"\".concat(key, \"\\\" must be accessed with \\\"$data.\").concat(key, \"\\\" because \") +\n            'properties starting with \"$\" or \"_\" are not proxied in the Vue instance to ' +\n            'prevent conflicts with Vue internals. ' +\n            'See: https://v2.vuejs.org/v2/api/#data', target);\n    };\n    var hasProxy_1 = typeof Proxy !== 'undefined' && isNative(Proxy);\n    if (hasProxy_1) {\n        var isBuiltInModifier_1 = makeMap('stop,prevent,self,ctrl,shift,alt,meta,exact');\n        config.keyCodes = new Proxy(config.keyCodes, {\n            set: function (target, key, value) {\n                if (isBuiltInModifier_1(key)) {\n                    warn(\"Avoid overwriting built-in modifier in config.keyCodes: .\".concat(key));\n                    return false;\n                }\n                else {\n                    target[key] = value;\n                    return true;\n                }\n            }\n        });\n    }\n    var hasHandler_1 = {\n        has: function (target, key) {\n            var has = key in target;\n            var isAllowed = allowedGlobals_1(key) ||\n                (typeof key === 'string' &&\n                    key.charAt(0) === '_' &&\n                    !(key in target.$data));\n            if (!has && !isAllowed) {\n                if (key in target.$data)\n                    warnReservedPrefix_1(target, key);\n                else\n                    warnNonPresent_1(target, key);\n            }\n            return has || !isAllowed;\n        }\n    };\n    var getHandler_1 = {\n        get: function (target, key) {\n            if (typeof key === 'string' && !(key in target)) {\n                if (key in target.$data)\n                    warnReservedPrefix_1(target, key);\n                else\n                    warnNonPresent_1(target, key);\n            }\n            return target[key];\n        }\n    };\n    initProxy = function initProxy(vm) {\n        if (hasProxy_1) {\n            // determine which proxy handler to use\n            var options = vm.$options;\n            var handlers = options.render && options.render._withStripped ? getHandler_1 : hasHandler_1;\n            vm._renderProxy = new Proxy(vm, handlers);\n        }\n        else {\n            vm._renderProxy = vm;\n        }\n    };\n}\n\nvar sharedPropertyDefinition = {\n    enumerable: true,\n    configurable: true,\n    get: noop,\n    set: noop\n};\nfunction proxy(target, sourceKey, key) {\n    sharedPropertyDefinition.get = function proxyGetter() {\n        return this[sourceKey][key];\n    };\n    sharedPropertyDefinition.set = function proxySetter(val) {\n        this[sourceKey][key] = val;\n    };\n    Object.defineProperty(target, key, sharedPropertyDefinition);\n}\nfunction initState(vm) {\n    var opts = vm.$options;\n    if (opts.props)\n        initProps$1(vm, opts.props);\n    // Composition API\n    initSetup(vm);\n    if (opts.methods)\n        initMethods(vm, opts.methods);\n    if (opts.data) {\n        initData(vm);\n    }\n    else {\n        var ob = observe((vm._data = {}));\n        ob && ob.vmCount++;\n    }\n    if (opts.computed)\n        initComputed$1(vm, opts.computed);\n    if (opts.watch && opts.watch !== nativeWatch) {\n        initWatch(vm, opts.watch);\n    }\n}\nfunction initProps$1(vm, propsOptions) {\n    var propsData = vm.$options.propsData || {};\n    var props = (vm._props = shallowReactive({}));\n    // cache prop keys so that future props updates can iterate using Array\n    // instead of dynamic object key enumeration.\n    var keys = (vm.$options._propKeys = []);\n    var isRoot = !vm.$parent;\n    // root instance props should be converted\n    if (!isRoot) {\n        toggleObserving(false);\n    }\n    var _loop_1 = function (key) {\n        keys.push(key);\n        var value = validateProp(key, propsOptions, propsData, vm);\n        /* istanbul ignore else */\n        if (process.env.NODE_ENV !== 'production') {\n            var hyphenatedKey = hyphenate(key);\n            if (isReservedAttribute(hyphenatedKey) ||\n                config.isReservedAttr(hyphenatedKey)) {\n                warn(\"\\\"\".concat(hyphenatedKey, \"\\\" is a reserved attribute and cannot be used as component prop.\"), vm);\n            }\n            defineReactive(props, key, value, function () {\n                if (!isRoot && !isUpdatingChildComponent) {\n                    warn(\"Avoid mutating a prop directly since the value will be \" +\n                        \"overwritten whenever the parent component re-renders. \" +\n                        \"Instead, use a data or computed property based on the prop's \" +\n                        \"value. Prop being mutated: \\\"\".concat(key, \"\\\"\"), vm);\n                }\n            }, true /* shallow */);\n        }\n        else {\n            defineReactive(props, key, value, undefined, true /* shallow */);\n        }\n        // static props are already proxied on the component's prototype\n        // during Vue.extend(). We only need to proxy props defined at\n        // instantiation here.\n        if (!(key in vm)) {\n            proxy(vm, \"_props\", key);\n        }\n    };\n    for (var key in propsOptions) {\n        _loop_1(key);\n    }\n    toggleObserving(true);\n}\nfunction initData(vm) {\n    var data = vm.$options.data;\n    data = vm._data = isFunction(data) ? getData(data, vm) : data || {};\n    if (!isPlainObject(data)) {\n        data = {};\n        process.env.NODE_ENV !== 'production' &&\n            warn('data functions should return an object:\\n' +\n                'https://v2.vuejs.org/v2/guide/components.html#data-Must-Be-a-Function', vm);\n    }\n    // proxy data on instance\n    var keys = Object.keys(data);\n    var props = vm.$options.props;\n    var methods = vm.$options.methods;\n    var i = keys.length;\n    while (i--) {\n        var key = keys[i];\n        if (process.env.NODE_ENV !== 'production') {\n            if (methods && hasOwn(methods, key)) {\n                warn(\"Method \\\"\".concat(key, \"\\\" has already been defined as a data property.\"), vm);\n            }\n        }\n        if (props && hasOwn(props, key)) {\n            process.env.NODE_ENV !== 'production' &&\n                warn(\"The data property \\\"\".concat(key, \"\\\" is already declared as a prop. \") +\n                    \"Use prop default value instead.\", vm);\n        }\n        else if (!isReserved(key)) {\n            proxy(vm, \"_data\", key);\n        }\n    }\n    // observe data\n    var ob = observe(data);\n    ob && ob.vmCount++;\n}\nfunction getData(data, vm) {\n    // #7573 disable dep collection when invoking data getters\n    pushTarget();\n    try {\n        return data.call(vm, vm);\n    }\n    catch (e) {\n        handleError(e, vm, \"data()\");\n        return {};\n    }\n    finally {\n        popTarget();\n    }\n}\nvar computedWatcherOptions = { lazy: true };\nfunction initComputed$1(vm, computed) {\n    // $flow-disable-line\n    var watchers = (vm._computedWatchers = Object.create(null));\n    // computed properties are just getters during SSR\n    var isSSR = isServerRendering();\n    for (var key in computed) {\n        var userDef = computed[key];\n        var getter = isFunction(userDef) ? userDef : userDef.get;\n        if (process.env.NODE_ENV !== 'production' && getter == null) {\n            warn(\"Getter is missing for computed property \\\"\".concat(key, \"\\\".\"), vm);\n        }\n        if (!isSSR) {\n            // create internal watcher for the computed property.\n            watchers[key] = new Watcher(vm, getter || noop, noop, computedWatcherOptions);\n        }\n        // component-defined computed properties are already defined on the\n        // component prototype. We only need to define computed properties defined\n        // at instantiation here.\n        if (!(key in vm)) {\n            defineComputed(vm, key, userDef);\n        }\n        else if (process.env.NODE_ENV !== 'production') {\n            if (key in vm.$data) {\n                warn(\"The computed property \\\"\".concat(key, \"\\\" is already defined in data.\"), vm);\n            }\n            else if (vm.$options.props && key in vm.$options.props) {\n                warn(\"The computed property \\\"\".concat(key, \"\\\" is already defined as a prop.\"), vm);\n            }\n            else if (vm.$options.methods && key in vm.$options.methods) {\n                warn(\"The computed property \\\"\".concat(key, \"\\\" is already defined as a method.\"), vm);\n            }\n        }\n    }\n}\nfunction defineComputed(target, key, userDef) {\n    var shouldCache = !isServerRendering();\n    if (isFunction(userDef)) {\n        sharedPropertyDefinition.get = shouldCache\n            ? createComputedGetter(key)\n            : createGetterInvoker(userDef);\n        sharedPropertyDefinition.set = noop;\n    }\n    else {\n        sharedPropertyDefinition.get = userDef.get\n            ? shouldCache && userDef.cache !== false\n                ? createComputedGetter(key)\n                : createGetterInvoker(userDef.get)\n            : noop;\n        sharedPropertyDefinition.set = userDef.set || noop;\n    }\n    if (process.env.NODE_ENV !== 'production' && sharedPropertyDefinition.set === noop) {\n        sharedPropertyDefinition.set = function () {\n            warn(\"Computed property \\\"\".concat(key, \"\\\" was assigned to but it has no setter.\"), this);\n        };\n    }\n    Object.defineProperty(target, key, sharedPropertyDefinition);\n}\nfunction createComputedGetter(key) {\n    return function computedGetter() {\n        var watcher = this._computedWatchers && this._computedWatchers[key];\n        if (watcher) {\n            if (watcher.dirty) {\n                watcher.evaluate();\n            }\n            if (Dep.target) {\n                if (process.env.NODE_ENV !== 'production' && Dep.target.onTrack) {\n                    Dep.target.onTrack({\n                        effect: Dep.target,\n                        target: this,\n                        type: \"get\" /* TrackOpTypes.GET */,\n                        key: key\n                    });\n                }\n                watcher.depend();\n            }\n            return watcher.value;\n        }\n    };\n}\nfunction createGetterInvoker(fn) {\n    return function computedGetter() {\n        return fn.call(this, this);\n    };\n}\nfunction initMethods(vm, methods) {\n    var props = vm.$options.props;\n    for (var key in methods) {\n        if (process.env.NODE_ENV !== 'production') {\n            if (typeof methods[key] !== 'function') {\n                warn(\"Method \\\"\".concat(key, \"\\\" has type \\\"\").concat(typeof methods[key], \"\\\" in the component definition. \") +\n                    \"Did you reference the function correctly?\", vm);\n            }\n            if (props && hasOwn(props, key)) {\n                warn(\"Method \\\"\".concat(key, \"\\\" has already been defined as a prop.\"), vm);\n            }\n            if (key in vm && isReserved(key)) {\n                warn(\"Method \\\"\".concat(key, \"\\\" conflicts with an existing Vue instance method. \") +\n                    \"Avoid defining component methods that start with _ or $.\");\n            }\n        }\n        vm[key] = typeof methods[key] !== 'function' ? noop : bind(methods[key], vm);\n    }\n}\nfunction initWatch(vm, watch) {\n    for (var key in watch) {\n        var handler = watch[key];\n        if (isArray(handler)) {\n            for (var i = 0; i < handler.length; i++) {\n                createWatcher(vm, key, handler[i]);\n            }\n        }\n        else {\n            createWatcher(vm, key, handler);\n        }\n    }\n}\nfunction createWatcher(vm, expOrFn, handler, options) {\n    if (isPlainObject(handler)) {\n        options = handler;\n        handler = handler.handler;\n    }\n    if (typeof handler === 'string') {\n        handler = vm[handler];\n    }\n    return vm.$watch(expOrFn, handler, options);\n}\nfunction stateMixin(Vue) {\n    // flow somehow has problems with directly declared definition object\n    // when using Object.defineProperty, so we have to procedurally build up\n    // the object here.\n    var dataDef = {};\n    dataDef.get = function () {\n        return this._data;\n    };\n    var propsDef = {};\n    propsDef.get = function () {\n        return this._props;\n    };\n    if (process.env.NODE_ENV !== 'production') {\n        dataDef.set = function () {\n            warn('Avoid replacing instance root $data. ' +\n                'Use nested data properties instead.', this);\n        };\n        propsDef.set = function () {\n            warn(\"$props is readonly.\", this);\n        };\n    }\n    Object.defineProperty(Vue.prototype, '$data', dataDef);\n    Object.defineProperty(Vue.prototype, '$props', propsDef);\n    Vue.prototype.$set = set;\n    Vue.prototype.$delete = del;\n    Vue.prototype.$watch = function (expOrFn, cb, options) {\n        var vm = this;\n        if (isPlainObject(cb)) {\n            return createWatcher(vm, expOrFn, cb, options);\n        }\n        options = options || {};\n        options.user = true;\n        var watcher = new Watcher(vm, expOrFn, cb, options);\n        if (options.immediate) {\n            var info = \"callback for immediate watcher \\\"\".concat(watcher.expression, \"\\\"\");\n            pushTarget();\n            invokeWithErrorHandling(cb, vm, [watcher.value], vm, info);\n            popTarget();\n        }\n        return function unwatchFn() {\n            watcher.teardown();\n        };\n    };\n}\n\nvar uid = 0;\nfunction initMixin$1(Vue) {\n    Vue.prototype._init = function (options) {\n        var vm = this;\n        // a uid\n        vm._uid = uid++;\n        var startTag, endTag;\n        /* istanbul ignore if */\n        if (process.env.NODE_ENV !== 'production' && config.performance && mark) {\n            startTag = \"vue-perf-start:\".concat(vm._uid);\n            endTag = \"vue-perf-end:\".concat(vm._uid);\n            mark(startTag);\n        }\n        // a flag to mark this as a Vue instance without having to do instanceof\n        // check\n        vm._isVue = true;\n        // avoid instances from being observed\n        vm.__v_skip = true;\n        // effect scope\n        vm._scope = new EffectScope(true /* detached */);\n        // #13134 edge case where a child component is manually created during the\n        // render of a parent component\n        vm._scope.parent = undefined;\n        vm._scope._vm = true;\n        // merge options\n        if (options && options._isComponent) {\n            // optimize internal component instantiation\n            // since dynamic options merging is pretty slow, and none of the\n            // internal component options needs special treatment.\n            initInternalComponent(vm, options);\n        }\n        else {\n            vm.$options = mergeOptions(resolveConstructorOptions(vm.constructor), options || {}, vm);\n        }\n        /* istanbul ignore else */\n        if (process.env.NODE_ENV !== 'production') {\n            initProxy(vm);\n        }\n        else {\n            vm._renderProxy = vm;\n        }\n        // expose real self\n        vm._self = vm;\n        initLifecycle(vm);\n        initEvents(vm);\n        initRender(vm);\n        callHook$1(vm, 'beforeCreate', undefined, false /* setContext */);\n        initInjections(vm); // resolve injections before data/props\n        initState(vm);\n        initProvide(vm); // resolve provide after data/props\n        callHook$1(vm, 'created');\n        /* istanbul ignore if */\n        if (process.env.NODE_ENV !== 'production' && config.performance && mark) {\n            vm._name = formatComponentName(vm, false);\n            mark(endTag);\n            measure(\"vue \".concat(vm._name, \" init\"), startTag, endTag);\n        }\n        if (vm.$options.el) {\n            vm.$mount(vm.$options.el);\n        }\n    };\n}\nfunction initInternalComponent(vm, options) {\n    var opts = (vm.$options = Object.create(vm.constructor.options));\n    // doing this because it's faster than dynamic enumeration.\n    var parentVnode = options._parentVnode;\n    opts.parent = options.parent;\n    opts._parentVnode = parentVnode;\n    var vnodeComponentOptions = parentVnode.componentOptions;\n    opts.propsData = vnodeComponentOptions.propsData;\n    opts._parentListeners = vnodeComponentOptions.listeners;\n    opts._renderChildren = vnodeComponentOptions.children;\n    opts._componentTag = vnodeComponentOptions.tag;\n    if (options.render) {\n        opts.render = options.render;\n        opts.staticRenderFns = options.staticRenderFns;\n    }\n}\nfunction resolveConstructorOptions(Ctor) {\n    var options = Ctor.options;\n    if (Ctor.super) {\n        var superOptions = resolveConstructorOptions(Ctor.super);\n        var cachedSuperOptions = Ctor.superOptions;\n        if (superOptions !== cachedSuperOptions) {\n            // super option changed,\n            // need to resolve new options.\n            Ctor.superOptions = superOptions;\n            // check if there are any late-modified/attached options (#4976)\n            var modifiedOptions = resolveModifiedOptions(Ctor);\n            // update base extend options\n            if (modifiedOptions) {\n                extend(Ctor.extendOptions, modifiedOptions);\n            }\n            options = Ctor.options = mergeOptions(superOptions, Ctor.extendOptions);\n            if (options.name) {\n                options.components[options.name] = Ctor;\n            }\n        }\n    }\n    return options;\n}\nfunction resolveModifiedOptions(Ctor) {\n    var modified;\n    var latest = Ctor.options;\n    var sealed = Ctor.sealedOptions;\n    for (var key in latest) {\n        if (latest[key] !== sealed[key]) {\n            if (!modified)\n                modified = {};\n            modified[key] = latest[key];\n        }\n    }\n    return modified;\n}\n\nfunction Vue(options) {\n    if (process.env.NODE_ENV !== 'production' && !(this instanceof Vue)) {\n        warn('Vue is a constructor and should be called with the `new` keyword');\n    }\n    this._init(options);\n}\n//@ts-expect-error Vue has function type\ninitMixin$1(Vue);\n//@ts-expect-error Vue has function type\nstateMixin(Vue);\n//@ts-expect-error Vue has function type\neventsMixin(Vue);\n//@ts-expect-error Vue has function type\nlifecycleMixin(Vue);\n//@ts-expect-error Vue has function type\nrenderMixin(Vue);\n\nfunction initUse(Vue) {\n    Vue.use = function (plugin) {\n        var installedPlugins = this._installedPlugins || (this._installedPlugins = []);\n        if (installedPlugins.indexOf(plugin) > -1) {\n            return this;\n        }\n        // additional parameters\n        var args = toArray(arguments, 1);\n        args.unshift(this);\n        if (isFunction(plugin.install)) {\n            plugin.install.apply(plugin, args);\n        }\n        else if (isFunction(plugin)) {\n            plugin.apply(null, args);\n        }\n        installedPlugins.push(plugin);\n        return this;\n    };\n}\n\nfunction initMixin(Vue) {\n    Vue.mixin = function (mixin) {\n        this.options = mergeOptions(this.options, mixin);\n        return this;\n    };\n}\n\nfunction initExtend(Vue) {\n    /**\n     * Each instance constructor, including Vue, has a unique\n     * cid. This enables us to create wrapped \"child\n     * constructors\" for prototypal inheritance and cache them.\n     */\n    Vue.cid = 0;\n    var cid = 1;\n    /**\n     * Class inheritance\n     */\n    Vue.extend = function (extendOptions) {\n        extendOptions = extendOptions || {};\n        var Super = this;\n        var SuperId = Super.cid;\n        var cachedCtors = extendOptions._Ctor || (extendOptions._Ctor = {});\n        if (cachedCtors[SuperId]) {\n            return cachedCtors[SuperId];\n        }\n        var name = getComponentName(extendOptions) || getComponentName(Super.options);\n        if (process.env.NODE_ENV !== 'production' && name) {\n            validateComponentName(name);\n        }\n        var Sub = function VueComponent(options) {\n            this._init(options);\n        };\n        Sub.prototype = Object.create(Super.prototype);\n        Sub.prototype.constructor = Sub;\n        Sub.cid = cid++;\n        Sub.options = mergeOptions(Super.options, extendOptions);\n        Sub['super'] = Super;\n        // For props and computed properties, we define the proxy getters on\n        // the Vue instances at extension time, on the extended prototype. This\n        // avoids Object.defineProperty calls for each instance created.\n        if (Sub.options.props) {\n            initProps(Sub);\n        }\n        if (Sub.options.computed) {\n            initComputed(Sub);\n        }\n        // allow further extension/mixin/plugin usage\n        Sub.extend = Super.extend;\n        Sub.mixin = Super.mixin;\n        Sub.use = Super.use;\n        // create asset registers, so extended classes\n        // can have their private assets too.\n        ASSET_TYPES.forEach(function (type) {\n            Sub[type] = Super[type];\n        });\n        // enable recursive self-lookup\n        if (name) {\n            Sub.options.components[name] = Sub;\n        }\n        // keep a reference to the super options at extension time.\n        // later at instantiation we can check if Super's options have\n        // been updated.\n        Sub.superOptions = Super.options;\n        Sub.extendOptions = extendOptions;\n        Sub.sealedOptions = extend({}, Sub.options);\n        // cache constructor\n        cachedCtors[SuperId] = Sub;\n        return Sub;\n    };\n}\nfunction initProps(Comp) {\n    var props = Comp.options.props;\n    for (var key in props) {\n        proxy(Comp.prototype, \"_props\", key);\n    }\n}\nfunction initComputed(Comp) {\n    var computed = Comp.options.computed;\n    for (var key in computed) {\n        defineComputed(Comp.prototype, key, computed[key]);\n    }\n}\n\nfunction initAssetRegisters(Vue) {\n    /**\n     * Create asset registration methods.\n     */\n    ASSET_TYPES.forEach(function (type) {\n        // @ts-expect-error function is not exact same type\n        Vue[type] = function (id, definition) {\n            if (!definition) {\n                return this.options[type + 's'][id];\n            }\n            else {\n                /* istanbul ignore if */\n                if (process.env.NODE_ENV !== 'production' && type === 'component') {\n                    validateComponentName(id);\n                }\n                if (type === 'component' && isPlainObject(definition)) {\n                    // @ts-expect-error\n                    definition.name = definition.name || id;\n                    definition = this.options._base.extend(definition);\n                }\n                if (type === 'directive' && isFunction(definition)) {\n                    definition = { bind: definition, update: definition };\n                }\n                this.options[type + 's'][id] = definition;\n                return definition;\n            }\n        };\n    });\n}\n\nfunction _getComponentName(opts) {\n    return opts && (getComponentName(opts.Ctor.options) || opts.tag);\n}\nfunction matches(pattern, name) {\n    if (isArray(pattern)) {\n        return pattern.indexOf(name) > -1;\n    }\n    else if (typeof pattern === 'string') {\n        return pattern.split(',').indexOf(name) > -1;\n    }\n    else if (isRegExp(pattern)) {\n        return pattern.test(name);\n    }\n    /* istanbul ignore next */\n    return false;\n}\nfunction pruneCache(keepAliveInstance, filter) {\n    var cache = keepAliveInstance.cache, keys = keepAliveInstance.keys, _vnode = keepAliveInstance._vnode, $vnode = keepAliveInstance.$vnode;\n    for (var key in cache) {\n        var entry = cache[key];\n        if (entry) {\n            var name_1 = entry.name;\n            if (name_1 && !filter(name_1)) {\n                pruneCacheEntry(cache, key, keys, _vnode);\n            }\n        }\n    }\n    $vnode.componentOptions.children = undefined;\n}\nfunction pruneCacheEntry(cache, key, keys, current) {\n    var entry = cache[key];\n    if (entry && (!current || entry.tag !== current.tag)) {\n        // @ts-expect-error can be undefined\n        entry.componentInstance.$destroy();\n    }\n    cache[key] = null;\n    remove$2(keys, key);\n}\nvar patternTypes = [String, RegExp, Array];\n// TODO defineComponent\nvar KeepAlive = {\n    name: 'keep-alive',\n    abstract: true,\n    props: {\n        include: patternTypes,\n        exclude: patternTypes,\n        max: [String, Number]\n    },\n    methods: {\n        cacheVNode: function () {\n            var _a = this, cache = _a.cache, keys = _a.keys, vnodeToCache = _a.vnodeToCache, keyToCache = _a.keyToCache;\n            if (vnodeToCache) {\n                var tag = vnodeToCache.tag, componentInstance = vnodeToCache.componentInstance, componentOptions = vnodeToCache.componentOptions;\n                cache[keyToCache] = {\n                    name: _getComponentName(componentOptions),\n                    tag: tag,\n                    componentInstance: componentInstance\n                };\n                keys.push(keyToCache);\n                // prune oldest entry\n                if (this.max && keys.length > parseInt(this.max)) {\n                    pruneCacheEntry(cache, keys[0], keys, this._vnode);\n                }\n                this.vnodeToCache = null;\n            }\n        }\n    },\n    created: function () {\n        this.cache = Object.create(null);\n        this.keys = [];\n    },\n    destroyed: function () {\n        for (var key in this.cache) {\n            pruneCacheEntry(this.cache, key, this.keys);\n        }\n    },\n    mounted: function () {\n        var _this = this;\n        this.cacheVNode();\n        this.$watch('include', function (val) {\n            pruneCache(_this, function (name) { return matches(val, name); });\n        });\n        this.$watch('exclude', function (val) {\n            pruneCache(_this, function (name) { return !matches(val, name); });\n        });\n    },\n    updated: function () {\n        this.cacheVNode();\n    },\n    render: function () {\n        var slot = this.$slots.default;\n        var vnode = getFirstComponentChild(slot);\n        var componentOptions = vnode && vnode.componentOptions;\n        if (componentOptions) {\n            // check pattern\n            var name_2 = _getComponentName(componentOptions);\n            var _a = this, include = _a.include, exclude = _a.exclude;\n            if (\n            // not included\n            (include && (!name_2 || !matches(include, name_2))) ||\n                // excluded\n                (exclude && name_2 && matches(exclude, name_2))) {\n                return vnode;\n            }\n            var _b = this, cache = _b.cache, keys = _b.keys;\n            var key = vnode.key == null\n                ? // same constructor may get registered as different local components\n                    // so cid alone is not enough (#3269)\n                    componentOptions.Ctor.cid +\n                        (componentOptions.tag ? \"::\".concat(componentOptions.tag) : '')\n                : vnode.key;\n            if (cache[key]) {\n                vnode.componentInstance = cache[key].componentInstance;\n                // make current key freshest\n                remove$2(keys, key);\n                keys.push(key);\n            }\n            else {\n                // delay setting the cache until update\n                this.vnodeToCache = vnode;\n                this.keyToCache = key;\n            }\n            // @ts-expect-error can vnode.data can be undefined\n            vnode.data.keepAlive = true;\n        }\n        return vnode || (slot && slot[0]);\n    }\n};\n\nvar builtInComponents = {\n    KeepAlive: KeepAlive\n};\n\nfunction initGlobalAPI(Vue) {\n    // config\n    var configDef = {};\n    configDef.get = function () { return config; };\n    if (process.env.NODE_ENV !== 'production') {\n        configDef.set = function () {\n            warn('Do not replace the Vue.config object, set individual fields instead.');\n        };\n    }\n    Object.defineProperty(Vue, 'config', configDef);\n    // exposed util methods.\n    // NOTE: these are not considered part of the public API - avoid relying on\n    // them unless you are aware of the risk.\n    Vue.util = {\n        warn: warn,\n        extend: extend,\n        mergeOptions: mergeOptions,\n        defineReactive: defineReactive\n    };\n    Vue.set = set;\n    Vue.delete = del;\n    Vue.nextTick = nextTick;\n    // 2.6 explicit observable API\n    Vue.observable = function (obj) {\n        observe(obj);\n        return obj;\n    };\n    Vue.options = Object.create(null);\n    ASSET_TYPES.forEach(function (type) {\n        Vue.options[type + 's'] = Object.create(null);\n    });\n    // this is used to identify the \"base\" constructor to extend all plain-object\n    // components with in Weex's multi-instance scenarios.\n    Vue.options._base = Vue;\n    extend(Vue.options.components, builtInComponents);\n    initUse(Vue);\n    initMixin(Vue);\n    initExtend(Vue);\n    initAssetRegisters(Vue);\n}\n\ninitGlobalAPI(Vue);\nObject.defineProperty(Vue.prototype, '$isServer', {\n    get: isServerRendering\n});\nObject.defineProperty(Vue.prototype, '$ssrContext', {\n    get: function () {\n        /* istanbul ignore next */\n        return this.$vnode && this.$vnode.ssrContext;\n    }\n});\n// expose FunctionalRenderContext for ssr runtime helper installation\nObject.defineProperty(Vue, 'FunctionalRenderContext', {\n    value: FunctionalRenderContext\n});\nVue.version = version;\n\n// these are reserved for web because they are directly compiled away\n// during template compilation\nvar isReservedAttr = makeMap('style,class');\n// attributes that should be using props for binding\nvar acceptValue = makeMap('input,textarea,option,select,progress');\nvar mustUseProp = function (tag, type, attr) {\n    return ((attr === 'value' && acceptValue(tag) && type !== 'button') ||\n        (attr === 'selected' && tag === 'option') ||\n        (attr === 'checked' && tag === 'input') ||\n        (attr === 'muted' && tag === 'video'));\n};\nvar isEnumeratedAttr = makeMap('contenteditable,draggable,spellcheck');\nvar isValidContentEditableValue = makeMap('events,caret,typing,plaintext-only');\nvar convertEnumeratedValue = function (key, value) {\n    return isFalsyAttrValue(value) || value === 'false'\n        ? 'false'\n        : // allow arbitrary string value for contenteditable\n            key === 'contenteditable' && isValidContentEditableValue(value)\n                ? value\n                : 'true';\n};\nvar isBooleanAttr = makeMap('allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,' +\n    'default,defaultchecked,defaultmuted,defaultselected,defer,disabled,' +\n    'enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,' +\n    'muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,' +\n    'required,reversed,scoped,seamless,selected,sortable,' +\n    'truespeed,typemustmatch,visible');\nvar xlinkNS = 'http://www.w3.org/1999/xlink';\nvar isXlink = function (name) {\n    return name.charAt(5) === ':' && name.slice(0, 5) === 'xlink';\n};\nvar getXlinkProp = function (name) {\n    return isXlink(name) ? name.slice(6, name.length) : '';\n};\nvar isFalsyAttrValue = function (val) {\n    return val == null || val === false;\n};\n\nfunction genClassForVnode(vnode) {\n    var data = vnode.data;\n    var parentNode = vnode;\n    var childNode = vnode;\n    while (isDef(childNode.componentInstance)) {\n        childNode = childNode.componentInstance._vnode;\n        if (childNode && childNode.data) {\n            data = mergeClassData(childNode.data, data);\n        }\n    }\n    // @ts-expect-error parentNode.parent not VNodeWithData\n    while (isDef((parentNode = parentNode.parent))) {\n        if (parentNode && parentNode.data) {\n            data = mergeClassData(data, parentNode.data);\n        }\n    }\n    return renderClass(data.staticClass, data.class);\n}\nfunction mergeClassData(child, parent) {\n    return {\n        staticClass: concat(child.staticClass, parent.staticClass),\n        class: isDef(child.class) ? [child.class, parent.class] : parent.class\n    };\n}\nfunction renderClass(staticClass, dynamicClass) {\n    if (isDef(staticClass) || isDef(dynamicClass)) {\n        return concat(staticClass, stringifyClass(dynamicClass));\n    }\n    /* istanbul ignore next */\n    return '';\n}\nfunction concat(a, b) {\n    return a ? (b ? a + ' ' + b : a) : b || '';\n}\nfunction stringifyClass(value) {\n    if (Array.isArray(value)) {\n        return stringifyArray(value);\n    }\n    if (isObject(value)) {\n        return stringifyObject(value);\n    }\n    if (typeof value === 'string') {\n        return value;\n    }\n    /* istanbul ignore next */\n    return '';\n}\nfunction stringifyArray(value) {\n    var res = '';\n    var stringified;\n    for (var i = 0, l = value.length; i < l; i++) {\n        if (isDef((stringified = stringifyClass(value[i]))) && stringified !== '') {\n            if (res)\n                res += ' ';\n            res += stringified;\n        }\n    }\n    return res;\n}\nfunction stringifyObject(value) {\n    var res = '';\n    for (var key in value) {\n        if (value[key]) {\n            if (res)\n                res += ' ';\n            res += key;\n        }\n    }\n    return res;\n}\n\nvar namespaceMap = {\n    svg: 'http://www.w3.org/2000/svg',\n    math: 'http://www.w3.org/1998/Math/MathML'\n};\nvar isHTMLTag = makeMap('html,body,base,head,link,meta,style,title,' +\n    'address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,' +\n    'div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,' +\n    'a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,' +\n    's,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,' +\n    'embed,object,param,source,canvas,script,noscript,del,ins,' +\n    'caption,col,colgroup,table,thead,tbody,td,th,tr,' +\n    'button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,' +\n    'output,progress,select,textarea,' +\n    'details,dialog,menu,menuitem,summary,' +\n    'content,element,shadow,template,blockquote,iframe,tfoot');\n// this map is intentionally selective, only covering SVG elements that may\n// contain child elements.\nvar isSVG = makeMap('svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,' +\n    'foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,' +\n    'polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view', true);\nvar isReservedTag = function (tag) {\n    return isHTMLTag(tag) || isSVG(tag);\n};\nfunction getTagNamespace(tag) {\n    if (isSVG(tag)) {\n        return 'svg';\n    }\n    // basic support for MathML\n    // note it doesn't support other MathML elements being component roots\n    if (tag === 'math') {\n        return 'math';\n    }\n}\nvar unknownElementCache = Object.create(null);\nfunction isUnknownElement(tag) {\n    /* istanbul ignore if */\n    if (!inBrowser) {\n        return true;\n    }\n    if (isReservedTag(tag)) {\n        return false;\n    }\n    tag = tag.toLowerCase();\n    /* istanbul ignore if */\n    if (unknownElementCache[tag] != null) {\n        return unknownElementCache[tag];\n    }\n    var el = document.createElement(tag);\n    if (tag.indexOf('-') > -1) {\n        // https://stackoverflow.com/a/28210364/1070244\n        return (unknownElementCache[tag] =\n            el.constructor === window.HTMLUnknownElement ||\n                el.constructor === window.HTMLElement);\n    }\n    else {\n        return (unknownElementCache[tag] = /HTMLUnknownElement/.test(el.toString()));\n    }\n}\nvar isTextInputType = makeMap('text,number,password,search,email,tel,url');\n\n/**\n * Query an element selector if it's not an element already.\n */\nfunction query(el) {\n    if (typeof el === 'string') {\n        var selected = document.querySelector(el);\n        if (!selected) {\n            process.env.NODE_ENV !== 'production' && warn('Cannot find element: ' + el);\n            return document.createElement('div');\n        }\n        return selected;\n    }\n    else {\n        return el;\n    }\n}\n\nfunction createElement(tagName, vnode) {\n    var elm = document.createElement(tagName);\n    if (tagName !== 'select') {\n        return elm;\n    }\n    // false or null will remove the attribute but undefined will not\n    if (vnode.data &&\n        vnode.data.attrs &&\n        vnode.data.attrs.multiple !== undefined) {\n        elm.setAttribute('multiple', 'multiple');\n    }\n    return elm;\n}\nfunction createElementNS(namespace, tagName) {\n    return document.createElementNS(namespaceMap[namespace], tagName);\n}\nfunction createTextNode(text) {\n    return document.createTextNode(text);\n}\nfunction createComment(text) {\n    return document.createComment(text);\n}\nfunction insertBefore(parentNode, newNode, referenceNode) {\n    parentNode.insertBefore(newNode, referenceNode);\n}\nfunction removeChild(node, child) {\n    node.removeChild(child);\n}\nfunction appendChild(node, child) {\n    node.appendChild(child);\n}\nfunction parentNode(node) {\n    return node.parentNode;\n}\nfunction nextSibling(node) {\n    return node.nextSibling;\n}\nfunction tagName(node) {\n    return node.tagName;\n}\nfunction setTextContent(node, text) {\n    node.textContent = text;\n}\nfunction setStyleScope(node, scopeId) {\n    node.setAttribute(scopeId, '');\n}\n\nvar nodeOps = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  createElement: createElement,\n  createElementNS: createElementNS,\n  createTextNode: createTextNode,\n  createComment: createComment,\n  insertBefore: insertBefore,\n  removeChild: removeChild,\n  appendChild: appendChild,\n  parentNode: parentNode,\n  nextSibling: nextSibling,\n  tagName: tagName,\n  setTextContent: setTextContent,\n  setStyleScope: setStyleScope\n});\n\nvar ref = {\n    create: function (_, vnode) {\n        registerRef(vnode);\n    },\n    update: function (oldVnode, vnode) {\n        if (oldVnode.data.ref !== vnode.data.ref) {\n            registerRef(oldVnode, true);\n            registerRef(vnode);\n        }\n    },\n    destroy: function (vnode) {\n        registerRef(vnode, true);\n    }\n};\nfunction registerRef(vnode, isRemoval) {\n    var ref = vnode.data.ref;\n    if (!isDef(ref))\n        return;\n    var vm = vnode.context;\n    var refValue = vnode.componentInstance || vnode.elm;\n    var value = isRemoval ? null : refValue;\n    var $refsValue = isRemoval ? undefined : refValue;\n    if (isFunction(ref)) {\n        invokeWithErrorHandling(ref, vm, [value], vm, \"template ref function\");\n        return;\n    }\n    var isFor = vnode.data.refInFor;\n    var _isString = typeof ref === 'string' || typeof ref === 'number';\n    var _isRef = isRef(ref);\n    var refs = vm.$refs;\n    if (_isString || _isRef) {\n        if (isFor) {\n            var existing = _isString ? refs[ref] : ref.value;\n            if (isRemoval) {\n                isArray(existing) && remove$2(existing, refValue);\n            }\n            else {\n                if (!isArray(existing)) {\n                    if (_isString) {\n                        refs[ref] = [refValue];\n                        setSetupRef(vm, ref, refs[ref]);\n                    }\n                    else {\n                        ref.value = [refValue];\n                    }\n                }\n                else if (!existing.includes(refValue)) {\n                    existing.push(refValue);\n                }\n            }\n        }\n        else if (_isString) {\n            if (isRemoval && refs[ref] !== refValue) {\n                return;\n            }\n            refs[ref] = $refsValue;\n            setSetupRef(vm, ref, value);\n        }\n        else if (_isRef) {\n            if (isRemoval && ref.value !== refValue) {\n                return;\n            }\n            ref.value = value;\n        }\n        else if (process.env.NODE_ENV !== 'production') {\n            warn(\"Invalid template ref type: \".concat(typeof ref));\n        }\n    }\n}\nfunction setSetupRef(_a, key, val) {\n    var _setupState = _a._setupState;\n    if (_setupState && hasOwn(_setupState, key)) {\n        if (isRef(_setupState[key])) {\n            _setupState[key].value = val;\n        }\n        else {\n            _setupState[key] = val;\n        }\n    }\n}\n\n/**\n * Virtual DOM patching algorithm based on Snabbdom by\n * Simon Friis Vindum (@paldepind)\n * Licensed under the MIT License\n * https://github.com/paldepind/snabbdom/blob/master/LICENSE\n *\n * modified by Evan You (@yyx990803)\n *\n * Not type-checking this because this file is perf-critical and the cost\n * of making flow understand it is not worth it.\n */\nvar emptyNode = new VNode('', {}, []);\nvar hooks = ['create', 'activate', 'update', 'remove', 'destroy'];\nfunction sameVnode(a, b) {\n    return (a.key === b.key &&\n        a.asyncFactory === b.asyncFactory &&\n        ((a.tag === b.tag &&\n            a.isComment === b.isComment &&\n            isDef(a.data) === isDef(b.data) &&\n            sameInputType(a, b)) ||\n            (isTrue(a.isAsyncPlaceholder) && isUndef(b.asyncFactory.error))));\n}\nfunction sameInputType(a, b) {\n    if (a.tag !== 'input')\n        return true;\n    var i;\n    var typeA = isDef((i = a.data)) && isDef((i = i.attrs)) && i.type;\n    var typeB = isDef((i = b.data)) && isDef((i = i.attrs)) && i.type;\n    return typeA === typeB || (isTextInputType(typeA) && isTextInputType(typeB));\n}\nfunction createKeyToOldIdx(children, beginIdx, endIdx) {\n    var i, key;\n    var map = {};\n    for (i = beginIdx; i <= endIdx; ++i) {\n        key = children[i].key;\n        if (isDef(key))\n            map[key] = i;\n    }\n    return map;\n}\nfunction createPatchFunction(backend) {\n    var i, j;\n    var cbs = {};\n    var modules = backend.modules, nodeOps = backend.nodeOps;\n    for (i = 0; i < hooks.length; ++i) {\n        cbs[hooks[i]] = [];\n        for (j = 0; j < modules.length; ++j) {\n            if (isDef(modules[j][hooks[i]])) {\n                cbs[hooks[i]].push(modules[j][hooks[i]]);\n            }\n        }\n    }\n    function emptyNodeAt(elm) {\n        return new VNode(nodeOps.tagName(elm).toLowerCase(), {}, [], undefined, elm);\n    }\n    function createRmCb(childElm, listeners) {\n        function remove() {\n            if (--remove.listeners === 0) {\n                removeNode(childElm);\n            }\n        }\n        remove.listeners = listeners;\n        return remove;\n    }\n    function removeNode(el) {\n        var parent = nodeOps.parentNode(el);\n        // element may have already been removed due to v-html / v-text\n        if (isDef(parent)) {\n            nodeOps.removeChild(parent, el);\n        }\n    }\n    function isUnknownElement(vnode, inVPre) {\n        return (!inVPre &&\n            !vnode.ns &&\n            !(config.ignoredElements.length &&\n                config.ignoredElements.some(function (ignore) {\n                    return isRegExp(ignore)\n                        ? ignore.test(vnode.tag)\n                        : ignore === vnode.tag;\n                })) &&\n            config.isUnknownElement(vnode.tag));\n    }\n    var creatingElmInVPre = 0;\n    function createElm(vnode, insertedVnodeQueue, parentElm, refElm, nested, ownerArray, index) {\n        if (isDef(vnode.elm) && isDef(ownerArray)) {\n            // This vnode was used in a previous render!\n            // now it's used as a new node, overwriting its elm would cause\n            // potential patch errors down the road when it's used as an insertion\n            // reference node. Instead, we clone the node on-demand before creating\n            // associated DOM element for it.\n            vnode = ownerArray[index] = cloneVNode(vnode);\n        }\n        vnode.isRootInsert = !nested; // for transition enter check\n        if (createComponent(vnode, insertedVnodeQueue, parentElm, refElm)) {\n            return;\n        }\n        var data = vnode.data;\n        var children = vnode.children;\n        var tag = vnode.tag;\n        if (isDef(tag)) {\n            if (process.env.NODE_ENV !== 'production') {\n                if (data && data.pre) {\n                    creatingElmInVPre++;\n                }\n                if (isUnknownElement(vnode, creatingElmInVPre)) {\n                    warn('Unknown custom element: <' +\n                        tag +\n                        '> - did you ' +\n                        'register the component correctly? For recursive components, ' +\n                        'make sure to provide the \"name\" option.', vnode.context);\n                }\n            }\n            vnode.elm = vnode.ns\n                ? nodeOps.createElementNS(vnode.ns, tag)\n                : nodeOps.createElement(tag, vnode);\n            setScope(vnode);\n            createChildren(vnode, children, insertedVnodeQueue);\n            if (isDef(data)) {\n                invokeCreateHooks(vnode, insertedVnodeQueue);\n            }\n            insert(parentElm, vnode.elm, refElm);\n            if (process.env.NODE_ENV !== 'production' && data && data.pre) {\n                creatingElmInVPre--;\n            }\n        }\n        else if (isTrue(vnode.isComment)) {\n            vnode.elm = nodeOps.createComment(vnode.text);\n            insert(parentElm, vnode.elm, refElm);\n        }\n        else {\n            vnode.elm = nodeOps.createTextNode(vnode.text);\n            insert(parentElm, vnode.elm, refElm);\n        }\n    }\n    function createComponent(vnode, insertedVnodeQueue, parentElm, refElm) {\n        var i = vnode.data;\n        if (isDef(i)) {\n            var isReactivated = isDef(vnode.componentInstance) && i.keepAlive;\n            if (isDef((i = i.hook)) && isDef((i = i.init))) {\n                i(vnode, false /* hydrating */);\n            }\n            // after calling the init hook, if the vnode is a child component\n            // it should've created a child instance and mounted it. the child\n            // component also has set the placeholder vnode's elm.\n            // in that case we can just return the element and be done.\n            if (isDef(vnode.componentInstance)) {\n                initComponent(vnode, insertedVnodeQueue);\n                insert(parentElm, vnode.elm, refElm);\n                if (isTrue(isReactivated)) {\n                    reactivateComponent(vnode, insertedVnodeQueue, parentElm, refElm);\n                }\n                return true;\n            }\n        }\n    }\n    function initComponent(vnode, insertedVnodeQueue) {\n        if (isDef(vnode.data.pendingInsert)) {\n            insertedVnodeQueue.push.apply(insertedVnodeQueue, vnode.data.pendingInsert);\n            vnode.data.pendingInsert = null;\n        }\n        vnode.elm = vnode.componentInstance.$el;\n        if (isPatchable(vnode)) {\n            invokeCreateHooks(vnode, insertedVnodeQueue);\n            setScope(vnode);\n        }\n        else {\n            // empty component root.\n            // skip all element-related modules except for ref (#3455)\n            registerRef(vnode);\n            // make sure to invoke the insert hook\n            insertedVnodeQueue.push(vnode);\n        }\n    }\n    function reactivateComponent(vnode, insertedVnodeQueue, parentElm, refElm) {\n        var i;\n        // hack for #4339: a reactivated component with inner transition\n        // does not trigger because the inner node's created hooks are not called\n        // again. It's not ideal to involve module-specific logic in here but\n        // there doesn't seem to be a better way to do it.\n        var innerNode = vnode;\n        while (innerNode.componentInstance) {\n            innerNode = innerNode.componentInstance._vnode;\n            if (isDef((i = innerNode.data)) && isDef((i = i.transition))) {\n                for (i = 0; i < cbs.activate.length; ++i) {\n                    cbs.activate[i](emptyNode, innerNode);\n                }\n                insertedVnodeQueue.push(innerNode);\n                break;\n            }\n        }\n        // unlike a newly created component,\n        // a reactivated keep-alive component doesn't insert itself\n        insert(parentElm, vnode.elm, refElm);\n    }\n    function insert(parent, elm, ref) {\n        if (isDef(parent)) {\n            if (isDef(ref)) {\n                if (nodeOps.parentNode(ref) === parent) {\n                    nodeOps.insertBefore(parent, elm, ref);\n                }\n            }\n            else {\n                nodeOps.appendChild(parent, elm);\n            }\n        }\n    }\n    function createChildren(vnode, children, insertedVnodeQueue) {\n        if (isArray(children)) {\n            if (process.env.NODE_ENV !== 'production') {\n                checkDuplicateKeys(children);\n            }\n            for (var i_1 = 0; i_1 < children.length; ++i_1) {\n                createElm(children[i_1], insertedVnodeQueue, vnode.elm, null, true, children, i_1);\n            }\n        }\n        else if (isPrimitive(vnode.text)) {\n            nodeOps.appendChild(vnode.elm, nodeOps.createTextNode(String(vnode.text)));\n        }\n    }\n    function isPatchable(vnode) {\n        while (vnode.componentInstance) {\n            vnode = vnode.componentInstance._vnode;\n        }\n        return isDef(vnode.tag);\n    }\n    function invokeCreateHooks(vnode, insertedVnodeQueue) {\n        for (var i_2 = 0; i_2 < cbs.create.length; ++i_2) {\n            cbs.create[i_2](emptyNode, vnode);\n        }\n        i = vnode.data.hook; // Reuse variable\n        if (isDef(i)) {\n            if (isDef(i.create))\n                i.create(emptyNode, vnode);\n            if (isDef(i.insert))\n                insertedVnodeQueue.push(vnode);\n        }\n    }\n    // set scope id attribute for scoped CSS.\n    // this is implemented as a special case to avoid the overhead\n    // of going through the normal attribute patching process.\n    function setScope(vnode) {\n        var i;\n        if (isDef((i = vnode.fnScopeId))) {\n            nodeOps.setStyleScope(vnode.elm, i);\n        }\n        else {\n            var ancestor = vnode;\n            while (ancestor) {\n                if (isDef((i = ancestor.context)) && isDef((i = i.$options._scopeId))) {\n                    nodeOps.setStyleScope(vnode.elm, i);\n                }\n                ancestor = ancestor.parent;\n            }\n        }\n        // for slot content they should also get the scopeId from the host instance.\n        if (isDef((i = activeInstance)) &&\n            i !== vnode.context &&\n            i !== vnode.fnContext &&\n            isDef((i = i.$options._scopeId))) {\n            nodeOps.setStyleScope(vnode.elm, i);\n        }\n    }\n    function addVnodes(parentElm, refElm, vnodes, startIdx, endIdx, insertedVnodeQueue) {\n        for (; startIdx <= endIdx; ++startIdx) {\n            createElm(vnodes[startIdx], insertedVnodeQueue, parentElm, refElm, false, vnodes, startIdx);\n        }\n    }\n    function invokeDestroyHook(vnode) {\n        var i, j;\n        var data = vnode.data;\n        if (isDef(data)) {\n            if (isDef((i = data.hook)) && isDef((i = i.destroy)))\n                i(vnode);\n            for (i = 0; i < cbs.destroy.length; ++i)\n                cbs.destroy[i](vnode);\n        }\n        if (isDef((i = vnode.children))) {\n            for (j = 0; j < vnode.children.length; ++j) {\n                invokeDestroyHook(vnode.children[j]);\n            }\n        }\n    }\n    function removeVnodes(vnodes, startIdx, endIdx) {\n        for (; startIdx <= endIdx; ++startIdx) {\n            var ch = vnodes[startIdx];\n            if (isDef(ch)) {\n                if (isDef(ch.tag)) {\n                    removeAndInvokeRemoveHook(ch);\n                    invokeDestroyHook(ch);\n                }\n                else {\n                    // Text node\n                    removeNode(ch.elm);\n                }\n            }\n        }\n    }\n    function removeAndInvokeRemoveHook(vnode, rm) {\n        if (isDef(rm) || isDef(vnode.data)) {\n            var i_3;\n            var listeners = cbs.remove.length + 1;\n            if (isDef(rm)) {\n                // we have a recursively passed down rm callback\n                // increase the listeners count\n                rm.listeners += listeners;\n            }\n            else {\n                // directly removing\n                rm = createRmCb(vnode.elm, listeners);\n            }\n            // recursively invoke hooks on child component root node\n            if (isDef((i_3 = vnode.componentInstance)) &&\n                isDef((i_3 = i_3._vnode)) &&\n                isDef(i_3.data)) {\n                removeAndInvokeRemoveHook(i_3, rm);\n            }\n            for (i_3 = 0; i_3 < cbs.remove.length; ++i_3) {\n                cbs.remove[i_3](vnode, rm);\n            }\n            if (isDef((i_3 = vnode.data.hook)) && isDef((i_3 = i_3.remove))) {\n                i_3(vnode, rm);\n            }\n            else {\n                rm();\n            }\n        }\n        else {\n            removeNode(vnode.elm);\n        }\n    }\n    function updateChildren(parentElm, oldCh, newCh, insertedVnodeQueue, removeOnly) {\n        var oldStartIdx = 0;\n        var newStartIdx = 0;\n        var oldEndIdx = oldCh.length - 1;\n        var oldStartVnode = oldCh[0];\n        var oldEndVnode = oldCh[oldEndIdx];\n        var newEndIdx = newCh.length - 1;\n        var newStartVnode = newCh[0];\n        var newEndVnode = newCh[newEndIdx];\n        var oldKeyToIdx, idxInOld, vnodeToMove, refElm;\n        // removeOnly is a special flag used only by <transition-group>\n        // to ensure removed elements stay in correct relative positions\n        // during leaving transitions\n        var canMove = !removeOnly;\n        if (process.env.NODE_ENV !== 'production') {\n            checkDuplicateKeys(newCh);\n        }\n        while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {\n            if (isUndef(oldStartVnode)) {\n                oldStartVnode = oldCh[++oldStartIdx]; // Vnode has been moved left\n            }\n            else if (isUndef(oldEndVnode)) {\n                oldEndVnode = oldCh[--oldEndIdx];\n            }\n            else if (sameVnode(oldStartVnode, newStartVnode)) {\n                patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue, newCh, newStartIdx);\n                oldStartVnode = oldCh[++oldStartIdx];\n                newStartVnode = newCh[++newStartIdx];\n            }\n            else if (sameVnode(oldEndVnode, newEndVnode)) {\n                patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue, newCh, newEndIdx);\n                oldEndVnode = oldCh[--oldEndIdx];\n                newEndVnode = newCh[--newEndIdx];\n            }\n            else if (sameVnode(oldStartVnode, newEndVnode)) {\n                // Vnode moved right\n                patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue, newCh, newEndIdx);\n                canMove &&\n                    nodeOps.insertBefore(parentElm, oldStartVnode.elm, nodeOps.nextSibling(oldEndVnode.elm));\n                oldStartVnode = oldCh[++oldStartIdx];\n                newEndVnode = newCh[--newEndIdx];\n            }\n            else if (sameVnode(oldEndVnode, newStartVnode)) {\n                // Vnode moved left\n                patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue, newCh, newStartIdx);\n                canMove &&\n                    nodeOps.insertBefore(parentElm, oldEndVnode.elm, oldStartVnode.elm);\n                oldEndVnode = oldCh[--oldEndIdx];\n                newStartVnode = newCh[++newStartIdx];\n            }\n            else {\n                if (isUndef(oldKeyToIdx))\n                    oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx);\n                idxInOld = isDef(newStartVnode.key)\n                    ? oldKeyToIdx[newStartVnode.key]\n                    : findIdxInOld(newStartVnode, oldCh, oldStartIdx, oldEndIdx);\n                if (isUndef(idxInOld)) {\n                    // New element\n                    createElm(newStartVnode, insertedVnodeQueue, parentElm, oldStartVnode.elm, false, newCh, newStartIdx);\n                }\n                else {\n                    vnodeToMove = oldCh[idxInOld];\n                    if (sameVnode(vnodeToMove, newStartVnode)) {\n                        patchVnode(vnodeToMove, newStartVnode, insertedVnodeQueue, newCh, newStartIdx);\n                        oldCh[idxInOld] = undefined;\n                        canMove &&\n                            nodeOps.insertBefore(parentElm, vnodeToMove.elm, oldStartVnode.elm);\n                    }\n                    else {\n                        // same key but different element. treat as new element\n                        createElm(newStartVnode, insertedVnodeQueue, parentElm, oldStartVnode.elm, false, newCh, newStartIdx);\n                    }\n                }\n                newStartVnode = newCh[++newStartIdx];\n            }\n        }\n        if (oldStartIdx > oldEndIdx) {\n            refElm = isUndef(newCh[newEndIdx + 1]) ? null : newCh[newEndIdx + 1].elm;\n            addVnodes(parentElm, refElm, newCh, newStartIdx, newEndIdx, insertedVnodeQueue);\n        }\n        else if (newStartIdx > newEndIdx) {\n            removeVnodes(oldCh, oldStartIdx, oldEndIdx);\n        }\n    }\n    function checkDuplicateKeys(children) {\n        var seenKeys = {};\n        for (var i_4 = 0; i_4 < children.length; i_4++) {\n            var vnode = children[i_4];\n            var key = vnode.key;\n            if (isDef(key)) {\n                if (seenKeys[key]) {\n                    warn(\"Duplicate keys detected: '\".concat(key, \"'. This may cause an update error.\"), vnode.context);\n                }\n                else {\n                    seenKeys[key] = true;\n                }\n            }\n        }\n    }\n    function findIdxInOld(node, oldCh, start, end) {\n        for (var i_5 = start; i_5 < end; i_5++) {\n            var c = oldCh[i_5];\n            if (isDef(c) && sameVnode(node, c))\n                return i_5;\n        }\n    }\n    function patchVnode(oldVnode, vnode, insertedVnodeQueue, ownerArray, index, removeOnly) {\n        if (oldVnode === vnode) {\n            return;\n        }\n        if (isDef(vnode.elm) && isDef(ownerArray)) {\n            // clone reused vnode\n            vnode = ownerArray[index] = cloneVNode(vnode);\n        }\n        var elm = (vnode.elm = oldVnode.elm);\n        if (isTrue(oldVnode.isAsyncPlaceholder)) {\n            if (isDef(vnode.asyncFactory.resolved)) {\n                hydrate(oldVnode.elm, vnode, insertedVnodeQueue);\n            }\n            else {\n                vnode.isAsyncPlaceholder = true;\n            }\n            return;\n        }\n        // reuse element for static trees.\n        // note we only do this if the vnode is cloned -\n        // if the new node is not cloned it means the render functions have been\n        // reset by the hot-reload-api and we need to do a proper re-render.\n        if (isTrue(vnode.isStatic) &&\n            isTrue(oldVnode.isStatic) &&\n            vnode.key === oldVnode.key &&\n            (isTrue(vnode.isCloned) || isTrue(vnode.isOnce))) {\n            vnode.componentInstance = oldVnode.componentInstance;\n            return;\n        }\n        var i;\n        var data = vnode.data;\n        if (isDef(data) && isDef((i = data.hook)) && isDef((i = i.prepatch))) {\n            i(oldVnode, vnode);\n        }\n        var oldCh = oldVnode.children;\n        var ch = vnode.children;\n        if (isDef(data) && isPatchable(vnode)) {\n            for (i = 0; i < cbs.update.length; ++i)\n                cbs.update[i](oldVnode, vnode);\n            if (isDef((i = data.hook)) && isDef((i = i.update)))\n                i(oldVnode, vnode);\n        }\n        if (isUndef(vnode.text)) {\n            if (isDef(oldCh) && isDef(ch)) {\n                if (oldCh !== ch)\n                    updateChildren(elm, oldCh, ch, insertedVnodeQueue, removeOnly);\n            }\n            else if (isDef(ch)) {\n                if (process.env.NODE_ENV !== 'production') {\n                    checkDuplicateKeys(ch);\n                }\n                if (isDef(oldVnode.text))\n                    nodeOps.setTextContent(elm, '');\n                addVnodes(elm, null, ch, 0, ch.length - 1, insertedVnodeQueue);\n            }\n            else if (isDef(oldCh)) {\n                removeVnodes(oldCh, 0, oldCh.length - 1);\n            }\n            else if (isDef(oldVnode.text)) {\n                nodeOps.setTextContent(elm, '');\n            }\n        }\n        else if (oldVnode.text !== vnode.text) {\n            nodeOps.setTextContent(elm, vnode.text);\n        }\n        if (isDef(data)) {\n            if (isDef((i = data.hook)) && isDef((i = i.postpatch)))\n                i(oldVnode, vnode);\n        }\n    }\n    function invokeInsertHook(vnode, queue, initial) {\n        // delay insert hooks for component root nodes, invoke them after the\n        // element is really inserted\n        if (isTrue(initial) && isDef(vnode.parent)) {\n            vnode.parent.data.pendingInsert = queue;\n        }\n        else {\n            for (var i_6 = 0; i_6 < queue.length; ++i_6) {\n                queue[i_6].data.hook.insert(queue[i_6]);\n            }\n        }\n    }\n    var hydrationBailed = false;\n    // list of modules that can skip create hook during hydration because they\n    // are already rendered on the client or has no need for initialization\n    // Note: style is excluded because it relies on initial clone for future\n    // deep updates (#7063).\n    var isRenderedModule = makeMap('attrs,class,staticClass,staticStyle,key');\n    // Note: this is a browser-only function so we can assume elms are DOM nodes.\n    function hydrate(elm, vnode, insertedVnodeQueue, inVPre) {\n        var i;\n        var tag = vnode.tag, data = vnode.data, children = vnode.children;\n        inVPre = inVPre || (data && data.pre);\n        vnode.elm = elm;\n        if (isTrue(vnode.isComment) && isDef(vnode.asyncFactory)) {\n            vnode.isAsyncPlaceholder = true;\n            return true;\n        }\n        // assert node match\n        if (process.env.NODE_ENV !== 'production') {\n            if (!assertNodeMatch(elm, vnode, inVPre)) {\n                return false;\n            }\n        }\n        if (isDef(data)) {\n            if (isDef((i = data.hook)) && isDef((i = i.init)))\n                i(vnode, true /* hydrating */);\n            if (isDef((i = vnode.componentInstance))) {\n                // child component. it should have hydrated its own tree.\n                initComponent(vnode, insertedVnodeQueue);\n                return true;\n            }\n        }\n        if (isDef(tag)) {\n            if (isDef(children)) {\n                // empty element, allow client to pick up and populate children\n                if (!elm.hasChildNodes()) {\n                    createChildren(vnode, children, insertedVnodeQueue);\n                }\n                else {\n                    // v-html and domProps: innerHTML\n                    if (isDef((i = data)) &&\n                        isDef((i = i.domProps)) &&\n                        isDef((i = i.innerHTML))) {\n                        if (i !== elm.innerHTML) {\n                            /* istanbul ignore if */\n                            if (process.env.NODE_ENV !== 'production' &&\n                                typeof console !== 'undefined' &&\n                                !hydrationBailed) {\n                                hydrationBailed = true;\n                                console.warn('Parent: ', elm);\n                                console.warn('server innerHTML: ', i);\n                                console.warn('client innerHTML: ', elm.innerHTML);\n                            }\n                            return false;\n                        }\n                    }\n                    else {\n                        // iterate and compare children lists\n                        var childrenMatch = true;\n                        var childNode = elm.firstChild;\n                        for (var i_7 = 0; i_7 < children.length; i_7++) {\n                            if (!childNode ||\n                                !hydrate(childNode, children[i_7], insertedVnodeQueue, inVPre)) {\n                                childrenMatch = false;\n                                break;\n                            }\n                            childNode = childNode.nextSibling;\n                        }\n                        // if childNode is not null, it means the actual childNodes list is\n                        // longer than the virtual children list.\n                        if (!childrenMatch || childNode) {\n                            /* istanbul ignore if */\n                            if (process.env.NODE_ENV !== 'production' &&\n                                typeof console !== 'undefined' &&\n                                !hydrationBailed) {\n                                hydrationBailed = true;\n                                console.warn('Parent: ', elm);\n                                console.warn('Mismatching childNodes vs. VNodes: ', elm.childNodes, children);\n                            }\n                            return false;\n                        }\n                    }\n                }\n            }\n            if (isDef(data)) {\n                var fullInvoke = false;\n                for (var key in data) {\n                    if (!isRenderedModule(key)) {\n                        fullInvoke = true;\n                        invokeCreateHooks(vnode, insertedVnodeQueue);\n                        break;\n                    }\n                }\n                if (!fullInvoke && data['class']) {\n                    // ensure collecting deps for deep class bindings for future updates\n                    traverse(data['class']);\n                }\n            }\n        }\n        else if (elm.data !== vnode.text) {\n            elm.data = vnode.text;\n        }\n        return true;\n    }\n    function assertNodeMatch(node, vnode, inVPre) {\n        if (isDef(vnode.tag)) {\n            return (vnode.tag.indexOf('vue-component') === 0 ||\n                (!isUnknownElement(vnode, inVPre) &&\n                    vnode.tag.toLowerCase() ===\n                        (node.tagName && node.tagName.toLowerCase())));\n        }\n        else {\n            return node.nodeType === (vnode.isComment ? 8 : 3);\n        }\n    }\n    return function patch(oldVnode, vnode, hydrating, removeOnly) {\n        if (isUndef(vnode)) {\n            if (isDef(oldVnode))\n                invokeDestroyHook(oldVnode);\n            return;\n        }\n        var isInitialPatch = false;\n        var insertedVnodeQueue = [];\n        if (isUndef(oldVnode)) {\n            // empty mount (likely as component), create new root element\n            isInitialPatch = true;\n            createElm(vnode, insertedVnodeQueue);\n        }\n        else {\n            var isRealElement = isDef(oldVnode.nodeType);\n            if (!isRealElement && sameVnode(oldVnode, vnode)) {\n                // patch existing root node\n                patchVnode(oldVnode, vnode, insertedVnodeQueue, null, null, removeOnly);\n            }\n            else {\n                if (isRealElement) {\n                    // mounting to a real element\n                    // check if this is server-rendered content and if we can perform\n                    // a successful hydration.\n                    if (oldVnode.nodeType === 1 && oldVnode.hasAttribute(SSR_ATTR)) {\n                        oldVnode.removeAttribute(SSR_ATTR);\n                        hydrating = true;\n                    }\n                    if (isTrue(hydrating)) {\n                        if (hydrate(oldVnode, vnode, insertedVnodeQueue)) {\n                            invokeInsertHook(vnode, insertedVnodeQueue, true);\n                            return oldVnode;\n                        }\n                        else if (process.env.NODE_ENV !== 'production') {\n                            warn('The client-side rendered virtual DOM tree is not matching ' +\n                                'server-rendered content. This is likely caused by incorrect ' +\n                                'HTML markup, for example nesting block-level elements inside ' +\n                                '<p>, or missing <tbody>. Bailing hydration and performing ' +\n                                'full client-side render.');\n                        }\n                    }\n                    // either not server-rendered, or hydration failed.\n                    // create an empty node and replace it\n                    oldVnode = emptyNodeAt(oldVnode);\n                }\n                // replacing existing element\n                var oldElm = oldVnode.elm;\n                var parentElm = nodeOps.parentNode(oldElm);\n                // create new node\n                createElm(vnode, insertedVnodeQueue, \n                // extremely rare edge case: do not insert if old element is in a\n                // leaving transition. Only happens when combining transition +\n                // keep-alive + HOCs. (#4590)\n                oldElm._leaveCb ? null : parentElm, nodeOps.nextSibling(oldElm));\n                // update parent placeholder node element, recursively\n                if (isDef(vnode.parent)) {\n                    var ancestor = vnode.parent;\n                    var patchable = isPatchable(vnode);\n                    while (ancestor) {\n                        for (var i_8 = 0; i_8 < cbs.destroy.length; ++i_8) {\n                            cbs.destroy[i_8](ancestor);\n                        }\n                        ancestor.elm = vnode.elm;\n                        if (patchable) {\n                            for (var i_9 = 0; i_9 < cbs.create.length; ++i_9) {\n                                cbs.create[i_9](emptyNode, ancestor);\n                            }\n                            // #6513\n                            // invoke insert hooks that may have been merged by create hooks.\n                            // e.g. for directives that uses the \"inserted\" hook.\n                            var insert_1 = ancestor.data.hook.insert;\n                            if (insert_1.merged) {\n                                // start at index 1 to avoid re-invoking component mounted hook\n                                // clone insert hooks to avoid being mutated during iteration.\n                                // e.g. for customed directives under transition group.\n                                var cloned = insert_1.fns.slice(1);\n                                for (var i_10 = 0; i_10 < cloned.length; i_10++) {\n                                    cloned[i_10]();\n                                }\n                            }\n                        }\n                        else {\n                            registerRef(ancestor);\n                        }\n                        ancestor = ancestor.parent;\n                    }\n                }\n                // destroy old node\n                if (isDef(parentElm)) {\n                    removeVnodes([oldVnode], 0, 0);\n                }\n                else if (isDef(oldVnode.tag)) {\n                    invokeDestroyHook(oldVnode);\n                }\n            }\n        }\n        invokeInsertHook(vnode, insertedVnodeQueue, isInitialPatch);\n        return vnode.elm;\n    };\n}\n\nvar directives = {\n    create: updateDirectives,\n    update: updateDirectives,\n    destroy: function unbindDirectives(vnode) {\n        // @ts-expect-error emptyNode is not VNodeWithData\n        updateDirectives(vnode, emptyNode);\n    }\n};\nfunction updateDirectives(oldVnode, vnode) {\n    if (oldVnode.data.directives || vnode.data.directives) {\n        _update(oldVnode, vnode);\n    }\n}\nfunction _update(oldVnode, vnode) {\n    var isCreate = oldVnode === emptyNode;\n    var isDestroy = vnode === emptyNode;\n    var oldDirs = normalizeDirectives(oldVnode.data.directives, oldVnode.context);\n    var newDirs = normalizeDirectives(vnode.data.directives, vnode.context);\n    var dirsWithInsert = [];\n    var dirsWithPostpatch = [];\n    var key, oldDir, dir;\n    for (key in newDirs) {\n        oldDir = oldDirs[key];\n        dir = newDirs[key];\n        if (!oldDir) {\n            // new directive, bind\n            callHook(dir, 'bind', vnode, oldVnode);\n            if (dir.def && dir.def.inserted) {\n                dirsWithInsert.push(dir);\n            }\n        }\n        else {\n            // existing directive, update\n            dir.oldValue = oldDir.value;\n            dir.oldArg = oldDir.arg;\n            callHook(dir, 'update', vnode, oldVnode);\n            if (dir.def && dir.def.componentUpdated) {\n                dirsWithPostpatch.push(dir);\n            }\n        }\n    }\n    if (dirsWithInsert.length) {\n        var callInsert = function () {\n            for (var i = 0; i < dirsWithInsert.length; i++) {\n                callHook(dirsWithInsert[i], 'inserted', vnode, oldVnode);\n            }\n        };\n        if (isCreate) {\n            mergeVNodeHook(vnode, 'insert', callInsert);\n        }\n        else {\n            callInsert();\n        }\n    }\n    if (dirsWithPostpatch.length) {\n        mergeVNodeHook(vnode, 'postpatch', function () {\n            for (var i = 0; i < dirsWithPostpatch.length; i++) {\n                callHook(dirsWithPostpatch[i], 'componentUpdated', vnode, oldVnode);\n            }\n        });\n    }\n    if (!isCreate) {\n        for (key in oldDirs) {\n            if (!newDirs[key]) {\n                // no longer present, unbind\n                callHook(oldDirs[key], 'unbind', oldVnode, oldVnode, isDestroy);\n            }\n        }\n    }\n}\nvar emptyModifiers = Object.create(null);\nfunction normalizeDirectives(dirs, vm) {\n    var res = Object.create(null);\n    if (!dirs) {\n        // $flow-disable-line\n        return res;\n    }\n    var i, dir;\n    for (i = 0; i < dirs.length; i++) {\n        dir = dirs[i];\n        if (!dir.modifiers) {\n            // $flow-disable-line\n            dir.modifiers = emptyModifiers;\n        }\n        res[getRawDirName(dir)] = dir;\n        if (vm._setupState && vm._setupState.__sfc) {\n            var setupDef = dir.def || resolveAsset(vm, '_setupState', 'v-' + dir.name);\n            if (typeof setupDef === 'function') {\n                dir.def = {\n                    bind: setupDef,\n                    update: setupDef,\n                };\n            }\n            else {\n                dir.def = setupDef;\n            }\n        }\n        dir.def = dir.def || resolveAsset(vm.$options, 'directives', dir.name, true);\n    }\n    // $flow-disable-line\n    return res;\n}\nfunction getRawDirName(dir) {\n    return (dir.rawName || \"\".concat(dir.name, \".\").concat(Object.keys(dir.modifiers || {}).join('.')));\n}\nfunction callHook(dir, hook, vnode, oldVnode, isDestroy) {\n    var fn = dir.def && dir.def[hook];\n    if (fn) {\n        try {\n            fn(vnode.elm, dir, vnode, oldVnode, isDestroy);\n        }\n        catch (e) {\n            handleError(e, vnode.context, \"directive \".concat(dir.name, \" \").concat(hook, \" hook\"));\n        }\n    }\n}\n\nvar baseModules = [ref, directives];\n\nfunction updateAttrs(oldVnode, vnode) {\n    var opts = vnode.componentOptions;\n    if (isDef(opts) && opts.Ctor.options.inheritAttrs === false) {\n        return;\n    }\n    if (isUndef(oldVnode.data.attrs) && isUndef(vnode.data.attrs)) {\n        return;\n    }\n    var key, cur, old;\n    var elm = vnode.elm;\n    var oldAttrs = oldVnode.data.attrs || {};\n    var attrs = vnode.data.attrs || {};\n    // clone observed objects, as the user probably wants to mutate it\n    if (isDef(attrs.__ob__) || isTrue(attrs._v_attr_proxy)) {\n        attrs = vnode.data.attrs = extend({}, attrs);\n    }\n    for (key in attrs) {\n        cur = attrs[key];\n        old = oldAttrs[key];\n        if (old !== cur) {\n            setAttr(elm, key, cur, vnode.data.pre);\n        }\n    }\n    // #4391: in IE9, setting type can reset value for input[type=radio]\n    // #6666: IE/Edge forces progress value down to 1 before setting a max\n    /* istanbul ignore if */\n    if ((isIE || isEdge) && attrs.value !== oldAttrs.value) {\n        setAttr(elm, 'value', attrs.value);\n    }\n    for (key in oldAttrs) {\n        if (isUndef(attrs[key])) {\n            if (isXlink(key)) {\n                elm.removeAttributeNS(xlinkNS, getXlinkProp(key));\n            }\n            else if (!isEnumeratedAttr(key)) {\n                elm.removeAttribute(key);\n            }\n        }\n    }\n}\nfunction setAttr(el, key, value, isInPre) {\n    if (isInPre || el.tagName.indexOf('-') > -1) {\n        baseSetAttr(el, key, value);\n    }\n    else if (isBooleanAttr(key)) {\n        // set attribute for blank value\n        // e.g. <option disabled>Select one</option>\n        if (isFalsyAttrValue(value)) {\n            el.removeAttribute(key);\n        }\n        else {\n            // technically allowfullscreen is a boolean attribute for <iframe>,\n            // but Flash expects a value of \"true\" when used on <embed> tag\n            value = key === 'allowfullscreen' && el.tagName === 'EMBED' ? 'true' : key;\n            el.setAttribute(key, value);\n        }\n    }\n    else if (isEnumeratedAttr(key)) {\n        el.setAttribute(key, convertEnumeratedValue(key, value));\n    }\n    else if (isXlink(key)) {\n        if (isFalsyAttrValue(value)) {\n            el.removeAttributeNS(xlinkNS, getXlinkProp(key));\n        }\n        else {\n            el.setAttributeNS(xlinkNS, key, value);\n        }\n    }\n    else {\n        baseSetAttr(el, key, value);\n    }\n}\nfunction baseSetAttr(el, key, value) {\n    if (isFalsyAttrValue(value)) {\n        el.removeAttribute(key);\n    }\n    else {\n        // #7138: IE10 & 11 fires input event when setting placeholder on\n        // <textarea>... block the first input event and remove the blocker\n        // immediately.\n        /* istanbul ignore if */\n        if (isIE &&\n            !isIE9 &&\n            el.tagName === 'TEXTAREA' &&\n            key === 'placeholder' &&\n            value !== '' &&\n            !el.__ieph) {\n            var blocker_1 = function (e) {\n                e.stopImmediatePropagation();\n                el.removeEventListener('input', blocker_1);\n            };\n            el.addEventListener('input', blocker_1);\n            // $flow-disable-line\n            el.__ieph = true; /* IE placeholder patched */\n        }\n        el.setAttribute(key, value);\n    }\n}\nvar attrs = {\n    create: updateAttrs,\n    update: updateAttrs\n};\n\nfunction updateClass(oldVnode, vnode) {\n    var el = vnode.elm;\n    var data = vnode.data;\n    var oldData = oldVnode.data;\n    if (isUndef(data.staticClass) &&\n        isUndef(data.class) &&\n        (isUndef(oldData) ||\n            (isUndef(oldData.staticClass) && isUndef(oldData.class)))) {\n        return;\n    }\n    var cls = genClassForVnode(vnode);\n    // handle transition classes\n    var transitionClass = el._transitionClasses;\n    if (isDef(transitionClass)) {\n        cls = concat(cls, stringifyClass(transitionClass));\n    }\n    // set the class\n    if (cls !== el._prevClass) {\n        el.setAttribute('class', cls);\n        el._prevClass = cls;\n    }\n}\nvar klass = {\n    create: updateClass,\n    update: updateClass\n};\n\n// in some cases, the event used has to be determined at runtime\n// so we used some reserved tokens during compile.\nvar RANGE_TOKEN = '__r';\nvar CHECKBOX_RADIO_TOKEN = '__c';\n\n// normalize v-model event tokens that can only be determined at runtime.\n// it's important to place the event as the first in the array because\n// the whole point is ensuring the v-model callback gets called before\n// user-attached handlers.\nfunction normalizeEvents(on) {\n    /* istanbul ignore if */\n    if (isDef(on[RANGE_TOKEN])) {\n        // IE input[type=range] only supports `change` event\n        var event_1 = isIE ? 'change' : 'input';\n        on[event_1] = [].concat(on[RANGE_TOKEN], on[event_1] || []);\n        delete on[RANGE_TOKEN];\n    }\n    // This was originally intended to fix #4521 but no longer necessary\n    // after 2.5. Keeping it for backwards compat with generated code from < 2.4\n    /* istanbul ignore if */\n    if (isDef(on[CHECKBOX_RADIO_TOKEN])) {\n        on.change = [].concat(on[CHECKBOX_RADIO_TOKEN], on.change || []);\n        delete on[CHECKBOX_RADIO_TOKEN];\n    }\n}\nvar target;\nfunction createOnceHandler(event, handler, capture) {\n    var _target = target; // save current target element in closure\n    return function onceHandler() {\n        var res = handler.apply(null, arguments);\n        if (res !== null) {\n            remove(event, onceHandler, capture, _target);\n        }\n    };\n}\n// #9446: Firefox <= 53 (in particular, ESR 52) has incorrect Event.timeStamp\n// implementation and does not fire microtasks in between event propagation, so\n// safe to exclude.\nvar useMicrotaskFix = isUsingMicroTask && !(isFF && Number(isFF[1]) <= 53);\nfunction add(name, handler, capture, passive) {\n    // async edge case #6566: inner click event triggers patch, event handler\n    // attached to outer element during patch, and triggered again. This\n    // happens because browsers fire microtask ticks between event propagation.\n    // the solution is simple: we save the timestamp when a handler is attached,\n    // and the handler would only fire if the event passed to it was fired\n    // AFTER it was attached.\n    if (useMicrotaskFix) {\n        var attachedTimestamp_1 = currentFlushTimestamp;\n        var original_1 = handler;\n        //@ts-expect-error\n        handler = original_1._wrapper = function (e) {\n            if (\n            // no bubbling, should always fire.\n            // this is just a safety net in case event.timeStamp is unreliable in\n            // certain weird environments...\n            e.target === e.currentTarget ||\n                // event is fired after handler attachment\n                e.timeStamp >= attachedTimestamp_1 ||\n                // bail for environments that have buggy event.timeStamp implementations\n                // #9462 iOS 9 bug: event.timeStamp is 0 after history.pushState\n                // #9681 QtWebEngine event.timeStamp is negative value\n                e.timeStamp <= 0 ||\n                // #9448 bail if event is fired in another document in a multi-page\n                // electron/nw.js app, since event.timeStamp will be using a different\n                // starting reference\n                e.target.ownerDocument !== document) {\n                return original_1.apply(this, arguments);\n            }\n        };\n    }\n    target.addEventListener(name, handler, supportsPassive ? { capture: capture, passive: passive } : capture);\n}\nfunction remove(name, handler, capture, _target) {\n    (_target || target).removeEventListener(name, \n    //@ts-expect-error\n    handler._wrapper || handler, capture);\n}\nfunction updateDOMListeners(oldVnode, vnode) {\n    if (isUndef(oldVnode.data.on) && isUndef(vnode.data.on)) {\n        return;\n    }\n    var on = vnode.data.on || {};\n    var oldOn = oldVnode.data.on || {};\n    // vnode is empty when removing all listeners,\n    // and use old vnode dom element\n    target = vnode.elm || oldVnode.elm;\n    normalizeEvents(on);\n    updateListeners(on, oldOn, add, remove, createOnceHandler, vnode.context);\n    target = undefined;\n}\nvar events = {\n    create: updateDOMListeners,\n    update: updateDOMListeners,\n    // @ts-expect-error emptyNode has actually data\n    destroy: function (vnode) { return updateDOMListeners(vnode, emptyNode); }\n};\n\nvar svgContainer;\nfunction updateDOMProps(oldVnode, vnode) {\n    if (isUndef(oldVnode.data.domProps) && isUndef(vnode.data.domProps)) {\n        return;\n    }\n    var key, cur;\n    var elm = vnode.elm;\n    var oldProps = oldVnode.data.domProps || {};\n    var props = vnode.data.domProps || {};\n    // clone observed objects, as the user probably wants to mutate it\n    if (isDef(props.__ob__) || isTrue(props._v_attr_proxy)) {\n        props = vnode.data.domProps = extend({}, props);\n    }\n    for (key in oldProps) {\n        if (!(key in props)) {\n            elm[key] = '';\n        }\n    }\n    for (key in props) {\n        cur = props[key];\n        // ignore children if the node has textContent or innerHTML,\n        // as these will throw away existing DOM nodes and cause removal errors\n        // on subsequent patches (#3360)\n        if (key === 'textContent' || key === 'innerHTML') {\n            if (vnode.children)\n                vnode.children.length = 0;\n            if (cur === oldProps[key])\n                continue;\n            // #6601 work around Chrome version <= 55 bug where single textNode\n            // replaced by innerHTML/textContent retains its parentNode property\n            if (elm.childNodes.length === 1) {\n                elm.removeChild(elm.childNodes[0]);\n            }\n        }\n        if (key === 'value' && elm.tagName !== 'PROGRESS') {\n            // store value as _value as well since\n            // non-string values will be stringified\n            elm._value = cur;\n            // avoid resetting cursor position when value is the same\n            var strCur = isUndef(cur) ? '' : String(cur);\n            if (shouldUpdateValue(elm, strCur)) {\n                elm.value = strCur;\n            }\n        }\n        else if (key === 'innerHTML' &&\n            isSVG(elm.tagName) &&\n            isUndef(elm.innerHTML)) {\n            // IE doesn't support innerHTML for SVG elements\n            svgContainer = svgContainer || document.createElement('div');\n            svgContainer.innerHTML = \"<svg>\".concat(cur, \"</svg>\");\n            var svg = svgContainer.firstChild;\n            while (elm.firstChild) {\n                elm.removeChild(elm.firstChild);\n            }\n            while (svg.firstChild) {\n                elm.appendChild(svg.firstChild);\n            }\n        }\n        else if (\n        // skip the update if old and new VDOM state is the same.\n        // `value` is handled separately because the DOM value may be temporarily\n        // out of sync with VDOM state due to focus, composition and modifiers.\n        // This  #4521 by skipping the unnecessary `checked` update.\n        cur !== oldProps[key]) {\n            // some property updates can throw\n            // e.g. `value` on <progress> w/ non-finite value\n            try {\n                elm[key] = cur;\n            }\n            catch (e) { }\n        }\n    }\n}\nfunction shouldUpdateValue(elm, checkVal) {\n    return (\n    //@ts-expect-error\n    !elm.composing &&\n        (elm.tagName === 'OPTION' ||\n            isNotInFocusAndDirty(elm, checkVal) ||\n            isDirtyWithModifiers(elm, checkVal)));\n}\nfunction isNotInFocusAndDirty(elm, checkVal) {\n    // return true when textbox (.number and .trim) loses focus and its value is\n    // not equal to the updated value\n    var notInFocus = true;\n    // #6157\n    // work around IE bug when accessing document.activeElement in an iframe\n    try {\n        notInFocus = document.activeElement !== elm;\n    }\n    catch (e) { }\n    return notInFocus && elm.value !== checkVal;\n}\nfunction isDirtyWithModifiers(elm, newVal) {\n    var value = elm.value;\n    var modifiers = elm._vModifiers; // injected by v-model runtime\n    if (isDef(modifiers)) {\n        if (modifiers.number) {\n            return toNumber(value) !== toNumber(newVal);\n        }\n        if (modifiers.trim) {\n            return value.trim() !== newVal.trim();\n        }\n    }\n    return value !== newVal;\n}\nvar domProps = {\n    create: updateDOMProps,\n    update: updateDOMProps\n};\n\nvar parseStyleText = cached(function (cssText) {\n    var res = {};\n    var listDelimiter = /;(?![^(]*\\))/g;\n    var propertyDelimiter = /:(.+)/;\n    cssText.split(listDelimiter).forEach(function (item) {\n        if (item) {\n            var tmp = item.split(propertyDelimiter);\n            tmp.length > 1 && (res[tmp[0].trim()] = tmp[1].trim());\n        }\n    });\n    return res;\n});\n// merge static and dynamic style data on the same vnode\nfunction normalizeStyleData(data) {\n    var style = normalizeStyleBinding(data.style);\n    // static style is pre-processed into an object during compilation\n    // and is always a fresh object, so it's safe to merge into it\n    return data.staticStyle ? extend(data.staticStyle, style) : style;\n}\n// normalize possible array / string values into Object\nfunction normalizeStyleBinding(bindingStyle) {\n    if (Array.isArray(bindingStyle)) {\n        return toObject(bindingStyle);\n    }\n    if (typeof bindingStyle === 'string') {\n        return parseStyleText(bindingStyle);\n    }\n    return bindingStyle;\n}\n/**\n * parent component style should be after child's\n * so that parent component's style could override it\n */\nfunction getStyle(vnode, checkChild) {\n    var res = {};\n    var styleData;\n    if (checkChild) {\n        var childNode = vnode;\n        while (childNode.componentInstance) {\n            childNode = childNode.componentInstance._vnode;\n            if (childNode &&\n                childNode.data &&\n                (styleData = normalizeStyleData(childNode.data))) {\n                extend(res, styleData);\n            }\n        }\n    }\n    if ((styleData = normalizeStyleData(vnode.data))) {\n        extend(res, styleData);\n    }\n    var parentNode = vnode;\n    // @ts-expect-error parentNode.parent not VNodeWithData\n    while ((parentNode = parentNode.parent)) {\n        if (parentNode.data && (styleData = normalizeStyleData(parentNode.data))) {\n            extend(res, styleData);\n        }\n    }\n    return res;\n}\n\nvar cssVarRE = /^--/;\nvar importantRE = /\\s*!important$/;\nvar setProp = function (el, name, val) {\n    /* istanbul ignore if */\n    if (cssVarRE.test(name)) {\n        el.style.setProperty(name, val);\n    }\n    else if (importantRE.test(val)) {\n        el.style.setProperty(hyphenate(name), val.replace(importantRE, ''), 'important');\n    }\n    else {\n        var normalizedName = normalize(name);\n        if (Array.isArray(val)) {\n            // Support values array created by autoprefixer, e.g.\n            // {display: [\"-webkit-box\", \"-ms-flexbox\", \"flex\"]}\n            // Set them one by one, and the browser will only set those it can recognize\n            for (var i = 0, len = val.length; i < len; i++) {\n                el.style[normalizedName] = val[i];\n            }\n        }\n        else {\n            el.style[normalizedName] = val;\n        }\n    }\n};\nvar vendorNames = ['Webkit', 'Moz', 'ms'];\nvar emptyStyle;\nvar normalize = cached(function (prop) {\n    emptyStyle = emptyStyle || document.createElement('div').style;\n    prop = camelize(prop);\n    if (prop !== 'filter' && prop in emptyStyle) {\n        return prop;\n    }\n    var capName = prop.charAt(0).toUpperCase() + prop.slice(1);\n    for (var i = 0; i < vendorNames.length; i++) {\n        var name_1 = vendorNames[i] + capName;\n        if (name_1 in emptyStyle) {\n            return name_1;\n        }\n    }\n});\nfunction updateStyle(oldVnode, vnode) {\n    var data = vnode.data;\n    var oldData = oldVnode.data;\n    if (isUndef(data.staticStyle) &&\n        isUndef(data.style) &&\n        isUndef(oldData.staticStyle) &&\n        isUndef(oldData.style)) {\n        return;\n    }\n    var cur, name;\n    var el = vnode.elm;\n    var oldStaticStyle = oldData.staticStyle;\n    var oldStyleBinding = oldData.normalizedStyle || oldData.style || {};\n    // if static style exists, stylebinding already merged into it when doing normalizeStyleData\n    var oldStyle = oldStaticStyle || oldStyleBinding;\n    var style = normalizeStyleBinding(vnode.data.style) || {};\n    // store normalized style under a different key for next diff\n    // make sure to clone it if it's reactive, since the user likely wants\n    // to mutate it.\n    vnode.data.normalizedStyle = isDef(style.__ob__) ? extend({}, style) : style;\n    var newStyle = getStyle(vnode, true);\n    for (name in oldStyle) {\n        if (isUndef(newStyle[name])) {\n            setProp(el, name, '');\n        }\n    }\n    for (name in newStyle) {\n        cur = newStyle[name];\n        // ie9 setting to null has no effect, must use empty string\n        setProp(el, name, cur == null ? '' : cur);\n    }\n}\nvar style = {\n    create: updateStyle,\n    update: updateStyle\n};\n\nvar whitespaceRE = /\\s+/;\n/**\n * Add class with compatibility for SVG since classList is not supported on\n * SVG elements in IE\n */\nfunction addClass(el, cls) {\n    /* istanbul ignore if */\n    if (!cls || !(cls = cls.trim())) {\n        return;\n    }\n    /* istanbul ignore else */\n    if (el.classList) {\n        if (cls.indexOf(' ') > -1) {\n            cls.split(whitespaceRE).forEach(function (c) { return el.classList.add(c); });\n        }\n        else {\n            el.classList.add(cls);\n        }\n    }\n    else {\n        var cur = \" \".concat(el.getAttribute('class') || '', \" \");\n        if (cur.indexOf(' ' + cls + ' ') < 0) {\n            el.setAttribute('class', (cur + cls).trim());\n        }\n    }\n}\n/**\n * Remove class with compatibility for SVG since classList is not supported on\n * SVG elements in IE\n */\nfunction removeClass(el, cls) {\n    /* istanbul ignore if */\n    if (!cls || !(cls = cls.trim())) {\n        return;\n    }\n    /* istanbul ignore else */\n    if (el.classList) {\n        if (cls.indexOf(' ') > -1) {\n            cls.split(whitespaceRE).forEach(function (c) { return el.classList.remove(c); });\n        }\n        else {\n            el.classList.remove(cls);\n        }\n        if (!el.classList.length) {\n            el.removeAttribute('class');\n        }\n    }\n    else {\n        var cur = \" \".concat(el.getAttribute('class') || '', \" \");\n        var tar = ' ' + cls + ' ';\n        while (cur.indexOf(tar) >= 0) {\n            cur = cur.replace(tar, ' ');\n        }\n        cur = cur.trim();\n        if (cur) {\n            el.setAttribute('class', cur);\n        }\n        else {\n            el.removeAttribute('class');\n        }\n    }\n}\n\nfunction resolveTransition(def) {\n    if (!def) {\n        return;\n    }\n    /* istanbul ignore else */\n    if (typeof def === 'object') {\n        var res = {};\n        if (def.css !== false) {\n            extend(res, autoCssTransition(def.name || 'v'));\n        }\n        extend(res, def);\n        return res;\n    }\n    else if (typeof def === 'string') {\n        return autoCssTransition(def);\n    }\n}\nvar autoCssTransition = cached(function (name) {\n    return {\n        enterClass: \"\".concat(name, \"-enter\"),\n        enterToClass: \"\".concat(name, \"-enter-to\"),\n        enterActiveClass: \"\".concat(name, \"-enter-active\"),\n        leaveClass: \"\".concat(name, \"-leave\"),\n        leaveToClass: \"\".concat(name, \"-leave-to\"),\n        leaveActiveClass: \"\".concat(name, \"-leave-active\")\n    };\n});\nvar hasTransition = inBrowser && !isIE9;\nvar TRANSITION = 'transition';\nvar ANIMATION = 'animation';\n// Transition property/event sniffing\nvar transitionProp = 'transition';\nvar transitionEndEvent = 'transitionend';\nvar animationProp = 'animation';\nvar animationEndEvent = 'animationend';\nif (hasTransition) {\n    /* istanbul ignore if */\n    if (window.ontransitionend === undefined &&\n        window.onwebkittransitionend !== undefined) {\n        transitionProp = 'WebkitTransition';\n        transitionEndEvent = 'webkitTransitionEnd';\n    }\n    if (window.onanimationend === undefined &&\n        window.onwebkitanimationend !== undefined) {\n        animationProp = 'WebkitAnimation';\n        animationEndEvent = 'webkitAnimationEnd';\n    }\n}\n// binding to window is necessary to make hot reload work in IE in strict mode\nvar raf = inBrowser\n    ? window.requestAnimationFrame\n        ? window.requestAnimationFrame.bind(window)\n        : setTimeout\n    : /* istanbul ignore next */ function (/* istanbul ignore next */ fn) { return fn(); };\nfunction nextFrame(fn) {\n    raf(function () {\n        // @ts-expect-error\n        raf(fn);\n    });\n}\nfunction addTransitionClass(el, cls) {\n    var transitionClasses = el._transitionClasses || (el._transitionClasses = []);\n    if (transitionClasses.indexOf(cls) < 0) {\n        transitionClasses.push(cls);\n        addClass(el, cls);\n    }\n}\nfunction removeTransitionClass(el, cls) {\n    if (el._transitionClasses) {\n        remove$2(el._transitionClasses, cls);\n    }\n    removeClass(el, cls);\n}\nfunction whenTransitionEnds(el, expectedType, cb) {\n    var _a = getTransitionInfo(el, expectedType), type = _a.type, timeout = _a.timeout, propCount = _a.propCount;\n    if (!type)\n        return cb();\n    var event = type === TRANSITION ? transitionEndEvent : animationEndEvent;\n    var ended = 0;\n    var end = function () {\n        el.removeEventListener(event, onEnd);\n        cb();\n    };\n    var onEnd = function (e) {\n        if (e.target === el) {\n            if (++ended >= propCount) {\n                end();\n            }\n        }\n    };\n    setTimeout(function () {\n        if (ended < propCount) {\n            end();\n        }\n    }, timeout + 1);\n    el.addEventListener(event, onEnd);\n}\nvar transformRE = /\\b(transform|all)(,|$)/;\nfunction getTransitionInfo(el, expectedType) {\n    var styles = window.getComputedStyle(el);\n    // JSDOM may return undefined for transition properties\n    var transitionDelays = (styles[transitionProp + 'Delay'] || '').split(', ');\n    var transitionDurations = (styles[transitionProp + 'Duration'] || '').split(', ');\n    var transitionTimeout = getTimeout(transitionDelays, transitionDurations);\n    var animationDelays = (styles[animationProp + 'Delay'] || '').split(', ');\n    var animationDurations = (styles[animationProp + 'Duration'] || '').split(', ');\n    var animationTimeout = getTimeout(animationDelays, animationDurations);\n    var type;\n    var timeout = 0;\n    var propCount = 0;\n    /* istanbul ignore if */\n    if (expectedType === TRANSITION) {\n        if (transitionTimeout > 0) {\n            type = TRANSITION;\n            timeout = transitionTimeout;\n            propCount = transitionDurations.length;\n        }\n    }\n    else if (expectedType === ANIMATION) {\n        if (animationTimeout > 0) {\n            type = ANIMATION;\n            timeout = animationTimeout;\n            propCount = animationDurations.length;\n        }\n    }\n    else {\n        timeout = Math.max(transitionTimeout, animationTimeout);\n        type =\n            timeout > 0\n                ? transitionTimeout > animationTimeout\n                    ? TRANSITION\n                    : ANIMATION\n                : null;\n        propCount = type\n            ? type === TRANSITION\n                ? transitionDurations.length\n                : animationDurations.length\n            : 0;\n    }\n    var hasTransform = type === TRANSITION && transformRE.test(styles[transitionProp + 'Property']);\n    return {\n        type: type,\n        timeout: timeout,\n        propCount: propCount,\n        hasTransform: hasTransform\n    };\n}\nfunction getTimeout(delays, durations) {\n    /* istanbul ignore next */\n    while (delays.length < durations.length) {\n        delays = delays.concat(delays);\n    }\n    return Math.max.apply(null, durations.map(function (d, i) {\n        return toMs(d) + toMs(delays[i]);\n    }));\n}\n// Old versions of Chromium (below 61.0.3163.100) formats floating pointer numbers\n// in a locale-dependent way, using a comma instead of a dot.\n// If comma is not replaced with a dot, the input will be rounded down (i.e. acting\n// as a floor function) causing unexpected behaviors\nfunction toMs(s) {\n    return Number(s.slice(0, -1).replace(',', '.')) * 1000;\n}\n\nfunction enter(vnode, toggleDisplay) {\n    var el = vnode.elm;\n    // call leave callback now\n    if (isDef(el._leaveCb)) {\n        el._leaveCb.cancelled = true;\n        el._leaveCb();\n    }\n    var data = resolveTransition(vnode.data.transition);\n    if (isUndef(data)) {\n        return;\n    }\n    /* istanbul ignore if */\n    if (isDef(el._enterCb) || el.nodeType !== 1) {\n        return;\n    }\n    var css = data.css, type = data.type, enterClass = data.enterClass, enterToClass = data.enterToClass, enterActiveClass = data.enterActiveClass, appearClass = data.appearClass, appearToClass = data.appearToClass, appearActiveClass = data.appearActiveClass, beforeEnter = data.beforeEnter, enter = data.enter, afterEnter = data.afterEnter, enterCancelled = data.enterCancelled, beforeAppear = data.beforeAppear, appear = data.appear, afterAppear = data.afterAppear, appearCancelled = data.appearCancelled, duration = data.duration;\n    // activeInstance will always be the <transition> component managing this\n    // transition. One edge case to check is when the <transition> is placed\n    // as the root node of a child component. In that case we need to check\n    // <transition>'s parent for appear check.\n    var context = activeInstance;\n    var transitionNode = activeInstance.$vnode;\n    while (transitionNode && transitionNode.parent) {\n        context = transitionNode.context;\n        transitionNode = transitionNode.parent;\n    }\n    var isAppear = !context._isMounted || !vnode.isRootInsert;\n    if (isAppear && !appear && appear !== '') {\n        return;\n    }\n    var startClass = isAppear && appearClass ? appearClass : enterClass;\n    var activeClass = isAppear && appearActiveClass ? appearActiveClass : enterActiveClass;\n    var toClass = isAppear && appearToClass ? appearToClass : enterToClass;\n    var beforeEnterHook = isAppear ? beforeAppear || beforeEnter : beforeEnter;\n    var enterHook = isAppear ? (isFunction(appear) ? appear : enter) : enter;\n    var afterEnterHook = isAppear ? afterAppear || afterEnter : afterEnter;\n    var enterCancelledHook = isAppear\n        ? appearCancelled || enterCancelled\n        : enterCancelled;\n    var explicitEnterDuration = toNumber(isObject(duration) ? duration.enter : duration);\n    if (process.env.NODE_ENV !== 'production' && explicitEnterDuration != null) {\n        checkDuration(explicitEnterDuration, 'enter', vnode);\n    }\n    var expectsCSS = css !== false && !isIE9;\n    var userWantsControl = getHookArgumentsLength(enterHook);\n    var cb = (el._enterCb = once(function () {\n        if (expectsCSS) {\n            removeTransitionClass(el, toClass);\n            removeTransitionClass(el, activeClass);\n        }\n        // @ts-expect-error\n        if (cb.cancelled) {\n            if (expectsCSS) {\n                removeTransitionClass(el, startClass);\n            }\n            enterCancelledHook && enterCancelledHook(el);\n        }\n        else {\n            afterEnterHook && afterEnterHook(el);\n        }\n        el._enterCb = null;\n    }));\n    if (!vnode.data.show) {\n        // remove pending leave element on enter by injecting an insert hook\n        mergeVNodeHook(vnode, 'insert', function () {\n            var parent = el.parentNode;\n            var pendingNode = parent && parent._pending && parent._pending[vnode.key];\n            if (pendingNode &&\n                pendingNode.tag === vnode.tag &&\n                pendingNode.elm._leaveCb) {\n                pendingNode.elm._leaveCb();\n            }\n            enterHook && enterHook(el, cb);\n        });\n    }\n    // start enter transition\n    beforeEnterHook && beforeEnterHook(el);\n    if (expectsCSS) {\n        addTransitionClass(el, startClass);\n        addTransitionClass(el, activeClass);\n        nextFrame(function () {\n            removeTransitionClass(el, startClass);\n            // @ts-expect-error\n            if (!cb.cancelled) {\n                addTransitionClass(el, toClass);\n                if (!userWantsControl) {\n                    if (isValidDuration(explicitEnterDuration)) {\n                        setTimeout(cb, explicitEnterDuration);\n                    }\n                    else {\n                        whenTransitionEnds(el, type, cb);\n                    }\n                }\n            }\n        });\n    }\n    if (vnode.data.show) {\n        toggleDisplay && toggleDisplay();\n        enterHook && enterHook(el, cb);\n    }\n    if (!expectsCSS && !userWantsControl) {\n        cb();\n    }\n}\nfunction leave(vnode, rm) {\n    var el = vnode.elm;\n    // call enter callback now\n    if (isDef(el._enterCb)) {\n        el._enterCb.cancelled = true;\n        el._enterCb();\n    }\n    var data = resolveTransition(vnode.data.transition);\n    if (isUndef(data) || el.nodeType !== 1) {\n        return rm();\n    }\n    /* istanbul ignore if */\n    if (isDef(el._leaveCb)) {\n        return;\n    }\n    var css = data.css, type = data.type, leaveClass = data.leaveClass, leaveToClass = data.leaveToClass, leaveActiveClass = data.leaveActiveClass, beforeLeave = data.beforeLeave, leave = data.leave, afterLeave = data.afterLeave, leaveCancelled = data.leaveCancelled, delayLeave = data.delayLeave, duration = data.duration;\n    var expectsCSS = css !== false && !isIE9;\n    var userWantsControl = getHookArgumentsLength(leave);\n    var explicitLeaveDuration = toNumber(isObject(duration) ? duration.leave : duration);\n    if (process.env.NODE_ENV !== 'production' && isDef(explicitLeaveDuration)) {\n        checkDuration(explicitLeaveDuration, 'leave', vnode);\n    }\n    var cb = (el._leaveCb = once(function () {\n        if (el.parentNode && el.parentNode._pending) {\n            el.parentNode._pending[vnode.key] = null;\n        }\n        if (expectsCSS) {\n            removeTransitionClass(el, leaveToClass);\n            removeTransitionClass(el, leaveActiveClass);\n        }\n        // @ts-expect-error\n        if (cb.cancelled) {\n            if (expectsCSS) {\n                removeTransitionClass(el, leaveClass);\n            }\n            leaveCancelled && leaveCancelled(el);\n        }\n        else {\n            rm();\n            afterLeave && afterLeave(el);\n        }\n        el._leaveCb = null;\n    }));\n    if (delayLeave) {\n        delayLeave(performLeave);\n    }\n    else {\n        performLeave();\n    }\n    function performLeave() {\n        // the delayed leave may have already been cancelled\n        // @ts-expect-error\n        if (cb.cancelled) {\n            return;\n        }\n        // record leaving element\n        if (!vnode.data.show && el.parentNode) {\n            (el.parentNode._pending || (el.parentNode._pending = {}))[vnode.key] =\n                vnode;\n        }\n        beforeLeave && beforeLeave(el);\n        if (expectsCSS) {\n            addTransitionClass(el, leaveClass);\n            addTransitionClass(el, leaveActiveClass);\n            nextFrame(function () {\n                removeTransitionClass(el, leaveClass);\n                // @ts-expect-error\n                if (!cb.cancelled) {\n                    addTransitionClass(el, leaveToClass);\n                    if (!userWantsControl) {\n                        if (isValidDuration(explicitLeaveDuration)) {\n                            setTimeout(cb, explicitLeaveDuration);\n                        }\n                        else {\n                            whenTransitionEnds(el, type, cb);\n                        }\n                    }\n                }\n            });\n        }\n        leave && leave(el, cb);\n        if (!expectsCSS && !userWantsControl) {\n            cb();\n        }\n    }\n}\n// only used in dev mode\nfunction checkDuration(val, name, vnode) {\n    if (typeof val !== 'number') {\n        warn(\"<transition> explicit \".concat(name, \" duration is not a valid number - \") +\n            \"got \".concat(JSON.stringify(val), \".\"), vnode.context);\n    }\n    else if (isNaN(val)) {\n        warn(\"<transition> explicit \".concat(name, \" duration is NaN - \") +\n            'the duration expression might be incorrect.', vnode.context);\n    }\n}\nfunction isValidDuration(val) {\n    return typeof val === 'number' && !isNaN(val);\n}\n/**\n * Normalize a transition hook's argument length. The hook may be:\n * - a merged hook (invoker) with the original in .fns\n * - a wrapped component method (check ._length)\n * - a plain function (.length)\n */\nfunction getHookArgumentsLength(fn) {\n    if (isUndef(fn)) {\n        return false;\n    }\n    // @ts-expect-error\n    var invokerFns = fn.fns;\n    if (isDef(invokerFns)) {\n        // invoker\n        return getHookArgumentsLength(Array.isArray(invokerFns) ? invokerFns[0] : invokerFns);\n    }\n    else {\n        // @ts-expect-error\n        return (fn._length || fn.length) > 1;\n    }\n}\nfunction _enter(_, vnode) {\n    if (vnode.data.show !== true) {\n        enter(vnode);\n    }\n}\nvar transition = inBrowser\n    ? {\n        create: _enter,\n        activate: _enter,\n        remove: function (vnode, rm) {\n            /* istanbul ignore else */\n            if (vnode.data.show !== true) {\n                // @ts-expect-error\n                leave(vnode, rm);\n            }\n            else {\n                rm();\n            }\n        }\n    }\n    : {};\n\nvar platformModules = [attrs, klass, events, domProps, style, transition];\n\n// the directive module should be applied last, after all\n// built-in modules have been applied.\nvar modules = platformModules.concat(baseModules);\nvar patch = createPatchFunction({ nodeOps: nodeOps, modules: modules });\n\n/**\n * Not type checking this file because flow doesn't like attaching\n * properties to Elements.\n */\n/* istanbul ignore if */\nif (isIE9) {\n    // http://www.matts411.com/post/internet-explorer-9-oninput/\n    document.addEventListener('selectionchange', function () {\n        var el = document.activeElement;\n        // @ts-expect-error\n        if (el && el.vmodel) {\n            trigger(el, 'input');\n        }\n    });\n}\nvar directive = {\n    inserted: function (el, binding, vnode, oldVnode) {\n        if (vnode.tag === 'select') {\n            // #6903\n            if (oldVnode.elm && !oldVnode.elm._vOptions) {\n                mergeVNodeHook(vnode, 'postpatch', function () {\n                    directive.componentUpdated(el, binding, vnode);\n                });\n            }\n            else {\n                setSelected(el, binding, vnode.context);\n            }\n            el._vOptions = [].map.call(el.options, getValue);\n        }\n        else if (vnode.tag === 'textarea' || isTextInputType(el.type)) {\n            el._vModifiers = binding.modifiers;\n            if (!binding.modifiers.lazy) {\n                el.addEventListener('compositionstart', onCompositionStart);\n                el.addEventListener('compositionend', onCompositionEnd);\n                // Safari < 10.2 & UIWebView doesn't fire compositionend when\n                // switching focus before confirming composition choice\n                // this also fixes the issue where some browsers e.g. iOS Chrome\n                // fires \"change\" instead of \"input\" on autocomplete.\n                el.addEventListener('change', onCompositionEnd);\n                /* istanbul ignore if */\n                if (isIE9) {\n                    el.vmodel = true;\n                }\n            }\n        }\n    },\n    componentUpdated: function (el, binding, vnode) {\n        if (vnode.tag === 'select') {\n            setSelected(el, binding, vnode.context);\n            // in case the options rendered by v-for have changed,\n            // it's possible that the value is out-of-sync with the rendered options.\n            // detect such cases and filter out values that no longer has a matching\n            // option in the DOM.\n            var prevOptions_1 = el._vOptions;\n            var curOptions_1 = (el._vOptions = [].map.call(el.options, getValue));\n            if (curOptions_1.some(function (o, i) { return !looseEqual(o, prevOptions_1[i]); })) {\n                // trigger change event if\n                // no matching option found for at least one value\n                var needReset = el.multiple\n                    ? binding.value.some(function (v) { return hasNoMatchingOption(v, curOptions_1); })\n                    : binding.value !== binding.oldValue &&\n                        hasNoMatchingOption(binding.value, curOptions_1);\n                if (needReset) {\n                    trigger(el, 'change');\n                }\n            }\n        }\n    }\n};\nfunction setSelected(el, binding, vm) {\n    actuallySetSelected(el, binding, vm);\n    /* istanbul ignore if */\n    if (isIE || isEdge) {\n        setTimeout(function () {\n            actuallySetSelected(el, binding, vm);\n        }, 0);\n    }\n}\nfunction actuallySetSelected(el, binding, vm) {\n    var value = binding.value;\n    var isMultiple = el.multiple;\n    if (isMultiple && !Array.isArray(value)) {\n        process.env.NODE_ENV !== 'production' &&\n            warn(\"<select multiple v-model=\\\"\".concat(binding.expression, \"\\\"> \") +\n                \"expects an Array value for its binding, but got \".concat(Object.prototype.toString\n                    .call(value)\n                    .slice(8, -1)), vm);\n        return;\n    }\n    var selected, option;\n    for (var i = 0, l = el.options.length; i < l; i++) {\n        option = el.options[i];\n        if (isMultiple) {\n            selected = looseIndexOf(value, getValue(option)) > -1;\n            if (option.selected !== selected) {\n                option.selected = selected;\n            }\n        }\n        else {\n            if (looseEqual(getValue(option), value)) {\n                if (el.selectedIndex !== i) {\n                    el.selectedIndex = i;\n                }\n                return;\n            }\n        }\n    }\n    if (!isMultiple) {\n        el.selectedIndex = -1;\n    }\n}\nfunction hasNoMatchingOption(value, options) {\n    return options.every(function (o) { return !looseEqual(o, value); });\n}\nfunction getValue(option) {\n    return '_value' in option ? option._value : option.value;\n}\nfunction onCompositionStart(e) {\n    e.target.composing = true;\n}\nfunction onCompositionEnd(e) {\n    // prevent triggering an input event for no reason\n    if (!e.target.composing)\n        return;\n    e.target.composing = false;\n    trigger(e.target, 'input');\n}\nfunction trigger(el, type) {\n    var e = document.createEvent('HTMLEvents');\n    e.initEvent(type, true, true);\n    el.dispatchEvent(e);\n}\n\n// recursively search for possible transition defined inside the component root\nfunction locateNode(vnode) {\n    // @ts-expect-error\n    return vnode.componentInstance && (!vnode.data || !vnode.data.transition)\n        ? locateNode(vnode.componentInstance._vnode)\n        : vnode;\n}\nvar show = {\n    bind: function (el, _a, vnode) {\n        var value = _a.value;\n        vnode = locateNode(vnode);\n        var transition = vnode.data && vnode.data.transition;\n        var originalDisplay = (el.__vOriginalDisplay =\n            el.style.display === 'none' ? '' : el.style.display);\n        if (value && transition) {\n            vnode.data.show = true;\n            enter(vnode, function () {\n                el.style.display = originalDisplay;\n            });\n        }\n        else {\n            el.style.display = value ? originalDisplay : 'none';\n        }\n    },\n    update: function (el, _a, vnode) {\n        var value = _a.value, oldValue = _a.oldValue;\n        /* istanbul ignore if */\n        if (!value === !oldValue)\n            return;\n        vnode = locateNode(vnode);\n        var transition = vnode.data && vnode.data.transition;\n        if (transition) {\n            vnode.data.show = true;\n            if (value) {\n                enter(vnode, function () {\n                    el.style.display = el.__vOriginalDisplay;\n                });\n            }\n            else {\n                leave(vnode, function () {\n                    el.style.display = 'none';\n                });\n            }\n        }\n        else {\n            el.style.display = value ? el.__vOriginalDisplay : 'none';\n        }\n    },\n    unbind: function (el, binding, vnode, oldVnode, isDestroy) {\n        if (!isDestroy) {\n            el.style.display = el.__vOriginalDisplay;\n        }\n    }\n};\n\nvar platformDirectives = {\n    model: directive,\n    show: show\n};\n\n// Provides transition support for a single element/component.\nvar transitionProps = {\n    name: String,\n    appear: Boolean,\n    css: Boolean,\n    mode: String,\n    type: String,\n    enterClass: String,\n    leaveClass: String,\n    enterToClass: String,\n    leaveToClass: String,\n    enterActiveClass: String,\n    leaveActiveClass: String,\n    appearClass: String,\n    appearActiveClass: String,\n    appearToClass: String,\n    duration: [Number, String, Object]\n};\n// in case the child is also an abstract component, e.g. <keep-alive>\n// we want to recursively retrieve the real component to be rendered\nfunction getRealChild(vnode) {\n    var compOptions = vnode && vnode.componentOptions;\n    if (compOptions && compOptions.Ctor.options.abstract) {\n        return getRealChild(getFirstComponentChild(compOptions.children));\n    }\n    else {\n        return vnode;\n    }\n}\nfunction extractTransitionData(comp) {\n    var data = {};\n    var options = comp.$options;\n    // props\n    for (var key in options.propsData) {\n        data[key] = comp[key];\n    }\n    // events.\n    // extract listeners and pass them directly to the transition methods\n    var listeners = options._parentListeners;\n    for (var key in listeners) {\n        data[camelize(key)] = listeners[key];\n    }\n    return data;\n}\nfunction placeholder(h, rawChild) {\n    // @ts-expect-error\n    if (/\\d-keep-alive$/.test(rawChild.tag)) {\n        return h('keep-alive', {\n            props: rawChild.componentOptions.propsData\n        });\n    }\n}\nfunction hasParentTransition(vnode) {\n    while ((vnode = vnode.parent)) {\n        if (vnode.data.transition) {\n            return true;\n        }\n    }\n}\nfunction isSameChild(child, oldChild) {\n    return oldChild.key === child.key && oldChild.tag === child.tag;\n}\nvar isNotTextNode = function (c) { return c.tag || isAsyncPlaceholder(c); };\nvar isVShowDirective = function (d) { return d.name === 'show'; };\nvar Transition = {\n    name: 'transition',\n    props: transitionProps,\n    abstract: true,\n    render: function (h) {\n        var _this = this;\n        var children = this.$slots.default;\n        if (!children) {\n            return;\n        }\n        // filter out text nodes (possible whitespaces)\n        children = children.filter(isNotTextNode);\n        /* istanbul ignore if */\n        if (!children.length) {\n            return;\n        }\n        // warn multiple elements\n        if (process.env.NODE_ENV !== 'production' && children.length > 1) {\n            warn('<transition> can only be used on a single element. Use ' +\n                '<transition-group> for lists.', this.$parent);\n        }\n        var mode = this.mode;\n        // warn invalid mode\n        if (process.env.NODE_ENV !== 'production' && mode && mode !== 'in-out' && mode !== 'out-in') {\n            warn('invalid <transition> mode: ' + mode, this.$parent);\n        }\n        var rawChild = children[0];\n        // if this is a component root node and the component's\n        // parent container node also has transition, skip.\n        if (hasParentTransition(this.$vnode)) {\n            return rawChild;\n        }\n        // apply transition data to child\n        // use getRealChild() to ignore abstract components e.g. keep-alive\n        var child = getRealChild(rawChild);\n        /* istanbul ignore if */\n        if (!child) {\n            return rawChild;\n        }\n        if (this._leaving) {\n            return placeholder(h, rawChild);\n        }\n        // ensure a key that is unique to the vnode type and to this transition\n        // component instance. This key will be used to remove pending leaving nodes\n        // during entering.\n        var id = \"__transition-\".concat(this._uid, \"-\");\n        child.key =\n            child.key == null\n                ? child.isComment\n                    ? id + 'comment'\n                    : id + child.tag\n                : isPrimitive(child.key)\n                    ? String(child.key).indexOf(id) === 0\n                        ? child.key\n                        : id + child.key\n                    : child.key;\n        var data = ((child.data || (child.data = {})).transition =\n            extractTransitionData(this));\n        var oldRawChild = this._vnode;\n        var oldChild = getRealChild(oldRawChild);\n        // mark v-show\n        // so that the transition module can hand over the control to the directive\n        if (child.data.directives && child.data.directives.some(isVShowDirective)) {\n            child.data.show = true;\n        }\n        if (oldChild &&\n            oldChild.data &&\n            !isSameChild(child, oldChild) &&\n            !isAsyncPlaceholder(oldChild) &&\n            // #6687 component root is a comment node\n            !(oldChild.componentInstance &&\n                oldChild.componentInstance._vnode.isComment)) {\n            // replace old child transition data with fresh one\n            // important for dynamic transitions!\n            var oldData = (oldChild.data.transition = extend({}, data));\n            // handle transition mode\n            if (mode === 'out-in') {\n                // return placeholder node and queue update when leave finishes\n                this._leaving = true;\n                mergeVNodeHook(oldData, 'afterLeave', function () {\n                    _this._leaving = false;\n                    _this.$forceUpdate();\n                });\n                return placeholder(h, rawChild);\n            }\n            else if (mode === 'in-out') {\n                if (isAsyncPlaceholder(child)) {\n                    return oldRawChild;\n                }\n                var delayedLeave_1;\n                var performLeave = function () {\n                    delayedLeave_1();\n                };\n                mergeVNodeHook(data, 'afterEnter', performLeave);\n                mergeVNodeHook(data, 'enterCancelled', performLeave);\n                mergeVNodeHook(oldData, 'delayLeave', function (leave) {\n                    delayedLeave_1 = leave;\n                });\n            }\n        }\n        return rawChild;\n    }\n};\n\n// Provides transition support for list items.\nvar props = extend({\n    tag: String,\n    moveClass: String\n}, transitionProps);\ndelete props.mode;\nvar TransitionGroup = {\n    props: props,\n    beforeMount: function () {\n        var _this = this;\n        var update = this._update;\n        this._update = function (vnode, hydrating) {\n            var restoreActiveInstance = setActiveInstance(_this);\n            // force removing pass\n            _this.__patch__(_this._vnode, _this.kept, false, // hydrating\n            true // removeOnly (!important, avoids unnecessary moves)\n            );\n            _this._vnode = _this.kept;\n            restoreActiveInstance();\n            update.call(_this, vnode, hydrating);\n        };\n    },\n    render: function (h) {\n        var tag = this.tag || this.$vnode.data.tag || 'span';\n        var map = Object.create(null);\n        var prevChildren = (this.prevChildren = this.children);\n        var rawChildren = this.$slots.default || [];\n        var children = (this.children = []);\n        var transitionData = extractTransitionData(this);\n        for (var i = 0; i < rawChildren.length; i++) {\n            var c = rawChildren[i];\n            if (c.tag) {\n                if (c.key != null && String(c.key).indexOf('__vlist') !== 0) {\n                    children.push(c);\n                    map[c.key] = c;\n                    (c.data || (c.data = {})).transition = transitionData;\n                }\n                else if (process.env.NODE_ENV !== 'production') {\n                    var opts = c.componentOptions;\n                    var name_1 = opts\n                        ? getComponentName(opts.Ctor.options) || opts.tag || ''\n                        : c.tag;\n                    warn(\"<transition-group> children must be keyed: <\".concat(name_1, \">\"));\n                }\n            }\n        }\n        if (prevChildren) {\n            var kept = [];\n            var removed = [];\n            for (var i = 0; i < prevChildren.length; i++) {\n                var c = prevChildren[i];\n                c.data.transition = transitionData;\n                // @ts-expect-error .getBoundingClientRect is not typed in Node\n                c.data.pos = c.elm.getBoundingClientRect();\n                if (map[c.key]) {\n                    kept.push(c);\n                }\n                else {\n                    removed.push(c);\n                }\n            }\n            this.kept = h(tag, null, kept);\n            this.removed = removed;\n        }\n        return h(tag, null, children);\n    },\n    updated: function () {\n        var children = this.prevChildren;\n        var moveClass = this.moveClass || (this.name || 'v') + '-move';\n        if (!children.length || !this.hasMove(children[0].elm, moveClass)) {\n            return;\n        }\n        // we divide the work into three loops to avoid mixing DOM reads and writes\n        // in each iteration - which helps prevent layout thrashing.\n        children.forEach(callPendingCbs);\n        children.forEach(recordPosition);\n        children.forEach(applyTranslation);\n        // force reflow to put everything in position\n        // assign to this to avoid being removed in tree-shaking\n        // $flow-disable-line\n        this._reflow = document.body.offsetHeight;\n        children.forEach(function (c) {\n            if (c.data.moved) {\n                var el_1 = c.elm;\n                var s = el_1.style;\n                addTransitionClass(el_1, moveClass);\n                s.transform = s.WebkitTransform = s.transitionDuration = '';\n                el_1.addEventListener(transitionEndEvent, (el_1._moveCb = function cb(e) {\n                    if (e && e.target !== el_1) {\n                        return;\n                    }\n                    if (!e || /transform$/.test(e.propertyName)) {\n                        el_1.removeEventListener(transitionEndEvent, cb);\n                        el_1._moveCb = null;\n                        removeTransitionClass(el_1, moveClass);\n                    }\n                }));\n            }\n        });\n    },\n    methods: {\n        hasMove: function (el, moveClass) {\n            /* istanbul ignore if */\n            if (!hasTransition) {\n                return false;\n            }\n            /* istanbul ignore if */\n            if (this._hasMove) {\n                return this._hasMove;\n            }\n            // Detect whether an element with the move class applied has\n            // CSS transitions. Since the element may be inside an entering\n            // transition at this very moment, we make a clone of it and remove\n            // all other transition classes applied to ensure only the move class\n            // is applied.\n            var clone = el.cloneNode();\n            if (el._transitionClasses) {\n                el._transitionClasses.forEach(function (cls) {\n                    removeClass(clone, cls);\n                });\n            }\n            addClass(clone, moveClass);\n            clone.style.display = 'none';\n            this.$el.appendChild(clone);\n            var info = getTransitionInfo(clone);\n            this.$el.removeChild(clone);\n            return (this._hasMove = info.hasTransform);\n        }\n    }\n};\nfunction callPendingCbs(c) {\n    /* istanbul ignore if */\n    if (c.elm._moveCb) {\n        c.elm._moveCb();\n    }\n    /* istanbul ignore if */\n    if (c.elm._enterCb) {\n        c.elm._enterCb();\n    }\n}\nfunction recordPosition(c) {\n    c.data.newPos = c.elm.getBoundingClientRect();\n}\nfunction applyTranslation(c) {\n    var oldPos = c.data.pos;\n    var newPos = c.data.newPos;\n    var dx = oldPos.left - newPos.left;\n    var dy = oldPos.top - newPos.top;\n    if (dx || dy) {\n        c.data.moved = true;\n        var s = c.elm.style;\n        s.transform = s.WebkitTransform = \"translate(\".concat(dx, \"px,\").concat(dy, \"px)\");\n        s.transitionDuration = '0s';\n    }\n}\n\nvar platformComponents = {\n    Transition: Transition,\n    TransitionGroup: TransitionGroup\n};\n\n// install platform specific utils\nVue.config.mustUseProp = mustUseProp;\nVue.config.isReservedTag = isReservedTag;\nVue.config.isReservedAttr = isReservedAttr;\nVue.config.getTagNamespace = getTagNamespace;\nVue.config.isUnknownElement = isUnknownElement;\n// install platform runtime directives & components\nextend(Vue.options.directives, platformDirectives);\nextend(Vue.options.components, platformComponents);\n// install platform patch function\nVue.prototype.__patch__ = inBrowser ? patch : noop;\n// public mount method\nVue.prototype.$mount = function (el, hydrating) {\n    el = el && inBrowser ? query(el) : undefined;\n    return mountComponent(this, el, hydrating);\n};\n// devtools global hook\n/* istanbul ignore next */\nif (inBrowser) {\n    setTimeout(function () {\n        if (config.devtools) {\n            if (devtools) {\n                devtools.emit('init', Vue);\n            }\n            else if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {\n                // @ts-expect-error\n                console[console.info ? 'info' : 'log']('Download the Vue Devtools extension for a better development experience:\\n' +\n                    'https://github.com/vuejs/vue-devtools');\n            }\n        }\n        if (process.env.NODE_ENV !== 'production' &&\n            process.env.NODE_ENV !== 'test' &&\n            config.productionTip !== false &&\n            typeof console !== 'undefined') {\n            // @ts-expect-error\n            console[console.info ? 'info' : 'log'](\"You are running Vue in development mode.\\n\" +\n                \"Make sure to turn on production mode when deploying for production.\\n\" +\n                \"See more tips at https://vuejs.org/guide/deployment.html\");\n        }\n    }, 0);\n}\n\nexport { EffectScope, computed, customRef, Vue as default, defineAsyncComponent, defineComponent, del, effectScope, getCurrentInstance, getCurrentScope, h, inject, isProxy, isReactive, isReadonly, isRef, isShallow, markRaw, mergeDefaults, nextTick, onActivated, onBeforeMount, onBeforeUnmount, onBeforeUpdate, onDeactivated, onErrorCaptured, onMounted, onRenderTracked, onRenderTriggered, onScopeDispose, onServerPrefetch, onUnmounted, onUpdated, provide, proxyRefs, reactive, readonly, ref$1 as ref, set, shallowReactive, shallowReadonly, shallowRef, toRaw, toRef, toRefs, triggerRef, unref, useAttrs, useCssModule, useCssVars, useListeners, useSlots, version, watch, watchEffect, watchPostEffect, watchSyncEffect };\n"],"mappings":"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","ignoreList":[]}]}